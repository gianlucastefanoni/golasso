(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();function Ck(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var kp={exports:{}},xu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cy;function Rk(){if(Cy)return xu;Cy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,o){var c=null;if(o!==void 0&&(c=""+o),a.key!==void 0&&(c=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:n,key:c,ref:a!==void 0?a:null,props:o}}return xu.Fragment=e,xu.jsx=r,xu.jsxs=r,xu}var Ry;function Ik(){return Ry||(Ry=1,kp.exports=Rk()),kp.exports}var F=Ik(),Cp={exports:{}},st={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iy;function Nk(){if(Iy)return st;Iy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function _(Y){return Y===null||typeof Y!="object"?null:(Y=x&&Y[x]||Y["@@iterator"],typeof Y=="function"?Y:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,A={};function w(Y,ve,j){this.props=Y,this.context=ve,this.refs=A,this.updater=j||T}w.prototype.isReactComponent={},w.prototype.setState=function(Y,ve){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,ve,"setState")},w.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function N(){}N.prototype=w.prototype;function U(Y,ve,j){this.props=Y,this.context=ve,this.refs=A,this.updater=j||T}var R=U.prototype=new N;R.constructor=U,y(R,w.prototype),R.isPureReactComponent=!0;var K=Array.isArray,te={H:null,A:null,T:null,S:null,V:null},J=Object.prototype.hasOwnProperty;function b(Y,ve,j,Q,ee,re){return j=re.ref,{$$typeof:t,type:Y,key:ve,ref:j!==void 0?j:null,props:re}}function I(Y,ve){return b(Y.type,ve,void 0,void 0,void 0,Y.props)}function C(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===t}function V(Y){var ve={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(j){return ve[j]})}var M=/\/+/g;function O(Y,ve){return typeof Y=="object"&&Y!==null&&Y.key!=null?V(""+Y.key):ve.toString(36)}function L(){}function De(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(L,L):(Y.status="pending",Y.then(function(ve){Y.status==="pending"&&(Y.status="fulfilled",Y.value=ve)},function(ve){Y.status==="pending"&&(Y.status="rejected",Y.reason=ve)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function be(Y,ve,j,Q,ee){var re=typeof Y;(re==="undefined"||re==="boolean")&&(Y=null);var me=!1;if(Y===null)me=!0;else switch(re){case"bigint":case"string":case"number":me=!0;break;case"object":switch(Y.$$typeof){case t:case e:me=!0;break;case g:return me=Y._init,be(me(Y._payload),ve,j,Q,ee)}}if(me)return ee=ee(Y),me=Q===""?"."+O(Y,0):Q,K(ee)?(j="",me!=null&&(j=me.replace(M,"$&/")+"/"),be(ee,ve,j,"",function(Fe){return Fe})):ee!=null&&(C(ee)&&(ee=I(ee,j+(ee.key==null||Y&&Y.key===ee.key?"":(""+ee.key).replace(M,"$&/")+"/")+me)),ve.push(ee)),1;me=0;var Ie=Q===""?".":Q+":";if(K(Y))for(var Ne=0;Ne<Y.length;Ne++)Q=Y[Ne],re=Ie+O(Q,Ne),me+=be(Q,ve,j,re,ee);else if(Ne=_(Y),typeof Ne=="function")for(Y=Ne.call(Y),Ne=0;!(Q=Y.next()).done;)Q=Q.value,re=Ie+O(Q,Ne++),me+=be(Q,ve,j,re,ee);else if(re==="object"){if(typeof Y.then=="function")return be(De(Y),ve,j,Q,ee);throw ve=String(Y),Error("Objects are not valid as a React child (found: "+(ve==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":ve)+"). If you meant to render a collection of children, use an array instead.")}return me}function ae(Y,ve,j){if(Y==null)return Y;var Q=[],ee=0;return be(Y,Q,"","",function(re){return ve.call(j,re,ee++)}),Q}function ue(Y){if(Y._status===-1){var ve=Y._result;ve=ve(),ve.then(function(j){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=j)},function(j){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=j)}),Y._status===-1&&(Y._status=0,Y._result=ve)}if(Y._status===1)return Y._result.default;throw Y._result}var Le=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ve=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(ve))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)};function oe(){}return st.Children={map:ae,forEach:function(Y,ve,j){ae(Y,function(){ve.apply(this,arguments)},j)},count:function(Y){var ve=0;return ae(Y,function(){ve++}),ve},toArray:function(Y){return ae(Y,function(ve){return ve})||[]},only:function(Y){if(!C(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},st.Component=w,st.Fragment=r,st.Profiler=a,st.PureComponent=U,st.StrictMode=n,st.Suspense=h,st.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=te,st.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return te.H.useMemoCache(Y)}},st.cache=function(Y){return function(){return Y.apply(null,arguments)}},st.cloneElement=function(Y,ve,j){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var Q=y({},Y.props),ee=Y.key,re=void 0;if(ve!=null)for(me in ve.ref!==void 0&&(re=void 0),ve.key!==void 0&&(ee=""+ve.key),ve)!J.call(ve,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&ve.ref===void 0||(Q[me]=ve[me]);var me=arguments.length-2;if(me===1)Q.children=j;else if(1<me){for(var Ie=Array(me),Ne=0;Ne<me;Ne++)Ie[Ne]=arguments[Ne+2];Q.children=Ie}return b(Y.type,ee,void 0,void 0,re,Q)},st.createContext=function(Y){return Y={$$typeof:c,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:o,_context:Y},Y},st.createElement=function(Y,ve,j){var Q,ee={},re=null;if(ve!=null)for(Q in ve.key!==void 0&&(re=""+ve.key),ve)J.call(ve,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(ee[Q]=ve[Q]);var me=arguments.length-2;if(me===1)ee.children=j;else if(1<me){for(var Ie=Array(me),Ne=0;Ne<me;Ne++)Ie[Ne]=arguments[Ne+2];ee.children=Ie}if(Y&&Y.defaultProps)for(Q in me=Y.defaultProps,me)ee[Q]===void 0&&(ee[Q]=me[Q]);return b(Y,re,void 0,void 0,null,ee)},st.createRef=function(){return{current:null}},st.forwardRef=function(Y){return{$$typeof:u,render:Y}},st.isValidElement=C,st.lazy=function(Y){return{$$typeof:g,_payload:{_status:-1,_result:Y},_init:ue}},st.memo=function(Y,ve){return{$$typeof:d,type:Y,compare:ve===void 0?null:ve}},st.startTransition=function(Y){var ve=te.T,j={};te.T=j;try{var Q=Y(),ee=te.S;ee!==null&&ee(j,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(oe,Le)}catch(re){Le(re)}finally{te.T=ve}},st.unstable_useCacheRefresh=function(){return te.H.useCacheRefresh()},st.use=function(Y){return te.H.use(Y)},st.useActionState=function(Y,ve,j){return te.H.useActionState(Y,ve,j)},st.useCallback=function(Y,ve){return te.H.useCallback(Y,ve)},st.useContext=function(Y){return te.H.useContext(Y)},st.useDebugValue=function(){},st.useDeferredValue=function(Y,ve){return te.H.useDeferredValue(Y,ve)},st.useEffect=function(Y,ve,j){var Q=te.H;if(typeof j=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Q.useEffect(Y,ve)},st.useId=function(){return te.H.useId()},st.useImperativeHandle=function(Y,ve,j){return te.H.useImperativeHandle(Y,ve,j)},st.useInsertionEffect=function(Y,ve){return te.H.useInsertionEffect(Y,ve)},st.useLayoutEffect=function(Y,ve){return te.H.useLayoutEffect(Y,ve)},st.useMemo=function(Y,ve){return te.H.useMemo(Y,ve)},st.useOptimistic=function(Y,ve){return te.H.useOptimistic(Y,ve)},st.useReducer=function(Y,ve,j){return te.H.useReducer(Y,ve,j)},st.useRef=function(Y){return te.H.useRef(Y)},st.useState=function(Y){return te.H.useState(Y)},st.useSyncExternalStore=function(Y,ve,j){return te.H.useSyncExternalStore(Y,ve,j)},st.useTransition=function(){return te.H.useTransition()},st.version="19.1.0",st}var Ny;function Gg(){return Ny||(Ny=1,Cp.exports=Nk()),Cp.exports}var _e=Gg();const q0=Ck(_e);var Rp={exports:{}},_u={},Ip={exports:{}},Np={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy;function Dk(){return Dy||(Dy=1,function(t){function e(ae,ue){var Le=ae.length;ae.push(ue);e:for(;0<Le;){var oe=Le-1>>>1,Y=ae[oe];if(0<a(Y,ue))ae[oe]=ue,ae[Le]=Y,Le=oe;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var ue=ae[0],Le=ae.pop();if(Le!==ue){ae[0]=Le;e:for(var oe=0,Y=ae.length,ve=Y>>>1;oe<ve;){var j=2*(oe+1)-1,Q=ae[j],ee=j+1,re=ae[ee];if(0>a(Q,Le))ee<Y&&0>a(re,Q)?(ae[oe]=re,ae[ee]=Le,oe=ee):(ae[oe]=Q,ae[j]=Le,oe=j);else if(ee<Y&&0>a(re,Le))ae[oe]=re,ae[ee]=Le,oe=ee;else break e}}return ue}function a(ae,ue){var Le=ae.sortIndex-ue.sortIndex;return Le!==0?Le:ae.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],d=[],g=1,x=null,_=3,T=!1,y=!1,A=!1,w=!1,N=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function K(ae){for(var ue=r(d);ue!==null;){if(ue.callback===null)n(d);else if(ue.startTime<=ae)n(d),ue.sortIndex=ue.expirationTime,e(h,ue);else break;ue=r(d)}}function te(ae){if(A=!1,K(ae),!y)if(r(h)!==null)y=!0,J||(J=!0,O());else{var ue=r(d);ue!==null&&be(te,ue.startTime-ae)}}var J=!1,b=-1,I=5,C=-1;function V(){return w?!0:!(t.unstable_now()-C<I)}function M(){if(w=!1,J){var ae=t.unstable_now();C=ae;var ue=!0;try{e:{y=!1,A&&(A=!1,U(b),b=-1),T=!0;var Le=_;try{t:{for(K(ae),x=r(h);x!==null&&!(x.expirationTime>ae&&V());){var oe=x.callback;if(typeof oe=="function"){x.callback=null,_=x.priorityLevel;var Y=oe(x.expirationTime<=ae);if(ae=t.unstable_now(),typeof Y=="function"){x.callback=Y,K(ae),ue=!0;break t}x===r(h)&&n(h),K(ae)}else n(h);x=r(h)}if(x!==null)ue=!0;else{var ve=r(d);ve!==null&&be(te,ve.startTime-ae),ue=!1}}break e}finally{x=null,_=Le,T=!1}ue=void 0}}finally{ue?O():J=!1}}}var O;if(typeof R=="function")O=function(){R(M)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,De=L.port2;L.port1.onmessage=M,O=function(){De.postMessage(null)}}else O=function(){N(M,0)};function be(ae,ue){b=N(function(){ae(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ae){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var Le=_;_=ue;try{return ae()}finally{_=Le}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(ae,ue){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var Le=_;_=ae;try{return ue()}finally{_=Le}},t.unstable_scheduleCallback=function(ae,ue,Le){var oe=t.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?oe+Le:oe):Le=oe,ae){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=Le+Y,ae={id:g++,callback:ue,priorityLevel:ae,startTime:Le,expirationTime:Y,sortIndex:-1},Le>oe?(ae.sortIndex=Le,e(d,ae),r(h)===null&&ae===r(d)&&(A?(U(b),b=-1):A=!0,be(te,Le-oe))):(ae.sortIndex=Y,e(h,ae),y||T||(y=!0,J||(J=!0,O()))),ae},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(ae){var ue=_;return function(){var Le=_;_=ue;try{return ae.apply(this,arguments)}finally{_=Le}}}}(Np)),Np}var Oy;function Ok(){return Oy||(Oy=1,Ip.exports=Dk()),Ip.exports}var Dp={exports:{}},en={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fy;function Fk(){if(Fy)return en;Fy=1;var t=Gg();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:h,containerInfo:d,implementation:g}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return en.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,en.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,g)},en.flushSync=function(h){var d=c.T,g=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=d,n.p=g,n.d.f()}},en.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},en.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},en.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,T=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:T}):g==="script"&&n.d.X(h,{crossOrigin:x,integrity:_,fetchPriority:T,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},en.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},en.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin);n.d.L(h,g,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},en.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},en.requestFormReset=function(h){n.d.r(h)},en.unstable_batchedUpdates=function(h,d){return h(d)},en.useFormState=function(h,d,g){return c.H.useFormState(h,d,g)},en.useFormStatus=function(){return c.H.useHostTransitionStatus()},en.version="19.1.0",en}var My;function Mk(){if(My)return Dp.exports;My=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Dp.exports=Fk(),Dp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py;function Pk(){if(Py)return _u;Py=1;var t=Ok(),e=Gg(),r=Mk();function n(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,l=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(l=s.return),i=s.return;while(i)}return s.tag===3?l:null}function c(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(o(i)!==i)throw Error(n(188))}function h(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(n(188));return s!==i?null:i}for(var l=i,f=s;;){var p=l.return;if(p===null)break;var v=p.alternate;if(v===null){if(f=p.return,f!==null){l=f;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===l)return u(p),i;if(v===f)return u(p),s;v=v.sibling}throw Error(n(188))}if(l.return!==f.return)l=p,f=v;else{for(var k=!1,P=p.child;P;){if(P===l){k=!0,l=p,f=v;break}if(P===f){k=!0,f=p,l=v;break}P=P.sibling}if(!k){for(P=v.child;P;){if(P===l){k=!0,l=v,f=p;break}if(P===f){k=!0,f=v,l=p;break}P=P.sibling}if(!k)throw Error(n(189))}}if(l.alternate!==f)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?i:s}function d(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=d(i),s!==null)return s;i=i.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),U=Symbol.for("react.consumer"),R=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function O(i){return i===null||typeof i!="object"?null:(i=M&&i[M]||i["@@iterator"],typeof i=="function"?i:null)}var L=Symbol.for("react.client.reference");function De(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===L?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case y:return"Fragment";case w:return"Profiler";case A:return"StrictMode";case te:return"Suspense";case J:return"SuspenseList";case C:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case T:return"Portal";case R:return(i.displayName||"Context")+".Provider";case U:return(i._context.displayName||"Context")+".Consumer";case K:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case b:return s=i.displayName||null,s!==null?s:De(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return De(i(s))}catch{}}return null}var be=Array.isArray,ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Le={pending:!1,data:null,method:null,action:null},oe=[],Y=-1;function ve(i){return{current:i}}function j(i){0>Y||(i.current=oe[Y],oe[Y]=null,Y--)}function Q(i,s){Y++,oe[Y]=i.current,i.current=s}var ee=ve(null),re=ve(null),me=ve(null),Ie=ve(null);function Ne(i,s){switch(Q(me,s),Q(re,i),Q(ee,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?ry(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=ry(s),i=ny(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}j(ee),Q(ee,i)}function Fe(){j(ee),j(re),j(me)}function Re(i){i.memoizedState!==null&&Q(Ie,i);var s=ee.current,l=ny(s,i.type);s!==l&&(Q(re,i),Q(ee,l))}function rt(i){re.current===i&&(j(ee),j(re)),Ie.current===i&&(j(Ie),du._currentValue=Le)}var W=Object.prototype.hasOwnProperty,Ot=t.unstable_scheduleCallback,ot=t.unstable_cancelCallback,St=t.unstable_shouldYield,at=t.unstable_requestPaint,Pe=t.unstable_now,Kt=t.unstable_getCurrentPriorityLevel,Ir=t.unstable_ImmediatePriority,Ur=t.unstable_UserBlockingPriority,Br=t.unstable_NormalPriority,li=t.unstable_LowPriority,dn=t.unstable_IdlePriority,_r=t.log,bn=t.unstable_setDisableYieldValue,Rt=null,pt=null;function Ft(i){if(typeof _r=="function"&&bn(i),pt&&typeof pt.setStrictMode=="function")try{pt.setStrictMode(Rt,i)}catch{}}var jt=Math.clz32?Math.clz32:fr,nt=Math.log,$t=Math.LN2;function fr(i){return i>>>=0,i===0?32:31-(nt(i)/$t|0)|0}var Ht=256,mn=4194304;function kn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ki(i,s,l){var f=i.pendingLanes;if(f===0)return 0;var p=0,v=i.suspendedLanes,k=i.pingedLanes;i=i.warmLanes;var P=f&134217727;return P!==0?(f=P&~v,f!==0?p=kn(f):(k&=P,k!==0?p=kn(k):l||(l=P&~i,l!==0&&(p=kn(l))))):(P=f&~v,P!==0?p=kn(P):k!==0?p=kn(k):l||(l=f&~i,l!==0&&(p=kn(l)))),p===0?0:s!==0&&s!==p&&(s&v)===0&&(v=p&-p,l=s&-s,v>=l||v===32&&(l&4194048)!==0)?s:p}function ci(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function $i(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yi(){var i=Ht;return Ht<<=1,(Ht&4194048)===0&&(Ht=256),i}function Wi(){var i=mn;return mn<<=1,(mn&62914560)===0&&(mn=4194304),i}function pa(i){for(var s=[],l=0;31>l;l++)s.push(i);return s}function ga(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Da(i,s,l,f,p,v){var k=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var P=i.entanglements,Z=i.expirationTimes,he=i.hiddenUpdates;for(l=k&~l;0<l;){var Te=31-jt(l),Ae=1<<Te;P[Te]=0,Z[Te]=-1;var ge=he[Te];if(ge!==null)for(he[Te]=null,Te=0;Te<ge.length;Te++){var xe=ge[Te];xe!==null&&(xe.lane&=-536870913)}l&=~Ae}f!==0&&Wn(i,f,0),v!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=v&~(k&~s))}function Wn(i,s,l){i.pendingLanes|=s,i.suspendedLanes&=~s;var f=31-jt(s);i.entangledLanes|=s,i.entanglements[f]=i.entanglements[f]|1073741824|l&4194090}function Ws(i,s){var l=i.entangledLanes|=s;for(i=i.entanglements;l;){var f=31-jt(l),p=1<<f;p&s|i[f]&s&&(i[f]|=s),l&=~p}}function Oa(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Qi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Fa(){var i=ue.p;return i!==0?i:(i=window.event,i===void 0?32:Ty(i.type))}function Wo(i,s){var l=ue.p;try{return ue.p=i,s()}finally{ue.p=l}}var Gt=Math.random().toString(36).slice(2),sr="__reactFiber$"+Gt,Yt="__reactProps$"+Gt,Cn="__reactContainer$"+Gt,Qs="__reactEvents$"+Gt,yc="__reactListeners$"+Gt,D="__reactHandles$"+Gt,q="__reactResources$"+Gt,H="__reactMarker$"+Gt;function z(i){delete i[sr],delete i[Yt],delete i[Qs],delete i[yc],delete i[D]}function G(i){var s=i[sr];if(s)return s;for(var l=i.parentNode;l;){if(s=l[Cn]||l[sr]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(i=oy(i);i!==null;){if(l=i[sr])return l;i=oy(i)}return s}i=l,l=i.parentNode}return null}function X(i){if(i=i[sr]||i[Cn]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function fe(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(n(33))}function ye(i){var s=i[q];return s||(s=i[q]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function se(i){i[H]=!0}var de=new Set,pe={};function ke(i,s){Me(i,s),Me(i+"Capture",s)}function Me(i,s){for(pe[i]=s,i=0;i<s.length;i++)de.add(s[i])}var Be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Oe={},Ue={};function Ye(i){return W.call(Ue,i)?!0:W.call(Oe,i)?!1:Be.test(i)?Ue[i]=!0:(Oe[i]=!0,!1)}function kt(i,s,l){if(Ye(s))if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+l)}}function vt(i,s,l){if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+l)}}function xt(i,s,l,f){if(f===null)i.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(s,l,""+f)}}var Pn,Ma;function pn(i){if(Pn===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Pn=s&&s[1]||"",Ma=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pn+i+Ma}var Rn=!1;function Pa(i,s){if(!i||Rn)return"";Rn=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Ae=function(){throw Error()};if(Object.defineProperty(Ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ae,[])}catch(xe){var ge=xe}Reflect.construct(i,[],Ae)}else{try{Ae.call()}catch(xe){ge=xe}i.call(Ae.prototype)}}else{try{throw Error()}catch(xe){ge=xe}(Ae=i())&&typeof Ae.catch=="function"&&Ae.catch(function(){})}}catch(xe){if(xe&&ge&&typeof xe.stack=="string")return[xe.stack,ge.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),k=v[0],P=v[1];if(k&&P){var Z=k.split(`
`),he=P.split(`
`);for(p=f=0;f<Z.length&&!Z[f].includes("DetermineComponentFrameRoot");)f++;for(;p<he.length&&!he[p].includes("DetermineComponentFrameRoot");)p++;if(f===Z.length||p===he.length)for(f=Z.length-1,p=he.length-1;1<=f&&0<=p&&Z[f]!==he[p];)p--;for(;1<=f&&0<=p;f--,p--)if(Z[f]!==he[p]){if(f!==1||p!==1)do if(f--,p--,0>p||Z[f]!==he[p]){var Te=`
`+Z[f].replace(" at new "," at ");return i.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",i.displayName)),Te}while(1<=f&&0<=p);break}}}finally{Rn=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?pn(l):""}function gn(i){switch(i.tag){case 26:case 27:case 5:return pn(i.type);case 16:return pn("Lazy");case 13:return pn("Suspense");case 19:return pn("SuspenseList");case 0:case 15:return Pa(i.type,!1);case 11:return Pa(i.type.render,!1);case 1:return Pa(i.type,!0);case 31:return pn("Activity");default:return""}}function Qo(i){try{var s="";do s+=gn(i),i=i.return;while(i);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function vn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ec(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Nd(i){var s=Ec(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),f=""+i[s];if(!i.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,v=l.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return p.call(this)},set:function(k){f=""+k,v.call(this,k)}}),Object.defineProperty(i,s,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(k){f=""+k},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Zo(i){i._valueTracker||(i._valueTracker=Nd(i))}function Tc(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return i&&(f=Ec(i)?i.checked?"true":"false":i.value),i=f,i!==l?(s.setValue(i),!0):!1}function Zs(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Dd=/[\n"\\]/g;function hr(i){return i.replace(Dd,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ln(i,s,l,f,p,v,k,P){i.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?i.type=k:i.removeAttribute("type"),s!=null?k==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+vn(s)):i.value!==""+vn(s)&&(i.value=""+vn(s)):k!=="submit"&&k!=="reset"||i.removeAttribute("value"),s!=null?Zi(i,k,vn(s)):l!=null?Zi(i,k,vn(l)):f!=null&&i.removeAttribute("value"),p==null&&v!=null&&(i.defaultChecked=!!v),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?i.name=""+vn(P):i.removeAttribute("name")}function Js(i,s,l,f,p,v,k,P){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),s!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||s!=null))return;l=l!=null?""+vn(l):"",s=s!=null?""+vn(s):l,P||s===i.value||(i.value=s),i.defaultValue=s}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=P?i.checked:!!f,i.defaultChecked=!!f,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(i.name=k)}function Zi(i,s,l){s==="number"&&Zs(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function ui(i,s,l,f){if(i=i.options,s){s={};for(var p=0;p<l.length;p++)s["$"+l[p]]=!0;for(l=0;l<i.length;l++)p=s.hasOwnProperty("$"+i[l].value),i[l].selected!==p&&(i[l].selected=p),p&&f&&(i[l].defaultSelected=!0)}else{for(l=""+vn(l),s=null,p=0;p<i.length;p++){if(i[p].value===l){i[p].selected=!0,f&&(i[p].defaultSelected=!0);return}s!==null||i[p].disabled||(s=i[p])}s!==null&&(s.selected=!0)}}function Lt(i,s,l){if(s!=null&&(s=""+vn(s),s!==i.value&&(i.value=s),l==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=l!=null?""+vn(l):""}function eo(i,s,l,f){if(s==null){if(f!=null){if(l!=null)throw Error(n(92));if(be(f)){if(1<f.length)throw Error(n(93));f=f[0]}l=f}l==null&&(l=""),s=l}l=vn(s),i.defaultValue=l,f=i.textContent,f===l&&f!==""&&f!==null&&(i.value=f)}function Qn(i,s){if(s){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=s;return}}i.textContent=s}var to=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function If(i,s,l){var f=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":f?i.setProperty(s,l):typeof l!="number"||l===0||to.has(s)?s==="float"?i.cssFloat=l:i[s]=(""+l).trim():i[s]=l+"px"}function wc(i,s,l){if(s!=null&&typeof s!="object")throw Error(n(62));if(i=i.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var p in s)f=s[p],s.hasOwnProperty(p)&&l[p]!==f&&If(i,p,f)}else for(var v in s)s.hasOwnProperty(v)&&If(i,v,s[v])}function Ac(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Od=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jo(i){return Fd.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var fi=null;function Zn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var hi=null,di=null;function Sc(i){var s=X(i);if(s&&(i=s.stateNode)){var l=i[Yt]||null;e:switch(i=s.stateNode,s.type){case"input":if(Ln(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+hr(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==i&&f.form===i.form){var p=f[Yt]||null;if(!p)throw Error(n(90));Ln(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<l.length;s++)f=l[s],f.form===i.form&&Tc(f)}break e;case"textarea":Lt(i,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&ui(i,!!l.multiple,s,!1)}}}var La=!1;function Nf(i,s,l){if(La)return i(s,l);La=!0;try{var f=i(s);return f}finally{if(La=!1,(hi!==null||di!==null)&&(A0(),hi&&(s=hi,i=di,di=hi=null,Sc(s),i)))for(s=0;s<i.length;s++)Sc(i[s])}}function ro(i,s){var l=i.stateNode;if(l===null)return null;var f=l[Yt]||null;if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(n(231,s,typeof l));return l}var va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jn=!1;if(va)try{var no={};Object.defineProperty(no,"passive",{get:function(){Jn=!0}}),window.addEventListener("test",no,no),window.removeEventListener("test",no,no)}catch{Jn=!1}var Va=null,Ji=null,mi=null;function bc(){if(mi)return mi;var i,s=Ji,l=s.length,f,p="value"in Va?Va.value:Va.textContent,v=p.length;for(i=0;i<l&&s[i]===p[i];i++);var k=l-i;for(f=1;f<=k&&s[l-f]===p[v-f];f++);return mi=p.slice(i,1<f?1-f:void 0)}function Ua(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Ba(){return!0}function kc(){return!1}function Nr(i){function s(l,f,p,v,k){this._reactName=l,this._targetInst=p,this.type=f,this.nativeEvent=v,this.target=k,this.currentTarget=null;for(var P in i)i.hasOwnProperty(P)&&(l=i[P],this[P]=l?l(v):v[P]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ba:kc,this.isPropagationStopped=kc,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),s}var Nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=Nr(Nt),ao=g({},Nt,{view:0,detail:0}),Df=Nr(ao),tl,rl,ja,io=g({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ja&&(ja&&i.type==="mousemove"?(tl=i.screenX-ja.screenX,rl=i.screenY-ja.screenY):rl=tl=0,ja=i),tl)},movementY:function(i){return"movementY"in i?i.movementY:rl}}),ea=Nr(io),Of=g({},io,{dataTransfer:0}),Md=Nr(Of),so=g({},ao,{relatedTarget:0}),nl=Nr(so),Cc=g({},Nt,{animationName:0,elapsedTime:0,pseudoElement:0}),al=Nr(Cc),Ff=g({},Nt,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),il=Nr(Ff),Pd=g({},Nt,{data:0}),Rc=Nr(Pd),oo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ic(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Pf[i])?!!s[i]:!1}function lo(){return Ic}var Lf=g({},ao,{key:function(i){if(i.key){var s=oo[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Ua(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Mf[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(i){return i.type==="keypress"?Ua(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ua(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),sl=Nr(Lf),Vf=g({},io,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nc=Nr(Vf),pi=g({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),Uf=Nr(pi),Bf=g({},Nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),jf=Nr(Bf),Hf=g({},io,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ol=Nr(Hf),xn=g({},Nt,{newState:0,oldState:0}),zf=Nr(xn),Gf=[9,13,27,32],Ha=va&&"CompositionEvent"in window,m=null;va&&"documentMode"in document&&(m=document.documentMode);var E=va&&"TextEvent"in window&&!m,S=va&&(!Ha||m&&8<m&&11>=m),B=" ",le=!1;function Ee(i,s){switch(i){case"keyup":return Gf.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ve(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var _t=!1;function yr(i,s){switch(i){case"compositionend":return Ve(s);case"keypress":return s.which!==32?null:(le=!0,B);case"textInput":return i=s.data,i===B&&le?null:i;default:return null}}function yt(i,s){if(_t)return i==="compositionend"||!Ha&&Ee(i,s)?(i=bc(),mi=Ji=Va=null,_t=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return S&&s.locale!=="ko"?null:s.data;default:return null}}var Dr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Er(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Dr[i.type]:s==="textarea"}function gi(i,s,l,f){hi?di?di.push(f):di=[f]:hi=f,s=I0(s,"onChange"),0<s.length&&(l=new el("onChange","change",null,l,f),i.push({event:l,listeners:s}))}var jr=null,za=null;function Dc(i){Q_(i,0)}function qf(i){var s=fe(i);if(Tc(s))return i}function xv(i,s){if(i==="change")return s}var _v=!1;if(va){var Ld;if(va){var Vd="oninput"in document;if(!Vd){var yv=document.createElement("div");yv.setAttribute("oninput","return;"),Vd=typeof yv.oninput=="function"}Ld=Vd}else Ld=!1;_v=Ld&&(!document.documentMode||9<document.documentMode)}function Ev(){jr&&(jr.detachEvent("onpropertychange",Tv),za=jr=null)}function Tv(i){if(i.propertyName==="value"&&qf(za)){var s=[];gi(s,za,i,Zn(i)),Nf(Dc,s)}}function ab(i,s,l){i==="focusin"?(Ev(),jr=s,za=l,jr.attachEvent("onpropertychange",Tv)):i==="focusout"&&Ev()}function ib(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return qf(za)}function sb(i,s){if(i==="click")return qf(s)}function ob(i,s){if(i==="input"||i==="change")return qf(s)}function lb(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Vn=typeof Object.is=="function"?Object.is:lb;function Oc(i,s){if(Vn(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var l=Object.keys(i),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var p=l[f];if(!W.call(s,p)||!Vn(i[p],s[p]))return!1}return!0}function wv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Av(i,s){var l=wv(i);i=0;for(var f;l;){if(l.nodeType===3){if(f=i+l.textContent.length,i<=s&&f>=s)return{node:l,offset:s-i};i=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=wv(l)}}function Sv(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Sv(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function bv(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Zs(i.document);s instanceof i.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)i=s.contentWindow;else break;s=Zs(i.document)}return s}function Ud(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var cb=va&&"documentMode"in document&&11>=document.documentMode,ll=null,Bd=null,Fc=null,jd=!1;function kv(i,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;jd||ll==null||ll!==Zs(f)||(f=ll,"selectionStart"in f&&Ud(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Fc&&Oc(Fc,f)||(Fc=f,f=I0(Bd,"onSelect"),0<f.length&&(s=new el("onSelect","select",null,s,l),i.push({event:s,listeners:f}),s.target=ll)))}function co(i,s){var l={};return l[i.toLowerCase()]=s.toLowerCase(),l["Webkit"+i]="webkit"+s,l["Moz"+i]="moz"+s,l}var cl={animationend:co("Animation","AnimationEnd"),animationiteration:co("Animation","AnimationIteration"),animationstart:co("Animation","AnimationStart"),transitionrun:co("Transition","TransitionRun"),transitionstart:co("Transition","TransitionStart"),transitioncancel:co("Transition","TransitionCancel"),transitionend:co("Transition","TransitionEnd")},Hd={},Cv={};va&&(Cv=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function uo(i){if(Hd[i])return Hd[i];if(!cl[i])return i;var s=cl[i],l;for(l in s)if(s.hasOwnProperty(l)&&l in Cv)return Hd[i]=s[l];return i}var Rv=uo("animationend"),Iv=uo("animationiteration"),Nv=uo("animationstart"),ub=uo("transitionrun"),fb=uo("transitionstart"),hb=uo("transitioncancel"),Dv=uo("transitionend"),Ov=new Map,zd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");zd.push("scrollEnd");function xa(i,s){Ov.set(i,s),ke(s,[i])}var Fv=new WeakMap;function ta(i,s){if(typeof i=="object"&&i!==null){var l=Fv.get(i);return l!==void 0?l:(s={value:i,source:s,stack:Qo(s)},Fv.set(i,s),s)}return{value:i,source:s,stack:Qo(s)}}var ra=[],ul=0,Gd=0;function Xf(){for(var i=ul,s=Gd=ul=0;s<i;){var l=ra[s];ra[s++]=null;var f=ra[s];ra[s++]=null;var p=ra[s];ra[s++]=null;var v=ra[s];if(ra[s++]=null,f!==null&&p!==null){var k=f.pending;k===null?p.next=p:(p.next=k.next,k.next=p),f.pending=p}v!==0&&Mv(l,p,v)}}function Kf(i,s,l,f){ra[ul++]=i,ra[ul++]=s,ra[ul++]=l,ra[ul++]=f,Gd|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function qd(i,s,l,f){return Kf(i,s,l,f),$f(i)}function fl(i,s){return Kf(i,null,null,s),$f(i)}function Mv(i,s,l){i.lanes|=l;var f=i.alternate;f!==null&&(f.lanes|=l);for(var p=!1,v=i.return;v!==null;)v.childLanes|=l,f=v.alternate,f!==null&&(f.childLanes|=l),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(p=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,p&&s!==null&&(p=31-jt(l),i=v.hiddenUpdates,f=i[p],f===null?i[p]=[s]:f.push(s),s.lane=l|536870912),v):null}function $f(i){if(50<iu)throw iu=0,Qm=null,Error(n(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var hl={};function db(i,s,l,f){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(i,s,l,f){return new db(i,s,l,f)}function Xd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function vi(i,s){var l=i.alternate;return l===null?(l=Un(i.tag,s,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=s,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,s=i.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function Pv(i,s){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,s=l.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Yf(i,s,l,f,p,v){var k=0;if(f=i,typeof i=="function")Xd(i)&&(k=1);else if(typeof i=="string")k=pk(i,l,ee.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case C:return i=Un(31,l,s,p),i.elementType=C,i.lanes=v,i;case y:return fo(l.children,p,v,s);case A:k=8,p|=24;break;case w:return i=Un(12,l,s,p|2),i.elementType=w,i.lanes=v,i;case te:return i=Un(13,l,s,p),i.elementType=te,i.lanes=v,i;case J:return i=Un(19,l,s,p),i.elementType=J,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:case R:k=10;break e;case U:k=9;break e;case K:k=11;break e;case b:k=14;break e;case I:k=16,f=null;break e}k=29,l=Error(n(130,i===null?"null":typeof i,"")),f=null}return s=Un(k,l,s,p),s.elementType=i,s.type=f,s.lanes=v,s}function fo(i,s,l,f){return i=Un(7,i,f,s),i.lanes=l,i}function Kd(i,s,l){return i=Un(6,i,null,s),i.lanes=l,i}function $d(i,s,l){return s=Un(4,i.children!==null?i.children:[],i.key,s),s.lanes=l,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var dl=[],ml=0,Wf=null,Qf=0,na=[],aa=0,ho=null,xi=1,_i="";function mo(i,s){dl[ml++]=Qf,dl[ml++]=Wf,Wf=i,Qf=s}function Lv(i,s,l){na[aa++]=xi,na[aa++]=_i,na[aa++]=ho,ho=i;var f=xi;i=_i;var p=32-jt(f)-1;f&=~(1<<p),l+=1;var v=32-jt(s)+p;if(30<v){var k=p-p%5;v=(f&(1<<k)-1).toString(32),f>>=k,p-=k,xi=1<<32-jt(s)+p|l<<p|f,_i=v+i}else xi=1<<v|l<<p|f,_i=i}function Yd(i){i.return!==null&&(mo(i,1),Lv(i,1,0))}function Wd(i){for(;i===Wf;)Wf=dl[--ml],dl[ml]=null,Qf=dl[--ml],dl[ml]=null;for(;i===ho;)ho=na[--aa],na[aa]=null,_i=na[--aa],na[aa]=null,xi=na[--aa],na[aa]=null}var _n=null,rr=null,It=!1,po=null,Ga=!1,Qd=Error(n(519));function go(i){var s=Error(n(418,""));throw Lc(ta(s,i)),Qd}function Vv(i){var s=i.stateNode,l=i.type,f=i.memoizedProps;switch(s[sr]=i,s[Yt]=f,l){case"dialog":ht("cancel",s),ht("close",s);break;case"iframe":case"object":case"embed":ht("load",s);break;case"video":case"audio":for(l=0;l<ou.length;l++)ht(ou[l],s);break;case"source":ht("error",s);break;case"img":case"image":case"link":ht("error",s),ht("load",s);break;case"details":ht("toggle",s);break;case"input":ht("invalid",s),Js(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),Zo(s);break;case"select":ht("invalid",s);break;case"textarea":ht("invalid",s),eo(s,f.value,f.defaultValue,f.children),Zo(s)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||f.suppressHydrationWarning===!0||ty(s.textContent,l)?(f.popover!=null&&(ht("beforetoggle",s),ht("toggle",s)),f.onScroll!=null&&ht("scroll",s),f.onScrollEnd!=null&&ht("scrollend",s),f.onClick!=null&&(s.onclick=N0),s=!0):s=!1,s||go(i)}function Uv(i){for(_n=i.return;_n;)switch(_n.tag){case 5:case 13:Ga=!1;return;case 27:case 3:Ga=!0;return;default:_n=_n.return}}function Mc(i){if(i!==_n)return!1;if(!It)return Uv(i),It=!0,!1;var s=i.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||dp(i.type,i.memoizedProps)),l=!l),l&&rr&&go(i),Uv(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(l=i.data,l==="/$"){if(s===0){rr=ya(i.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;i=i.nextSibling}rr=null}}else s===27?(s=rr,ps(i.type)?(i=vp,vp=null,rr=i):rr=s):rr=_n?ya(i.stateNode.nextSibling):null;return!0}function Pc(){rr=_n=null,It=!1}function Bv(){var i=po;return i!==null&&(Dn===null?Dn=i:Dn.push.apply(Dn,i),po=null),i}function Lc(i){po===null?po=[i]:po.push(i)}var Zd=ve(null),vo=null,yi=null;function es(i,s,l){Q(Zd,s._currentValue),s._currentValue=l}function Ei(i){i._currentValue=Zd.current,j(Zd)}function Jd(i,s,l){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===l)break;i=i.return}}function em(i,s,l,f){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var v=p.dependencies;if(v!==null){var k=p.child;v=v.firstContext;e:for(;v!==null;){var P=v;v=p;for(var Z=0;Z<s.length;Z++)if(P.context===s[Z]){v.lanes|=l,P=v.alternate,P!==null&&(P.lanes|=l),Jd(v.return,l,i),f||(k=null);break e}v=P.next}}else if(p.tag===18){if(k=p.return,k===null)throw Error(n(341));k.lanes|=l,v=k.alternate,v!==null&&(v.lanes|=l),Jd(k,l,i),k=null}else k=p.child;if(k!==null)k.return=p;else for(k=p;k!==null;){if(k===i){k=null;break}if(p=k.sibling,p!==null){p.return=k.return,k=p;break}k=k.return}p=k}}function Vc(i,s,l,f){i=null;for(var p=s,v=!1;p!==null;){if(!v){if((p.flags&524288)!==0)v=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var k=p.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var P=p.type;Vn(p.pendingProps.value,k.value)||(i!==null?i.push(P):i=[P])}}else if(p===Ie.current){if(k=p.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(du):i=[du])}p=p.return}i!==null&&em(s,i,l,f),s.flags|=262144}function Zf(i){for(i=i.firstContext;i!==null;){if(!Vn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function xo(i){vo=i,yi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Jr(i){return jv(vo,i)}function Jf(i,s){return vo===null&&xo(i),jv(i,s)}function jv(i,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},yi===null){if(i===null)throw Error(n(308));yi=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else yi=yi.next=s;return l}var mb=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(l,f){i.push(f)}};this.abort=function(){s.aborted=!0,i.forEach(function(l){return l()})}},pb=t.unstable_scheduleCallback,gb=t.unstable_NormalPriority,Tr={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function tm(){return{controller:new mb,data:new Map,refCount:0}}function Uc(i){i.refCount--,i.refCount===0&&pb(gb,function(){i.controller.abort()})}var Bc=null,rm=0,pl=0,gl=null;function vb(i,s){if(Bc===null){var l=Bc=[];rm=0,pl=ap(),gl={status:"pending",value:void 0,then:function(f){l.push(f)}}}return rm++,s.then(Hv,Hv),s}function Hv(){if(--rm===0&&Bc!==null){gl!==null&&(gl.status="fulfilled");var i=Bc;Bc=null,pl=0,gl=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function xb(i,s){var l=[],f={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return i.then(function(){f.status="fulfilled",f.value=s;for(var p=0;p<l.length;p++)(0,l[p])(s)},function(p){for(f.status="rejected",f.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),f}var zv=ae.S;ae.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&vb(i,s),zv!==null&&zv(i,s)};var _o=ve(null);function nm(){var i=_o.current;return i!==null?i:qt.pooledCache}function e0(i,s){s===null?Q(_o,_o.current):Q(_o,s.pool)}function Gv(){var i=nm();return i===null?null:{parent:Tr._currentValue,pool:i}}var jc=Error(n(460)),qv=Error(n(474)),t0=Error(n(542)),am={then:function(){}};function Xv(i){return i=i.status,i==="fulfilled"||i==="rejected"}function r0(){}function Kv(i,s,l){switch(l=i[l],l===void 0?i.push(s):l!==s&&(s.then(r0,r0),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Yv(i),i;default:if(typeof s.status=="string")s.then(r0,r0);else{if(i=qt,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=s,i.status="pending",i.then(function(f){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=f}},function(f){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Yv(i),i}throw Hc=s,jc}}var Hc=null;function $v(){if(Hc===null)throw Error(n(459));var i=Hc;return Hc=null,i}function Yv(i){if(i===jc||i===t0)throw Error(n(483))}var ts=!1;function im(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function rs(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ns(i,s,l){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(Mt&2)!==0){var p=f.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),f.pending=s,s=$f(i),Mv(i,null,l),s}return Kf(i,f,s,l),$f(i)}function zc(i,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var f=s.lanes;f&=i.pendingLanes,l|=f,s.lanes=l,Ws(i,l)}}function om(i,s){var l=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var p=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var k={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?p=v=k:v=v.next=k,l=l.next}while(l!==null);v===null?p=v=s:v=v.next=s}else p=v=s;l={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=s:i.next=s,l.lastBaseUpdate=s}var lm=!1;function Gc(){if(lm){var i=gl;if(i!==null)throw i}}function qc(i,s,l,f){lm=!1;var p=i.updateQueue;ts=!1;var v=p.firstBaseUpdate,k=p.lastBaseUpdate,P=p.shared.pending;if(P!==null){p.shared.pending=null;var Z=P,he=Z.next;Z.next=null,k===null?v=he:k.next=he,k=Z;var Te=i.alternate;Te!==null&&(Te=Te.updateQueue,P=Te.lastBaseUpdate,P!==k&&(P===null?Te.firstBaseUpdate=he:P.next=he,Te.lastBaseUpdate=Z))}if(v!==null){var Ae=p.baseState;k=0,Te=he=Z=null,P=v;do{var ge=P.lane&-536870913,xe=ge!==P.lane;if(xe?(Et&ge)===ge:(f&ge)===ge){ge!==0&&ge===pl&&(lm=!0),Te!==null&&(Te=Te.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var We=i,Xe=P;ge=s;var Bt=l;switch(Xe.tag){case 1:if(We=Xe.payload,typeof We=="function"){Ae=We.call(Bt,Ae,ge);break e}Ae=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=Xe.payload,ge=typeof We=="function"?We.call(Bt,Ae,ge):We,ge==null)break e;Ae=g({},Ae,ge);break e;case 2:ts=!0}}ge=P.callback,ge!==null&&(i.flags|=64,xe&&(i.flags|=8192),xe=p.callbacks,xe===null?p.callbacks=[ge]:xe.push(ge))}else xe={lane:ge,tag:P.tag,payload:P.payload,callback:P.callback,next:null},Te===null?(he=Te=xe,Z=Ae):Te=Te.next=xe,k|=ge;if(P=P.next,P===null){if(P=p.shared.pending,P===null)break;xe=P,P=xe.next,xe.next=null,p.lastBaseUpdate=xe,p.shared.pending=null}}while(!0);Te===null&&(Z=Ae),p.baseState=Z,p.firstBaseUpdate=he,p.lastBaseUpdate=Te,v===null&&(p.shared.lanes=0),fs|=k,i.lanes=k,i.memoizedState=Ae}}function Wv(i,s){if(typeof i!="function")throw Error(n(191,i));i.call(s)}function Qv(i,s){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)Wv(l[i],s)}var vl=ve(null),n0=ve(0);function Zv(i,s){i=Ci,Q(n0,i),Q(vl,s),Ci=i|s.baseLanes}function cm(){Q(n0,Ci),Q(vl,vl.current)}function um(){Ci=n0.current,j(vl),j(n0)}var as=0,lt=null,Vt=null,dr=null,a0=!1,xl=!1,yo=!1,i0=0,Xc=0,_l=null,_b=0;function or(){throw Error(n(321))}function fm(i,s){if(s===null)return!1;for(var l=0;l<s.length&&l<i.length;l++)if(!Vn(i[l],s[l]))return!1;return!0}function hm(i,s,l,f,p,v){return as=v,lt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ae.H=i===null||i.memoizedState===null?Mx:Px,yo=!1,v=l(f,p),yo=!1,xl&&(v=ex(s,l,f,p)),Jv(i),v}function Jv(i){ae.H=f0;var s=Vt!==null&&Vt.next!==null;if(as=0,dr=Vt=lt=null,a0=!1,Xc=0,_l=null,s)throw Error(n(300));i===null||Or||(i=i.dependencies,i!==null&&Zf(i)&&(Or=!0))}function ex(i,s,l,f){lt=i;var p=0;do{if(xl&&(_l=null),Xc=0,xl=!1,25<=p)throw Error(n(301));if(p+=1,dr=Vt=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ae.H=bb,v=s(l,f)}while(xl);return v}function yb(){var i=ae.H,s=i.useState()[0];return s=typeof s.then=="function"?Kc(s):s,i=i.useState()[0],(Vt!==null?Vt.memoizedState:null)!==i&&(lt.flags|=1024),s}function dm(){var i=i0!==0;return i0=0,i}function mm(i,s,l){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~l}function pm(i){if(a0){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}a0=!1}as=0,dr=Vt=lt=null,xl=!1,Xc=i0=0,_l=null}function In(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dr===null?lt.memoizedState=dr=i:dr=dr.next=i,dr}function mr(){if(Vt===null){var i=lt.alternate;i=i!==null?i.memoizedState:null}else i=Vt.next;var s=dr===null?lt.memoizedState:dr.next;if(s!==null)dr=s,Vt=i;else{if(i===null)throw lt.alternate===null?Error(n(467)):Error(n(310));Vt=i,i={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},dr===null?lt.memoizedState=dr=i:dr=dr.next=i}return dr}function gm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Kc(i){var s=Xc;return Xc+=1,_l===null&&(_l=[]),i=Kv(_l,i,s),s=lt,(dr===null?s.memoizedState:dr.next)===null&&(s=s.alternate,ae.H=s===null||s.memoizedState===null?Mx:Px),i}function s0(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Kc(i);if(i.$$typeof===R)return Jr(i)}throw Error(n(438,String(i)))}function vm(i){var s=null,l=lt.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var f=lt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=gm(),lt.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(i),f=0;f<i;f++)l[f]=V;return s.index++,l}function Ti(i,s){return typeof s=="function"?s(i):s}function o0(i){var s=mr();return xm(s,Vt,i)}function xm(i,s,l){var f=i.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=l;var p=i.baseQueue,v=f.pending;if(v!==null){if(p!==null){var k=p.next;p.next=v.next,v.next=k}s.baseQueue=p=v,f.pending=null}if(v=i.baseState,p===null)i.memoizedState=v;else{s=p.next;var P=k=null,Z=null,he=s,Te=!1;do{var Ae=he.lane&-536870913;if(Ae!==he.lane?(Et&Ae)===Ae:(as&Ae)===Ae){var ge=he.revertLane;if(ge===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),Ae===pl&&(Te=!0);else if((as&ge)===ge){he=he.next,ge===pl&&(Te=!0);continue}else Ae={lane:0,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},Z===null?(P=Z=Ae,k=v):Z=Z.next=Ae,lt.lanes|=ge,fs|=ge;Ae=he.action,yo&&l(v,Ae),v=he.hasEagerState?he.eagerState:l(v,Ae)}else ge={lane:Ae,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},Z===null?(P=Z=ge,k=v):Z=Z.next=ge,lt.lanes|=Ae,fs|=Ae;he=he.next}while(he!==null&&he!==s);if(Z===null?k=v:Z.next=P,!Vn(v,i.memoizedState)&&(Or=!0,Te&&(l=gl,l!==null)))throw l;i.memoizedState=v,i.baseState=k,i.baseQueue=Z,f.lastRenderedState=v}return p===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function _m(i){var s=mr(),l=s.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=i;var f=l.dispatch,p=l.pending,v=s.memoizedState;if(p!==null){l.pending=null;var k=p=p.next;do v=i(v,k.action),k=k.next;while(k!==p);Vn(v,s.memoizedState)||(Or=!0),s.memoizedState=v,s.baseQueue===null&&(s.baseState=v),l.lastRenderedState=v}return[v,f]}function tx(i,s,l){var f=lt,p=mr(),v=It;if(v){if(l===void 0)throw Error(n(407));l=l()}else l=s();var k=!Vn((Vt||p).memoizedState,l);k&&(p.memoizedState=l,Or=!0),p=p.queue;var P=ax.bind(null,f,p,i);if($c(2048,8,P,[i]),p.getSnapshot!==s||k||dr!==null&&dr.memoizedState.tag&1){if(f.flags|=2048,yl(9,l0(),nx.bind(null,f,p,l,s),null),qt===null)throw Error(n(349));v||(as&124)!==0||rx(f,s,l)}return l}function rx(i,s,l){i.flags|=16384,i={getSnapshot:s,value:l},s=lt.updateQueue,s===null?(s=gm(),lt.updateQueue=s,s.stores=[i]):(l=s.stores,l===null?s.stores=[i]:l.push(i))}function nx(i,s,l,f){s.value=l,s.getSnapshot=f,ix(s)&&sx(i)}function ax(i,s,l){return l(function(){ix(s)&&sx(i)})}function ix(i){var s=i.getSnapshot;i=i.value;try{var l=s();return!Vn(i,l)}catch{return!0}}function sx(i){var s=fl(i,2);s!==null&&Gn(s,i,2)}function ym(i){var s=In();if(typeof i=="function"){var l=i;if(i=l(),yo){Ft(!0);try{l()}finally{Ft(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:i},s}function ox(i,s,l,f){return i.baseState=l,xm(i,Vt,typeof f=="function"?f:Ti)}function Eb(i,s,l,f,p){if(u0(i))throw Error(n(485));if(i=s.action,i!==null){var v={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){v.listeners.push(k)}};ae.T!==null?l(!0):v.isTransition=!1,f(v),l=s.pending,l===null?(v.next=s.pending=v,lx(s,v)):(v.next=l.next,s.pending=l.next=v)}}function lx(i,s){var l=s.action,f=s.payload,p=i.state;if(s.isTransition){var v=ae.T,k={};ae.T=k;try{var P=l(p,f),Z=ae.S;Z!==null&&Z(k,P),cx(i,s,P)}catch(he){Em(i,s,he)}finally{ae.T=v}}else try{v=l(p,f),cx(i,s,v)}catch(he){Em(i,s,he)}}function cx(i,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){ux(i,s,f)},function(f){return Em(i,s,f)}):ux(i,s,l)}function ux(i,s,l){s.status="fulfilled",s.value=l,fx(s),i.state=l,s=i.pending,s!==null&&(l=s.next,l===s?i.pending=null:(l=l.next,s.next=l,lx(i,l)))}function Em(i,s,l){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=l,fx(s),s=s.next;while(s!==f)}i.action=null}function fx(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function hx(i,s){return s}function dx(i,s){if(It){var l=qt.formState;if(l!==null){e:{var f=lt;if(It){if(rr){t:{for(var p=rr,v=Ga;p.nodeType!==8;){if(!v){p=null;break t}if(p=ya(p.nextSibling),p===null){p=null;break t}}v=p.data,p=v==="F!"||v==="F"?p:null}if(p){rr=ya(p.nextSibling),f=p.data==="F!";break e}}go(f)}f=!1}f&&(s=l[0])}}return l=In(),l.memoizedState=l.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hx,lastRenderedState:s},l.queue=f,l=Dx.bind(null,lt,f),f.dispatch=l,f=ym(!1),v=bm.bind(null,lt,!1,f.queue),f=In(),p={state:s,dispatch:null,action:i,pending:null},f.queue=p,l=Eb.bind(null,lt,p,v,l),p.dispatch=l,f.memoizedState=i,[s,l,!1]}function mx(i){var s=mr();return px(s,Vt,i)}function px(i,s,l){if(s=xm(i,s,hx)[0],i=o0(Ti)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Kc(s)}catch(k){throw k===jc?t0:k}else f=s;s=mr();var p=s.queue,v=p.dispatch;return l!==s.memoizedState&&(lt.flags|=2048,yl(9,l0(),Tb.bind(null,p,l),null)),[f,v,i]}function Tb(i,s){i.action=s}function gx(i){var s=mr(),l=Vt;if(l!==null)return px(s,l,i);mr(),s=s.memoizedState,l=mr();var f=l.queue.dispatch;return l.memoizedState=i,[s,f,!1]}function yl(i,s,l,f){return i={tag:i,create:l,deps:f,inst:s,next:null},s=lt.updateQueue,s===null&&(s=gm(),lt.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=i.next=i:(f=l.next,l.next=i,i.next=f,s.lastEffect=i),i}function l0(){return{destroy:void 0,resource:void 0}}function vx(){return mr().memoizedState}function c0(i,s,l,f){var p=In();f=f===void 0?null:f,lt.flags|=i,p.memoizedState=yl(1|s,l0(),l,f)}function $c(i,s,l,f){var p=mr();f=f===void 0?null:f;var v=p.memoizedState.inst;Vt!==null&&f!==null&&fm(f,Vt.memoizedState.deps)?p.memoizedState=yl(s,v,l,f):(lt.flags|=i,p.memoizedState=yl(1|s,v,l,f))}function xx(i,s){c0(8390656,8,i,s)}function _x(i,s){$c(2048,8,i,s)}function yx(i,s){return $c(4,2,i,s)}function Ex(i,s){return $c(4,4,i,s)}function Tx(i,s){if(typeof s=="function"){i=i();var l=s(i);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function wx(i,s,l){l=l!=null?l.concat([i]):null,$c(4,4,Tx.bind(null,s,i),l)}function Tm(){}function Ax(i,s){var l=mr();s=s===void 0?null:s;var f=l.memoizedState;return s!==null&&fm(s,f[1])?f[0]:(l.memoizedState=[i,s],i)}function Sx(i,s){var l=mr();s=s===void 0?null:s;var f=l.memoizedState;if(s!==null&&fm(s,f[1]))return f[0];if(f=i(),yo){Ft(!0);try{i()}finally{Ft(!1)}}return l.memoizedState=[f,s],f}function wm(i,s,l){return l===void 0||(as&1073741824)!==0?i.memoizedState=s:(i.memoizedState=l,i=C_(),lt.lanes|=i,fs|=i,l)}function bx(i,s,l,f){return Vn(l,s)?l:vl.current!==null?(i=wm(i,l,f),Vn(i,s)||(Or=!0),i):(as&42)===0?(Or=!0,i.memoizedState=l):(i=C_(),lt.lanes|=i,fs|=i,s)}function kx(i,s,l,f,p){var v=ue.p;ue.p=v!==0&&8>v?v:8;var k=ae.T,P={};ae.T=P,bm(i,!1,s,l);try{var Z=p(),he=ae.S;if(he!==null&&he(P,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var Te=xb(Z,f);Yc(i,s,Te,zn(i))}else Yc(i,s,f,zn(i))}catch(Ae){Yc(i,s,{then:function(){},status:"rejected",reason:Ae},zn())}finally{ue.p=v,ae.T=k}}function wb(){}function Am(i,s,l,f){if(i.tag!==5)throw Error(n(476));var p=Cx(i).queue;kx(i,p,s,Le,l===null?wb:function(){return Rx(i),l(f)})}function Cx(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Le,baseState:Le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:Le},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:l},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Rx(i){var s=Cx(i).next.queue;Yc(i,s,{},zn())}function Sm(){return Jr(du)}function Ix(){return mr().memoizedState}function Nx(){return mr().memoizedState}function Ab(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var l=zn();i=rs(l);var f=ns(s,i,l);f!==null&&(Gn(f,s,l),zc(f,s,l)),s={cache:tm()},i.payload=s;return}s=s.return}}function Sb(i,s,l){var f=zn();l={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},u0(i)?Ox(s,l):(l=qd(i,s,l,f),l!==null&&(Gn(l,i,f),Fx(l,s,f)))}function Dx(i,s,l){var f=zn();Yc(i,s,l,f)}function Yc(i,s,l,f){var p={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(u0(i))Ox(s,p);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=s.lastRenderedReducer,v!==null))try{var k=s.lastRenderedState,P=v(k,l);if(p.hasEagerState=!0,p.eagerState=P,Vn(P,k))return Kf(i,s,p,0),qt===null&&Xf(),!1}catch{}finally{}if(l=qd(i,s,p,f),l!==null)return Gn(l,i,f),Fx(l,s,f),!0}return!1}function bm(i,s,l,f){if(f={lane:2,revertLane:ap(),action:f,hasEagerState:!1,eagerState:null,next:null},u0(i)){if(s)throw Error(n(479))}else s=qd(i,l,f,2),s!==null&&Gn(s,i,2)}function u0(i){var s=i.alternate;return i===lt||s!==null&&s===lt}function Ox(i,s){xl=a0=!0;var l=i.pending;l===null?s.next=s:(s.next=l.next,l.next=s),i.pending=s}function Fx(i,s,l){if((l&4194048)!==0){var f=s.lanes;f&=i.pendingLanes,l|=f,s.lanes=l,Ws(i,l)}}var f0={readContext:Jr,use:s0,useCallback:or,useContext:or,useEffect:or,useImperativeHandle:or,useLayoutEffect:or,useInsertionEffect:or,useMemo:or,useReducer:or,useRef:or,useState:or,useDebugValue:or,useDeferredValue:or,useTransition:or,useSyncExternalStore:or,useId:or,useHostTransitionStatus:or,useFormState:or,useActionState:or,useOptimistic:or,useMemoCache:or,useCacheRefresh:or},Mx={readContext:Jr,use:s0,useCallback:function(i,s){return In().memoizedState=[i,s===void 0?null:s],i},useContext:Jr,useEffect:xx,useImperativeHandle:function(i,s,l){l=l!=null?l.concat([i]):null,c0(4194308,4,Tx.bind(null,s,i),l)},useLayoutEffect:function(i,s){return c0(4194308,4,i,s)},useInsertionEffect:function(i,s){c0(4,2,i,s)},useMemo:function(i,s){var l=In();s=s===void 0?null:s;var f=i();if(yo){Ft(!0);try{i()}finally{Ft(!1)}}return l.memoizedState=[f,s],f},useReducer:function(i,s,l){var f=In();if(l!==void 0){var p=l(s);if(yo){Ft(!0);try{l(s)}finally{Ft(!1)}}}else p=s;return f.memoizedState=f.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},f.queue=i,i=i.dispatch=Sb.bind(null,lt,i),[f.memoizedState,i]},useRef:function(i){var s=In();return i={current:i},s.memoizedState=i},useState:function(i){i=ym(i);var s=i.queue,l=Dx.bind(null,lt,s);return s.dispatch=l,[i.memoizedState,l]},useDebugValue:Tm,useDeferredValue:function(i,s){var l=In();return wm(l,i,s)},useTransition:function(){var i=ym(!1);return i=kx.bind(null,lt,i.queue,!0,!1),In().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,l){var f=lt,p=In();if(It){if(l===void 0)throw Error(n(407));l=l()}else{if(l=s(),qt===null)throw Error(n(349));(Et&124)!==0||rx(f,s,l)}p.memoizedState=l;var v={value:l,getSnapshot:s};return p.queue=v,xx(ax.bind(null,f,v,i),[i]),f.flags|=2048,yl(9,l0(),nx.bind(null,f,v,l,s),null),l},useId:function(){var i=In(),s=qt.identifierPrefix;if(It){var l=_i,f=xi;l=(f&~(1<<32-jt(f)-1)).toString(32)+l,s=""+s+"R"+l,l=i0++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=_b++,s=""+s+"r"+l.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Sm,useFormState:dx,useActionState:dx,useOptimistic:function(i){var s=In();s.memoizedState=s.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=bm.bind(null,lt,!0,l),l.dispatch=s,[i,s]},useMemoCache:vm,useCacheRefresh:function(){return In().memoizedState=Ab.bind(null,lt)}},Px={readContext:Jr,use:s0,useCallback:Ax,useContext:Jr,useEffect:_x,useImperativeHandle:wx,useInsertionEffect:yx,useLayoutEffect:Ex,useMemo:Sx,useReducer:o0,useRef:vx,useState:function(){return o0(Ti)},useDebugValue:Tm,useDeferredValue:function(i,s){var l=mr();return bx(l,Vt.memoizedState,i,s)},useTransition:function(){var i=o0(Ti)[0],s=mr().memoizedState;return[typeof i=="boolean"?i:Kc(i),s]},useSyncExternalStore:tx,useId:Ix,useHostTransitionStatus:Sm,useFormState:mx,useActionState:mx,useOptimistic:function(i,s){var l=mr();return ox(l,Vt,i,s)},useMemoCache:vm,useCacheRefresh:Nx},bb={readContext:Jr,use:s0,useCallback:Ax,useContext:Jr,useEffect:_x,useImperativeHandle:wx,useInsertionEffect:yx,useLayoutEffect:Ex,useMemo:Sx,useReducer:_m,useRef:vx,useState:function(){return _m(Ti)},useDebugValue:Tm,useDeferredValue:function(i,s){var l=mr();return Vt===null?wm(l,i,s):bx(l,Vt.memoizedState,i,s)},useTransition:function(){var i=_m(Ti)[0],s=mr().memoizedState;return[typeof i=="boolean"?i:Kc(i),s]},useSyncExternalStore:tx,useId:Ix,useHostTransitionStatus:Sm,useFormState:gx,useActionState:gx,useOptimistic:function(i,s){var l=mr();return Vt!==null?ox(l,Vt,i,s):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:vm,useCacheRefresh:Nx},El=null,Wc=0;function h0(i){var s=Wc;return Wc+=1,El===null&&(El=[]),Kv(El,i,s)}function Qc(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function d0(i,s){throw s.$$typeof===x?Error(n(525)):(i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Lx(i){var s=i._init;return s(i._payload)}function Vx(i){function s(ie,ne){if(i){var ce=ie.deletions;ce===null?(ie.deletions=[ne],ie.flags|=16):ce.push(ne)}}function l(ie,ne){if(!i)return null;for(;ne!==null;)s(ie,ne),ne=ne.sibling;return null}function f(ie){for(var ne=new Map;ie!==null;)ie.key!==null?ne.set(ie.key,ie):ne.set(ie.index,ie),ie=ie.sibling;return ne}function p(ie,ne){return ie=vi(ie,ne),ie.index=0,ie.sibling=null,ie}function v(ie,ne,ce){return ie.index=ce,i?(ce=ie.alternate,ce!==null?(ce=ce.index,ce<ne?(ie.flags|=67108866,ne):ce):(ie.flags|=67108866,ne)):(ie.flags|=1048576,ne)}function k(ie){return i&&ie.alternate===null&&(ie.flags|=67108866),ie}function P(ie,ne,ce,we){return ne===null||ne.tag!==6?(ne=Kd(ce,ie.mode,we),ne.return=ie,ne):(ne=p(ne,ce),ne.return=ie,ne)}function Z(ie,ne,ce,we){var He=ce.type;return He===y?Te(ie,ne,ce.props.children,we,ce.key):ne!==null&&(ne.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===I&&Lx(He)===ne.type)?(ne=p(ne,ce.props),Qc(ne,ce),ne.return=ie,ne):(ne=Yf(ce.type,ce.key,ce.props,null,ie.mode,we),Qc(ne,ce),ne.return=ie,ne)}function he(ie,ne,ce,we){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ce.containerInfo||ne.stateNode.implementation!==ce.implementation?(ne=$d(ce,ie.mode,we),ne.return=ie,ne):(ne=p(ne,ce.children||[]),ne.return=ie,ne)}function Te(ie,ne,ce,we,He){return ne===null||ne.tag!==7?(ne=fo(ce,ie.mode,we,He),ne.return=ie,ne):(ne=p(ne,ce),ne.return=ie,ne)}function Ae(ie,ne,ce){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=Kd(""+ne,ie.mode,ce),ne.return=ie,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case _:return ce=Yf(ne.type,ne.key,ne.props,null,ie.mode,ce),Qc(ce,ne),ce.return=ie,ce;case T:return ne=$d(ne,ie.mode,ce),ne.return=ie,ne;case I:var we=ne._init;return ne=we(ne._payload),Ae(ie,ne,ce)}if(be(ne)||O(ne))return ne=fo(ne,ie.mode,ce,null),ne.return=ie,ne;if(typeof ne.then=="function")return Ae(ie,h0(ne),ce);if(ne.$$typeof===R)return Ae(ie,Jf(ie,ne),ce);d0(ie,ne)}return null}function ge(ie,ne,ce,we){var He=ne!==null?ne.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return He!==null?null:P(ie,ne,""+ce,we);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:return ce.key===He?Z(ie,ne,ce,we):null;case T:return ce.key===He?he(ie,ne,ce,we):null;case I:return He=ce._init,ce=He(ce._payload),ge(ie,ne,ce,we)}if(be(ce)||O(ce))return He!==null?null:Te(ie,ne,ce,we,null);if(typeof ce.then=="function")return ge(ie,ne,h0(ce),we);if(ce.$$typeof===R)return ge(ie,ne,Jf(ie,ce),we);d0(ie,ce)}return null}function xe(ie,ne,ce,we,He){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return ie=ie.get(ce)||null,P(ne,ie,""+we,He);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case _:return ie=ie.get(we.key===null?ce:we.key)||null,Z(ne,ie,we,He);case T:return ie=ie.get(we.key===null?ce:we.key)||null,he(ne,ie,we,He);case I:var ut=we._init;return we=ut(we._payload),xe(ie,ne,ce,we,He)}if(be(we)||O(we))return ie=ie.get(ce)||null,Te(ne,ie,we,He,null);if(typeof we.then=="function")return xe(ie,ne,ce,h0(we),He);if(we.$$typeof===R)return xe(ie,ne,ce,Jf(ne,we),He);d0(ne,we)}return null}function We(ie,ne,ce,we){for(var He=null,ut=null,Ge=ne,Ke=ne=0,Mr=null;Ge!==null&&Ke<ce.length;Ke++){Ge.index>Ke?(Mr=Ge,Ge=null):Mr=Ge.sibling;var Ct=ge(ie,Ge,ce[Ke],we);if(Ct===null){Ge===null&&(Ge=Mr);break}i&&Ge&&Ct.alternate===null&&s(ie,Ge),ne=v(Ct,ne,Ke),ut===null?He=Ct:ut.sibling=Ct,ut=Ct,Ge=Mr}if(Ke===ce.length)return l(ie,Ge),It&&mo(ie,Ke),He;if(Ge===null){for(;Ke<ce.length;Ke++)Ge=Ae(ie,ce[Ke],we),Ge!==null&&(ne=v(Ge,ne,Ke),ut===null?He=Ge:ut.sibling=Ge,ut=Ge);return It&&mo(ie,Ke),He}for(Ge=f(Ge);Ke<ce.length;Ke++)Mr=xe(Ge,ie,Ke,ce[Ke],we),Mr!==null&&(i&&Mr.alternate!==null&&Ge.delete(Mr.key===null?Ke:Mr.key),ne=v(Mr,ne,Ke),ut===null?He=Mr:ut.sibling=Mr,ut=Mr);return i&&Ge.forEach(function(ys){return s(ie,ys)}),It&&mo(ie,Ke),He}function Xe(ie,ne,ce,we){if(ce==null)throw Error(n(151));for(var He=null,ut=null,Ge=ne,Ke=ne=0,Mr=null,Ct=ce.next();Ge!==null&&!Ct.done;Ke++,Ct=ce.next()){Ge.index>Ke?(Mr=Ge,Ge=null):Mr=Ge.sibling;var ys=ge(ie,Ge,Ct.value,we);if(ys===null){Ge===null&&(Ge=Mr);break}i&&Ge&&ys.alternate===null&&s(ie,Ge),ne=v(ys,ne,Ke),ut===null?He=ys:ut.sibling=ys,ut=ys,Ge=Mr}if(Ct.done)return l(ie,Ge),It&&mo(ie,Ke),He;if(Ge===null){for(;!Ct.done;Ke++,Ct=ce.next())Ct=Ae(ie,Ct.value,we),Ct!==null&&(ne=v(Ct,ne,Ke),ut===null?He=Ct:ut.sibling=Ct,ut=Ct);return It&&mo(ie,Ke),He}for(Ge=f(Ge);!Ct.done;Ke++,Ct=ce.next())Ct=xe(Ge,ie,Ke,Ct.value,we),Ct!==null&&(i&&Ct.alternate!==null&&Ge.delete(Ct.key===null?Ke:Ct.key),ne=v(Ct,ne,Ke),ut===null?He=Ct:ut.sibling=Ct,ut=Ct);return i&&Ge.forEach(function(kk){return s(ie,kk)}),It&&mo(ie,Ke),He}function Bt(ie,ne,ce,we){if(typeof ce=="object"&&ce!==null&&ce.type===y&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:e:{for(var He=ce.key;ne!==null;){if(ne.key===He){if(He=ce.type,He===y){if(ne.tag===7){l(ie,ne.sibling),we=p(ne,ce.props.children),we.return=ie,ie=we;break e}}else if(ne.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===I&&Lx(He)===ne.type){l(ie,ne.sibling),we=p(ne,ce.props),Qc(we,ce),we.return=ie,ie=we;break e}l(ie,ne);break}else s(ie,ne);ne=ne.sibling}ce.type===y?(we=fo(ce.props.children,ie.mode,we,ce.key),we.return=ie,ie=we):(we=Yf(ce.type,ce.key,ce.props,null,ie.mode,we),Qc(we,ce),we.return=ie,ie=we)}return k(ie);case T:e:{for(He=ce.key;ne!==null;){if(ne.key===He)if(ne.tag===4&&ne.stateNode.containerInfo===ce.containerInfo&&ne.stateNode.implementation===ce.implementation){l(ie,ne.sibling),we=p(ne,ce.children||[]),we.return=ie,ie=we;break e}else{l(ie,ne);break}else s(ie,ne);ne=ne.sibling}we=$d(ce,ie.mode,we),we.return=ie,ie=we}return k(ie);case I:return He=ce._init,ce=He(ce._payload),Bt(ie,ne,ce,we)}if(be(ce))return We(ie,ne,ce,we);if(O(ce)){if(He=O(ce),typeof He!="function")throw Error(n(150));return ce=He.call(ce),Xe(ie,ne,ce,we)}if(typeof ce.then=="function")return Bt(ie,ne,h0(ce),we);if(ce.$$typeof===R)return Bt(ie,ne,Jf(ie,ce),we);d0(ie,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ne!==null&&ne.tag===6?(l(ie,ne.sibling),we=p(ne,ce),we.return=ie,ie=we):(l(ie,ne),we=Kd(ce,ie.mode,we),we.return=ie,ie=we),k(ie)):l(ie,ne)}return function(ie,ne,ce,we){try{Wc=0;var He=Bt(ie,ne,ce,we);return El=null,He}catch(Ge){if(Ge===jc||Ge===t0)throw Ge;var ut=Un(29,Ge,null,ie.mode);return ut.lanes=we,ut.return=ie,ut}finally{}}}var Tl=Vx(!0),Ux=Vx(!1),ia=ve(null),qa=null;function is(i){var s=i.alternate;Q(wr,wr.current&1),Q(ia,i),qa===null&&(s===null||vl.current!==null||s.memoizedState!==null)&&(qa=i)}function Bx(i){if(i.tag===22){if(Q(wr,wr.current),Q(ia,i),qa===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(qa=i)}}else ss()}function ss(){Q(wr,wr.current),Q(ia,ia.current)}function wi(i){j(ia),qa===i&&(qa=null),j(wr)}var wr=ve(0);function m0(i){for(var s=i;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||gp(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function km(i,s,l,f){s=i.memoizedState,l=l(f,s),l=l==null?s:g({},s,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Cm={enqueueSetState:function(i,s,l){i=i._reactInternals;var f=zn(),p=rs(f);p.payload=s,l!=null&&(p.callback=l),s=ns(i,p,f),s!==null&&(Gn(s,i,f),zc(s,i,f))},enqueueReplaceState:function(i,s,l){i=i._reactInternals;var f=zn(),p=rs(f);p.tag=1,p.payload=s,l!=null&&(p.callback=l),s=ns(i,p,f),s!==null&&(Gn(s,i,f),zc(s,i,f))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var l=zn(),f=rs(l);f.tag=2,s!=null&&(f.callback=s),s=ns(i,f,l),s!==null&&(Gn(s,i,l),zc(s,i,l))}};function jx(i,s,l,f,p,v,k){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,v,k):s.prototype&&s.prototype.isPureReactComponent?!Oc(l,f)||!Oc(p,v):!0}function Hx(i,s,l,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==i&&Cm.enqueueReplaceState(s,s.state,null)}function Eo(i,s){var l=s;if("ref"in s){l={};for(var f in s)f!=="ref"&&(l[f]=s[f])}if(i=i.defaultProps){l===s&&(l=g({},l));for(var p in i)l[p]===void 0&&(l[p]=i[p])}return l}var p0=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function zx(i){p0(i)}function Gx(i){console.error(i)}function qx(i){p0(i)}function g0(i,s){try{var l=i.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function Xx(i,s,l){try{var f=i.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Rm(i,s,l){return l=rs(l),l.tag=3,l.payload={element:null},l.callback=function(){g0(i,s)},l}function Kx(i){return i=rs(i),i.tag=3,i}function $x(i,s,l,f){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var v=f.value;i.payload=function(){return p(v)},i.callback=function(){Xx(s,l,f)}}var k=l.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(i.callback=function(){Xx(s,l,f),typeof p!="function"&&(hs===null?hs=new Set([this]):hs.add(this));var P=f.stack;this.componentDidCatch(f.value,{componentStack:P!==null?P:""})})}function kb(i,s,l,f,p){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=l.alternate,s!==null&&Vc(s,l,p,!0),l=ia.current,l!==null){switch(l.tag){case 13:return qa===null?Jm():l.alternate===null&&nr===0&&(nr=3),l.flags&=-257,l.flags|=65536,l.lanes=p,f===am?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([f]):s.add(f),tp(i,f,p)),!1;case 22:return l.flags|=65536,f===am?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([f]):l.add(f)),tp(i,f,p)),!1}throw Error(n(435,l.tag))}return tp(i,f,p),Jm(),!1}if(It)return s=ia.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,f!==Qd&&(i=Error(n(422),{cause:f}),Lc(ta(i,l)))):(f!==Qd&&(s=Error(n(423),{cause:f}),Lc(ta(s,l))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,f=ta(f,l),p=Rm(i.stateNode,f,p),om(i,p),nr!==4&&(nr=2)),!1;var v=Error(n(520),{cause:f});if(v=ta(v,l),au===null?au=[v]:au.push(v),nr!==4&&(nr=2),s===null)return!0;f=ta(f,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,i=p&-p,l.lanes|=i,i=Rm(l.stateNode,f,i),om(l,i),!1;case 1:if(s=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(hs===null||!hs.has(v))))return l.flags|=65536,p&=-p,l.lanes|=p,p=Kx(p),$x(p,i,l,f),om(l,p),!1}l=l.return}while(l!==null);return!1}var Yx=Error(n(461)),Or=!1;function Hr(i,s,l,f){s.child=i===null?Ux(s,null,l,f):Tl(s,i.child,l,f)}function Wx(i,s,l,f,p){l=l.render;var v=s.ref;if("ref"in f){var k={};for(var P in f)P!=="ref"&&(k[P]=f[P])}else k=f;return xo(s),f=hm(i,s,l,k,v,p),P=dm(),i!==null&&!Or?(mm(i,s,p),Ai(i,s,p)):(It&&P&&Yd(s),s.flags|=1,Hr(i,s,f,p),s.child)}function Qx(i,s,l,f,p){if(i===null){var v=l.type;return typeof v=="function"&&!Xd(v)&&v.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=v,Zx(i,s,v,f,p)):(i=Yf(l.type,null,f,s,s.mode,p),i.ref=s.ref,i.return=s,s.child=i)}if(v=i.child,!Lm(i,p)){var k=v.memoizedProps;if(l=l.compare,l=l!==null?l:Oc,l(k,f)&&i.ref===s.ref)return Ai(i,s,p)}return s.flags|=1,i=vi(v,f),i.ref=s.ref,i.return=s,s.child=i}function Zx(i,s,l,f,p){if(i!==null){var v=i.memoizedProps;if(Oc(v,f)&&i.ref===s.ref)if(Or=!1,s.pendingProps=f=v,Lm(i,p))(i.flags&131072)!==0&&(Or=!0);else return s.lanes=i.lanes,Ai(i,s,p)}return Im(i,s,l,f,p)}function Jx(i,s,l){var f=s.pendingProps,p=f.children,v=i!==null?i.memoizedState:null;if(f.mode==="hidden"){if((s.flags&128)!==0){if(f=v!==null?v.baseLanes|l:l,i!==null){for(p=s.child=i.child,v=0;p!==null;)v=v|p.lanes|p.childLanes,p=p.sibling;s.childLanes=v&~f}else s.childLanes=0,s.child=null;return e_(i,s,f,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&e0(s,v!==null?v.cachePool:null),v!==null?Zv(s,v):cm(),Bx(s);else return s.lanes=s.childLanes=536870912,e_(i,s,v!==null?v.baseLanes|l:l,l)}else v!==null?(e0(s,v.cachePool),Zv(s,v),ss(),s.memoizedState=null):(i!==null&&e0(s,null),cm(),ss());return Hr(i,s,p,l),s.child}function e_(i,s,l,f){var p=nm();return p=p===null?null:{parent:Tr._currentValue,pool:p},s.memoizedState={baseLanes:l,cachePool:p},i!==null&&e0(s,null),cm(),Bx(s),i!==null&&Vc(i,s,f,!0),null}function v0(i,s){var l=s.ref;if(l===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(i===null||i.ref!==l)&&(s.flags|=4194816)}}function Im(i,s,l,f,p){return xo(s),l=hm(i,s,l,f,void 0,p),f=dm(),i!==null&&!Or?(mm(i,s,p),Ai(i,s,p)):(It&&f&&Yd(s),s.flags|=1,Hr(i,s,l,p),s.child)}function t_(i,s,l,f,p,v){return xo(s),s.updateQueue=null,l=ex(s,f,l,p),Jv(i),f=dm(),i!==null&&!Or?(mm(i,s,v),Ai(i,s,v)):(It&&f&&Yd(s),s.flags|=1,Hr(i,s,l,v),s.child)}function r_(i,s,l,f,p){if(xo(s),s.stateNode===null){var v=hl,k=l.contextType;typeof k=="object"&&k!==null&&(v=Jr(k)),v=new l(f,v),s.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Cm,s.stateNode=v,v._reactInternals=s,v=s.stateNode,v.props=f,v.state=s.memoizedState,v.refs={},im(s),k=l.contextType,v.context=typeof k=="object"&&k!==null?Jr(k):hl,v.state=s.memoizedState,k=l.getDerivedStateFromProps,typeof k=="function"&&(km(s,l,k,f),v.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(k=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),k!==v.state&&Cm.enqueueReplaceState(v,v.state,null),qc(s,f,v,p),Gc(),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(i===null){v=s.stateNode;var P=s.memoizedProps,Z=Eo(l,P);v.props=Z;var he=v.context,Te=l.contextType;k=hl,typeof Te=="object"&&Te!==null&&(k=Jr(Te));var Ae=l.getDerivedStateFromProps;Te=typeof Ae=="function"||typeof v.getSnapshotBeforeUpdate=="function",P=s.pendingProps!==P,Te||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(P||he!==k)&&Hx(s,v,f,k),ts=!1;var ge=s.memoizedState;v.state=ge,qc(s,f,v,p),Gc(),he=s.memoizedState,P||ge!==he||ts?(typeof Ae=="function"&&(km(s,l,Ae,f),he=s.memoizedState),(Z=ts||jx(s,l,Z,f,ge,he,k))?(Te||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(s.flags|=4194308)):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=he),v.props=f,v.state=he,v.context=k,f=Z):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{v=s.stateNode,sm(i,s),k=s.memoizedProps,Te=Eo(l,k),v.props=Te,Ae=s.pendingProps,ge=v.context,he=l.contextType,Z=hl,typeof he=="object"&&he!==null&&(Z=Jr(he)),P=l.getDerivedStateFromProps,(he=typeof P=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(k!==Ae||ge!==Z)&&Hx(s,v,f,Z),ts=!1,ge=s.memoizedState,v.state=ge,qc(s,f,v,p),Gc();var xe=s.memoizedState;k!==Ae||ge!==xe||ts||i!==null&&i.dependencies!==null&&Zf(i.dependencies)?(typeof P=="function"&&(km(s,l,P,f),xe=s.memoizedState),(Te=ts||jx(s,l,Te,f,ge,xe,Z)||i!==null&&i.dependencies!==null&&Zf(i.dependencies))?(he||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,xe,Z),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,xe,Z)),typeof v.componentDidUpdate=="function"&&(s.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof v.componentDidUpdate!="function"||k===i.memoizedProps&&ge===i.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===i.memoizedProps&&ge===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=xe),v.props=f,v.state=xe,v.context=Z,f=Te):(typeof v.componentDidUpdate!="function"||k===i.memoizedProps&&ge===i.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===i.memoizedProps&&ge===i.memoizedState||(s.flags|=1024),f=!1)}return v=f,v0(i,s),f=(s.flags&128)!==0,v||f?(v=s.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:v.render(),s.flags|=1,i!==null&&f?(s.child=Tl(s,i.child,null,p),s.child=Tl(s,null,l,p)):Hr(i,s,l,p),s.memoizedState=v.state,i=s.child):i=Ai(i,s,p),i}function n_(i,s,l,f){return Pc(),s.flags|=256,Hr(i,s,l,f),s.child}var Nm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dm(i){return{baseLanes:i,cachePool:Gv()}}function Om(i,s,l){return i=i!==null?i.childLanes&~l:0,s&&(i|=sa),i}function a_(i,s,l){var f=s.pendingProps,p=!1,v=(s.flags&128)!==0,k;if((k=v)||(k=i!==null&&i.memoizedState===null?!1:(wr.current&2)!==0),k&&(p=!0,s.flags&=-129),k=(s.flags&32)!==0,s.flags&=-33,i===null){if(It){if(p?is(s):ss(),It){var P=rr,Z;if(Z=P){e:{for(Z=P,P=Ga;Z.nodeType!==8;){if(!P){P=null;break e}if(Z=ya(Z.nextSibling),Z===null){P=null;break e}}P=Z}P!==null?(s.memoizedState={dehydrated:P,treeContext:ho!==null?{id:xi,overflow:_i}:null,retryLane:536870912,hydrationErrors:null},Z=Un(18,null,null,0),Z.stateNode=P,Z.return=s,s.child=Z,_n=s,rr=null,Z=!0):Z=!1}Z||go(s)}if(P=s.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return gp(P)?s.lanes=32:s.lanes=536870912,null;wi(s)}return P=f.children,f=f.fallback,p?(ss(),p=s.mode,P=x0({mode:"hidden",children:P},p),f=fo(f,p,l,null),P.return=s,f.return=s,P.sibling=f,s.child=P,p=s.child,p.memoizedState=Dm(l),p.childLanes=Om(i,k,l),s.memoizedState=Nm,f):(is(s),Fm(s,P))}if(Z=i.memoizedState,Z!==null&&(P=Z.dehydrated,P!==null)){if(v)s.flags&256?(is(s),s.flags&=-257,s=Mm(i,s,l)):s.memoizedState!==null?(ss(),s.child=i.child,s.flags|=128,s=null):(ss(),p=f.fallback,P=s.mode,f=x0({mode:"visible",children:f.children},P),p=fo(p,P,l,null),p.flags|=2,f.return=s,p.return=s,f.sibling=p,s.child=f,Tl(s,i.child,null,l),f=s.child,f.memoizedState=Dm(l),f.childLanes=Om(i,k,l),s.memoizedState=Nm,s=p);else if(is(s),gp(P)){if(k=P.nextSibling&&P.nextSibling.dataset,k)var he=k.dgst;k=he,f=Error(n(419)),f.stack="",f.digest=k,Lc({value:f,source:null,stack:null}),s=Mm(i,s,l)}else if(Or||Vc(i,s,l,!1),k=(l&i.childLanes)!==0,Or||k){if(k=qt,k!==null&&(f=l&-l,f=(f&42)!==0?1:Oa(f),f=(f&(k.suspendedLanes|l))!==0?0:f,f!==0&&f!==Z.retryLane))throw Z.retryLane=f,fl(i,f),Gn(k,i,f),Yx;P.data==="$?"||Jm(),s=Mm(i,s,l)}else P.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=Z.treeContext,rr=ya(P.nextSibling),_n=s,It=!0,po=null,Ga=!1,i!==null&&(na[aa++]=xi,na[aa++]=_i,na[aa++]=ho,xi=i.id,_i=i.overflow,ho=s),s=Fm(s,f.children),s.flags|=4096);return s}return p?(ss(),p=f.fallback,P=s.mode,Z=i.child,he=Z.sibling,f=vi(Z,{mode:"hidden",children:f.children}),f.subtreeFlags=Z.subtreeFlags&65011712,he!==null?p=vi(he,p):(p=fo(p,P,l,null),p.flags|=2),p.return=s,f.return=s,f.sibling=p,s.child=f,f=p,p=s.child,P=i.child.memoizedState,P===null?P=Dm(l):(Z=P.cachePool,Z!==null?(he=Tr._currentValue,Z=Z.parent!==he?{parent:he,pool:he}:Z):Z=Gv(),P={baseLanes:P.baseLanes|l,cachePool:Z}),p.memoizedState=P,p.childLanes=Om(i,k,l),s.memoizedState=Nm,f):(is(s),l=i.child,i=l.sibling,l=vi(l,{mode:"visible",children:f.children}),l.return=s,l.sibling=null,i!==null&&(k=s.deletions,k===null?(s.deletions=[i],s.flags|=16):k.push(i)),s.child=l,s.memoizedState=null,l)}function Fm(i,s){return s=x0({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function x0(i,s){return i=Un(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Mm(i,s,l){return Tl(s,i.child,null,l),i=Fm(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function i_(i,s,l){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),Jd(i.return,s,l)}function Pm(i,s,l,f,p){var v=i.memoizedState;v===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:p}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=p)}function s_(i,s,l){var f=s.pendingProps,p=f.revealOrder,v=f.tail;if(Hr(i,s,f.children,l),f=wr.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&i_(i,l,s);else if(i.tag===19)i_(i,l,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}switch(Q(wr,f),p){case"forwards":for(l=s.child,p=null;l!==null;)i=l.alternate,i!==null&&m0(i)===null&&(p=l),l=l.sibling;l=p,l===null?(p=s.child,s.child=null):(p=l.sibling,l.sibling=null),Pm(s,!1,p,l,v);break;case"backwards":for(l=null,p=s.child,s.child=null;p!==null;){if(i=p.alternate,i!==null&&m0(i)===null){s.child=p;break}i=p.sibling,p.sibling=l,l=p,p=i}Pm(s,!0,l,null,v);break;case"together":Pm(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ai(i,s,l){if(i!==null&&(s.dependencies=i.dependencies),fs|=s.lanes,(l&s.childLanes)===0)if(i!==null){if(Vc(i,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,l=vi(i,i.pendingProps),s.child=l,l.return=s;i.sibling!==null;)i=i.sibling,l=l.sibling=vi(i,i.pendingProps),l.return=s;l.sibling=null}return s.child}function Lm(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Zf(i)))}function Cb(i,s,l){switch(s.tag){case 3:Ne(s,s.stateNode.containerInfo),es(s,Tr,i.memoizedState.cache),Pc();break;case 27:case 5:Re(s);break;case 4:Ne(s,s.stateNode.containerInfo);break;case 10:es(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(is(s),s.flags|=128,null):(l&s.child.childLanes)!==0?a_(i,s,l):(is(s),i=Ai(i,s,l),i!==null?i.sibling:null);is(s);break;case 19:var p=(i.flags&128)!==0;if(f=(l&s.childLanes)!==0,f||(Vc(i,s,l,!1),f=(l&s.childLanes)!==0),p){if(f)return s_(i,s,l);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Q(wr,wr.current),f)break;return null;case 22:case 23:return s.lanes=0,Jx(i,s,l);case 24:es(s,Tr,i.memoizedState.cache)}return Ai(i,s,l)}function o_(i,s,l){if(i!==null)if(i.memoizedProps!==s.pendingProps)Or=!0;else{if(!Lm(i,l)&&(s.flags&128)===0)return Or=!1,Cb(i,s,l);Or=(i.flags&131072)!==0}else Or=!1,It&&(s.flags&1048576)!==0&&Lv(s,Qf,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var f=s.elementType,p=f._init;if(f=p(f._payload),s.type=f,typeof f=="function")Xd(f)?(i=Eo(f,i),s.tag=1,s=r_(null,s,f,i,l)):(s.tag=0,s=Im(null,s,f,i,l));else{if(f!=null){if(p=f.$$typeof,p===K){s.tag=11,s=Wx(null,s,f,i,l);break e}else if(p===b){s.tag=14,s=Qx(null,s,f,i,l);break e}}throw s=De(f)||f,Error(n(306,s,""))}}return s;case 0:return Im(i,s,s.type,s.pendingProps,l);case 1:return f=s.type,p=Eo(f,s.pendingProps),r_(i,s,f,p,l);case 3:e:{if(Ne(s,s.stateNode.containerInfo),i===null)throw Error(n(387));f=s.pendingProps;var v=s.memoizedState;p=v.element,sm(i,s),qc(s,f,null,l);var k=s.memoizedState;if(f=k.cache,es(s,Tr,f),f!==v.cache&&em(s,[Tr],l,!0),Gc(),f=k.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:k.cache},s.updateQueue.baseState=v,s.memoizedState=v,s.flags&256){s=n_(i,s,f,l);break e}else if(f!==p){p=ta(Error(n(424)),s),Lc(p),s=n_(i,s,f,l);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(rr=ya(i.firstChild),_n=s,It=!0,po=null,Ga=!0,l=Ux(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Pc(),f===p){s=Ai(i,s,l);break e}Hr(i,s,f,l)}s=s.child}return s;case 26:return v0(i,s),i===null?(l=fy(s.type,null,s.pendingProps,null))?s.memoizedState=l:It||(l=s.type,i=s.pendingProps,f=D0(me.current).createElement(l),f[sr]=s,f[Yt]=i,Gr(f,l,i),se(f),s.stateNode=f):s.memoizedState=fy(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Re(s),i===null&&It&&(f=s.stateNode=ly(s.type,s.pendingProps,me.current),_n=s,Ga=!0,p=rr,ps(s.type)?(vp=p,rr=ya(f.firstChild)):rr=p),Hr(i,s,s.pendingProps.children,l),v0(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&It&&((p=f=rr)&&(f=rk(f,s.type,s.pendingProps,Ga),f!==null?(s.stateNode=f,_n=s,rr=ya(f.firstChild),Ga=!1,p=!0):p=!1),p||go(s)),Re(s),p=s.type,v=s.pendingProps,k=i!==null?i.memoizedProps:null,f=v.children,dp(p,v)?f=null:k!==null&&dp(p,k)&&(s.flags|=32),s.memoizedState!==null&&(p=hm(i,s,yb,null,null,l),du._currentValue=p),v0(i,s),Hr(i,s,f,l),s.child;case 6:return i===null&&It&&((i=l=rr)&&(l=nk(l,s.pendingProps,Ga),l!==null?(s.stateNode=l,_n=s,rr=null,i=!0):i=!1),i||go(s)),null;case 13:return a_(i,s,l);case 4:return Ne(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=Tl(s,null,f,l):Hr(i,s,f,l),s.child;case 11:return Wx(i,s,s.type,s.pendingProps,l);case 7:return Hr(i,s,s.pendingProps,l),s.child;case 8:return Hr(i,s,s.pendingProps.children,l),s.child;case 12:return Hr(i,s,s.pendingProps.children,l),s.child;case 10:return f=s.pendingProps,es(s,s.type,f.value),Hr(i,s,f.children,l),s.child;case 9:return p=s.type._context,f=s.pendingProps.children,xo(s),p=Jr(p),f=f(p),s.flags|=1,Hr(i,s,f,l),s.child;case 14:return Qx(i,s,s.type,s.pendingProps,l);case 15:return Zx(i,s,s.type,s.pendingProps,l);case 19:return s_(i,s,l);case 31:return f=s.pendingProps,l=s.mode,f={mode:f.mode,children:f.children},i===null?(l=x0(f,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=vi(i.child,f),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return Jx(i,s,l);case 24:return xo(s),f=Jr(Tr),i===null?(p=nm(),p===null&&(p=qt,v=tm(),p.pooledCache=v,v.refCount++,v!==null&&(p.pooledCacheLanes|=l),p=v),s.memoizedState={parent:f,cache:p},im(s),es(s,Tr,p)):((i.lanes&l)!==0&&(sm(i,s),qc(s,null,null,l),Gc()),p=i.memoizedState,v=s.memoizedState,p.parent!==f?(p={parent:f,cache:f},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),es(s,Tr,f)):(f=v.cache,es(s,Tr,f),f!==p.cache&&em(s,[Tr],l,!0))),Hr(i,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Si(i){i.flags|=4}function l_(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!gy(s)){if(s=ia.current,s!==null&&((Et&4194048)===Et?qa!==null:(Et&62914560)!==Et&&(Et&536870912)===0||s!==qa))throw Hc=am,qv;i.flags|=8192}}function _0(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Wi():536870912,i.lanes|=s,bl|=s)}function Zc(i,s){if(!It)switch(i.tailMode){case"hidden":s=i.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function er(i){var s=i.alternate!==null&&i.alternate.child===i.child,l=0,f=0;if(s)for(var p=i.child;p!==null;)l|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)l|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=f,i.childLanes=l,s}function Rb(i,s,l){var f=s.pendingProps;switch(Wd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(s),null;case 1:return er(s),null;case 3:return l=s.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Ei(Tr),Fe(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Mc(s)?Si(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Bv())),er(s),null;case 26:return l=s.memoizedState,i===null?(Si(s),l!==null?(er(s),l_(s,l)):(er(s),s.flags&=-16777217)):l?l!==i.memoizedState?(Si(s),er(s),l_(s,l)):(er(s),s.flags&=-16777217):(i.memoizedProps!==f&&Si(s),er(s),s.flags&=-16777217),null;case 27:rt(s),l=me.current;var p=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Si(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return er(s),null}i=ee.current,Mc(s)?Vv(s):(i=ly(p,f,l),s.stateNode=i,Si(s))}return er(s),null;case 5:if(rt(s),l=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Si(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return er(s),null}if(i=ee.current,Mc(s))Vv(s);else{switch(p=D0(me.current),i){case 1:i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":i=p.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof f.is=="string"?p.createElement("select",{is:f.is}):p.createElement("select"),f.multiple?i.multiple=!0:f.size&&(i.size=f.size);break;default:i=typeof f.is=="string"?p.createElement(l,{is:f.is}):p.createElement(l)}}i[sr]=s,i[Yt]=f;e:for(p=s.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===s)break e;for(;p.sibling===null;){if(p.return===null||p.return===s)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}s.stateNode=i;e:switch(Gr(i,l,f),l){case"button":case"input":case"select":case"textarea":i=!!f.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Si(s)}}return er(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==f&&Si(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(i=me.current,Mc(s)){if(i=s.stateNode,l=s.memoizedProps,f=null,p=_n,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}i[sr]=s,i=!!(i.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||ty(i.nodeValue,l)),i||go(s)}else i=D0(i).createTextNode(f),i[sr]=s,s.stateNode=i}return er(s),null;case 13:if(f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Mc(s),f!==null&&f.dehydrated!==null){if(i===null){if(!p)throw Error(n(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[sr]=s}else Pc(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;er(s),p=!1}else p=Bv(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(wi(s),s):(wi(s),null)}if(wi(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=f!==null,i=i!==null&&i.memoizedState!==null,l){f=s.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool);var v=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==p&&(f.flags|=2048)}return l!==i&&l&&(s.child.flags|=8192),_0(s,s.updateQueue),er(s),null;case 4:return Fe(),i===null&&lp(s.stateNode.containerInfo),er(s),null;case 10:return Ei(s.type),er(s),null;case 19:if(j(wr),p=s.memoizedState,p===null)return er(s),null;if(f=(s.flags&128)!==0,v=p.rendering,v===null)if(f)Zc(p,!1);else{if(nr!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(v=m0(i),v!==null){for(s.flags|=128,Zc(p,!1),i=v.updateQueue,s.updateQueue=i,_0(s,i),s.subtreeFlags=0,i=l,l=s.child;l!==null;)Pv(l,i),l=l.sibling;return Q(wr,wr.current&1|2),s.child}i=i.sibling}p.tail!==null&&Pe()>T0&&(s.flags|=128,f=!0,Zc(p,!1),s.lanes=4194304)}else{if(!f)if(i=m0(v),i!==null){if(s.flags|=128,f=!0,i=i.updateQueue,s.updateQueue=i,_0(s,i),Zc(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!It)return er(s),null}else 2*Pe()-p.renderingStartTime>T0&&l!==536870912&&(s.flags|=128,f=!0,Zc(p,!1),s.lanes=4194304);p.isBackwards?(v.sibling=s.child,s.child=v):(i=p.last,i!==null?i.sibling=v:s.child=v,p.last=v)}return p.tail!==null?(s=p.tail,p.rendering=s,p.tail=s.sibling,p.renderingStartTime=Pe(),s.sibling=null,i=wr.current,Q(wr,f?i&1|2:i&1),s):(er(s),null);case 22:case 23:return wi(s),um(),f=s.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(l&536870912)!==0&&(s.flags&128)===0&&(er(s),s.subtreeFlags&6&&(s.flags|=8192)):er(s),l=s.updateQueue,l!==null&&_0(s,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==l&&(s.flags|=2048),i!==null&&j(_o),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),Ei(Tr),er(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function Ib(i,s){switch(Wd(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Ei(Tr),Fe(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return rt(s),null;case 13:if(wi(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Pc()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return j(wr),null;case 4:return Fe(),null;case 10:return Ei(s.type),null;case 22:case 23:return wi(s),um(),i!==null&&j(_o),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Ei(Tr),null;case 25:return null;default:return null}}function c_(i,s){switch(Wd(s),s.tag){case 3:Ei(Tr),Fe();break;case 26:case 27:case 5:rt(s);break;case 4:Fe();break;case 13:wi(s);break;case 19:j(wr);break;case 10:Ei(s.type);break;case 22:case 23:wi(s),um(),i!==null&&j(_o);break;case 24:Ei(Tr)}}function Jc(i,s){try{var l=s.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var p=f.next;l=p;do{if((l.tag&i)===i){f=void 0;var v=l.create,k=l.inst;f=v(),k.destroy=f}l=l.next}while(l!==p)}}catch(P){zt(s,s.return,P)}}function os(i,s,l){try{var f=s.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var v=p.next;f=v;do{if((f.tag&i)===i){var k=f.inst,P=k.destroy;if(P!==void 0){k.destroy=void 0,p=s;var Z=l,he=P;try{he()}catch(Te){zt(p,Z,Te)}}}f=f.next}while(f!==v)}}catch(Te){zt(s,s.return,Te)}}function u_(i){var s=i.updateQueue;if(s!==null){var l=i.stateNode;try{Qv(s,l)}catch(f){zt(i,i.return,f)}}}function f_(i,s,l){l.props=Eo(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(f){zt(i,s,f)}}function eu(i,s){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof l=="function"?i.refCleanup=l(f):l.current=f}}catch(p){zt(i,s,p)}}function Xa(i,s){var l=i.ref,f=i.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(p){zt(i,s,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){zt(i,s,p)}else l.current=null}function h_(i){var s=i.type,l=i.memoizedProps,f=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(p){zt(i,i.return,p)}}function Vm(i,s,l){try{var f=i.stateNode;Qb(f,i.type,l,s),f[Yt]=s}catch(p){zt(i,i.return,p)}}function d_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&ps(i.type)||i.tag===4}function Um(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||d_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&ps(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Bm(i,s,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(i),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=N0));else if(f!==4&&(f===27&&ps(i.type)&&(l=i.stateNode,s=null),i=i.child,i!==null))for(Bm(i,s,l),i=i.sibling;i!==null;)Bm(i,s,l),i=i.sibling}function y0(i,s,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?l.insertBefore(i,s):l.appendChild(i);else if(f!==4&&(f===27&&ps(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(y0(i,s,l),i=i.sibling;i!==null;)y0(i,s,l),i=i.sibling}function m_(i){var s=i.stateNode,l=i.memoizedProps;try{for(var f=i.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);Gr(s,f,l),s[sr]=i,s[Yt]=l}catch(v){zt(i,i.return,v)}}var bi=!1,lr=!1,jm=!1,p_=typeof WeakSet=="function"?WeakSet:Set,Fr=null;function Nb(i,s){if(i=i.containerInfo,fp=V0,i=bv(i),Ud(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var p=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var k=0,P=-1,Z=-1,he=0,Te=0,Ae=i,ge=null;t:for(;;){for(var xe;Ae!==l||p!==0&&Ae.nodeType!==3||(P=k+p),Ae!==v||f!==0&&Ae.nodeType!==3||(Z=k+f),Ae.nodeType===3&&(k+=Ae.nodeValue.length),(xe=Ae.firstChild)!==null;)ge=Ae,Ae=xe;for(;;){if(Ae===i)break t;if(ge===l&&++he===p&&(P=k),ge===v&&++Te===f&&(Z=k),(xe=Ae.nextSibling)!==null)break;Ae=ge,ge=Ae.parentNode}Ae=xe}l=P===-1||Z===-1?null:{start:P,end:Z}}else l=null}l=l||{start:0,end:0}}else l=null;for(hp={focusedElem:i,selectionRange:l},V0=!1,Fr=s;Fr!==null;)if(s=Fr,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,Fr=i;else for(;Fr!==null;){switch(s=Fr,v=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,l=s,p=v.memoizedProps,v=v.memoizedState,f=l.stateNode;try{var We=Eo(l.type,p,l.elementType===l.type);i=f.getSnapshotBeforeUpdate(We,v),f.__reactInternalSnapshotBeforeUpdate=i}catch(Xe){zt(l,l.return,Xe)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,l=i.nodeType,l===9)pp(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":pp(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=s.sibling,i!==null){i.return=s.return,Fr=i;break}Fr=s.return}}function g_(i,s,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:ls(i,l),f&4&&Jc(5,l);break;case 1:if(ls(i,l),f&4)if(i=l.stateNode,s===null)try{i.componentDidMount()}catch(k){zt(l,l.return,k)}else{var p=Eo(l.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(p,s,i.__reactInternalSnapshotBeforeUpdate)}catch(k){zt(l,l.return,k)}}f&64&&u_(l),f&512&&eu(l,l.return);break;case 3:if(ls(i,l),f&64&&(i=l.updateQueue,i!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{Qv(i,s)}catch(k){zt(l,l.return,k)}}break;case 27:s===null&&f&4&&m_(l);case 26:case 5:ls(i,l),s===null&&f&4&&h_(l),f&512&&eu(l,l.return);break;case 12:ls(i,l);break;case 13:ls(i,l),f&4&&__(i,l),f&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=Bb.bind(null,l),ak(i,l))));break;case 22:if(f=l.memoizedState!==null||bi,!f){s=s!==null&&s.memoizedState!==null||lr,p=bi;var v=lr;bi=f,(lr=s)&&!v?cs(i,l,(l.subtreeFlags&8772)!==0):ls(i,l),bi=p,lr=v}break;case 30:break;default:ls(i,l)}}function v_(i){var s=i.alternate;s!==null&&(i.alternate=null,v_(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&z(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Wt=null,Nn=!1;function ki(i,s,l){for(l=l.child;l!==null;)x_(i,s,l),l=l.sibling}function x_(i,s,l){if(pt&&typeof pt.onCommitFiberUnmount=="function")try{pt.onCommitFiberUnmount(Rt,l)}catch{}switch(l.tag){case 26:lr||Xa(l,s),ki(i,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:lr||Xa(l,s);var f=Wt,p=Nn;ps(l.type)&&(Wt=l.stateNode,Nn=!1),ki(i,s,l),cu(l.stateNode),Wt=f,Nn=p;break;case 5:lr||Xa(l,s);case 6:if(f=Wt,p=Nn,Wt=null,ki(i,s,l),Wt=f,Nn=p,Wt!==null)if(Nn)try{(Wt.nodeType===9?Wt.body:Wt.nodeName==="HTML"?Wt.ownerDocument.body:Wt).removeChild(l.stateNode)}catch(v){zt(l,s,v)}else try{Wt.removeChild(l.stateNode)}catch(v){zt(l,s,v)}break;case 18:Wt!==null&&(Nn?(i=Wt,sy(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),vu(i)):sy(Wt,l.stateNode));break;case 4:f=Wt,p=Nn,Wt=l.stateNode.containerInfo,Nn=!0,ki(i,s,l),Wt=f,Nn=p;break;case 0:case 11:case 14:case 15:lr||os(2,l,s),lr||os(4,l,s),ki(i,s,l);break;case 1:lr||(Xa(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"&&f_(l,s,f)),ki(i,s,l);break;case 21:ki(i,s,l);break;case 22:lr=(f=lr)||l.memoizedState!==null,ki(i,s,l),lr=f;break;default:ki(i,s,l)}}function __(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{vu(i)}catch(l){zt(s,s.return,l)}}function Db(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new p_),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new p_),s;default:throw Error(n(435,i.tag))}}function Hm(i,s){var l=Db(i);s.forEach(function(f){var p=jb.bind(null,i,f);l.has(f)||(l.add(f),f.then(p,p))})}function Bn(i,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var p=l[f],v=i,k=s,P=k;e:for(;P!==null;){switch(P.tag){case 27:if(ps(P.type)){Wt=P.stateNode,Nn=!1;break e}break;case 5:Wt=P.stateNode,Nn=!1;break e;case 3:case 4:Wt=P.stateNode.containerInfo,Nn=!0;break e}P=P.return}if(Wt===null)throw Error(n(160));x_(v,k,p),Wt=null,Nn=!1,v=p.alternate,v!==null&&(v.return=null),p.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)y_(s,i),s=s.sibling}var _a=null;function y_(i,s){var l=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Bn(s,i),jn(i),f&4&&(os(3,i,i.return),Jc(3,i),os(5,i,i.return));break;case 1:Bn(s,i),jn(i),f&512&&(lr||l===null||Xa(l,l.return)),f&64&&bi&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var p=_a;if(Bn(s,i),jn(i),f&512&&(lr||l===null||Xa(l,l.return)),f&4){var v=l!==null?l.memoizedState:null;if(f=i.memoizedState,l===null)if(f===null)if(i.stateNode===null){e:{f=i.type,l=i.memoizedProps,p=p.ownerDocument||p;t:switch(f){case"title":v=p.getElementsByTagName("title")[0],(!v||v[H]||v[sr]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=p.createElement(f),p.head.insertBefore(v,p.querySelector("head > title"))),Gr(v,f,l),v[sr]=i,se(v),f=v;break e;case"link":var k=my("link","href",p).get(f+(l.href||""));if(k){for(var P=0;P<k.length;P++)if(v=k[P],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){k.splice(P,1);break t}}v=p.createElement(f),Gr(v,f,l),p.head.appendChild(v);break;case"meta":if(k=my("meta","content",p).get(f+(l.content||""))){for(P=0;P<k.length;P++)if(v=k[P],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){k.splice(P,1);break t}}v=p.createElement(f),Gr(v,f,l),p.head.appendChild(v);break;default:throw Error(n(468,f))}v[sr]=i,se(v),f=v}i.stateNode=f}else py(p,i.type,i.stateNode);else i.stateNode=dy(p,f,i.memoizedProps);else v!==f?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,f===null?py(p,i.type,i.stateNode):dy(p,f,i.memoizedProps)):f===null&&i.stateNode!==null&&Vm(i,i.memoizedProps,l.memoizedProps)}break;case 27:Bn(s,i),jn(i),f&512&&(lr||l===null||Xa(l,l.return)),l!==null&&f&4&&Vm(i,i.memoizedProps,l.memoizedProps);break;case 5:if(Bn(s,i),jn(i),f&512&&(lr||l===null||Xa(l,l.return)),i.flags&32){p=i.stateNode;try{Qn(p,"")}catch(xe){zt(i,i.return,xe)}}f&4&&i.stateNode!=null&&(p=i.memoizedProps,Vm(i,p,l!==null?l.memoizedProps:p)),f&1024&&(jm=!0);break;case 6:if(Bn(s,i),jn(i),f&4){if(i.stateNode===null)throw Error(n(162));f=i.memoizedProps,l=i.stateNode;try{l.nodeValue=f}catch(xe){zt(i,i.return,xe)}}break;case 3:if(M0=null,p=_a,_a=O0(s.containerInfo),Bn(s,i),_a=p,jn(i),f&4&&l!==null&&l.memoizedState.isDehydrated)try{vu(s.containerInfo)}catch(xe){zt(i,i.return,xe)}jm&&(jm=!1,E_(i));break;case 4:f=_a,_a=O0(i.stateNode.containerInfo),Bn(s,i),jn(i),_a=f;break;case 12:Bn(s,i),jn(i);break;case 13:Bn(s,i),jn(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&($m=Pe()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Hm(i,f)));break;case 22:p=i.memoizedState!==null;var Z=l!==null&&l.memoizedState!==null,he=bi,Te=lr;if(bi=he||p,lr=Te||Z,Bn(s,i),lr=Te,bi=he,jn(i),f&8192)e:for(s=i.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(l===null||Z||bi||lr||To(i)),l=null,s=i;;){if(s.tag===5||s.tag===26){if(l===null){Z=l=s;try{if(v=Z.stateNode,p)k=v.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{P=Z.stateNode;var Ae=Z.memoizedProps.style,ge=Ae!=null&&Ae.hasOwnProperty("display")?Ae.display:null;P.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(xe){zt(Z,Z.return,xe)}}}else if(s.tag===6){if(l===null){Z=s;try{Z.stateNode.nodeValue=p?"":Z.memoizedProps}catch(xe){zt(Z,Z.return,xe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=i.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,Hm(i,l))));break;case 19:Bn(s,i),jn(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Hm(i,f)));break;case 30:break;case 21:break;default:Bn(s,i),jn(i)}}function jn(i){var s=i.flags;if(s&2){try{for(var l,f=i.return;f!==null;){if(d_(f)){l=f;break}f=f.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var p=l.stateNode,v=Um(i);y0(i,v,p);break;case 5:var k=l.stateNode;l.flags&32&&(Qn(k,""),l.flags&=-33);var P=Um(i);y0(i,P,k);break;case 3:case 4:var Z=l.stateNode.containerInfo,he=Um(i);Bm(i,he,Z);break;default:throw Error(n(161))}}catch(Te){zt(i,i.return,Te)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function E_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;E_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function ls(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)g_(i,s.alternate,s),s=s.sibling}function To(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:os(4,s,s.return),To(s);break;case 1:Xa(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&f_(s,s.return,l),To(s);break;case 27:cu(s.stateNode);case 26:case 5:Xa(s,s.return),To(s);break;case 22:s.memoizedState===null&&To(s);break;case 30:To(s);break;default:To(s)}i=i.sibling}}function cs(i,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,p=i,v=s,k=v.flags;switch(v.tag){case 0:case 11:case 15:cs(p,v,l),Jc(4,v);break;case 1:if(cs(p,v,l),f=v,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(he){zt(f,f.return,he)}if(f=v,p=f.updateQueue,p!==null){var P=f.stateNode;try{var Z=p.shared.hiddenCallbacks;if(Z!==null)for(p.shared.hiddenCallbacks=null,p=0;p<Z.length;p++)Wv(Z[p],P)}catch(he){zt(f,f.return,he)}}l&&k&64&&u_(v),eu(v,v.return);break;case 27:m_(v);case 26:case 5:cs(p,v,l),l&&f===null&&k&4&&h_(v),eu(v,v.return);break;case 12:cs(p,v,l);break;case 13:cs(p,v,l),l&&k&4&&__(p,v);break;case 22:v.memoizedState===null&&cs(p,v,l),eu(v,v.return);break;case 30:break;default:cs(p,v,l)}s=s.sibling}}function zm(i,s){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Uc(l))}function Gm(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Uc(i))}function Ka(i,s,l,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)T_(i,s,l,f),s=s.sibling}function T_(i,s,l,f){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Ka(i,s,l,f),p&2048&&Jc(9,s);break;case 1:Ka(i,s,l,f);break;case 3:Ka(i,s,l,f),p&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Uc(i)));break;case 12:if(p&2048){Ka(i,s,l,f),i=s.stateNode;try{var v=s.memoizedProps,k=v.id,P=v.onPostCommit;typeof P=="function"&&P(k,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Z){zt(s,s.return,Z)}}else Ka(i,s,l,f);break;case 13:Ka(i,s,l,f);break;case 23:break;case 22:v=s.stateNode,k=s.alternate,s.memoizedState!==null?v._visibility&2?Ka(i,s,l,f):tu(i,s):v._visibility&2?Ka(i,s,l,f):(v._visibility|=2,wl(i,s,l,f,(s.subtreeFlags&10256)!==0)),p&2048&&zm(k,s);break;case 24:Ka(i,s,l,f),p&2048&&Gm(s.alternate,s);break;default:Ka(i,s,l,f)}}function wl(i,s,l,f,p){for(p=p&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var v=i,k=s,P=l,Z=f,he=k.flags;switch(k.tag){case 0:case 11:case 15:wl(v,k,P,Z,p),Jc(8,k);break;case 23:break;case 22:var Te=k.stateNode;k.memoizedState!==null?Te._visibility&2?wl(v,k,P,Z,p):tu(v,k):(Te._visibility|=2,wl(v,k,P,Z,p)),p&&he&2048&&zm(k.alternate,k);break;case 24:wl(v,k,P,Z,p),p&&he&2048&&Gm(k.alternate,k);break;default:wl(v,k,P,Z,p)}s=s.sibling}}function tu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=i,f=s,p=f.flags;switch(f.tag){case 22:tu(l,f),p&2048&&zm(f.alternate,f);break;case 24:tu(l,f),p&2048&&Gm(f.alternate,f);break;default:tu(l,f)}s=s.sibling}}var ru=8192;function Al(i){if(i.subtreeFlags&ru)for(i=i.child;i!==null;)w_(i),i=i.sibling}function w_(i){switch(i.tag){case 26:Al(i),i.flags&ru&&i.memoizedState!==null&&vk(_a,i.memoizedState,i.memoizedProps);break;case 5:Al(i);break;case 3:case 4:var s=_a;_a=O0(i.stateNode.containerInfo),Al(i),_a=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=ru,ru=16777216,Al(i),ru=s):Al(i));break;default:Al(i)}}function A_(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function nu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];Fr=f,b_(f,i)}A_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)S_(i),i=i.sibling}function S_(i){switch(i.tag){case 0:case 11:case 15:nu(i),i.flags&2048&&os(9,i,i.return);break;case 3:nu(i);break;case 12:nu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,E0(i)):nu(i);break;default:nu(i)}}function E0(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];Fr=f,b_(f,i)}A_(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:os(8,s,s.return),E0(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,E0(s));break;default:E0(s)}i=i.sibling}}function b_(i,s){for(;Fr!==null;){var l=Fr;switch(l.tag){case 0:case 11:case 15:os(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Uc(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,Fr=f;else e:for(l=i;Fr!==null;){f=Fr;var p=f.sibling,v=f.return;if(v_(f),f===l){Fr=null;break e}if(p!==null){p.return=v,Fr=p;break e}Fr=v}}}var Ob={getCacheForType:function(i){var s=Jr(Tr),l=s.data.get(i);return l===void 0&&(l=i(),s.data.set(i,l)),l}},Fb=typeof WeakMap=="function"?WeakMap:Map,Mt=0,qt=null,ft=null,Et=0,Pt=0,Hn=null,us=!1,Sl=!1,qm=!1,Ci=0,nr=0,fs=0,wo=0,Xm=0,sa=0,bl=0,au=null,Dn=null,Km=!1,$m=0,T0=1/0,w0=null,hs=null,zr=0,ds=null,kl=null,Cl=0,Ym=0,Wm=null,k_=null,iu=0,Qm=null;function zn(){if((Mt&2)!==0&&Et!==0)return Et&-Et;if(ae.T!==null){var i=pl;return i!==0?i:ap()}return Fa()}function C_(){sa===0&&(sa=(Et&536870912)===0||It?Yi():536870912);var i=ia.current;return i!==null&&(i.flags|=32),sa}function Gn(i,s,l){(i===qt&&(Pt===2||Pt===9)||i.cancelPendingCommit!==null)&&(Rl(i,0),ms(i,Et,sa,!1)),ga(i,l),((Mt&2)===0||i!==qt)&&(i===qt&&((Mt&2)===0&&(wo|=l),nr===4&&ms(i,Et,sa,!1)),$a(i))}function R_(i,s,l){if((Mt&6)!==0)throw Error(n(327));var f=!l&&(s&124)===0&&(s&i.expiredLanes)===0||ci(i,s),p=f?Lb(i,s):ep(i,s,!0),v=f;do{if(p===0){Sl&&!f&&ms(i,s,0,!1);break}else{if(l=i.current.alternate,v&&!Mb(l)){p=ep(i,s,!1),v=!1;continue}if(p===2){if(v=s,i.errorRecoveryDisabledLanes&v)var k=0;else k=i.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){s=k;e:{var P=i;p=au;var Z=P.current.memoizedState.isDehydrated;if(Z&&(Rl(P,k).flags|=256),k=ep(P,k,!1),k!==2){if(qm&&!Z){P.errorRecoveryDisabledLanes|=v,wo|=v,p=4;break e}v=Dn,Dn=p,v!==null&&(Dn===null?Dn=v:Dn.push.apply(Dn,v))}p=k}if(v=!1,p!==2)continue}}if(p===1){Rl(i,0),ms(i,s,0,!0);break}e:{switch(f=i,v=p,v){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:ms(f,s,sa,!us);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(p=$m+300-Pe(),10<p)){if(ms(f,s,sa,!us),Ki(f,0,!0)!==0)break e;f.timeoutHandle=ay(I_.bind(null,f,l,Dn,w0,Km,s,sa,wo,bl,us,v,2,-0,0),p);break e}I_(f,l,Dn,w0,Km,s,sa,wo,bl,us,v,0,-0,0)}}break}while(!0);$a(i)}function I_(i,s,l,f,p,v,k,P,Z,he,Te,Ae,ge,xe){if(i.timeoutHandle=-1,Ae=s.subtreeFlags,(Ae&8192||(Ae&16785408)===16785408)&&(hu={stylesheets:null,count:0,unsuspend:gk},w_(s),Ae=xk(),Ae!==null)){i.cancelPendingCommit=Ae(L_.bind(null,i,s,v,l,f,p,k,P,Z,Te,1,ge,xe)),ms(i,v,k,!he);return}L_(i,s,v,l,f,p,k,P,Z)}function Mb(i){for(var s=i;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var p=l[f],v=p.getSnapshot;p=p.value;try{if(!Vn(v(),p))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ms(i,s,l,f){s&=~Xm,s&=~wo,i.suspendedLanes|=s,i.pingedLanes&=~s,f&&(i.warmLanes|=s),f=i.expirationTimes;for(var p=s;0<p;){var v=31-jt(p),k=1<<v;f[v]=-1,p&=~k}l!==0&&Wn(i,l,s)}function A0(){return(Mt&6)===0?(su(0),!1):!0}function Zm(){if(ft!==null){if(Pt===0)var i=ft.return;else i=ft,yi=vo=null,pm(i),El=null,Wc=0,i=ft;for(;i!==null;)c_(i.alternate,i),i=i.return;ft=null}}function Rl(i,s){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,Jb(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),Zm(),qt=i,ft=l=vi(i.current,null),Et=s,Pt=0,Hn=null,us=!1,Sl=ci(i,s),qm=!1,bl=sa=Xm=wo=fs=nr=0,Dn=au=null,Km=!1,(s&8)!==0&&(s|=s&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=s;0<f;){var p=31-jt(f),v=1<<p;s|=i[p],f&=~v}return Ci=s,Xf(),l}function N_(i,s){lt=null,ae.H=f0,s===jc||s===t0?(s=$v(),Pt=3):s===qv?(s=$v(),Pt=4):Pt=s===Yx?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Hn=s,ft===null&&(nr=1,g0(i,ta(s,i.current)))}function D_(){var i=ae.H;return ae.H=f0,i===null?f0:i}function O_(){var i=ae.A;return ae.A=Ob,i}function Jm(){nr=4,us||(Et&4194048)!==Et&&ia.current!==null||(Sl=!0),(fs&134217727)===0&&(wo&134217727)===0||qt===null||ms(qt,Et,sa,!1)}function ep(i,s,l){var f=Mt;Mt|=2;var p=D_(),v=O_();(qt!==i||Et!==s)&&(w0=null,Rl(i,s)),s=!1;var k=nr;e:do try{if(Pt!==0&&ft!==null){var P=ft,Z=Hn;switch(Pt){case 8:Zm(),k=6;break e;case 3:case 2:case 9:case 6:ia.current===null&&(s=!0);var he=Pt;if(Pt=0,Hn=null,Il(i,P,Z,he),l&&Sl){k=0;break e}break;default:he=Pt,Pt=0,Hn=null,Il(i,P,Z,he)}}Pb(),k=nr;break}catch(Te){N_(i,Te)}while(!0);return s&&i.shellSuspendCounter++,yi=vo=null,Mt=f,ae.H=p,ae.A=v,ft===null&&(qt=null,Et=0,Xf()),k}function Pb(){for(;ft!==null;)F_(ft)}function Lb(i,s){var l=Mt;Mt|=2;var f=D_(),p=O_();qt!==i||Et!==s?(w0=null,T0=Pe()+500,Rl(i,s)):Sl=ci(i,s);e:do try{if(Pt!==0&&ft!==null){s=ft;var v=Hn;t:switch(Pt){case 1:Pt=0,Hn=null,Il(i,s,v,1);break;case 2:case 9:if(Xv(v)){Pt=0,Hn=null,M_(s);break}s=function(){Pt!==2&&Pt!==9||qt!==i||(Pt=7),$a(i)},v.then(s,s);break e;case 3:Pt=7;break e;case 4:Pt=5;break e;case 7:Xv(v)?(Pt=0,Hn=null,M_(s)):(Pt=0,Hn=null,Il(i,s,v,7));break;case 5:var k=null;switch(ft.tag){case 26:k=ft.memoizedState;case 5:case 27:var P=ft;if(!k||gy(k)){Pt=0,Hn=null;var Z=P.sibling;if(Z!==null)ft=Z;else{var he=P.return;he!==null?(ft=he,S0(he)):ft=null}break t}}Pt=0,Hn=null,Il(i,s,v,5);break;case 6:Pt=0,Hn=null,Il(i,s,v,6);break;case 8:Zm(),nr=6;break e;default:throw Error(n(462))}}Vb();break}catch(Te){N_(i,Te)}while(!0);return yi=vo=null,ae.H=f,ae.A=p,Mt=l,ft!==null?0:(qt=null,Et=0,Xf(),nr)}function Vb(){for(;ft!==null&&!St();)F_(ft)}function F_(i){var s=o_(i.alternate,i,Ci);i.memoizedProps=i.pendingProps,s===null?S0(i):ft=s}function M_(i){var s=i,l=s.alternate;switch(s.tag){case 15:case 0:s=t_(l,s,s.pendingProps,s.type,void 0,Et);break;case 11:s=t_(l,s,s.pendingProps,s.type.render,s.ref,Et);break;case 5:pm(s);default:c_(l,s),s=ft=Pv(s,Ci),s=o_(l,s,Ci)}i.memoizedProps=i.pendingProps,s===null?S0(i):ft=s}function Il(i,s,l,f){yi=vo=null,pm(s),El=null,Wc=0;var p=s.return;try{if(kb(i,p,s,l,Et)){nr=1,g0(i,ta(l,i.current)),ft=null;return}}catch(v){if(p!==null)throw ft=p,v;nr=1,g0(i,ta(l,i.current)),ft=null;return}s.flags&32768?(It||f===1?i=!0:Sl||(Et&536870912)!==0?i=!1:(us=i=!0,(f===2||f===9||f===3||f===6)&&(f=ia.current,f!==null&&f.tag===13&&(f.flags|=16384))),P_(s,i)):S0(s)}function S0(i){var s=i;do{if((s.flags&32768)!==0){P_(s,us);return}i=s.return;var l=Rb(s.alternate,s,Ci);if(l!==null){ft=l;return}if(s=s.sibling,s!==null){ft=s;return}ft=s=i}while(s!==null);nr===0&&(nr=5)}function P_(i,s){do{var l=Ib(i.alternate,i);if(l!==null){l.flags&=32767,ft=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(i=i.sibling,i!==null)){ft=i;return}ft=i=l}while(i!==null);nr=6,ft=null}function L_(i,s,l,f,p,v,k,P,Z){i.cancelPendingCommit=null;do b0();while(zr!==0);if((Mt&6)!==0)throw Error(n(327));if(s!==null){if(s===i.current)throw Error(n(177));if(v=s.lanes|s.childLanes,v|=Gd,Da(i,l,v,k,P,Z),i===qt&&(ft=qt=null,Et=0),kl=s,ds=i,Cl=l,Ym=v,Wm=p,k_=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Hb(Br,function(){return H_(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ae.T,ae.T=null,p=ue.p,ue.p=2,k=Mt,Mt|=4;try{Nb(i,s,l)}finally{Mt=k,ue.p=p,ae.T=f}}zr=1,V_(),U_(),B_()}}function V_(){if(zr===1){zr=0;var i=ds,s=kl,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=ae.T,ae.T=null;var f=ue.p;ue.p=2;var p=Mt;Mt|=4;try{y_(s,i);var v=hp,k=bv(i.containerInfo),P=v.focusedElem,Z=v.selectionRange;if(k!==P&&P&&P.ownerDocument&&Sv(P.ownerDocument.documentElement,P)){if(Z!==null&&Ud(P)){var he=Z.start,Te=Z.end;if(Te===void 0&&(Te=he),"selectionStart"in P)P.selectionStart=he,P.selectionEnd=Math.min(Te,P.value.length);else{var Ae=P.ownerDocument||document,ge=Ae&&Ae.defaultView||window;if(ge.getSelection){var xe=ge.getSelection(),We=P.textContent.length,Xe=Math.min(Z.start,We),Bt=Z.end===void 0?Xe:Math.min(Z.end,We);!xe.extend&&Xe>Bt&&(k=Bt,Bt=Xe,Xe=k);var ie=Av(P,Xe),ne=Av(P,Bt);if(ie&&ne&&(xe.rangeCount!==1||xe.anchorNode!==ie.node||xe.anchorOffset!==ie.offset||xe.focusNode!==ne.node||xe.focusOffset!==ne.offset)){var ce=Ae.createRange();ce.setStart(ie.node,ie.offset),xe.removeAllRanges(),Xe>Bt?(xe.addRange(ce),xe.extend(ne.node,ne.offset)):(ce.setEnd(ne.node,ne.offset),xe.addRange(ce))}}}}for(Ae=[],xe=P;xe=xe.parentNode;)xe.nodeType===1&&Ae.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<Ae.length;P++){var we=Ae[P];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}V0=!!fp,hp=fp=null}finally{Mt=p,ue.p=f,ae.T=l}}i.current=s,zr=2}}function U_(){if(zr===2){zr=0;var i=ds,s=kl,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=ae.T,ae.T=null;var f=ue.p;ue.p=2;var p=Mt;Mt|=4;try{g_(i,s.alternate,s)}finally{Mt=p,ue.p=f,ae.T=l}}zr=3}}function B_(){if(zr===4||zr===3){zr=0,at();var i=ds,s=kl,l=Cl,f=k_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?zr=5:(zr=0,kl=ds=null,j_(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(hs=null),Qi(l),s=s.stateNode,pt&&typeof pt.onCommitFiberRoot=="function")try{pt.onCommitFiberRoot(Rt,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ae.T,p=ue.p,ue.p=2,ae.T=null;try{for(var v=i.onRecoverableError,k=0;k<f.length;k++){var P=f[k];v(P.value,{componentStack:P.stack})}}finally{ae.T=s,ue.p=p}}(Cl&3)!==0&&b0(),$a(i),p=i.pendingLanes,(l&4194090)!==0&&(p&42)!==0?i===Qm?iu++:(iu=0,Qm=i):iu=0,su(0)}}function j_(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Uc(s)))}function b0(i){return V_(),U_(),B_(),H_()}function H_(){if(zr!==5)return!1;var i=ds,s=Ym;Ym=0;var l=Qi(Cl),f=ae.T,p=ue.p;try{ue.p=32>l?32:l,ae.T=null,l=Wm,Wm=null;var v=ds,k=Cl;if(zr=0,kl=ds=null,Cl=0,(Mt&6)!==0)throw Error(n(331));var P=Mt;if(Mt|=4,S_(v.current),T_(v,v.current,k,l),Mt=P,su(0,!1),pt&&typeof pt.onPostCommitFiberRoot=="function")try{pt.onPostCommitFiberRoot(Rt,v)}catch{}return!0}finally{ue.p=p,ae.T=f,j_(i,s)}}function z_(i,s,l){s=ta(l,s),s=Rm(i.stateNode,s,2),i=ns(i,s,2),i!==null&&(ga(i,2),$a(i))}function zt(i,s,l){if(i.tag===3)z_(i,i,l);else for(;s!==null;){if(s.tag===3){z_(s,i,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(hs===null||!hs.has(f))){i=ta(l,i),l=Kx(2),f=ns(s,l,2),f!==null&&($x(l,f,s,i),ga(f,2),$a(f));break}}s=s.return}}function tp(i,s,l){var f=i.pingCache;if(f===null){f=i.pingCache=new Fb;var p=new Set;f.set(s,p)}else p=f.get(s),p===void 0&&(p=new Set,f.set(s,p));p.has(l)||(qm=!0,p.add(l),i=Ub.bind(null,i,s,l),s.then(i,i))}function Ub(i,s,l){var f=i.pingCache;f!==null&&f.delete(s),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,qt===i&&(Et&l)===l&&(nr===4||nr===3&&(Et&62914560)===Et&&300>Pe()-$m?(Mt&2)===0&&Rl(i,0):Xm|=l,bl===Et&&(bl=0)),$a(i)}function G_(i,s){s===0&&(s=Wi()),i=fl(i,s),i!==null&&(ga(i,s),$a(i))}function Bb(i){var s=i.memoizedState,l=0;s!==null&&(l=s.retryLane),G_(i,l)}function jb(i,s){var l=0;switch(i.tag){case 13:var f=i.stateNode,p=i.memoizedState;p!==null&&(l=p.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),G_(i,l)}function Hb(i,s){return Ot(i,s)}var k0=null,Nl=null,rp=!1,C0=!1,np=!1,Ao=0;function $a(i){i!==Nl&&i.next===null&&(Nl===null?k0=Nl=i:Nl=Nl.next=i),C0=!0,rp||(rp=!0,Gb())}function su(i,s){if(!np&&C0){np=!0;do for(var l=!1,f=k0;f!==null;){if(i!==0){var p=f.pendingLanes;if(p===0)var v=0;else{var k=f.suspendedLanes,P=f.pingedLanes;v=(1<<31-jt(42|i)+1)-1,v&=p&~(k&~P),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,$_(f,v))}else v=Et,v=Ki(f,f===qt?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||ci(f,v)||(l=!0,$_(f,v));f=f.next}while(l);np=!1}}function zb(){q_()}function q_(){C0=rp=!1;var i=0;Ao!==0&&(Zb()&&(i=Ao),Ao=0);for(var s=Pe(),l=null,f=k0;f!==null;){var p=f.next,v=X_(f,s);v===0?(f.next=null,l===null?k0=p:l.next=p,p===null&&(Nl=l)):(l=f,(i!==0||(v&3)!==0)&&(C0=!0)),f=p}su(i)}function X_(i,s){for(var l=i.suspendedLanes,f=i.pingedLanes,p=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var k=31-jt(v),P=1<<k,Z=p[k];Z===-1?((P&l)===0||(P&f)!==0)&&(p[k]=$i(P,s)):Z<=s&&(i.expiredLanes|=P),v&=~P}if(s=qt,l=Et,l=Ki(i,i===s?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,l===0||i===s&&(Pt===2||Pt===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&ot(f),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||ci(i,l)){if(s=l&-l,s===i.callbackPriority)return s;switch(f!==null&&ot(f),Qi(l)){case 2:case 8:l=Ur;break;case 32:l=Br;break;case 268435456:l=dn;break;default:l=Br}return f=K_.bind(null,i),l=Ot(l,f),i.callbackPriority=s,i.callbackNode=l,s}return f!==null&&f!==null&&ot(f),i.callbackPriority=2,i.callbackNode=null,2}function K_(i,s){if(zr!==0&&zr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(b0()&&i.callbackNode!==l)return null;var f=Et;return f=Ki(i,i===qt?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(R_(i,f,s),X_(i,Pe()),i.callbackNode!=null&&i.callbackNode===l?K_.bind(null,i):null)}function $_(i,s){if(b0())return null;R_(i,s,!0)}function Gb(){ek(function(){(Mt&6)!==0?Ot(Ir,zb):q_()})}function ap(){return Ao===0&&(Ao=Yi()),Ao}function Y_(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Jo(""+i)}function W_(i,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,i.id&&l.setAttribute("form",i.id),s.parentNode.insertBefore(l,s),i=new FormData(i),l.parentNode.removeChild(l),i}function qb(i,s,l,f,p){if(s==="submit"&&l&&l.stateNode===p){var v=Y_((p[Yt]||null).action),k=f.submitter;k&&(s=(s=k[Yt]||null)?Y_(s.formAction):k.getAttribute("formAction"),s!==null&&(v=s,k=null));var P=new el("action","action",null,f,p);i.push({event:P,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ao!==0){var Z=k?W_(p,k):new FormData(p);Am(l,{pending:!0,data:Z,method:p.method,action:v},null,Z)}}else typeof v=="function"&&(P.preventDefault(),Z=k?W_(p,k):new FormData(p),Am(l,{pending:!0,data:Z,method:p.method,action:v},v,Z))},currentTarget:p}]})}}for(var ip=0;ip<zd.length;ip++){var sp=zd[ip],Xb=sp.toLowerCase(),Kb=sp[0].toUpperCase()+sp.slice(1);xa(Xb,"on"+Kb)}xa(Rv,"onAnimationEnd"),xa(Iv,"onAnimationIteration"),xa(Nv,"onAnimationStart"),xa("dblclick","onDoubleClick"),xa("focusin","onFocus"),xa("focusout","onBlur"),xa(ub,"onTransitionRun"),xa(fb,"onTransitionStart"),xa(hb,"onTransitionCancel"),xa(Dv,"onTransitionEnd"),Me("onMouseEnter",["mouseout","mouseover"]),Me("onMouseLeave",["mouseout","mouseover"]),Me("onPointerEnter",["pointerout","pointerover"]),Me("onPointerLeave",["pointerout","pointerover"]),ke("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ke("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ke("onBeforeInput",["compositionend","keypress","textInput","paste"]),ke("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ke("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ke("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$b=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ou));function Q_(i,s){s=(s&4)!==0;for(var l=0;l<i.length;l++){var f=i[l],p=f.event;f=f.listeners;e:{var v=void 0;if(s)for(var k=f.length-1;0<=k;k--){var P=f[k],Z=P.instance,he=P.currentTarget;if(P=P.listener,Z!==v&&p.isPropagationStopped())break e;v=P,p.currentTarget=he;try{v(p)}catch(Te){p0(Te)}p.currentTarget=null,v=Z}else for(k=0;k<f.length;k++){if(P=f[k],Z=P.instance,he=P.currentTarget,P=P.listener,Z!==v&&p.isPropagationStopped())break e;v=P,p.currentTarget=he;try{v(p)}catch(Te){p0(Te)}p.currentTarget=null,v=Z}}}}function ht(i,s){var l=s[Qs];l===void 0&&(l=s[Qs]=new Set);var f=i+"__bubble";l.has(f)||(Z_(s,i,2,!1),l.add(f))}function op(i,s,l){var f=0;s&&(f|=4),Z_(l,i,f,s)}var R0="_reactListening"+Math.random().toString(36).slice(2);function lp(i){if(!i[R0]){i[R0]=!0,de.forEach(function(l){l!=="selectionchange"&&($b.has(l)||op(l,!1,i),op(l,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[R0]||(s[R0]=!0,op("selectionchange",!1,s))}}function Z_(i,s,l,f){switch(Ty(s)){case 2:var p=Ek;break;case 8:p=Tk;break;default:p=Tp}l=p.bind(null,s,l,i),p=void 0,!Jn||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),f?p!==void 0?i.addEventListener(s,l,{capture:!0,passive:p}):i.addEventListener(s,l,!0):p!==void 0?i.addEventListener(s,l,{passive:p}):i.addEventListener(s,l,!1)}function cp(i,s,l,f,p){var v=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var k=f.tag;if(k===3||k===4){var P=f.stateNode.containerInfo;if(P===p)break;if(k===4)for(k=f.return;k!==null;){var Z=k.tag;if((Z===3||Z===4)&&k.stateNode.containerInfo===p)return;k=k.return}for(;P!==null;){if(k=G(P),k===null)return;if(Z=k.tag,Z===5||Z===6||Z===26||Z===27){f=v=k;continue e}P=P.parentNode}}f=f.return}Nf(function(){var he=v,Te=Zn(l),Ae=[];e:{var ge=Ov.get(i);if(ge!==void 0){var xe=el,We=i;switch(i){case"keypress":if(Ua(l)===0)break e;case"keydown":case"keyup":xe=sl;break;case"focusin":We="focus",xe=nl;break;case"focusout":We="blur",xe=nl;break;case"beforeblur":case"afterblur":xe=nl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=ea;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=Md;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=Uf;break;case Rv:case Iv:case Nv:xe=al;break;case Dv:xe=jf;break;case"scroll":case"scrollend":xe=Df;break;case"wheel":xe=ol;break;case"copy":case"cut":case"paste":xe=il;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Nc;break;case"toggle":case"beforetoggle":xe=zf}var Xe=(s&4)!==0,Bt=!Xe&&(i==="scroll"||i==="scrollend"),ie=Xe?ge!==null?ge+"Capture":null:ge;Xe=[];for(var ne=he,ce;ne!==null;){var we=ne;if(ce=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||ce===null||ie===null||(we=ro(ne,ie),we!=null&&Xe.push(lu(ne,we,ce))),Bt)break;ne=ne.return}0<Xe.length&&(ge=new xe(ge,We,null,l,Te),Ae.push({event:ge,listeners:Xe}))}}if((s&7)===0){e:{if(ge=i==="mouseover"||i==="pointerover",xe=i==="mouseout"||i==="pointerout",ge&&l!==fi&&(We=l.relatedTarget||l.fromElement)&&(G(We)||We[Cn]))break e;if((xe||ge)&&(ge=Te.window===Te?Te:(ge=Te.ownerDocument)?ge.defaultView||ge.parentWindow:window,xe?(We=l.relatedTarget||l.toElement,xe=he,We=We?G(We):null,We!==null&&(Bt=o(We),Xe=We.tag,We!==Bt||Xe!==5&&Xe!==27&&Xe!==6)&&(We=null)):(xe=null,We=he),xe!==We)){if(Xe=ea,we="onMouseLeave",ie="onMouseEnter",ne="mouse",(i==="pointerout"||i==="pointerover")&&(Xe=Nc,we="onPointerLeave",ie="onPointerEnter",ne="pointer"),Bt=xe==null?ge:fe(xe),ce=We==null?ge:fe(We),ge=new Xe(we,ne+"leave",xe,l,Te),ge.target=Bt,ge.relatedTarget=ce,we=null,G(Te)===he&&(Xe=new Xe(ie,ne+"enter",We,l,Te),Xe.target=ce,Xe.relatedTarget=Bt,we=Xe),Bt=we,xe&&We)t:{for(Xe=xe,ie=We,ne=0,ce=Xe;ce;ce=Dl(ce))ne++;for(ce=0,we=ie;we;we=Dl(we))ce++;for(;0<ne-ce;)Xe=Dl(Xe),ne--;for(;0<ce-ne;)ie=Dl(ie),ce--;for(;ne--;){if(Xe===ie||ie!==null&&Xe===ie.alternate)break t;Xe=Dl(Xe),ie=Dl(ie)}Xe=null}else Xe=null;xe!==null&&J_(Ae,ge,xe,Xe,!1),We!==null&&Bt!==null&&J_(Ae,Bt,We,Xe,!0)}}e:{if(ge=he?fe(he):window,xe=ge.nodeName&&ge.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ge.type==="file")var He=xv;else if(Er(ge))if(_v)He=ob;else{He=ib;var ut=ab}else xe=ge.nodeName,!xe||xe.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?he&&Ac(he.elementType)&&(He=xv):He=sb;if(He&&(He=He(i,he))){gi(Ae,He,l,Te);break e}ut&&ut(i,ge,he),i==="focusout"&&he&&ge.type==="number"&&he.memoizedProps.value!=null&&Zi(ge,"number",ge.value)}switch(ut=he?fe(he):window,i){case"focusin":(Er(ut)||ut.contentEditable==="true")&&(ll=ut,Bd=he,Fc=null);break;case"focusout":Fc=Bd=ll=null;break;case"mousedown":jd=!0;break;case"contextmenu":case"mouseup":case"dragend":jd=!1,kv(Ae,l,Te);break;case"selectionchange":if(cb)break;case"keydown":case"keyup":kv(Ae,l,Te)}var Ge;if(Ha)e:{switch(i){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else _t?Ee(i,l)&&(Ke="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Ke="onCompositionStart");Ke&&(S&&l.locale!=="ko"&&(_t||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&_t&&(Ge=bc()):(Va=Te,Ji="value"in Va?Va.value:Va.textContent,_t=!0)),ut=I0(he,Ke),0<ut.length&&(Ke=new Rc(Ke,i,null,l,Te),Ae.push({event:Ke,listeners:ut}),Ge?Ke.data=Ge:(Ge=Ve(l),Ge!==null&&(Ke.data=Ge)))),(Ge=E?yr(i,l):yt(i,l))&&(Ke=I0(he,"onBeforeInput"),0<Ke.length&&(ut=new Rc("onBeforeInput","beforeinput",null,l,Te),Ae.push({event:ut,listeners:Ke}),ut.data=Ge)),qb(Ae,i,he,l,Te)}Q_(Ae,s)})}function lu(i,s,l){return{instance:i,listener:s,currentTarget:l}}function I0(i,s){for(var l=s+"Capture",f=[];i!==null;){var p=i,v=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||v===null||(p=ro(i,l),p!=null&&f.unshift(lu(i,p,v)),p=ro(i,s),p!=null&&f.push(lu(i,p,v))),i.tag===3)return f;i=i.return}return[]}function Dl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function J_(i,s,l,f,p){for(var v=s._reactName,k=[];l!==null&&l!==f;){var P=l,Z=P.alternate,he=P.stateNode;if(P=P.tag,Z!==null&&Z===f)break;P!==5&&P!==26&&P!==27||he===null||(Z=he,p?(he=ro(l,v),he!=null&&k.unshift(lu(l,he,Z))):p||(he=ro(l,v),he!=null&&k.push(lu(l,he,Z)))),l=l.return}k.length!==0&&i.push({event:s,listeners:k})}var Yb=/\r\n?/g,Wb=/\u0000|\uFFFD/g;function ey(i){return(typeof i=="string"?i:""+i).replace(Yb,`
`).replace(Wb,"")}function ty(i,s){return s=ey(s),ey(i)===s}function N0(){}function Ut(i,s,l,f,p,v){switch(l){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Qn(i,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Qn(i,""+f);break;case"className":vt(i,"class",f);break;case"tabIndex":vt(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":vt(i,l,f);break;case"style":wc(i,f,v);break;case"data":if(s!=="object"){vt(i,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||l!=="href")){i.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(l);break}f=Jo(""+f),i.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(s!=="input"&&Ut(i,s,"name",p.name,p,null),Ut(i,s,"formEncType",p.formEncType,p,null),Ut(i,s,"formMethod",p.formMethod,p,null),Ut(i,s,"formTarget",p.formTarget,p,null)):(Ut(i,s,"encType",p.encType,p,null),Ut(i,s,"method",p.method,p,null),Ut(i,s,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(l);break}f=Jo(""+f),i.setAttribute(l,f);break;case"onClick":f!=null&&(i.onclick=N0);break;case"onScroll":f!=null&&ht("scroll",i);break;case"onScrollEnd":f!=null&&ht("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}l=Jo(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(l,""+f):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":f===!0?i.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(l,f):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(l,f):i.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(l):i.setAttribute(l,f);break;case"popover":ht("beforetoggle",i),ht("toggle",i),kt(i,"popover",f);break;case"xlinkActuate":xt(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":xt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":xt(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":xt(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":xt(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":xt(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":xt(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":xt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":xt(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":kt(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Od.get(l)||l,kt(i,l,f))}}function up(i,s,l,f,p,v){switch(l){case"style":wc(i,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"children":typeof f=="string"?Qn(i,f):(typeof f=="number"||typeof f=="bigint")&&Qn(i,""+f);break;case"onScroll":f!=null&&ht("scroll",i);break;case"onScrollEnd":f!=null&&ht("scrollend",i);break;case"onClick":f!=null&&(i.onclick=N0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pe.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),s=l.slice(2,p?l.length-7:void 0),v=i[Yt]||null,v=v!=null?v[l]:null,typeof v=="function"&&i.removeEventListener(s,v,p),typeof f=="function")){typeof v!="function"&&v!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(s,f,p);break e}l in i?i[l]=f:f===!0?i.setAttribute(l,""):kt(i,l,f)}}}function Gr(i,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",i),ht("load",i);var f=!1,p=!1,v;for(v in l)if(l.hasOwnProperty(v)){var k=l[v];if(k!=null)switch(v){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ut(i,s,v,k,l,null)}}p&&Ut(i,s,"srcSet",l.srcSet,l,null),f&&Ut(i,s,"src",l.src,l,null);return;case"input":ht("invalid",i);var P=v=k=p=null,Z=null,he=null;for(f in l)if(l.hasOwnProperty(f)){var Te=l[f];if(Te!=null)switch(f){case"name":p=Te;break;case"type":k=Te;break;case"checked":Z=Te;break;case"defaultChecked":he=Te;break;case"value":v=Te;break;case"defaultValue":P=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,s));break;default:Ut(i,s,f,Te,l,null)}}Js(i,v,P,Z,he,k,p,!1),Zo(i);return;case"select":ht("invalid",i),f=k=v=null;for(p in l)if(l.hasOwnProperty(p)&&(P=l[p],P!=null))switch(p){case"value":v=P;break;case"defaultValue":k=P;break;case"multiple":f=P;default:Ut(i,s,p,P,l,null)}s=v,l=k,i.multiple=!!f,s!=null?ui(i,!!f,s,!1):l!=null&&ui(i,!!f,l,!0);return;case"textarea":ht("invalid",i),v=p=f=null;for(k in l)if(l.hasOwnProperty(k)&&(P=l[k],P!=null))switch(k){case"value":f=P;break;case"defaultValue":p=P;break;case"children":v=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(n(91));break;default:Ut(i,s,k,P,l,null)}eo(i,f,p,v),Zo(i);return;case"option":for(Z in l)if(l.hasOwnProperty(Z)&&(f=l[Z],f!=null))switch(Z){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ut(i,s,Z,f,l,null)}return;case"dialog":ht("beforetoggle",i),ht("toggle",i),ht("cancel",i),ht("close",i);break;case"iframe":case"object":ht("load",i);break;case"video":case"audio":for(f=0;f<ou.length;f++)ht(ou[f],i);break;case"image":ht("error",i),ht("load",i);break;case"details":ht("toggle",i);break;case"embed":case"source":case"link":ht("error",i),ht("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in l)if(l.hasOwnProperty(he)&&(f=l[he],f!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ut(i,s,he,f,l,null)}return;default:if(Ac(s)){for(Te in l)l.hasOwnProperty(Te)&&(f=l[Te],f!==void 0&&up(i,s,Te,f,l,void 0));return}}for(P in l)l.hasOwnProperty(P)&&(f=l[P],f!=null&&Ut(i,s,P,f,l,null))}function Qb(i,s,l,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,v=null,k=null,P=null,Z=null,he=null,Te=null;for(xe in l){var Ae=l[xe];if(l.hasOwnProperty(xe)&&Ae!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":Z=Ae;default:f.hasOwnProperty(xe)||Ut(i,s,xe,null,f,Ae)}}for(var ge in f){var xe=f[ge];if(Ae=l[ge],f.hasOwnProperty(ge)&&(xe!=null||Ae!=null))switch(ge){case"type":v=xe;break;case"name":p=xe;break;case"checked":he=xe;break;case"defaultChecked":Te=xe;break;case"value":k=xe;break;case"defaultValue":P=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(n(137,s));break;default:xe!==Ae&&Ut(i,s,ge,xe,f,Ae)}}Ln(i,k,P,Z,he,Te,v,p);return;case"select":xe=k=P=ge=null;for(v in l)if(Z=l[v],l.hasOwnProperty(v)&&Z!=null)switch(v){case"value":break;case"multiple":xe=Z;default:f.hasOwnProperty(v)||Ut(i,s,v,null,f,Z)}for(p in f)if(v=f[p],Z=l[p],f.hasOwnProperty(p)&&(v!=null||Z!=null))switch(p){case"value":ge=v;break;case"defaultValue":P=v;break;case"multiple":k=v;default:v!==Z&&Ut(i,s,p,v,f,Z)}s=P,l=k,f=xe,ge!=null?ui(i,!!l,ge,!1):!!f!=!!l&&(s!=null?ui(i,!!l,s,!0):ui(i,!!l,l?[]:"",!1));return;case"textarea":xe=ge=null;for(P in l)if(p=l[P],l.hasOwnProperty(P)&&p!=null&&!f.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:Ut(i,s,P,null,f,p)}for(k in f)if(p=f[k],v=l[k],f.hasOwnProperty(k)&&(p!=null||v!=null))switch(k){case"value":ge=p;break;case"defaultValue":xe=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==v&&Ut(i,s,k,p,f,v)}Lt(i,ge,xe);return;case"option":for(var We in l)if(ge=l[We],l.hasOwnProperty(We)&&ge!=null&&!f.hasOwnProperty(We))switch(We){case"selected":i.selected=!1;break;default:Ut(i,s,We,null,f,ge)}for(Z in f)if(ge=f[Z],xe=l[Z],f.hasOwnProperty(Z)&&ge!==xe&&(ge!=null||xe!=null))switch(Z){case"selected":i.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Ut(i,s,Z,ge,f,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in l)ge=l[Xe],l.hasOwnProperty(Xe)&&ge!=null&&!f.hasOwnProperty(Xe)&&Ut(i,s,Xe,null,f,ge);for(he in f)if(ge=f[he],xe=l[he],f.hasOwnProperty(he)&&ge!==xe&&(ge!=null||xe!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(n(137,s));break;default:Ut(i,s,he,ge,f,xe)}return;default:if(Ac(s)){for(var Bt in l)ge=l[Bt],l.hasOwnProperty(Bt)&&ge!==void 0&&!f.hasOwnProperty(Bt)&&up(i,s,Bt,void 0,f,ge);for(Te in f)ge=f[Te],xe=l[Te],!f.hasOwnProperty(Te)||ge===xe||ge===void 0&&xe===void 0||up(i,s,Te,ge,f,xe);return}}for(var ie in l)ge=l[ie],l.hasOwnProperty(ie)&&ge!=null&&!f.hasOwnProperty(ie)&&Ut(i,s,ie,null,f,ge);for(Ae in f)ge=f[Ae],xe=l[Ae],!f.hasOwnProperty(Ae)||ge===xe||ge==null&&xe==null||Ut(i,s,Ae,ge,f,xe)}var fp=null,hp=null;function D0(i){return i.nodeType===9?i:i.ownerDocument}function ry(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ny(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function dp(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var mp=null;function Zb(){var i=window.event;return i&&i.type==="popstate"?i===mp?!1:(mp=i,!0):(mp=null,!1)}var ay=typeof setTimeout=="function"?setTimeout:void 0,Jb=typeof clearTimeout=="function"?clearTimeout:void 0,iy=typeof Promise=="function"?Promise:void 0,ek=typeof queueMicrotask=="function"?queueMicrotask:typeof iy<"u"?function(i){return iy.resolve(null).then(i).catch(tk)}:ay;function tk(i){setTimeout(function(){throw i})}function ps(i){return i==="head"}function sy(i,s){var l=s,f=0,p=0;do{var v=l.nextSibling;if(i.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<f&&8>f){l=f;var k=i.ownerDocument;if(l&1&&cu(k.documentElement),l&2&&cu(k.body),l&4)for(l=k.head,cu(l),k=l.firstChild;k;){var P=k.nextSibling,Z=k.nodeName;k[H]||Z==="SCRIPT"||Z==="STYLE"||Z==="LINK"&&k.rel.toLowerCase()==="stylesheet"||l.removeChild(k),k=P}}if(p===0){i.removeChild(v),vu(s);return}p--}else l==="$"||l==="$?"||l==="$!"?p++:f=l.charCodeAt(0)-48;else f=0;l=v}while(l);vu(s)}function pp(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":pp(l),z(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function rk(i,s,l,f){for(;i.nodeType===1;){var p=l;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[H])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var v=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=ya(i.nextSibling),i===null)break}return null}function nk(i,s,l){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=ya(i.nextSibling),i===null))return null;return i}function gp(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function ak(i,s){var l=i.ownerDocument;if(i.data!=="$?"||l.readyState==="complete")s();else{var f=function(){s(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function ya(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var vp=null;function oy(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return i;s--}else l==="/$"&&s++}i=i.previousSibling}return null}function ly(i,s,l){switch(s=D0(l),i){case"html":if(i=s.documentElement,!i)throw Error(n(452));return i;case"head":if(i=s.head,!i)throw Error(n(453));return i;case"body":if(i=s.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function cu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);z(i)}var oa=new Map,cy=new Set;function O0(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ri=ue.d;ue.d={f:ik,r:sk,D:ok,C:lk,L:ck,m:uk,X:hk,S:fk,M:dk};function ik(){var i=Ri.f(),s=A0();return i||s}function sk(i){var s=X(i);s!==null&&s.tag===5&&s.type==="form"?Rx(s):Ri.r(i)}var Ol=typeof document>"u"?null:document;function uy(i,s,l){var f=Ol;if(f&&typeof s=="string"&&s){var p=hr(s);p='link[rel="'+i+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),cy.has(p)||(cy.add(p),i={rel:i,crossOrigin:l,href:s},f.querySelector(p)===null&&(s=f.createElement("link"),Gr(s,"link",i),se(s),f.head.appendChild(s)))}}function ok(i){Ri.D(i),uy("dns-prefetch",i,null)}function lk(i,s){Ri.C(i,s),uy("preconnect",i,s)}function ck(i,s,l){Ri.L(i,s,l);var f=Ol;if(f&&i&&s){var p='link[rel="preload"][as="'+hr(s)+'"]';s==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+hr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+hr(l.imageSizes)+'"]')):p+='[href="'+hr(i)+'"]';var v=p;switch(s){case"style":v=Fl(i);break;case"script":v=Ml(i)}oa.has(v)||(i=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:i,as:s},l),oa.set(v,i),f.querySelector(p)!==null||s==="style"&&f.querySelector(uu(v))||s==="script"&&f.querySelector(fu(v))||(s=f.createElement("link"),Gr(s,"link",i),se(s),f.head.appendChild(s)))}}function uk(i,s){Ri.m(i,s);var l=Ol;if(l&&i){var f=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+hr(f)+'"][href="'+hr(i)+'"]',v=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Ml(i)}if(!oa.has(v)&&(i=g({rel:"modulepreload",href:i},s),oa.set(v,i),l.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(fu(v)))return}f=l.createElement("link"),Gr(f,"link",i),se(f),l.head.appendChild(f)}}}function fk(i,s,l){Ri.S(i,s,l);var f=Ol;if(f&&i){var p=ye(f).hoistableStyles,v=Fl(i);s=s||"default";var k=p.get(v);if(!k){var P={loading:0,preload:null};if(k=f.querySelector(uu(v)))P.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":s},l),(l=oa.get(v))&&xp(i,l);var Z=k=f.createElement("link");se(Z),Gr(Z,"link",i),Z._p=new Promise(function(he,Te){Z.onload=he,Z.onerror=Te}),Z.addEventListener("load",function(){P.loading|=1}),Z.addEventListener("error",function(){P.loading|=2}),P.loading|=4,F0(k,s,f)}k={type:"stylesheet",instance:k,count:1,state:P},p.set(v,k)}}}function hk(i,s){Ri.X(i,s);var l=Ol;if(l&&i){var f=ye(l).hoistableScripts,p=Ml(i),v=f.get(p);v||(v=l.querySelector(fu(p)),v||(i=g({src:i,async:!0},s),(s=oa.get(p))&&_p(i,s),v=l.createElement("script"),se(v),Gr(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(p,v))}}function dk(i,s){Ri.M(i,s);var l=Ol;if(l&&i){var f=ye(l).hoistableScripts,p=Ml(i),v=f.get(p);v||(v=l.querySelector(fu(p)),v||(i=g({src:i,async:!0,type:"module"},s),(s=oa.get(p))&&_p(i,s),v=l.createElement("script"),se(v),Gr(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(p,v))}}function fy(i,s,l,f){var p=(p=me.current)?O0(p):null;if(!p)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=Fl(l.href),l=ye(p).hoistableStyles,f=l.get(s),f||(f={type:"style",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=Fl(l.href);var v=ye(p).hoistableStyles,k=v.get(i);if(k||(p=p.ownerDocument||p,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,k),(v=p.querySelector(uu(i)))&&!v._p&&(k.instance=v,k.state.loading=5),oa.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},oa.set(i,l),v||mk(p,i,l,k.state))),s&&f===null)throw Error(n(528,""));return k}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Ml(l),l=ye(p).hoistableScripts,f=l.get(s),f||(f={type:"script",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Fl(i){return'href="'+hr(i)+'"'}function uu(i){return'link[rel="stylesheet"]['+i+"]"}function hy(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function mk(i,s,l,f){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=i.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Gr(s,"link",l),se(s),i.head.appendChild(s))}function Ml(i){return'[src="'+hr(i)+'"]'}function fu(i){return"script[async]"+i}function dy(i,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var f=i.querySelector('style[data-href~="'+hr(l.href)+'"]');if(f)return s.instance=f,se(f),f;var p=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),se(f),Gr(f,"style",p),F0(f,l.precedence,i),s.instance=f;case"stylesheet":p=Fl(l.href);var v=i.querySelector(uu(p));if(v)return s.state.loading|=4,s.instance=v,se(v),v;f=hy(l),(p=oa.get(p))&&xp(f,p),v=(i.ownerDocument||i).createElement("link"),se(v);var k=v;return k._p=new Promise(function(P,Z){k.onload=P,k.onerror=Z}),Gr(v,"link",f),s.state.loading|=4,F0(v,l.precedence,i),s.instance=v;case"script":return v=Ml(l.src),(p=i.querySelector(fu(v)))?(s.instance=p,se(p),p):(f=l,(p=oa.get(v))&&(f=g({},l),_p(f,p)),i=i.ownerDocument||i,p=i.createElement("script"),se(p),Gr(p,"link",f),i.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,F0(f,l.precedence,i));return s.instance}function F0(i,s,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,v=p,k=0;k<f.length;k++){var P=f[k];if(P.dataset.precedence===s)v=P;else if(v!==p)break}v?v.parentNode.insertBefore(i,v.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(i,s.firstChild))}function xp(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function _p(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var M0=null;function my(i,s,l){if(M0===null){var f=new Map,p=M0=new Map;p.set(l,f)}else p=M0,f=p.get(l),f||(f=new Map,p.set(l,f));if(f.has(i))return f;for(f.set(i,null),l=l.getElementsByTagName(i),p=0;p<l.length;p++){var v=l[p];if(!(v[H]||v[sr]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var k=v.getAttribute(s)||"";k=i+k;var P=f.get(k);P?P.push(v):f.set(k,[v])}}return f}function py(i,s,l){i=i.ownerDocument||i,i.head.insertBefore(l,s==="title"?i.querySelector("head > title"):null)}function pk(i,s,l){if(l===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function gy(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var hu=null;function gk(){}function vk(i,s,l){if(hu===null)throw Error(n(475));var f=hu;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var p=Fl(l.href),v=i.querySelector(uu(p));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(f.count++,f=P0.bind(f),i.then(f,f)),s.state.loading|=4,s.instance=v,se(v);return}v=i.ownerDocument||i,l=hy(l),(p=oa.get(p))&&xp(l,p),v=v.createElement("link"),se(v);var k=v;k._p=new Promise(function(P,Z){k.onload=P,k.onerror=Z}),Gr(v,"link",l),s.instance=v}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(f.count++,s=P0.bind(f),i.addEventListener("load",s),i.addEventListener("error",s))}}function xk(){if(hu===null)throw Error(n(475));var i=hu;return i.stylesheets&&i.count===0&&yp(i,i.stylesheets),0<i.count?function(s){var l=setTimeout(function(){if(i.stylesheets&&yp(i,i.stylesheets),i.unsuspend){var f=i.unsuspend;i.unsuspend=null,f()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(l)}}:null}function P0(){if(this.count--,this.count===0){if(this.stylesheets)yp(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var L0=null;function yp(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,L0=new Map,s.forEach(_k,i),L0=null,P0.call(i))}function _k(i,s){if(!(s.state.loading&4)){var l=L0.get(i);if(l)var f=l.get(null);else{l=new Map,L0.set(i,l);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<p.length;v++){var k=p[v];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(l.set(k.dataset.precedence,k),f=k)}f&&l.set(null,f)}p=s.instance,k=p.getAttribute("data-precedence"),v=l.get(k)||f,v===f&&l.set(null,p),l.set(k,p),this.count++,f=P0.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),v?v.parentNode.insertBefore(p,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),s.state.loading|=4}}var du={$$typeof:R,Provider:null,Consumer:null,_currentValue:Le,_currentValue2:Le,_threadCount:0};function yk(i,s,l,f,p,v,k,P){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=pa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pa(0),this.hiddenUpdates=pa(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=v,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function vy(i,s,l,f,p,v,k,P,Z,he,Te,Ae){return i=new yk(i,s,l,k,P,Z,he,Ae),s=1,v===!0&&(s|=24),v=Un(3,null,null,s),i.current=v,v.stateNode=i,s=tm(),s.refCount++,i.pooledCache=s,s.refCount++,v.memoizedState={element:f,isDehydrated:l,cache:s},im(v),i}function xy(i){return i?(i=hl,i):hl}function _y(i,s,l,f,p,v){p=xy(p),f.context===null?f.context=p:f.pendingContext=p,f=rs(s),f.payload={element:l},v=v===void 0?null:v,v!==null&&(f.callback=v),l=ns(i,f,s),l!==null&&(Gn(l,i,s),zc(l,i,s))}function yy(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<s?l:s}}function Ep(i,s){yy(i,s),(i=i.alternate)&&yy(i,s)}function Ey(i){if(i.tag===13){var s=fl(i,67108864);s!==null&&Gn(s,i,67108864),Ep(i,67108864)}}var V0=!0;function Ek(i,s,l,f){var p=ae.T;ae.T=null;var v=ue.p;try{ue.p=2,Tp(i,s,l,f)}finally{ue.p=v,ae.T=p}}function Tk(i,s,l,f){var p=ae.T;ae.T=null;var v=ue.p;try{ue.p=8,Tp(i,s,l,f)}finally{ue.p=v,ae.T=p}}function Tp(i,s,l,f){if(V0){var p=wp(f);if(p===null)cp(i,s,f,U0,l),wy(i,f);else if(Ak(p,i,s,l,f))f.stopPropagation();else if(wy(i,f),s&4&&-1<wk.indexOf(i)){for(;p!==null;){var v=X(p);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var k=kn(v.pendingLanes);if(k!==0){var P=v;for(P.pendingLanes|=2,P.entangledLanes|=2;k;){var Z=1<<31-jt(k);P.entanglements[1]|=Z,k&=~Z}$a(v),(Mt&6)===0&&(T0=Pe()+500,su(0))}}break;case 13:P=fl(v,2),P!==null&&Gn(P,v,2),A0(),Ep(v,2)}if(v=wp(f),v===null&&cp(i,s,f,U0,l),v===p)break;p=v}p!==null&&f.stopPropagation()}else cp(i,s,f,null,l)}}function wp(i){return i=Zn(i),Ap(i)}var U0=null;function Ap(i){if(U0=null,i=G(i),i!==null){var s=o(i);if(s===null)i=null;else{var l=s.tag;if(l===13){if(i=c(s),i!==null)return i;i=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return U0=i,null}function Ty(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Kt()){case Ir:return 2;case Ur:return 8;case Br:case li:return 32;case dn:return 268435456;default:return 32}default:return 32}}var Sp=!1,gs=null,vs=null,xs=null,mu=new Map,pu=new Map,_s=[],wk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wy(i,s){switch(i){case"focusin":case"focusout":gs=null;break;case"dragenter":case"dragleave":vs=null;break;case"mouseover":case"mouseout":xs=null;break;case"pointerover":case"pointerout":mu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":pu.delete(s.pointerId)}}function gu(i,s,l,f,p,v){return i===null||i.nativeEvent!==v?(i={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[p]},s!==null&&(s=X(s),s!==null&&Ey(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),i)}function Ak(i,s,l,f,p){switch(s){case"focusin":return gs=gu(gs,i,s,l,f,p),!0;case"dragenter":return vs=gu(vs,i,s,l,f,p),!0;case"mouseover":return xs=gu(xs,i,s,l,f,p),!0;case"pointerover":var v=p.pointerId;return mu.set(v,gu(mu.get(v)||null,i,s,l,f,p)),!0;case"gotpointercapture":return v=p.pointerId,pu.set(v,gu(pu.get(v)||null,i,s,l,f,p)),!0}return!1}function Ay(i){var s=G(i.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){i.blockedOn=s,Wo(i.priority,function(){if(l.tag===13){var f=zn();f=Oa(f);var p=fl(l,f);p!==null&&Gn(p,l,f),Ep(l,f)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function B0(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var l=wp(i.nativeEvent);if(l===null){l=i.nativeEvent;var f=new l.constructor(l.type,l);fi=f,l.target.dispatchEvent(f),fi=null}else return s=X(l),s!==null&&Ey(s),i.blockedOn=l,!1;s.shift()}return!0}function Sy(i,s,l){B0(i)&&l.delete(s)}function Sk(){Sp=!1,gs!==null&&B0(gs)&&(gs=null),vs!==null&&B0(vs)&&(vs=null),xs!==null&&B0(xs)&&(xs=null),mu.forEach(Sy),pu.forEach(Sy)}function j0(i,s){i.blockedOn===s&&(i.blockedOn=null,Sp||(Sp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Sk)))}var H0=null;function by(i){H0!==i&&(H0=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){H0===i&&(H0=null);for(var s=0;s<i.length;s+=3){var l=i[s],f=i[s+1],p=i[s+2];if(typeof f!="function"){if(Ap(f||l)===null)continue;break}var v=X(l);v!==null&&(i.splice(s,3),s-=3,Am(v,{pending:!0,data:p,method:l.method,action:f},f,p))}}))}function vu(i){function s(Z){return j0(Z,i)}gs!==null&&j0(gs,i),vs!==null&&j0(vs,i),xs!==null&&j0(xs,i),mu.forEach(s),pu.forEach(s);for(var l=0;l<_s.length;l++){var f=_s[l];f.blockedOn===i&&(f.blockedOn=null)}for(;0<_s.length&&(l=_s[0],l.blockedOn===null);)Ay(l),l.blockedOn===null&&_s.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var p=l[f],v=l[f+1],k=p[Yt]||null;if(typeof v=="function")k||by(l);else if(k){var P=null;if(v&&v.hasAttribute("formAction")){if(p=v,k=v[Yt]||null)P=k.formAction;else if(Ap(p)!==null)continue}else P=k.action;typeof P=="function"?l[f+1]=P:(l.splice(f,3),f-=3),by(l)}}}function bp(i){this._internalRoot=i}z0.prototype.render=bp.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));var l=s.current,f=zn();_y(l,f,i,s,null,null)},z0.prototype.unmount=bp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;_y(i.current,2,null,i,null,null),A0(),s[Cn]=null}};function z0(i){this._internalRoot=i}z0.prototype.unstable_scheduleHydration=function(i){if(i){var s=Fa();i={blockedOn:null,target:i,priority:s};for(var l=0;l<_s.length&&s!==0&&s<_s[l].priority;l++);_s.splice(l,0,i),l===0&&Ay(i)}};var ky=e.version;if(ky!=="19.1.0")throw Error(n(527,ky,"19.1.0"));ue.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=h(s),i=i!==null?d(i):null,i=i===null?null:i.stateNode,i};var bk={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var G0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!G0.isDisabled&&G0.supportsFiber)try{Rt=G0.inject(bk),pt=G0}catch{}}return _u.createRoot=function(i,s){if(!a(i))throw Error(n(299));var l=!1,f="",p=zx,v=Gx,k=qx,P=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(v=s.onCaughtError),s.onRecoverableError!==void 0&&(k=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(P=s.unstable_transitionCallbacks)),s=vy(i,1,!1,null,null,l,f,p,v,k,P,null),i[Cn]=s.current,lp(i),new bp(s)},_u.hydrateRoot=function(i,s,l){if(!a(i))throw Error(n(299));var f=!1,p="",v=zx,k=Gx,P=qx,Z=null,he=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(k=l.onCaughtError),l.onRecoverableError!==void 0&&(P=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(Z=l.unstable_transitionCallbacks),l.formState!==void 0&&(he=l.formState)),s=vy(i,1,!0,s,l??null,f,p,v,k,P,Z,he),s.context=xy(null),l=s.current,f=zn(),f=Oa(f),p=rs(f),p.callback=null,ns(l,p,f),l=f,s.current.lanes=l,ga(s,l),$a(s),i[Cn]=s.current,lp(i),new z0(s)},_u.version="19.1.0",_u}var Ly;function Lk(){if(Ly)return Rp.exports;Ly=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Rp.exports=Pk(),Rp.exports}var Vk=Lk(),yu={},Vy;function Uk(){if(Vy)return yu;Vy=1,Object.defineProperty(yu,"__esModule",{value:!0}),yu.parse=c,yu.serialize=d;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const _=function(){};return _.prototype=Object.create(null),_})();function c(_,T){const y=new o,A=_.length;if(A<2)return y;const w=(T==null?void 0:T.decode)||g;let N=0;do{const U=_.indexOf("=",N);if(U===-1)break;const R=_.indexOf(";",N),K=R===-1?A:R;if(U>K){N=_.lastIndexOf(";",U-1)+1;continue}const te=u(_,N,U),J=h(_,U,te),b=_.slice(te,J);if(y[b]===void 0){let I=u(_,U+1,K),C=h(_,K,I);const V=w(_.slice(I,C));y[b]=V}N=K+1}while(N<A);return y}function u(_,T,y){do{const A=_.charCodeAt(T);if(A!==32&&A!==9)return T}while(++T<y);return y}function h(_,T,y){for(;T>y;){const A=_.charCodeAt(--T);if(A!==32&&A!==9)return T+1}return y}function d(_,T,y){const A=(y==null?void 0:y.encode)||encodeURIComponent;if(!t.test(_))throw new TypeError(`argument name is invalid: ${_}`);const w=A(T);if(!e.test(w))throw new TypeError(`argument val is invalid: ${T}`);let N=_+"="+w;if(!y)return N;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);N+="; Max-Age="+y.maxAge}if(y.domain){if(!r.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);N+="; Domain="+y.domain}if(y.path){if(!n.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);N+="; Path="+y.path}if(y.expires){if(!x(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);N+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(N+="; HttpOnly"),y.secure&&(N+="; Secure"),y.partitioned&&(N+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":N+="; Priority=Low";break;case"medium":N+="; Priority=Medium";break;case"high":N+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":N+="; SameSite=Strict";break;case"lax":N+="; SameSite=Lax";break;case"none":N+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return N}function g(_){if(_.indexOf("%")===-1)return _;try{return decodeURIComponent(_)}catch{return _}}function x(_){return a.call(_)==="[object Date]"}return yu}Uk();var Uy="popstate";function Bk(t={}){function e(a,o){let{pathname:c="/",search:u="",hash:h=""}=jo(a.location.hash.substring(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),ag("",{pathname:c,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(a,o){let c=a.document.querySelector("base"),u="";if(c&&c.getAttribute("href")){let h=a.location.href,d=h.indexOf("#");u=d===-1?h:h.slice(0,d)}return u+"#"+(typeof o=="string"?o:Xu(o))}function n(a,o){ha(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return Hk(e,r,n,t)}function Jt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ha(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function jk(){return Math.random().toString(36).substring(2,10)}function By(t,e){return{usr:t.state,key:t.key,idx:e}}function ag(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?jo(e):e,state:r,key:e&&e.key||n||jk()}}function Xu({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function jo(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function Hk(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:o=!1}=n,c=a.history,u="POP",h=null,d=g();d==null&&(d=0,c.replaceState({...c.state,idx:d},""));function g(){return(c.state||{idx:null}).idx}function x(){u="POP";let w=g(),N=w==null?null:w-d;d=w,h&&h({action:u,location:A.location,delta:N})}function _(w,N){u="PUSH";let U=ag(A.location,w,N);r&&r(U,w),d=g()+1;let R=By(U,d),K=A.createHref(U);try{c.pushState(R,"",K)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;a.location.assign(K)}o&&h&&h({action:u,location:A.location,delta:1})}function T(w,N){u="REPLACE";let U=ag(A.location,w,N);r&&r(U,w),d=g();let R=By(U,d),K=A.createHref(U);c.replaceState(R,"",K),o&&h&&h({action:u,location:A.location,delta:0})}function y(w){let N=a.location.origin!=="null"?a.location.origin:a.location.href,U=typeof w=="string"?w:Xu(w);return U=U.replace(/ $/,"%20"),Jt(N,`No window.location.(origin|href) available to create URL for href: ${U}`),new URL(U,N)}let A={get action(){return u},get location(){return t(a,c)},listen(w){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(Uy,x),h=w,()=>{a.removeEventListener(Uy,x),h=null}},createHref(w){return e(a,w)},createURL:y,encodeLocation(w){let N=y(w);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:_,replace:T,go(w){return c.go(w)}};return A}function AT(t,e,r="/"){return zk(t,e,r,!1)}function zk(t,e,r,n){let a=typeof e=="string"?jo(e):e,o=Ui(a.pathname||"/",r);if(o==null)return null;let c=ST(t);Gk(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let d=tC(o);u=Jk(c[h],d,n)}return u}function ST(t,e=[],r=[],n=""){let a=(o,c,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(Jt(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length));let d=Mi([n,h.relativePath]),g=r.concat(h);o.children&&o.children.length>0&&(Jt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),ST(o.children,e,g,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:Qk(d,o.index),routesMeta:g})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))a(o,c);else for(let h of bT(o.path))a(o,c,h)}),e}function bT(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let c=bT(n.join("/")),u=[];return u.push(...c.map(h=>h===""?o:[o,h].join("/"))),a&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function Gk(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Zk(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var qk=/^:[\w-]+$/,Xk=3,Kk=2,$k=1,Yk=10,Wk=-2,jy=t=>t==="*";function Qk(t,e){let r=t.split("/"),n=r.length;return r.some(jy)&&(n+=Wk),e&&(n+=Kk),r.filter(a=>!jy(a)).reduce((a,o)=>a+(qk.test(o)?Xk:o===""?$k:Yk),n)}function Zk(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function Jk(t,e,r=!1){let{routesMeta:n}=t,a={},o="/",c=[];for(let u=0;u<n.length;++u){let h=n[u],d=u===n.length-1,g=o==="/"?e:e.slice(o.length)||"/",x=Eh({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},g),_=h.route;if(!x&&d&&r&&!n[n.length-1].route.index&&(x=Eh({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},g)),!x)return null;Object.assign(a,x.params),c.push({params:a,pathname:Mi([o,x.pathname]),pathnameBase:iC(Mi([o,x.pathnameBase])),route:_}),x.pathnameBase!=="/"&&(o=Mi([o,x.pathnameBase]))}return c}function Eh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=eC(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((d,{paramName:g,isOptional:x},_)=>{if(g==="*"){let y=u[_]||"";c=o.slice(0,o.length-y.length).replace(/(.)\/+$/,"$1")}const T=u[_];return x&&!T?d[g]=void 0:d[g]=(T||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:c,pattern:t}}function eC(t,e=!1,r=!0){ha(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function tC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ha(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ui(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function rC(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?jo(t):t;return{pathname:r?r.startsWith("/")?r:nC(r,e):e,search:sC(n),hash:oC(a)}}function nC(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Op(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function aC(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function qg(t){let e=aC(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function Xg(t,e,r,n=!1){let a;typeof t=="string"?a=jo(t):(a={...t},Jt(!a.pathname||!a.pathname.includes("?"),Op("?","pathname","search",a)),Jt(!a.pathname||!a.pathname.includes("#"),Op("#","pathname","hash",a)),Jt(!a.search||!a.search.includes("#"),Op("#","search","hash",a)));let o=t===""||a.pathname==="",c=o?"/":a.pathname,u;if(c==null)u=r;else{let x=e.length-1;if(!n&&c.startsWith("..")){let _=c.split("/");for(;_[0]==="..";)_.shift(),x-=1;a.pathname=_.join("/")}u=x>=0?e[x]:"/"}let h=rC(a,u),d=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(d||g)&&(h.pathname+="/"),h}var Mi=t=>t.join("/").replace(/\/\/+/g,"/"),iC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),sC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,oC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function lC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var kT=["POST","PUT","PATCH","DELETE"];new Set(kT);var cC=["GET",...kT];new Set(cC);var oc=_e.createContext(null);oc.displayName="DataRouter";var td=_e.createContext(null);td.displayName="DataRouterState";var CT=_e.createContext({isTransitioning:!1});CT.displayName="ViewTransition";var uC=_e.createContext(new Map);uC.displayName="Fetchers";var fC=_e.createContext(null);fC.displayName="Await";var Na=_e.createContext(null);Na.displayName="Navigation";var uf=_e.createContext(null);uf.displayName="Location";var ii=_e.createContext({outlet:null,matches:[],isDataRoute:!1});ii.displayName="Route";var Kg=_e.createContext(null);Kg.displayName="RouteError";function hC(t,{relative:e}={}){Jt(lc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=_e.useContext(Na),{hash:a,pathname:o,search:c}=hf(t,{relative:e}),u=o;return r!=="/"&&(u=o==="/"?r:Mi([r,o])),n.createHref({pathname:u,search:c,hash:a})}function lc(){return _e.useContext(uf)!=null}function Xs(){return Jt(lc(),"useLocation() may be used only in the context of a <Router> component."),_e.useContext(uf).location}var RT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function IT(t){_e.useContext(Na).static||_e.useLayoutEffect(t)}function ff(){let{isDataRoute:t}=_e.useContext(ii);return t?SC():dC()}function dC(){Jt(lc(),"useNavigate() may be used only in the context of a <Router> component.");let t=_e.useContext(oc),{basename:e,navigator:r}=_e.useContext(Na),{matches:n}=_e.useContext(ii),{pathname:a}=Xs(),o=JSON.stringify(qg(n)),c=_e.useRef(!1);return IT(()=>{c.current=!0}),_e.useCallback((h,d={})=>{if(ha(c.current,RT),!c.current)return;if(typeof h=="number"){r.go(h);return}let g=Xg(h,JSON.parse(o),a,d.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Mi([e,g.pathname])),(d.replace?r.replace:r.push)(g,d.state,d)},[e,r,o,a,t])}_e.createContext(null);function hf(t,{relative:e}={}){let{matches:r}=_e.useContext(ii),{pathname:n}=Xs(),a=JSON.stringify(qg(r));return _e.useMemo(()=>Xg(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function mC(t,e){return NT(t,e)}function NT(t,e,r,n){var U;Jt(lc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=_e.useContext(Na),{matches:c}=_e.useContext(ii),u=c[c.length-1],h=u?u.params:{},d=u?u.pathname:"/",g=u?u.pathnameBase:"/",x=u&&u.route;{let R=x&&x.path||"";DT(d,!x||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let _=Xs(),T;if(e){let R=typeof e=="string"?jo(e):e;Jt(g==="/"||((U=R.pathname)==null?void 0:U.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${R.pathname}" was given in the \`location\` prop.`),T=R}else T=_;let y=T.pathname||"/",A=y;if(g!=="/"){let R=g.replace(/^\//,"").split("/");A="/"+y.replace(/^\//,"").split("/").slice(R.length).join("/")}let w=!o&&r&&r.matches&&r.matches.length>0?r.matches:AT(t,{pathname:A});ha(x||w!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),ha(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=_C(w&&w.map(R=>Object.assign({},R,{params:Object.assign({},h,R.params),pathname:Mi([g,a.encodeLocation?a.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?g:Mi([g,a.encodeLocation?a.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),c,r,n);return e&&N?_e.createElement(uf.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},N):N}function pC(){let t=AC(),e=lC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=_e.createElement(_e.Fragment,null,_e.createElement("p",null," Hey developer "),_e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_e.createElement("code",{style:o},"ErrorBoundary")," or"," ",_e.createElement("code",{style:o},"errorElement")," prop on your route.")),_e.createElement(_e.Fragment,null,_e.createElement("h2",null,"Unexpected Application Error!"),_e.createElement("h3",{style:{fontStyle:"italic"}},e),r?_e.createElement("pre",{style:a},r):null,c)}var gC=_e.createElement(pC,null),vC=class extends _e.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?_e.createElement(ii.Provider,{value:this.props.routeContext},_e.createElement(Kg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xC({routeContext:t,match:e,children:r}){let n=_e.useContext(oc);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),_e.createElement(ii.Provider,{value:t},r)}function _C(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=r==null?void 0:r.errors;if(o!=null){let h=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);Jt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(r)for(let h=0;h<a.length;h++){let d=a[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:g,errors:x}=r,_=d.route.loader&&!g.hasOwnProperty(d.route.id)&&(!x||x[d.route.id]===void 0);if(d.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,d,g)=>{let x,_=!1,T=null,y=null;r&&(x=o&&d.route.id?o[d.route.id]:void 0,T=d.route.errorElement||gC,c&&(u<0&&g===0?(DT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,y=null):u===g&&(_=!0,y=d.route.hydrateFallbackElement||null)));let A=e.concat(a.slice(0,g+1)),w=()=>{let N;return x?N=T:_?N=y:d.route.Component?N=_e.createElement(d.route.Component,null):d.route.element?N=d.route.element:N=h,_e.createElement(xC,{match:d,routeContext:{outlet:h,matches:A,isDataRoute:r!=null},children:N})};return r&&(d.route.ErrorBoundary||d.route.errorElement||g===0)?_e.createElement(vC,{location:r.location,revalidation:r.revalidation,component:T,error:x,children:w(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):w()},null)}function $g(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yC(t){let e=_e.useContext(oc);return Jt(e,$g(t)),e}function EC(t){let e=_e.useContext(td);return Jt(e,$g(t)),e}function TC(t){let e=_e.useContext(ii);return Jt(e,$g(t)),e}function Yg(t){let e=TC(t),r=e.matches[e.matches.length-1];return Jt(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function wC(){return Yg("useRouteId")}function AC(){var n;let t=_e.useContext(Kg),e=EC("useRouteError"),r=Yg("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function SC(){let{router:t}=yC("useNavigate"),e=Yg("useNavigate"),r=_e.useRef(!1);return IT(()=>{r.current=!0}),_e.useCallback(async(a,o={})=>{ha(r.current,RT),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...o}))},[t,e])}var Hy={};function DT(t,e,r){!e&&!Hy[t]&&(Hy[t]=!0,ha(!1,r))}_e.memo(bC);function bC({routes:t,future:e,state:r}){return NT(t,void 0,r,e)}function ig({to:t,replace:e,state:r,relative:n}){Jt(lc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=_e.useContext(Na);ha(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=_e.useContext(ii),{pathname:c}=Xs(),u=ff(),h=Xg(t,qg(o),c,n==="path"),d=JSON.stringify(h);return _e.useEffect(()=>{u(JSON.parse(d),{replace:e,state:r,relative:n})},[u,d,n,e,r]),null}function ws(t){Jt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function kC({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:o=!1}){Jt(!lc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=_e.useMemo(()=>({basename:c,navigator:a,static:o,future:{}}),[c,a,o]);typeof r=="string"&&(r=jo(r));let{pathname:h="/",search:d="",hash:g="",state:x=null,key:_="default"}=r,T=_e.useMemo(()=>{let y=Ui(h,c);return y==null?null:{location:{pathname:y,search:d,hash:g,state:x,key:_},navigationType:n}},[c,h,d,g,x,_,n]);return ha(T!=null,`<Router basename="${c}"> is not able to match the URL "${h}${d}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:_e.createElement(Na.Provider,{value:u},_e.createElement(uf.Provider,{children:e,value:T}))}function CC({children:t,location:e}){return mC(sg(t),e)}function sg(t,e=[]){let r=[];return _e.Children.forEach(t,(n,a)=>{if(!_e.isValidElement(n))return;let o=[...e,a];if(n.type===_e.Fragment){r.push.apply(r,sg(n.props.children,o));return}Jt(n.type===ws,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Jt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=sg(n.props.children,o)),r.push(c)}),r}var lh="get",ch="application/x-www-form-urlencoded";function rd(t){return t!=null&&typeof t.tagName=="string"}function RC(t){return rd(t)&&t.tagName.toLowerCase()==="button"}function IC(t){return rd(t)&&t.tagName.toLowerCase()==="form"}function NC(t){return rd(t)&&t.tagName.toLowerCase()==="input"}function DC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function OC(t,e){return t.button===0&&(!e||e==="_self")&&!DC(t)}var X0=null;function FC(){if(X0===null)try{new FormData(document.createElement("form"),0),X0=!1}catch{X0=!0}return X0}var MC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Fp(t){return t!=null&&!MC.has(t)?(ha(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ch}"`),null):t}function PC(t,e){let r,n,a,o,c;if(IC(t)){let u=t.getAttribute("action");n=u?Ui(u,e):null,r=t.getAttribute("method")||lh,a=Fp(t.getAttribute("enctype"))||ch,o=new FormData(t)}else if(RC(t)||NC(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||u.getAttribute("action");if(n=h?Ui(h,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||lh,a=Fp(t.getAttribute("formenctype"))||Fp(u.getAttribute("enctype"))||ch,o=new FormData(u,t),!FC()){let{name:d,type:g,value:x}=t;if(g==="image"){let _=d?`${d}.`:"";o.append(`${_}x`,"0"),o.append(`${_}y`,"0")}else d&&o.append(d,x)}}else{if(rd(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=lh,n=null,a=ch,c=t}return o&&a==="text/plain"&&(c=o,o=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:o,body:c}}function Wg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function LC(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function VC(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function UC(t,e,r){let n=await Promise.all(t.map(async a=>{let o=e.routes[a.route.id];if(o){let c=await LC(o,r);return c.links?c.links():[]}return[]}));return zC(n.flat(1).filter(VC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function zy(t,e,r,n,a,o){let c=(h,d)=>r[d]?h.route.id!==r[d].route.id:!0,u=(h,d)=>{var g;return r[d].pathname!==h.pathname||((g=r[d].route.path)==null?void 0:g.endsWith("*"))&&r[d].params["*"]!==h.params["*"]};return o==="assets"?e.filter((h,d)=>c(h,d)||u(h,d)):o==="data"?e.filter((h,d)=>{var x;let g=n.routes[h.route.id];if(!g||!g.hasLoader)return!1;if(c(h,d)||u(h,d))return!0;if(h.route.shouldRevalidate){let _=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((x=r[0])==null?void 0:x.params)||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function BC(t,e,{includeHydrateFallback:r}={}){return jC(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function jC(t){return[...new Set(t)]}function HC(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function zC(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let o=JSON.stringify(HC(a));return r.has(o)||(r.add(o),n.push({key:o,link:a})),n},[])}var GC=new Set([100,101,204,205]);function qC(t,e){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname="_root.data":e&&Ui(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function OT(){let t=_e.useContext(oc);return Wg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function XC(){let t=_e.useContext(td);return Wg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Qg=_e.createContext(void 0);Qg.displayName="FrameworkContext";function FT(){let t=_e.useContext(Qg);return Wg(t,"You must render this element inside a <HydratedRouter> element"),t}function KC(t,e){let r=_e.useContext(Qg),[n,a]=_e.useState(!1),[o,c]=_e.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:d,onMouseLeave:g,onTouchStart:x}=e,_=_e.useRef(null);_e.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let A=N=>{N.forEach(U=>{c(U.isIntersecting)})},w=new IntersectionObserver(A,{threshold:.5});return _.current&&w.observe(_.current),()=>{w.disconnect()}}},[t]),_e.useEffect(()=>{if(n){let A=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(A)}}},[n]);let T=()=>{a(!0)},y=()=>{a(!1),c(!1)};return r?t!=="intent"?[o,_,{}]:[o,_,{onFocus:Eu(u,T),onBlur:Eu(h,y),onMouseEnter:Eu(d,T),onMouseLeave:Eu(g,y),onTouchStart:Eu(x,T)}]:[!1,_,{}]}function Eu(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function $C({page:t,...e}){let{router:r}=OT(),n=_e.useMemo(()=>AT(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?_e.createElement(WC,{page:t,matches:n,...e}):null}function YC(t){let{manifest:e,routeModules:r}=FT(),[n,a]=_e.useState([]);return _e.useEffect(()=>{let o=!1;return UC(t,e,r).then(c=>{o||a(c)}),()=>{o=!0}},[t,e,r]),n}function WC({page:t,matches:e,...r}){let n=Xs(),{manifest:a,routeModules:o}=FT(),{basename:c}=OT(),{loaderData:u,matches:h}=XC(),d=_e.useMemo(()=>zy(t,e,h,a,n,"data"),[t,e,h,a,n]),g=_e.useMemo(()=>zy(t,e,h,a,n,"assets"),[t,e,h,a,n]),x=_e.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let y=new Set,A=!1;if(e.forEach(N=>{var R;let U=a.routes[N.route.id];!U||!U.hasLoader||(!d.some(K=>K.route.id===N.route.id)&&N.route.id in u&&((R=o[N.route.id])!=null&&R.shouldRevalidate)||U.hasClientLoader?A=!0:y.add(N.route.id))}),y.size===0)return[];let w=qC(t,c);return A&&y.size>0&&w.searchParams.set("_routes",e.filter(N=>y.has(N.route.id)).map(N=>N.route.id).join(",")),[w.pathname+w.search]},[c,u,n,a,d,e,t,o]),_=_e.useMemo(()=>BC(g,a),[g,a]),T=YC(g);return _e.createElement(_e.Fragment,null,x.map(y=>_e.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),_.map(y=>_e.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),T.map(({key:y,link:A})=>_e.createElement("link",{key:y,...A})))}function QC(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var MT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{MT&&(window.__reactRouterVersion="7.5.2")}catch{}function ZC({basename:t,children:e,window:r}){let n=_e.useRef();n.current==null&&(n.current=Bk({window:r,v5Compat:!0}));let a=n.current,[o,c]=_e.useState({action:a.action,location:a.location}),u=_e.useCallback(h=>{_e.startTransition(()=>c(h))},[c]);return _e.useLayoutEffect(()=>a.listen(u),[a,u]),_e.createElement(kC,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a})}var PT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Sa=_e.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:o,replace:c,state:u,target:h,to:d,preventScrollReset:g,viewTransition:x,..._},T){let{basename:y}=_e.useContext(Na),A=typeof d=="string"&&PT.test(d),w,N=!1;if(typeof d=="string"&&A&&(w=d,MT))try{let C=new URL(window.location.href),V=d.startsWith("//")?new URL(C.protocol+d):new URL(d),M=Ui(V.pathname,y);V.origin===C.origin&&M!=null?d=M+V.search+V.hash:N=!0}catch{ha(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let U=hC(d,{relative:a}),[R,K,te]=KC(n,_),J=rR(d,{replace:c,state:u,target:h,preventScrollReset:g,relative:a,viewTransition:x});function b(C){e&&e(C),C.defaultPrevented||J(C)}let I=_e.createElement("a",{..._,...te,href:w||U,onClick:N||o?e:b,ref:QC(T,K),target:h,"data-discover":!A&&r==="render"?"true":void 0});return R&&!A?_e.createElement(_e.Fragment,null,I,_e.createElement($C,{page:U})):I});Sa.displayName="Link";var JC=_e.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:o,to:c,viewTransition:u,children:h,...d},g){let x=hf(c,{relative:d.relative}),_=Xs(),T=_e.useContext(td),{navigator:y,basename:A}=_e.useContext(Na),w=T!=null&&oR(x)&&u===!0,N=y.encodeLocation?y.encodeLocation(x).pathname:x.pathname,U=_.pathname,R=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;r||(U=U.toLowerCase(),R=R?R.toLowerCase():null,N=N.toLowerCase()),R&&A&&(R=Ui(R,A)||R);const K=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let te=U===N||!a&&U.startsWith(N)&&U.charAt(K)==="/",J=R!=null&&(R===N||!a&&R.startsWith(N)&&R.charAt(N.length)==="/"),b={isActive:te,isPending:J,isTransitioning:w},I=te?e:void 0,C;typeof n=="function"?C=n(b):C=[n,te?"active":null,J?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let V=typeof o=="function"?o(b):o;return _e.createElement(Sa,{...d,"aria-current":I,className:C,ref:g,style:V,to:c,viewTransition:u},typeof h=="function"?h(b):h)});JC.displayName="NavLink";var eR=_e.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:o,method:c=lh,action:u,onSubmit:h,relative:d,preventScrollReset:g,viewTransition:x,..._},T)=>{let y=iR(),A=sR(u,{relative:d}),w=c.toLowerCase()==="get"?"get":"post",N=typeof u=="string"&&PT.test(u),U=R=>{if(h&&h(R),R.defaultPrevented)return;R.preventDefault();let K=R.nativeEvent.submitter,te=(K==null?void 0:K.getAttribute("formmethod"))||c;y(K||R.currentTarget,{fetcherKey:e,method:te,navigate:r,replace:a,state:o,relative:d,preventScrollReset:g,viewTransition:x})};return _e.createElement("form",{ref:T,method:w,action:A,onSubmit:n?h:U,..._,"data-discover":!N&&t==="render"?"true":void 0})});eR.displayName="Form";function tR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LT(t){let e=_e.useContext(oc);return Jt(e,tR(t)),e}function rR(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:o,viewTransition:c}={}){let u=ff(),h=Xs(),d=hf(t,{relative:o});return _e.useCallback(g=>{if(OC(g,e)){g.preventDefault();let x=r!==void 0?r:Xu(h)===Xu(d);u(t,{replace:x,state:n,preventScrollReset:a,relative:o,viewTransition:c})}},[h,u,d,r,n,e,t,a,o,c])}var nR=0,aR=()=>`__${String(++nR)}__`;function iR(){let{router:t}=LT("useSubmit"),{basename:e}=_e.useContext(Na),r=wC();return _e.useCallback(async(n,a={})=>{let{action:o,method:c,encType:u,formData:h,body:d}=PC(n,e);if(a.navigate===!1){let g=a.fetcherKey||aR();await t.fetch(g,r,a.action||o,{preventScrollReset:a.preventScrollReset,formData:h,body:d,formMethod:a.method||c,formEncType:a.encType||u,flushSync:a.flushSync})}else await t.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:h,body:d,formMethod:a.method||c,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function sR(t,{relative:e}={}){let{basename:r}=_e.useContext(Na),n=_e.useContext(ii);Jt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),o={...hf(t||".",{relative:e})},c=Xs();if(t==null){o.search=c.search;let u=new URLSearchParams(o.search),h=u.getAll("index");if(h.some(g=>g==="")){u.delete("index"),h.filter(x=>x).forEach(x=>u.append("index",x));let g=u.toString();o.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:Mi([r,o.pathname])),Xu(o)}function oR(t,e={}){let r=_e.useContext(CT);Jt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=LT("useViewTransitionState"),a=hf(t,{relative:e.relative});if(!r.isTransitioning)return!1;let o=Ui(r.currentLocation.pathname,n)||r.currentLocation.pathname,c=Ui(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Eh(a.pathname,c)!=null||Eh(a.pathname,o)!=null}new TextEncoder;[...GC];const Gy=t=>{let e;const r=new Set,n=(d,g)=>{const x=typeof d=="function"?d(e):d;if(!Object.is(x,e)){const _=e;e=g??(typeof x!="object"||x===null)?x:Object.assign({},e,x),r.forEach(T=>T(e,_))}},a=()=>e,u={setState:n,getState:a,getInitialState:()=>h,subscribe:d=>(r.add(d),()=>r.delete(d))},h=e=t(n,a,u);return u},lR=t=>t?Gy(t):Gy,cR=t=>t;function uR(t,e=cR){const r=q0.useSyncExternalStore(t.subscribe,q0.useCallback(()=>e(t.getState()),[t,e]),q0.useCallback(()=>e(t.getInitialState()),[t,e]));return q0.useDebugValue(r),r}const qy=t=>{const e=lR(t),r=n=>uR(e,n);return Object.assign(r,e),r},VT=t=>t?qy(t):qy,fR=()=>{};var Xy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},hR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],c=t[r++],u=t[r++],h=((a&7)<<18|(o&63)<<12|(c&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],c=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|c&63)}}return e.join("")},BT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],c=a+1<t.length,u=c?t[a+1]:0,h=a+2<t.length,d=h?t[a+2]:0,g=o>>2,x=(o&3)<<4|u>>4;let _=(u&15)<<2|d>>6,T=d&63;h||(T=64,c||(_=64)),n.push(r[g],r[x],r[_],r[T])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(UT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):hR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const x=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||u==null||d==null||x==null)throw new dR;const _=o<<2|u>>4;if(n.push(_),d!==64){const T=u<<4&240|d>>2;if(n.push(T),x!==64){const y=d<<6&192|x;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const mR=function(t){const e=UT(t);return BT.encodeByteArray(e,!0)},Th=function(t){return mR(t).replace(/\./g,"")},jT=function(t){try{return BT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR=()=>pR().__FIREBASE_DEFAULTS__,vR=()=>{if(typeof process>"u"||typeof Xy>"u")return;const t=Xy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},xR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&jT(t[1]);return e&&JSON.parse(e)},nd=()=>{try{return fR()||gR()||vR()||xR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},HT=t=>{var e,r;return(r=(e=nd())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},_R=t=>{const e=HT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},zT=()=>{var t;return(t=nd())===null||t===void 0?void 0:t.config},GT=t=>{var e;return(e=nd())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(t){return t.endsWith(".cloudworkstations.dev")}async function qT(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Th(JSON.stringify(r)),Th(JSON.stringify(c)),""].join(".")}const Nu={};function TR(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nu))Nu[e]?t.emulator.push(e):t.prod.push(e);return t}function wR(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Ky=!1;function XT(t,e){if(typeof window>"u"||typeof document>"u"||!cc(window.location.host)||Nu[t]===e||Nu[t]||Ky)return;Nu[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=TR().prod.length>0;function c(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function h(_,T){_.setAttribute("width","24"),_.setAttribute("id",T),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Ky=!0,c()},_}function g(_,T){_.setAttribute("id",T),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function x(){const _=wR(n),T=r("text"),y=document.getElementById(T)||document.createElement("span"),A=r("learnmore"),w=document.getElementById(A)||document.createElement("a"),N=r("preprendIcon"),U=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const R=_.element;u(R),g(w,A);const K=d();h(U,N),R.append(U,y,w,K),document.body.appendChild(R)}o?(y.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(un())}function SR(){var t;const e=(t=nd())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function CR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RR(){const t=un();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function IR(){return!SR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function NR(){try{return typeof indexedDB=="object"}catch{return!1}}function DR(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="FirebaseError";class qi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=OR,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,df.prototype.create)}}class df{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],c=o?FR(o,n):"Error",u=`${this.serviceName}: ${c} (${a}).`;return new qi(a,u,n)}}function FR(t,e){return t.replace(MR,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const MR=/\{\$([^}]+)}/g;function PR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Oo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const o=t[a],c=e[a];if($y(o)&&$y(c)){if(!Oo(o,c))return!1}else if(o!==c)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function $y(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function LR(t,e){const r=new VR(t,e);return r.subscribe.bind(r)}class VR{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");UR(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=Mp),a.error===void 0&&(a.error=Mp),a.complete===void 0&&(a.complete=Mp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UR(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Mp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t){return t&&t._delegate?t._delegate:t}class Fo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new yR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HR(e))try{this.getOrInitializeService({instanceIdentifier:So})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:a});n.resolve(o)}catch{}}}}clearInstance(e=So){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=So){return this.instances.has(e)}getOptions(e=So){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,c]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&c.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(a,o);const c=this.instances.get(a);return c&&e(c,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:jR(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=So){return this.component?this.component.multipleInstances?e:So:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function jR(t){return t===So?void 0:t}function HR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new BR(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(dt||(dt={}));const GR={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},qR=dt.INFO,XR={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},KR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=XR[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zg{constructor(e){this.name=e,this._logLevel=qR,this._logHandler=KR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...e),this._logHandler(this,dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...e),this._logHandler(this,dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...e),this._logHandler(this,dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...e),this._logHandler(this,dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...e),this._logHandler(this,dt.ERROR,...e)}}const $R=(t,e)=>e.some(r=>t instanceof r);let Yy,Wy;function YR(){return Yy||(Yy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WR(){return Wy||(Wy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const KT=new WeakMap,og=new WeakMap,$T=new WeakMap,Pp=new WeakMap,Jg=new WeakMap;function QR(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",c)},o=()=>{r(Ns(t.result)),a()},c=()=>{n(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",c)});return e.then(r=>{r instanceof IDBCursor&&KT.set(r,t)}).catch(()=>{}),Jg.set(e,t),e}function ZR(t){if(og.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",c),t.removeEventListener("abort",c)},o=()=>{r(),a()},c=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",c),t.addEventListener("abort",c)});og.set(t,e)}let lg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return og.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$T.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ns(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function JR(t){lg=t(lg)}function e3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Lp(this),e,...r);return $T.set(n,e.sort?e.sort():[e]),Ns(n)}:WR().includes(t)?function(...e){return t.apply(Lp(this),e),Ns(KT.get(this))}:function(...e){return Ns(t.apply(Lp(this),e))}}function t3(t){return typeof t=="function"?e3(t):(t instanceof IDBTransaction&&ZR(t),$R(t,YR())?new Proxy(t,lg):t)}function Ns(t){if(t instanceof IDBRequest)return QR(t);if(Pp.has(t))return Pp.get(t);const e=t3(t);return e!==t&&(Pp.set(t,e),Jg.set(e,t)),e}const Lp=t=>Jg.get(t);function r3(t,e,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const c=indexedDB.open(t,e),u=Ns(c);return n&&c.addEventListener("upgradeneeded",h=>{n(Ns(c.result),h.oldVersion,h.newVersion,Ns(c.transaction),h)}),r&&c.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const n3=["get","getKey","getAll","getAllKeys","count"],a3=["put","add","delete","clear"],Vp=new Map;function Qy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vp.get(e))return Vp.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=a3.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||n3.includes(r)))return;const o=async function(c,...u){const h=this.transaction(c,a?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&h.done]))[0]};return Vp.set(e,o),o}JR(t=>({...t,get:(e,r,n)=>Qy(e,r)||t.get(e,r,n),has:(e,r)=>!!Qy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(s3(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function s3(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cg="@firebase/app",Zy="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new Zg("@firebase/app"),o3="@firebase/app-compat",l3="@firebase/analytics-compat",c3="@firebase/analytics",u3="@firebase/app-check-compat",f3="@firebase/app-check",h3="@firebase/auth",d3="@firebase/auth-compat",m3="@firebase/database",p3="@firebase/data-connect",g3="@firebase/database-compat",v3="@firebase/functions",x3="@firebase/functions-compat",_3="@firebase/installations",y3="@firebase/installations-compat",E3="@firebase/messaging",T3="@firebase/messaging-compat",w3="@firebase/performance",A3="@firebase/performance-compat",S3="@firebase/remote-config",b3="@firebase/remote-config-compat",k3="@firebase/storage",C3="@firebase/storage-compat",R3="@firebase/firestore",I3="@firebase/ai",N3="@firebase/firestore-compat",D3="firebase",O3="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="[DEFAULT]",F3={[cg]:"fire-core",[o3]:"fire-core-compat",[c3]:"fire-analytics",[l3]:"fire-analytics-compat",[f3]:"fire-app-check",[u3]:"fire-app-check-compat",[h3]:"fire-auth",[d3]:"fire-auth-compat",[m3]:"fire-rtdb",[p3]:"fire-data-connect",[g3]:"fire-rtdb-compat",[v3]:"fire-fn",[x3]:"fire-fn-compat",[_3]:"fire-iid",[y3]:"fire-iid-compat",[E3]:"fire-fcm",[T3]:"fire-fcm-compat",[w3]:"fire-perf",[A3]:"fire-perf-compat",[S3]:"fire-rc",[b3]:"fire-rc-compat",[k3]:"fire-gcs",[C3]:"fire-gcs-compat",[R3]:"fire-fst",[N3]:"fire-fst-compat",[I3]:"fire-vertex","fire-js":"fire-js",[D3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=new Map,M3=new Map,fg=new Map;function Jy(t,e){try{t.container.addComponent(e)}catch(r){Bi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Wl(t){const e=t.name;if(fg.has(e))return Bi.debug(`There were multiple attempts to register component ${e}.`),!1;fg.set(e,t);for(const r of wh.values())Jy(r,t);for(const r of M3.values())Jy(r,t);return!0}function e1(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function wa(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ds=new df("app","Firebase",P3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Fo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ds.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uc=O3;function YT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ug,automaticDataCollectionEnabled:!0},e),a=n.name;if(typeof a!="string"||!a)throw Ds.create("bad-app-name",{appName:String(a)});if(r||(r=zT()),!r)throw Ds.create("no-options");const o=wh.get(a);if(o){if(Oo(r,o.options)&&Oo(n,o.config))return o;throw Ds.create("duplicate-app",{appName:a})}const c=new zR(a);for(const h of fg.values())c.addComponent(h);const u=new L3(r,n,c);return wh.set(a,u),u}function WT(t=ug){const e=wh.get(t);if(!e&&t===ug&&zT())return YT();if(!e)throw Ds.create("no-app",{appName:t});return e}function Os(t,e,r){var n;let a=(n=F3[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const o=a.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const u=[`Unable to register library "${a}" with version "${e}":`];o&&u.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&c&&u.push("and"),c&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bi.warn(u.join(" "));return}Wl(new Fo(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3="firebase-heartbeat-database",U3=1,Ku="firebase-heartbeat-store";let Up=null;function QT(){return Up||(Up=r3(V3,U3,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ku)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ds.create("idb-open",{originalErrorMessage:t.message})})),Up}async function B3(t){try{const r=(await QT()).transaction(Ku),n=await r.objectStore(Ku).get(ZT(t));return await r.done,n}catch(e){if(e instanceof qi)Bi.warn(e.message);else{const r=Ds.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bi.warn(r.message)}}}async function e2(t,e){try{const n=(await QT()).transaction(Ku,"readwrite");await n.objectStore(Ku).put(e,ZT(t)),await n.done}catch(r){if(r instanceof qi)Bi.warn(r.message);else{const n=Ds.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Bi.warn(n.message)}}}function ZT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3=1024,H3=30;class z3{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new q3(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=t2();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:a}),this._heartbeatsCache.heartbeats.length>H3){const c=X3(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Bi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=t2(),{heartbeatsToSend:n,unsentEntries:a}=G3(this._heartbeatsCache.heartbeats),o=Th(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return Bi.warn(r),""}}}function t2(){return new Date().toISOString().substring(0,10)}function G3(t,e=j3){const r=[];let n=t.slice();for(const a of t){const o=r.find(c=>c.agent===a.agent);if(o){if(o.dates.push(a.date),r2(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),r2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class q3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return NR()?DR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await B3(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return e2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return e2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function r2(t){return Th(JSON.stringify({version:2,heartbeats:t})).length}function X3(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K3(t){Wl(new Fo("platform-logger",e=>new i3(e),"PRIVATE")),Wl(new Fo("heartbeat",e=>new z3(e),"PRIVATE")),Os(cg,Zy,t),Os(cg,Zy,"esm2017"),Os("fire-js","")}K3("");function t1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function JT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $3=JT,ew=new df("auth","Firebase",JT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Zg("@firebase/auth");function Y3(t,...e){Ah.logLevel<=dt.WARN&&Ah.warn(`Auth (${uc}): ${t}`,...e)}function uh(t,...e){Ah.logLevel<=dt.ERROR&&Ah.error(`Auth (${uc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(t,...e){throw n1(t,...e)}function Ra(t,...e){return n1(t,...e)}function r1(t,e,r){const n=Object.assign(Object.assign({},$3()),{[e]:r});return new df("auth","Firebase",n).create(e,{appName:t.name})}function Io(t){return r1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function W3(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ti(t,"argument-error"),r1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function n1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return ew.create(t,...e)}function Ze(t,e,...r){if(!t)throw n1(e,...r)}function Di(t){const e="INTERNAL ASSERTION FAILED: "+t;throw uh(e),new Error(e)}function ji(t,e){t||Di(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Q3(){return n2()==="http:"||n2()==="https:"}function n2(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Q3()||kR()||"connection"in navigator)?navigator.onLine:!0}function J3(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,r){this.shortDelay=e,this.longDelay=r,ji(r>e,"Short delay should be less than long delay!"),this.isMobile=AR()||CR()}get(){return Z3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(t,e){ji(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rI=new pf(3e4,6e4);function i1(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function fc(t,e,r,n,a={}){return rw(t,a,async()=>{let o={},c={};n&&(e==="GET"?c=n:o={body:JSON.stringify(n)});const u=mf(Object.assign({key:t.config.apiKey},c)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:h},o);return bR()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&cc(t.emulatorConfig.host)&&(d.credentials="include"),tw.fetch()(await nw(t,t.config.apiHost,r,u),d)})}async function rw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},eI),e);try{const a=new aI(t),o=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw K0(t,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const u=o.ok?c.errorMessage:c.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw K0(t,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw K0(t,"email-already-in-use",c);if(h==="USER_DISABLED")throw K0(t,"user-disabled",c);const g=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw r1(t,g,d);ti(t,g)}}catch(a){if(a instanceof qi)throw a;ti(t,"network-request-failed",{message:String(a)})}}async function nI(t,e,r,n,a={}){const o=await fc(t,e,r,n,a);return"mfaPendingCredential"in o&&ti(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function nw(t,e,r,n){const a=`${e}${r}?${n}`,o=t,c=o.config.emulator?a1(t.config,a):`${t.config.apiScheme}://${a}`;return tI.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}class aI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Ra(this.auth,"network-request-failed")),rI.get())})}}function K0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Ra(t,e,n);return a.customData._tokenResponse=r,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iI(t,e){return fc(t,"POST","/v1/accounts:delete",e)}async function Sh(t,e){return fc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sI(t,e=!1){const r=Wr(t),n=await r.getIdToken(e),a=s1(n);Ze(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,c=o==null?void 0:o.sign_in_provider;return{claims:a,token:n,authTime:Du(Bp(a.auth_time)),issuedAtTime:Du(Bp(a.iat)),expirationTime:Du(Bp(a.exp)),signInProvider:c||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Bp(t){return Number(t)*1e3}function s1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return uh("JWT malformed, contained fewer than 3 sections"),null;try{const a=jT(r);return a?JSON.parse(a):(uh("Failed to decode base64 JWT payload"),null)}catch(a){return uh("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function a2(t){const e=s1(t);return Ze(e,"internal-error"),Ze(typeof e.exp<"u","internal-error"),Ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $u(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof qi&&oI(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function oI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Du(this.lastLoginAt),this.creationTime=Du(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bh(t){var e;const r=t.auth,n=await t.getIdToken(),a=await $u(t,Sh(r,{idToken:n}));Ze(a==null?void 0:a.users.length,r,"internal-error");const o=a.users[0];t._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?aw(o.providerUserInfo):[],u=uI(t.providerData,c),h=t.isAnonymous,d=!(t.email&&o.passwordHash)&&!(u!=null&&u.length),g=h?d:!1,x={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new dg(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(t,x)}async function cI(t){const e=Wr(t);await bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uI(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function aw(t){return t.map(e=>{var{providerId:r}=e,n=t1(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fI(t,e){const r=await rw(t,{},async()=>{const n=mf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,c=await nw(t,a,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&cc(t.emulatorConfig.host)&&(h.credentials="include"),tw.fetch()(c,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function hI(t,e){return fc(t,"POST","/v2/accounts:revokeToken",i1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ze(e.idToken,"internal-error"),Ze(typeof e.idToken<"u","internal-error"),Ze(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):a2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ze(e.length!==0,"internal-error");const r=a2(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:o}=await fI(e,r);this.updateTokensAndExpiration(n,a,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:o}=r,c=new zl;return n&&(Ze(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),a&&(Ze(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),o&&(Ze(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zl,this.toJSON())}_performRefresh(){return Di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(t,e){Ze(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ba{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,o=t1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new dg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await $u(this,this.stsTokenManager.getToken(this.auth,e));return Ze(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return sI(this,e)}reload(){return cI(this)}_assign(e){this!==e&&(Ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ba(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await bh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wa(this.auth.app))return Promise.reject(Io(this.auth));const e=await this.getIdToken();return await $u(this,iI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,o,c,u,h,d,g;const x=(n=r.displayName)!==null&&n!==void 0?n:void 0,_=(a=r.email)!==null&&a!==void 0?a:void 0,T=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,y=(c=r.photoURL)!==null&&c!==void 0?c:void 0,A=(u=r.tenantId)!==null&&u!==void 0?u:void 0,w=(h=r._redirectEventId)!==null&&h!==void 0?h:void 0,N=(d=r.createdAt)!==null&&d!==void 0?d:void 0,U=(g=r.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:R,emailVerified:K,isAnonymous:te,providerData:J,stsTokenManager:b}=r;Ze(R&&b,e,"internal-error");const I=zl.fromJSON(this.name,b);Ze(typeof R=="string",e,"internal-error"),Es(x,e.name),Es(_,e.name),Ze(typeof K=="boolean",e,"internal-error"),Ze(typeof te=="boolean",e,"internal-error"),Es(T,e.name),Es(y,e.name),Es(A,e.name),Es(w,e.name),Es(N,e.name),Es(U,e.name);const C=new ba({uid:R,auth:e,email:_,emailVerified:K,displayName:x,isAnonymous:te,photoURL:y,phoneNumber:T,tenantId:A,stsTokenManager:I,createdAt:N,lastLoginAt:U});return J&&Array.isArray(J)&&(C.providerData=J.map(V=>Object.assign({},V))),w&&(C._redirectEventId=w),C}static async _fromIdTokenResponse(e,r,n=!1){const a=new zl;a.updateFromServerResponse(r);const o=new ba({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await bh(o),o}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];Ze(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?aw(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(o!=null&&o.length),u=new zl;u.updateFromIdToken(n);const h=new ba({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:c}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new dg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=new Map;function Oi(t){ji(t instanceof Function,"Expected a class definition");let e=i2.get(t);return e?(ji(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,i2.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}iw.type="NONE";const s2=iw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fh(t,e,r){return`firebase:${t}:${e}:${r}`}class Gl{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:o}=this.auth;this.fullUserKey=fh(this.userKey,a.apiKey,o),this.fullPersistenceKey=fh("persistence",a.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Sh(this.auth,{idToken:e}).catch(()=>{});return r?ba._fromGetAccountInfoResponse(this.auth,r,e):null}return ba._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Gl(Oi(s2),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=a[0]||Oi(s2);const c=fh(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const g=await d._get(c);if(g){let x;if(typeof g=="string"){const _=await Sh(e,{idToken:g}).catch(()=>{});if(!_)break;x=await ba._fromGetAccountInfoResponse(e,_,g)}else x=ba._fromJSON(e,g);d!==o&&(u=x),o=d;break}}catch{}const h=a.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Gl(o,e,n):(o=h[0],u&&await o._set(c,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(c)}catch{}})),new Gl(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fw(e))return"Blackberry";if(hw(e))return"Webos";if(ow(e))return"Safari";if((e.includes("chrome/")||lw(e))&&!e.includes("edge/"))return"Chrome";if(uw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function sw(t=un()){return/firefox\//i.test(t)}function ow(t=un()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lw(t=un()){return/crios\//i.test(t)}function cw(t=un()){return/iemobile/i.test(t)}function uw(t=un()){return/android/i.test(t)}function fw(t=un()){return/blackberry/i.test(t)}function hw(t=un()){return/webos/i.test(t)}function o1(t=un()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function dI(t=un()){var e;return o1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function mI(){return RR()&&document.documentMode===10}function dw(t=un()){return o1(t)||uw(t)||hw(t)||fw(t)||/windows phone/i.test(t)||cw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t,e=[]){let r;switch(t){case"Browser":r=o2(un());break;case"Worker":r=`${o2(un())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${uc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((c,u)=>{try{const h=e(o);c(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gI(t,e={}){return fc(t,"GET","/v2/passwordPolicy",i1(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=6;class xI{constructor(e){var r,n,a,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=c.minPasswordLength)!==null&&r!==void 0?r:vI,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,o,c,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(r=h.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(n=h.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(a=h.containsLowercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new l2(this),this.idTokenSubscription=new l2(this),this.beforeStateQueue=new pI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ew,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Oi(r)),this._initializationPromise=this.queue(async()=>{var n,a,o;if(!this._deleted&&(this.persistenceManager=await Gl.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Sh(this,{idToken:e}),n=await ba._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(wa(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=a==null?void 0:a._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===u)&&(h!=null&&h.user)&&(a=h.user,o=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(a)}catch(c){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await bh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=J3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wa(this.app))return Promise.reject(Io(this));const r=e?Wr(e):null;return r&&Ze(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wa(this.app)?Promise.reject(Io(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wa(this.app)?Promise.reject(Io(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Oi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gI(this),r=new xI(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new df("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await hI(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Oi(e)||this._popupRedirectResolver;Ze(r,this,"argument-error"),this.redirectPersistenceManager=await Gl.create(this,[Oi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let c=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ze(u,this,"internal-error"),u.then(()=>{c||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,a);return()=>{c=!0,h()}}else{const h=e.addObserver(r);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;if(wa(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Y3(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ad(t){return Wr(t)}class l2{constructor(e){this.auth=e,this.observer=null,this.addObserver=LR(r=>this.observer=r)}get next(){return Ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yI(t){l1=t}function EI(t){return l1.loadJS(t)}function TI(){return l1.gapiScript}function wI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AI(t,e){const r=e1(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),o=r.getOptions();if(Oo(o,e??{}))return a;ti(a,"already-initialized")}return r.initialize({options:e})}function SI(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Oi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function bI(t,e,r){const n=ad(t);Ze(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,o=pw(e),{host:c,port:u}=kI(e),h=u===null?"":`:${u}`,d={url:`${o}//${c}${h}/`},g=Object.freeze({host:c,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){Ze(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ze(Oo(d,n.config.emulator)&&Oo(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,cc(c)?(qT(`${o}//${c}${h}`),XT("Auth",!0)):CI()}function pw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function kI(t){const e=pw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const o=a[1];return{host:o,port:c2(n.substr(o.length+1))}}else{const[o,c]=n.split(":");return{host:o,port:c2(c)}}}function c2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function CI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,r){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ql(t,e){return nI(t,"POST","/v1/accounts:signInWithIdp",i1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="http://localhost";class Mo extends gw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Mo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ti("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,o=t1(r,["providerId","signInMethod"]);if(!n||!a)return null;const c=new Mo(n,a);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const r=this.buildRequest();return ql(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ql(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ql(e,r)}buildRequest(){const e={requestUri:RI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=mf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf extends c1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends gf{constructor(){super("facebook.com")}static credential(e){return Mo._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.FACEBOOK_SIGN_IN_METHOD="facebook.com";As.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends gf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Mo._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Ni.credential(r,n)}catch{return null}}}Ni.GOOGLE_SIGN_IN_METHOD="google.com";Ni.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends gf{constructor(){super("github.com")}static credential(e){return Mo._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ss.credential(e.oauthAccessToken)}catch{return null}}}Ss.GITHUB_SIGN_IN_METHOD="github.com";Ss.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs extends gf{constructor(){super("twitter.com")}static credential(e,r){return Mo._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return bs.credentialFromTaggedObject(e)}static credentialFromError(e){return bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return bs.credential(r,n)}catch{return null}}}bs.TWITTER_SIGN_IN_METHOD="twitter.com";bs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const o=await ba._fromIdTokenResponse(e,n,a),c=u2(n);return new Ql({user:o,providerId:c,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=u2(n);return new Ql({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function u2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends qi{constructor(e,r,n,a){var o;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,kh.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new kh(e,r,n,a)}}function vw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?kh._fromErrorAndOperation(t,o,e,n):o})}async function II(t,e,r=!1){const n=await $u(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ql._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NI(t,e,r=!1){const{auth:n}=t;if(wa(n.app))return Promise.reject(Io(n));const a="reauthenticate";try{const o=await $u(t,vw(n,a,e,t),r);Ze(o.idToken,n,"internal-error");const c=s1(o.idToken);Ze(c,n,"internal-error");const{sub:u}=c;return Ze(t.uid===u,n,"user-mismatch"),Ql._forOperation(t,a,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&ti(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DI(t,e,r=!1){if(wa(t.app))return Promise.reject(Io(t));const n="signIn",a=await vw(t,n,e),o=await Ql._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(o.user),o}function OI(t,e,r,n){return Wr(t).onIdTokenChanged(e,r,n)}function FI(t,e,r){return Wr(t).beforeAuthStateChanged(e,r)}function xw(t,e,r,n){return Wr(t).onAuthStateChanged(e,r,n)}function MI(t){return Wr(t).signOut()}const Ch="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Ch,"1"),this.storage.removeItem(Ch),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI=1e3,LI=10;class yw extends _w{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(n);!r&&this.localCache[n]===c||this.notifyListeners(n,c)},o=this.storage.getItem(n);mI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,LI):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},PI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}yw.type="LOCAL";const VI=yw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew extends _w{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Ew.type="SESSION";const Tw=Ew;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new id(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:o}=r.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(c).map(async d=>d(r.origin,o)),h=await UI(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}id.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const d=u1("",20);a.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},n);c={messageChannel:a,onMessage(x){const _=x;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(_.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(){return window}function jI(t){Za().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(){return typeof Za().WorkerGlobalScope<"u"&&typeof Za().importScripts=="function"}async function HI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function zI(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function GI(){return ww()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="firebaseLocalStorageDb",qI=1,Rh="firebaseLocalStorage",Sw="fbase_key";class vf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function sd(t,e){return t.transaction([Rh],e?"readwrite":"readonly").objectStore(Rh)}function XI(){const t=indexedDB.deleteDatabase(Aw);return new vf(t).toPromise()}function mg(){const t=indexedDB.open(Aw,qI);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Rh,{keyPath:Sw})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Rh)?e(n):(n.close(),await XI(),e(await mg()))})})}async function f2(t,e,r){const n=sd(t,!0).put({[Sw]:e,value:r});return new vf(n).toPromise()}async function KI(t,e){const r=sd(t,!1).get(e),n=await new vf(r).toPromise();return n===void 0?null:n.value}function h2(t,e){const r=sd(t,!0).delete(e);return new vf(r).toPromise()}const $I=800,YI=3;class bw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>YI)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ww()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=id._getInstance(GI()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await HI(),!this.activeServiceWorker)return;this.sender=new BI(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||zI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mg();return await f2(e,Ch,"1"),await h2(e,Ch),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>f2(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>KI(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>h2(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=sd(a,!1).getAll();return new vf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$I)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bw.type="LOCAL";const WI=bw;new pf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t,e){return e?Oi(e):(Ze(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1 extends gw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ql(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ql(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ql(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function QI(t){return DI(t.auth,new f1(t),t.bypassAuthState)}function ZI(t){const{auth:e,user:r}=t;return Ze(r,e,"internal-error"),NI(r,new f1(t),t.bypassAuthState)}async function JI(t){const{auth:e,user:r}=t;return Ze(r,e,"internal-error"),II(r,new f1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(e,r,n,a,o=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:o,error:c,type:u}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QI;case"linkViaPopup":case"linkViaRedirect":return JI;case"reauthViaPopup":case"reauthViaRedirect":return ZI;default:ti(this.auth,"internal-error")}}resolve(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN=new pf(2e3,1e4);async function tN(t,e,r){if(wa(t.app))return Promise.reject(Ra(t,"operation-not-supported-in-this-environment"));const n=ad(t);W3(t,e,c1);const a=kw(n,r);return new ko(n,"signInViaPopup",e,a).executeNotNull()}class ko extends Cw{constructor(e,r,n,a,o){super(e,r,a,o),this.provider=n,this.authWindow=null,this.pollId=null,ko.currentPopupAction&&ko.currentPopupAction.cancel(),ko.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ze(e,this.auth,"internal-error"),e}async onExecution(){ji(this.filter.length===1,"Popup operations only handle one event");const e=u1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ra(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ra(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ko.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ra(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eN.get())};e()}}ko.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="pendingRedirect",hh=new Map;class nN extends Cw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=hh.get(this.auth._key());if(!e){try{const n=await aN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}hh.set(this.auth._key(),e)}return this.bypassAuthState||hh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aN(t,e){const r=oN(e),n=sN(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function iN(t,e){hh.set(t._key(),e)}function sN(t){return Oi(t._redirectPersistence)}function oN(t){return fh(rN,t.config.apiKey,t.name)}async function lN(t,e,r=!1){if(wa(t.app))return Promise.reject(Io(t));const n=ad(t),a=kw(n,e),c=await new nN(n,a,r).execute();return c&&!r&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN=10*60*1e3;class uN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!fN(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!Rw(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Ra(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cN&&this.cachedEventUids.clear(),this.cachedEventUids.has(d2(e))}saveEventToCache(e){this.cachedEventUids.add(d2(e)),this.lastProcessedEventTime=Date.now()}}function d2(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Rw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function fN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hN(t,e={}){return fc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mN=/^https?/;async function pN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await hN(t);for(const r of e)try{if(gN(r))return}catch{}ti(t,"unauthorized-domain")}function gN(t){const e=hg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&c.hostname===n}if(!mN.test(r))return!1;if(dN.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=new pf(3e4,6e4);function m2(){const t=Za().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function xN(t){return new Promise((e,r)=>{var n,a,o;function c(){m2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{m2(),r(Ra(t,"network-request-failed"))},timeout:vN.get()})}if(!((a=(n=Za().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((o=Za().gapi)===null||o===void 0)&&o.load)c();else{const u=wI("iframefcb");return Za()[u]=()=>{gapi.load?c():r(Ra(t,"network-request-failed"))},EI(`${TI()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw dh=null,e})}let dh=null;function _N(t){return dh=dh||xN(t),dh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN=new pf(5e3,15e3),EN="__/auth/iframe",TN="emulator/auth/iframe",wN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function SN(t){const e=t.config;Ze(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?a1(e,TN):`https://${t.config.authDomain}/${EN}`,n={apiKey:e.apiKey,appName:t.name,v:uc},a=AN.get(t.config.apiHost);a&&(n.eid=a);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${mf(n).slice(1)}`}async function bN(t){const e=await _N(t),r=Za().gapi;return Ze(r,t,"internal-error"),e.open({where:document.body,url:SN(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wN,dontclear:!0},n=>new Promise(async(a,o)=>{await n.restyle({setHideOnLeave:!1});const c=Ra(t,"network-request-failed"),u=Za().setTimeout(()=>{o(c)},yN.get());function h(){Za().clearTimeout(u),a(n)}n.ping(h).then(h,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CN=500,RN=600,IN="_blank",NN="http://localhost";class p2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function DN(t,e,r,n=CN,a=RN){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h=Object.assign(Object.assign({},kN),{width:n.toString(),height:a.toString(),top:o,left:c}),d=un().toLowerCase();r&&(u=lw(d)?IN:r),sw(d)&&(e=e||NN,h.scrollbars="yes");const g=Object.entries(h).reduce((_,[T,y])=>`${_}${T}=${y},`,"");if(dI(d)&&u!=="_self")return ON(e||"",u),new p2(null);const x=window.open(e||"",u,g);Ze(x,t,"popup-blocked");try{x.focus()}catch{}return new p2(x)}function ON(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN="__/auth/handler",MN="emulator/auth/handler",PN=encodeURIComponent("fac");async function g2(t,e,r,n,a,o){Ze(t.config.authDomain,t,"auth-domain-config-required"),Ze(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:uc,eventId:a};if(e instanceof c1){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",PR(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,x]of Object.entries({}))c[g]=x}if(e instanceof gf){const g=e.getScopes().filter(x=>x!=="");g.length>0&&(c.scopes=g.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const h=await t._getAppCheckToken(),d=h?`#${PN}=${encodeURIComponent(h)}`:"";return`${LN(t)}?${mf(u).slice(1)}${d}`}function LN({config:t}){return t.emulator?a1(t,MN):`https://${t.authDomain}/${FN}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp="webStorageSupport";class VN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tw,this._completeRedirectFn=lN,this._overrideRedirectResult=iN}async _openPopup(e,r,n,a){var o;ji((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await g2(e,r,n,hg(),a);return DN(e,c,u1())}async _openRedirect(e,r,n,a){await this._originValidation(e);const o=await g2(e,r,n,hg(),a);return jI(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:o}=this.eventManagers[r];return a?Promise.resolve(a):(ji(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await bN(e),n=new uN(e);return r.register("authEvent",a=>(Ze(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(jp,{type:jp},a=>{var o;const c=(o=a==null?void 0:a[0])===null||o===void 0?void 0:o[jp];c!==void 0&&r(!!c),ti(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=pN(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return dw()||ow()||o1()}}const UN=VN;var v2="@firebase/auth",x2="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HN(t){Wl(new Fo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:u}=n.options;Ze(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:c,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mw(t)},d=new _I(n,a,o,h);return SI(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Wl(new Fo("auth-internal",e=>{const r=ad(e.getProvider("auth").getImmediate());return(n=>new BN(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Os(v2,x2,jN(t)),Os(v2,x2,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN=5*60,GN=GT("authIdTokenMaxAge")||zN;let _2=null;const qN=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>GN)return;const a=r==null?void 0:r.token;_2!==a&&(_2=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function h1(t=WT()){const e=e1(t,"auth");if(e.isInitialized())return e.getImmediate();const r=AI(t,{popupRedirectResolver:UN,persistence:[WI,VI,Tw]}),n=GT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const c=qN(o.toString());FI(r,c,()=>c(r.currentUser)),OI(r,u=>c(u))}}const a=HT("auth");return a&&bI(r,`http://${a}`),r}function XN(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}yI({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const o=Ra("internal-error");o.customData=a,r(o)},n.type="text/javascript",n.charset="UTF-8",XN().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HN("Browser");var y2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fs,Iw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,I){function C(){}C.prototype=I.prototype,b.D=I.prototype,b.prototype=new C,b.prototype.constructor=b,b.C=function(V,M,O){for(var L=Array(arguments.length-2),De=2;De<arguments.length;De++)L[De-2]=arguments[De];return I.prototype[M].apply(V,L)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(b,I,C){C||(C=0);var V=Array(16);if(typeof I=="string")for(var M=0;16>M;++M)V[M]=I.charCodeAt(C++)|I.charCodeAt(C++)<<8|I.charCodeAt(C++)<<16|I.charCodeAt(C++)<<24;else for(M=0;16>M;++M)V[M]=I[C++]|I[C++]<<8|I[C++]<<16|I[C++]<<24;I=b.g[0],C=b.g[1],M=b.g[2];var O=b.g[3],L=I+(O^C&(M^O))+V[0]+3614090360&4294967295;I=C+(L<<7&4294967295|L>>>25),L=O+(M^I&(C^M))+V[1]+3905402710&4294967295,O=I+(L<<12&4294967295|L>>>20),L=M+(C^O&(I^C))+V[2]+606105819&4294967295,M=O+(L<<17&4294967295|L>>>15),L=C+(I^M&(O^I))+V[3]+3250441966&4294967295,C=M+(L<<22&4294967295|L>>>10),L=I+(O^C&(M^O))+V[4]+4118548399&4294967295,I=C+(L<<7&4294967295|L>>>25),L=O+(M^I&(C^M))+V[5]+1200080426&4294967295,O=I+(L<<12&4294967295|L>>>20),L=M+(C^O&(I^C))+V[6]+2821735955&4294967295,M=O+(L<<17&4294967295|L>>>15),L=C+(I^M&(O^I))+V[7]+4249261313&4294967295,C=M+(L<<22&4294967295|L>>>10),L=I+(O^C&(M^O))+V[8]+1770035416&4294967295,I=C+(L<<7&4294967295|L>>>25),L=O+(M^I&(C^M))+V[9]+2336552879&4294967295,O=I+(L<<12&4294967295|L>>>20),L=M+(C^O&(I^C))+V[10]+4294925233&4294967295,M=O+(L<<17&4294967295|L>>>15),L=C+(I^M&(O^I))+V[11]+2304563134&4294967295,C=M+(L<<22&4294967295|L>>>10),L=I+(O^C&(M^O))+V[12]+1804603682&4294967295,I=C+(L<<7&4294967295|L>>>25),L=O+(M^I&(C^M))+V[13]+4254626195&4294967295,O=I+(L<<12&4294967295|L>>>20),L=M+(C^O&(I^C))+V[14]+2792965006&4294967295,M=O+(L<<17&4294967295|L>>>15),L=C+(I^M&(O^I))+V[15]+1236535329&4294967295,C=M+(L<<22&4294967295|L>>>10),L=I+(M^O&(C^M))+V[1]+4129170786&4294967295,I=C+(L<<5&4294967295|L>>>27),L=O+(C^M&(I^C))+V[6]+3225465664&4294967295,O=I+(L<<9&4294967295|L>>>23),L=M+(I^C&(O^I))+V[11]+643717713&4294967295,M=O+(L<<14&4294967295|L>>>18),L=C+(O^I&(M^O))+V[0]+3921069994&4294967295,C=M+(L<<20&4294967295|L>>>12),L=I+(M^O&(C^M))+V[5]+3593408605&4294967295,I=C+(L<<5&4294967295|L>>>27),L=O+(C^M&(I^C))+V[10]+38016083&4294967295,O=I+(L<<9&4294967295|L>>>23),L=M+(I^C&(O^I))+V[15]+3634488961&4294967295,M=O+(L<<14&4294967295|L>>>18),L=C+(O^I&(M^O))+V[4]+3889429448&4294967295,C=M+(L<<20&4294967295|L>>>12),L=I+(M^O&(C^M))+V[9]+568446438&4294967295,I=C+(L<<5&4294967295|L>>>27),L=O+(C^M&(I^C))+V[14]+3275163606&4294967295,O=I+(L<<9&4294967295|L>>>23),L=M+(I^C&(O^I))+V[3]+4107603335&4294967295,M=O+(L<<14&4294967295|L>>>18),L=C+(O^I&(M^O))+V[8]+1163531501&4294967295,C=M+(L<<20&4294967295|L>>>12),L=I+(M^O&(C^M))+V[13]+2850285829&4294967295,I=C+(L<<5&4294967295|L>>>27),L=O+(C^M&(I^C))+V[2]+4243563512&4294967295,O=I+(L<<9&4294967295|L>>>23),L=M+(I^C&(O^I))+V[7]+1735328473&4294967295,M=O+(L<<14&4294967295|L>>>18),L=C+(O^I&(M^O))+V[12]+2368359562&4294967295,C=M+(L<<20&4294967295|L>>>12),L=I+(C^M^O)+V[5]+4294588738&4294967295,I=C+(L<<4&4294967295|L>>>28),L=O+(I^C^M)+V[8]+2272392833&4294967295,O=I+(L<<11&4294967295|L>>>21),L=M+(O^I^C)+V[11]+1839030562&4294967295,M=O+(L<<16&4294967295|L>>>16),L=C+(M^O^I)+V[14]+4259657740&4294967295,C=M+(L<<23&4294967295|L>>>9),L=I+(C^M^O)+V[1]+2763975236&4294967295,I=C+(L<<4&4294967295|L>>>28),L=O+(I^C^M)+V[4]+1272893353&4294967295,O=I+(L<<11&4294967295|L>>>21),L=M+(O^I^C)+V[7]+4139469664&4294967295,M=O+(L<<16&4294967295|L>>>16),L=C+(M^O^I)+V[10]+3200236656&4294967295,C=M+(L<<23&4294967295|L>>>9),L=I+(C^M^O)+V[13]+681279174&4294967295,I=C+(L<<4&4294967295|L>>>28),L=O+(I^C^M)+V[0]+3936430074&4294967295,O=I+(L<<11&4294967295|L>>>21),L=M+(O^I^C)+V[3]+3572445317&4294967295,M=O+(L<<16&4294967295|L>>>16),L=C+(M^O^I)+V[6]+76029189&4294967295,C=M+(L<<23&4294967295|L>>>9),L=I+(C^M^O)+V[9]+3654602809&4294967295,I=C+(L<<4&4294967295|L>>>28),L=O+(I^C^M)+V[12]+3873151461&4294967295,O=I+(L<<11&4294967295|L>>>21),L=M+(O^I^C)+V[15]+530742520&4294967295,M=O+(L<<16&4294967295|L>>>16),L=C+(M^O^I)+V[2]+3299628645&4294967295,C=M+(L<<23&4294967295|L>>>9),L=I+(M^(C|~O))+V[0]+4096336452&4294967295,I=C+(L<<6&4294967295|L>>>26),L=O+(C^(I|~M))+V[7]+1126891415&4294967295,O=I+(L<<10&4294967295|L>>>22),L=M+(I^(O|~C))+V[14]+2878612391&4294967295,M=O+(L<<15&4294967295|L>>>17),L=C+(O^(M|~I))+V[5]+4237533241&4294967295,C=M+(L<<21&4294967295|L>>>11),L=I+(M^(C|~O))+V[12]+1700485571&4294967295,I=C+(L<<6&4294967295|L>>>26),L=O+(C^(I|~M))+V[3]+2399980690&4294967295,O=I+(L<<10&4294967295|L>>>22),L=M+(I^(O|~C))+V[10]+4293915773&4294967295,M=O+(L<<15&4294967295|L>>>17),L=C+(O^(M|~I))+V[1]+2240044497&4294967295,C=M+(L<<21&4294967295|L>>>11),L=I+(M^(C|~O))+V[8]+1873313359&4294967295,I=C+(L<<6&4294967295|L>>>26),L=O+(C^(I|~M))+V[15]+4264355552&4294967295,O=I+(L<<10&4294967295|L>>>22),L=M+(I^(O|~C))+V[6]+2734768916&4294967295,M=O+(L<<15&4294967295|L>>>17),L=C+(O^(M|~I))+V[13]+1309151649&4294967295,C=M+(L<<21&4294967295|L>>>11),L=I+(M^(C|~O))+V[4]+4149444226&4294967295,I=C+(L<<6&4294967295|L>>>26),L=O+(C^(I|~M))+V[11]+3174756917&4294967295,O=I+(L<<10&4294967295|L>>>22),L=M+(I^(O|~C))+V[2]+718787259&4294967295,M=O+(L<<15&4294967295|L>>>17),L=C+(O^(M|~I))+V[9]+3951481745&4294967295,b.g[0]=b.g[0]+I&4294967295,b.g[1]=b.g[1]+(M+(L<<21&4294967295|L>>>11))&4294967295,b.g[2]=b.g[2]+M&4294967295,b.g[3]=b.g[3]+O&4294967295}n.prototype.u=function(b,I){I===void 0&&(I=b.length);for(var C=I-this.blockSize,V=this.B,M=this.h,O=0;O<I;){if(M==0)for(;O<=C;)a(this,b,O),O+=this.blockSize;if(typeof b=="string"){for(;O<I;)if(V[M++]=b.charCodeAt(O++),M==this.blockSize){a(this,V),M=0;break}}else for(;O<I;)if(V[M++]=b[O++],M==this.blockSize){a(this,V),M=0;break}}this.h=M,this.o+=I},n.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var I=1;I<b.length-8;++I)b[I]=0;var C=8*this.o;for(I=b.length-8;I<b.length;++I)b[I]=C&255,C/=256;for(this.u(b),b=Array(16),I=C=0;4>I;++I)for(var V=0;32>V;V+=8)b[C++]=this.g[I]>>>V&255;return b};function o(b,I){var C=u;return Object.prototype.hasOwnProperty.call(C,b)?C[b]:C[b]=I(b)}function c(b,I){this.h=I;for(var C=[],V=!0,M=b.length-1;0<=M;M--){var O=b[M]|0;V&&O==I||(C[M]=O,V=!1)}this.g=C}var u={};function h(b){return-128<=b&&128>b?o(b,function(I){return new c([I|0],0>I?-1:0)}):new c([b|0],0>b?-1:0)}function d(b){if(isNaN(b)||!isFinite(b))return x;if(0>b)return w(d(-b));for(var I=[],C=1,V=0;b>=C;V++)I[V]=b/C|0,C*=4294967296;return new c(I,0)}function g(b,I){if(b.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(b.charAt(0)=="-")return w(g(b.substring(1),I));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=d(Math.pow(I,8)),V=x,M=0;M<b.length;M+=8){var O=Math.min(8,b.length-M),L=parseInt(b.substring(M,M+O),I);8>O?(O=d(Math.pow(I,O)),V=V.j(O).add(d(L))):(V=V.j(C),V=V.add(d(L)))}return V}var x=h(0),_=h(1),T=h(16777216);t=c.prototype,t.m=function(){if(A(this))return-w(this).m();for(var b=0,I=1,C=0;C<this.g.length;C++){var V=this.i(C);b+=(0<=V?V:4294967296+V)*I,I*=4294967296}return b},t.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(y(this))return"0";if(A(this))return"-"+w(this).toString(b);for(var I=d(Math.pow(b,6)),C=this,V="";;){var M=K(C,I).g;C=N(C,M.j(I));var O=((0<C.g.length?C.g[0]:C.h)>>>0).toString(b);if(C=M,y(C))return O+V;for(;6>O.length;)O="0"+O;V=O+V}},t.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function y(b){if(b.h!=0)return!1;for(var I=0;I<b.g.length;I++)if(b.g[I]!=0)return!1;return!0}function A(b){return b.h==-1}t.l=function(b){return b=N(this,b),A(b)?-1:y(b)?0:1};function w(b){for(var I=b.g.length,C=[],V=0;V<I;V++)C[V]=~b.g[V];return new c(C,~b.h).add(_)}t.abs=function(){return A(this)?w(this):this},t.add=function(b){for(var I=Math.max(this.g.length,b.g.length),C=[],V=0,M=0;M<=I;M++){var O=V+(this.i(M)&65535)+(b.i(M)&65535),L=(O>>>16)+(this.i(M)>>>16)+(b.i(M)>>>16);V=L>>>16,O&=65535,L&=65535,C[M]=L<<16|O}return new c(C,C[C.length-1]&-2147483648?-1:0)};function N(b,I){return b.add(w(I))}t.j=function(b){if(y(this)||y(b))return x;if(A(this))return A(b)?w(this).j(w(b)):w(w(this).j(b));if(A(b))return w(this.j(w(b)));if(0>this.l(T)&&0>b.l(T))return d(this.m()*b.m());for(var I=this.g.length+b.g.length,C=[],V=0;V<2*I;V++)C[V]=0;for(V=0;V<this.g.length;V++)for(var M=0;M<b.g.length;M++){var O=this.i(V)>>>16,L=this.i(V)&65535,De=b.i(M)>>>16,be=b.i(M)&65535;C[2*V+2*M]+=L*be,U(C,2*V+2*M),C[2*V+2*M+1]+=O*be,U(C,2*V+2*M+1),C[2*V+2*M+1]+=L*De,U(C,2*V+2*M+1),C[2*V+2*M+2]+=O*De,U(C,2*V+2*M+2)}for(V=0;V<I;V++)C[V]=C[2*V+1]<<16|C[2*V];for(V=I;V<2*I;V++)C[V]=0;return new c(C,0)};function U(b,I){for(;(b[I]&65535)!=b[I];)b[I+1]+=b[I]>>>16,b[I]&=65535,I++}function R(b,I){this.g=b,this.h=I}function K(b,I){if(y(I))throw Error("division by zero");if(y(b))return new R(x,x);if(A(b))return I=K(w(b),I),new R(w(I.g),w(I.h));if(A(I))return I=K(b,w(I)),new R(w(I.g),I.h);if(30<b.g.length){if(A(b)||A(I))throw Error("slowDivide_ only works with positive integers.");for(var C=_,V=I;0>=V.l(b);)C=te(C),V=te(V);var M=J(C,1),O=J(V,1);for(V=J(V,2),C=J(C,2);!y(V);){var L=O.add(V);0>=L.l(b)&&(M=M.add(C),O=L),V=J(V,1),C=J(C,1)}return I=N(b,M.j(I)),new R(M,I)}for(M=x;0<=b.l(I);){for(C=Math.max(1,Math.floor(b.m()/I.m())),V=Math.ceil(Math.log(C)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),O=d(C),L=O.j(I);A(L)||0<L.l(b);)C-=V,O=d(C),L=O.j(I);y(O)&&(O=_),M=M.add(O),b=N(b,L)}return new R(M,b)}t.A=function(b){return K(this,b).h},t.and=function(b){for(var I=Math.max(this.g.length,b.g.length),C=[],V=0;V<I;V++)C[V]=this.i(V)&b.i(V);return new c(C,this.h&b.h)},t.or=function(b){for(var I=Math.max(this.g.length,b.g.length),C=[],V=0;V<I;V++)C[V]=this.i(V)|b.i(V);return new c(C,this.h|b.h)},t.xor=function(b){for(var I=Math.max(this.g.length,b.g.length),C=[],V=0;V<I;V++)C[V]=this.i(V)^b.i(V);return new c(C,this.h^b.h)};function te(b){for(var I=b.g.length+1,C=[],V=0;V<I;V++)C[V]=b.i(V)<<1|b.i(V-1)>>>31;return new c(C,b.h)}function J(b,I){var C=I>>5;I%=32;for(var V=b.g.length-C,M=[],O=0;O<V;O++)M[O]=0<I?b.i(O+C)>>>I|b.i(O+C+1)<<32-I:b.i(O+C);return new c(M,b.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Iw=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=d,c.fromString=g,Fs=c}).apply(typeof y2<"u"?y2:typeof self<"u"?self:typeof window<"u"?window:{});var $0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Nw,wu,Dw,mh,pg,Ow,Fw,Mw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,E,S){return m==Array.prototype||m==Object.prototype||(m[E]=S.value),m};function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof $0=="object"&&$0];for(var E=0;E<m.length;++E){var S=m[E];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var n=r(this);function a(m,E){if(E)e:{var S=n;m=m.split(".");for(var B=0;B<m.length-1;B++){var le=m[B];if(!(le in S))break e;S=S[le]}m=m[m.length-1],B=S[m],E=E(B),E!=B&&E!=null&&e(S,m,{configurable:!0,writable:!0,value:E})}}function o(m,E){m instanceof String&&(m+="");var S=0,B=!1,le={next:function(){if(!B&&S<m.length){var Ee=S++;return{value:E(Ee,m[Ee]),done:!1}}return B=!0,{done:!0,value:void 0}}};return le[Symbol.iterator]=function(){return le},le}a("Array.prototype.values",function(m){return m||function(){return o(this,function(E,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},u=this||self;function h(m){var E=typeof m;return E=E!="object"?E:m?Array.isArray(m)?"array":E:"null",E=="array"||E=="object"&&typeof m.length=="number"}function d(m){var E=typeof m;return E=="object"&&m!=null||E=="function"}function g(m,E,S){return m.call.apply(m.bind,arguments)}function x(m,E,S){if(!m)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var le=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(le,B),m.apply(E,le)}}return function(){return m.apply(E,arguments)}}function _(m,E,S){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:x,_.apply(null,arguments)}function T(m,E){var S=Array.prototype.slice.call(arguments,1);return function(){var B=S.slice();return B.push.apply(B,arguments),m.apply(this,B)}}function y(m,E){function S(){}S.prototype=E.prototype,m.aa=E.prototype,m.prototype=new S,m.prototype.constructor=m,m.Qb=function(B,le,Ee){for(var Ve=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)Ve[_t-2]=arguments[_t];return E.prototype[le].apply(B,Ve)}}function A(m){const E=m.length;if(0<E){const S=Array(E);for(let B=0;B<E;B++)S[B]=m[B];return S}return[]}function w(m,E){for(let S=1;S<arguments.length;S++){const B=arguments[S];if(h(B)){const le=m.length||0,Ee=B.length||0;m.length=le+Ee;for(let Ve=0;Ve<Ee;Ve++)m[le+Ve]=B[Ve]}else m.push(B)}}class N{constructor(E,S){this.i=E,this.j=S,this.h=0,this.g=null}get(){let E;return 0<this.h?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function U(m){return/^[\s\xa0]*$/.test(m)}function R(){var m=u.navigator;return m&&(m=m.userAgent)?m:""}function K(m){return K[" "](m),m}K[" "]=function(){};var te=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function J(m,E,S){for(const B in m)E.call(S,m[B],B,m)}function b(m,E){for(const S in m)E.call(void 0,m[S],S,m)}function I(m){const E={};for(const S in m)E[S]=m[S];return E}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(m,E){let S,B;for(let le=1;le<arguments.length;le++){B=arguments[le];for(S in B)m[S]=B[S];for(let Ee=0;Ee<C.length;Ee++)S=C[Ee],Object.prototype.hasOwnProperty.call(B,S)&&(m[S]=B[S])}}function M(m){var E=1;m=m.split(":");const S=[];for(;0<E&&m.length;)S.push(m.shift()),E--;return m.length&&S.push(m.join(":")),S}function O(m){u.setTimeout(()=>{throw m},0)}function L(){var m=oe;let E=null;return m.g&&(E=m.g,m.g=m.g.next,m.g||(m.h=null),E.next=null),E}class De{constructor(){this.h=this.g=null}add(E,S){const B=be.get();B.set(E,S),this.h?this.h.next=B:this.g=B,this.h=B}}var be=new N(()=>new ae,m=>m.reset());class ae{constructor(){this.next=this.g=this.h=null}set(E,S){this.h=E,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,Le=!1,oe=new De,Y=()=>{const m=u.Promise.resolve(void 0);ue=()=>{m.then(ve)}};var ve=()=>{for(var m;m=L();){try{m.h.call(m.g)}catch(S){O(S)}var E=be;E.j(m),100>E.h&&(E.h++,m.next=E.g,E.g=m)}Le=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Q(m,E){this.type=m,this.g=this.target=E,this.defaultPrevented=!1}Q.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var m=!1,E=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const S=()=>{};u.addEventListener("test",S,E),u.removeEventListener("test",S,E)}catch{}return m}();function re(m,E){if(Q.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var S=this.type=m.type,B=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=E,E=m.relatedTarget){if(te){e:{try{K(E.nodeName);var le=!0;break e}catch{}le=!1}le||(E=null)}}else S=="mouseover"?E=m.fromElement:S=="mouseout"&&(E=m.toElement);this.relatedTarget=E,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:me[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&re.aa.h.call(this)}}y(re,Q);var me={2:"touch",3:"pen",4:"mouse"};re.prototype.h=function(){re.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Ie="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function Fe(m,E,S,B,le){this.listener=m,this.proxy=null,this.src=E,this.type=S,this.capture=!!B,this.ha=le,this.key=++Ne,this.da=this.fa=!1}function Re(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function rt(m){this.src=m,this.g={},this.h=0}rt.prototype.add=function(m,E,S,B,le){var Ee=m.toString();m=this.g[Ee],m||(m=this.g[Ee]=[],this.h++);var Ve=Ot(m,E,B,le);return-1<Ve?(E=m[Ve],S||(E.fa=!1)):(E=new Fe(E,this.src,Ee,!!B,le),E.fa=S,m.push(E)),E};function W(m,E){var S=E.type;if(S in m.g){var B=m.g[S],le=Array.prototype.indexOf.call(B,E,void 0),Ee;(Ee=0<=le)&&Array.prototype.splice.call(B,le,1),Ee&&(Re(E),m.g[S].length==0&&(delete m.g[S],m.h--))}}function Ot(m,E,S,B){for(var le=0;le<m.length;++le){var Ee=m[le];if(!Ee.da&&Ee.listener==E&&Ee.capture==!!S&&Ee.ha==B)return le}return-1}var ot="closure_lm_"+(1e6*Math.random()|0),St={};function at(m,E,S,B,le){if(Array.isArray(E)){for(var Ee=0;Ee<E.length;Ee++)at(m,E[Ee],S,B,le);return null}return S=bn(S),m&&m[Ie]?m.K(E,S,d(B)?!!B.capture:!1,le):Pe(m,E,S,!1,B,le)}function Pe(m,E,S,B,le,Ee){if(!E)throw Error("Invalid event type");var Ve=d(le)?!!le.capture:!!le,_t=dn(m);if(_t||(m[ot]=_t=new rt(m)),S=_t.add(E,S,B,Ve,Ee),S.proxy)return S;if(B=Kt(),S.proxy=B,B.src=m,B.listener=S,m.addEventListener)ee||(le=Ve),le===void 0&&(le=!1),m.addEventListener(E.toString(),B,le);else if(m.attachEvent)m.attachEvent(Br(E.toString()),B);else if(m.addListener&&m.removeListener)m.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Kt(){function m(S){return E.call(m.src,m.listener,S)}const E=li;return m}function Ir(m,E,S,B,le){if(Array.isArray(E))for(var Ee=0;Ee<E.length;Ee++)Ir(m,E[Ee],S,B,le);else B=d(B)?!!B.capture:!!B,S=bn(S),m&&m[Ie]?(m=m.i,E=String(E).toString(),E in m.g&&(Ee=m.g[E],S=Ot(Ee,S,B,le),-1<S&&(Re(Ee[S]),Array.prototype.splice.call(Ee,S,1),Ee.length==0&&(delete m.g[E],m.h--)))):m&&(m=dn(m))&&(E=m.g[E.toString()],m=-1,E&&(m=Ot(E,S,B,le)),(S=-1<m?E[m]:null)&&Ur(S))}function Ur(m){if(typeof m!="number"&&m&&!m.da){var E=m.src;if(E&&E[Ie])W(E.i,m);else{var S=m.type,B=m.proxy;E.removeEventListener?E.removeEventListener(S,B,m.capture):E.detachEvent?E.detachEvent(Br(S),B):E.addListener&&E.removeListener&&E.removeListener(B),(S=dn(E))?(W(S,m),S.h==0&&(S.src=null,E[ot]=null)):Re(m)}}}function Br(m){return m in St?St[m]:St[m]="on"+m}function li(m,E){if(m.da)m=!0;else{E=new re(E,this);var S=m.listener,B=m.ha||m.src;m.fa&&Ur(m),m=S.call(B,E)}return m}function dn(m){return m=m[ot],m instanceof rt?m:null}var _r="__closure_events_fn_"+(1e9*Math.random()>>>0);function bn(m){return typeof m=="function"?m:(m[_r]||(m[_r]=function(E){return m.handleEvent(E)}),m[_r])}function Rt(){j.call(this),this.i=new rt(this),this.M=this,this.F=null}y(Rt,j),Rt.prototype[Ie]=!0,Rt.prototype.removeEventListener=function(m,E,S,B){Ir(this,m,E,S,B)};function pt(m,E){var S,B=m.F;if(B)for(S=[];B;B=B.F)S.push(B);if(m=m.M,B=E.type||E,typeof E=="string")E=new Q(E,m);else if(E instanceof Q)E.target=E.target||m;else{var le=E;E=new Q(B,m),V(E,le)}if(le=!0,S)for(var Ee=S.length-1;0<=Ee;Ee--){var Ve=E.g=S[Ee];le=Ft(Ve,B,!0,E)&&le}if(Ve=E.g=m,le=Ft(Ve,B,!0,E)&&le,le=Ft(Ve,B,!1,E)&&le,S)for(Ee=0;Ee<S.length;Ee++)Ve=E.g=S[Ee],le=Ft(Ve,B,!1,E)&&le}Rt.prototype.N=function(){if(Rt.aa.N.call(this),this.i){var m=this.i,E;for(E in m.g){for(var S=m.g[E],B=0;B<S.length;B++)Re(S[B]);delete m.g[E],m.h--}}this.F=null},Rt.prototype.K=function(m,E,S,B){return this.i.add(String(m),E,!1,S,B)},Rt.prototype.L=function(m,E,S,B){return this.i.add(String(m),E,!0,S,B)};function Ft(m,E,S,B){if(E=m.i.g[String(E)],!E)return!0;E=E.concat();for(var le=!0,Ee=0;Ee<E.length;++Ee){var Ve=E[Ee];if(Ve&&!Ve.da&&Ve.capture==S){var _t=Ve.listener,yr=Ve.ha||Ve.src;Ve.fa&&W(m.i,Ve),le=_t.call(yr,B)!==!1&&le}}return le&&!B.defaultPrevented}function jt(m,E,S){if(typeof m=="function")S&&(m=_(m,S));else if(m&&typeof m.handleEvent=="function")m=_(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(E)?-1:u.setTimeout(m,E||0)}function nt(m){m.g=jt(()=>{m.g=null,m.i&&(m.i=!1,nt(m))},m.l);const E=m.h;m.h=null,m.m.apply(null,E)}class $t extends j{constructor(E,S){super(),this.m=E,this.l=S,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:nt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fr(m){j.call(this),this.h=m,this.g={}}y(fr,j);var Ht=[];function mn(m){J(m.g,function(E,S){this.g.hasOwnProperty(S)&&Ur(E)},m),m.g={}}fr.prototype.N=function(){fr.aa.N.call(this),mn(this)},fr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var kn=u.JSON.stringify,Ki=u.JSON.parse,ci=class{stringify(m){return u.JSON.stringify(m,void 0)}parse(m){return u.JSON.parse(m,void 0)}};function $i(){}$i.prototype.h=null;function Yi(m){return m.h||(m.h=m.i())}function Wi(){}var pa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ga(){Q.call(this,"d")}y(ga,Q);function Da(){Q.call(this,"c")}y(Da,Q);var Wn={},Ws=null;function Oa(){return Ws=Ws||new Rt}Wn.La="serverreachability";function Qi(m){Q.call(this,Wn.La,m)}y(Qi,Q);function Fa(m){const E=Oa();pt(E,new Qi(E))}Wn.STAT_EVENT="statevent";function Wo(m,E){Q.call(this,Wn.STAT_EVENT,m),this.stat=E}y(Wo,Q);function Gt(m){const E=Oa();pt(E,new Wo(E,m))}Wn.Ma="timingevent";function sr(m,E){Q.call(this,Wn.Ma,m),this.size=E}y(sr,Q);function Yt(m,E){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){m()},E)}function Cn(){this.g=!0}Cn.prototype.xa=function(){this.g=!1};function Qs(m,E,S,B,le,Ee){m.info(function(){if(m.g)if(Ee)for(var Ve="",_t=Ee.split("&"),yr=0;yr<_t.length;yr++){var yt=_t[yr].split("=");if(1<yt.length){var Dr=yt[0];yt=yt[1];var Er=Dr.split("_");Ve=2<=Er.length&&Er[1]=="type"?Ve+(Dr+"="+yt+"&"):Ve+(Dr+"=redacted&")}}else Ve=null;else Ve=Ee;return"XMLHTTP REQ ("+B+") [attempt "+le+"]: "+E+`
`+S+`
`+Ve})}function yc(m,E,S,B,le,Ee,Ve){m.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+le+"]: "+E+`
`+S+`
`+Ee+" "+Ve})}function D(m,E,S,B){m.info(function(){return"XMLHTTP TEXT ("+E+"): "+H(m,S)+(B?" "+B:"")})}function q(m,E){m.info(function(){return"TIMEOUT: "+E})}Cn.prototype.info=function(){};function H(m,E){if(!m.g)return E;if(!E)return null;try{var S=JSON.parse(E);if(S){for(m=0;m<S.length;m++)if(Array.isArray(S[m])){var B=S[m];if(!(2>B.length)){var le=B[1];if(Array.isArray(le)&&!(1>le.length)){var Ee=le[0];if(Ee!="noop"&&Ee!="stop"&&Ee!="close")for(var Ve=1;Ve<le.length;Ve++)le[Ve]=""}}}}return kn(S)}catch{return E}}var z={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},G={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function fe(){}y(fe,$i),fe.prototype.g=function(){return new XMLHttpRequest},fe.prototype.i=function(){return{}},X=new fe;function ye(m,E,S,B){this.j=m,this.i=E,this.l=S,this.R=B||1,this.U=new fr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new se}function se(){this.i=null,this.g="",this.h=!1}var de={},pe={};function ke(m,E,S){m.L=1,m.v=eo(Ln(E)),m.m=S,m.P=!0,Me(m,null)}function Me(m,E){m.F=Date.now(),Ue(m),m.A=Ln(m.v);var S=m.A,B=m.R;Array.isArray(B)||(B=[String(B)]),Sc(S.i,"t",B),m.C=0,S=m.j.J,m.h=new se,m.g=jf(m.j,S?E:null,!m.m),0<m.O&&(m.M=new $t(_(m.Y,m,m.g),m.O)),E=m.U,S=m.g,B=m.ca;var le="readystatechange";Array.isArray(le)||(le&&(Ht[0]=le.toString()),le=Ht);for(var Ee=0;Ee<le.length;Ee++){var Ve=at(S,le[Ee],B||E.handleEvent,!1,E.h||E);if(!Ve)break;E.g[Ve.key]=Ve}E=m.H?I(m.H):{},m.m?(m.u||(m.u="POST"),E["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,E)):(m.u="GET",m.g.ea(m.A,m.u,null,E)),Fa(),Qs(m.i,m.u,m.A,m.l,m.R,m.m)}ye.prototype.ca=function(m){m=m.target;const E=this.M;E&&ea(m)==3?E.j():this.Y(m)},ye.prototype.Y=function(m){try{if(m==this.g)e:{const Er=ea(this.g);var E=this.g.Ba();const gi=this.g.Z();if(!(3>Er)&&(Er!=3||this.g&&(this.h.h||this.g.oa()||Of(this.g)))){this.J||Er!=4||E==7||(E==8||0>=gi?Fa(3):Fa(2)),kt(this);var S=this.g.Z();this.X=S;t:if(Be(this)){var B=Of(this.g);m="";var le=B.length,Ee=ea(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xt(this),vt(this);var Ve="";break t}this.h.i=new u.TextDecoder}for(E=0;E<le;E++)this.h.h=!0,m+=this.h.i.decode(B[E],{stream:!(Ee&&E==le-1)});B.length=0,this.h.g+=m,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=S==200,yc(this.i,this.u,this.A,this.l,this.R,Er,S),this.o){if(this.T&&!this.K){t:{if(this.g){var _t,yr=this.g;if((_t=yr.g?yr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(_t)){var yt=_t;break t}}yt=null}if(S=yt)D(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pn(this,S);else{this.o=!1,this.s=3,Gt(12),xt(this),vt(this);break e}}if(this.P){S=!0;let jr;for(;!this.J&&this.C<Ve.length;)if(jr=Oe(this,Ve),jr==pe){Er==4&&(this.s=4,Gt(14),S=!1),D(this.i,this.l,null,"[Incomplete Response]");break}else if(jr==de){this.s=4,Gt(15),D(this.i,this.l,Ve,"[Invalid Chunk]"),S=!1;break}else D(this.i,this.l,jr,null),Pn(this,jr);if(Be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Er!=4||Ve.length!=0||this.h.h||(this.s=1,Gt(16),S=!1),this.o=this.o&&S,!S)D(this.i,this.l,Ve,"[Invalid Chunked Response]"),xt(this),vt(this);else if(0<Ve.length&&!this.W){this.W=!0;var Dr=this.j;Dr.g==this&&Dr.ba&&!Dr.M&&(Dr.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),lo(Dr),Dr.M=!0,Gt(11))}}else D(this.i,this.l,Ve,null),Pn(this,Ve);Er==4&&xt(this),this.o&&!this.J&&(Er==4?Vf(this.j,this):(this.o=!1,Ue(this)))}else Md(this.g),S==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),xt(this),vt(this)}}}catch{}finally{}};function Be(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function Oe(m,E){var S=m.C,B=E.indexOf(`
`,S);return B==-1?pe:(S=Number(E.substring(S,B)),isNaN(S)?de:(B+=1,B+S>E.length?pe:(E=E.slice(B,B+S),m.C=B+S,E)))}ye.prototype.cancel=function(){this.J=!0,xt(this)};function Ue(m){m.S=Date.now()+m.I,Ye(m,m.I)}function Ye(m,E){if(m.B!=null)throw Error("WatchDog timer not null");m.B=Yt(_(m.ba,m),E)}function kt(m){m.B&&(u.clearTimeout(m.B),m.B=null)}ye.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(q(this.i,this.A),this.L!=2&&(Fa(),Gt(17)),xt(this),this.s=2,vt(this)):Ye(this,this.S-m)};function vt(m){m.j.G==0||m.J||Vf(m.j,m)}function xt(m){kt(m);var E=m.M;E&&typeof E.ma=="function"&&E.ma(),m.M=null,mn(m.U),m.g&&(E=m.g,m.g=null,E.abort(),E.ma())}function Pn(m,E){try{var S=m.j;if(S.G!=0&&(S.g==m||gn(S.h,m))){if(!m.K&&gn(S.h,m)&&S.G==3){try{var B=S.Da.g.parse(E)}catch{B=null}if(Array.isArray(B)&&B.length==3){var le=B;if(le[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<m.F)sl(S),al(S);else break e;Ic(S),Gt(18)}}else S.za=le[1],0<S.za-S.T&&37500>le[2]&&S.F&&S.v==0&&!S.C&&(S.C=Yt(_(S.Za,S),6e3));if(1>=Pa(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else pi(S,11)}else if((m.K||S.g==m)&&sl(S),!U(E))for(le=S.Da.g.parse(E),E=0;E<le.length;E++){let yt=le[E];if(S.T=yt[0],yt=yt[1],S.G==2)if(yt[0]=="c"){S.K=yt[1],S.ia=yt[2];const Dr=yt[3];Dr!=null&&(S.la=Dr,S.j.info("VER="+S.la));const Er=yt[4];Er!=null&&(S.Aa=Er,S.j.info("SVER="+S.Aa));const gi=yt[5];gi!=null&&typeof gi=="number"&&0<gi&&(B=1.5*gi,S.L=B,S.j.info("backChannelRequestTimeoutMs_="+B)),B=S;const jr=m.g;if(jr){const za=jr.g?jr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(za){var Ee=B.h;Ee.g||za.indexOf("spdy")==-1&&za.indexOf("quic")==-1&&za.indexOf("h2")==-1||(Ee.j=Ee.l,Ee.g=new Set,Ee.h&&(Qo(Ee,Ee.h),Ee.h=null))}if(B.D){const Dc=jr.g?jr.g.getResponseHeader("X-HTTP-Session-Id"):null;Dc&&(B.ya=Dc,Lt(B.I,B.D,Dc))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-m.F,S.j.info("Handshake RTT: "+S.R+"ms")),B=S;var Ve=m;if(B.qa=Bf(B,B.J?B.ia:null,B.W),Ve.K){vn(B.h,Ve);var _t=Ve,yr=B.L;yr&&(_t.I=yr),_t.B&&(kt(_t),Ue(_t)),B.g=Ve}else Pf(B);0<S.i.length&&il(S)}else yt[0]!="stop"&&yt[0]!="close"||pi(S,7);else S.G==3&&(yt[0]=="stop"||yt[0]=="close"?yt[0]=="stop"?pi(S,7):Cc(S):yt[0]!="noop"&&S.l&&S.l.ta(yt),S.v=0)}}Fa(4)}catch{}}var Ma=class{constructor(m,E){this.g=m,this.map=E}};function pn(m){this.l=m||10,u.PerformanceNavigationTiming?(m=u.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Rn(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Pa(m){return m.h?1:m.g?m.g.size:0}function gn(m,E){return m.h?m.h==E:m.g?m.g.has(E):!1}function Qo(m,E){m.g?m.g.add(E):m.h=E}function vn(m,E){m.h&&m.h==E?m.h=null:m.g&&m.g.has(E)&&m.g.delete(E)}pn.prototype.cancel=function(){if(this.i=Ec(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Ec(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let E=m.i;for(const S of m.g.values())E=E.concat(S.D);return E}return A(m.i)}function Nd(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(h(m)){for(var E=[],S=m.length,B=0;B<S;B++)E.push(m[B]);return E}E=[],S=0;for(B in m)E[S++]=m[B];return E}function Zo(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(h(m)||typeof m=="string"){var E=[];m=m.length;for(var S=0;S<m;S++)E.push(S);return E}E=[],S=0;for(const B in m)E[S++]=B;return E}}}function Tc(m,E){if(m.forEach&&typeof m.forEach=="function")m.forEach(E,void 0);else if(h(m)||typeof m=="string")Array.prototype.forEach.call(m,E,void 0);else for(var S=Zo(m),B=Nd(m),le=B.length,Ee=0;Ee<le;Ee++)E.call(void 0,B[Ee],S&&S[Ee],m)}var Zs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Dd(m,E){if(m){m=m.split("&");for(var S=0;S<m.length;S++){var B=m[S].indexOf("="),le=null;if(0<=B){var Ee=m[S].substring(0,B);le=m[S].substring(B+1)}else Ee=m[S];E(Ee,le?decodeURIComponent(le.replace(/\+/g," ")):"")}}}function hr(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof hr){this.h=m.h,Js(this,m.j),this.o=m.o,this.g=m.g,Zi(this,m.s),this.l=m.l;var E=m.i,S=new fi;S.i=E.i,E.g&&(S.g=new Map(E.g),S.h=E.h),ui(this,S),this.m=m.m}else m&&(E=String(m).match(Zs))?(this.h=!1,Js(this,E[1]||"",!0),this.o=Qn(E[2]||""),this.g=Qn(E[3]||"",!0),Zi(this,E[4]),this.l=Qn(E[5]||"",!0),ui(this,E[6]||"",!0),this.m=Qn(E[7]||"")):(this.h=!1,this.i=new fi(null,this.h))}hr.prototype.toString=function(){var m=[],E=this.j;E&&m.push(to(E,wc,!0),":");var S=this.g;return(S||E=="file")&&(m.push("//"),(E=this.o)&&m.push(to(E,wc,!0),"@"),m.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&m.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&m.push("/"),m.push(to(S,S.charAt(0)=="/"?Od:Ac,!0))),(S=this.i.toString())&&m.push("?",S),(S=this.m)&&m.push("#",to(S,Jo)),m.join("")};function Ln(m){return new hr(m)}function Js(m,E,S){m.j=S?Qn(E,!0):E,m.j&&(m.j=m.j.replace(/:$/,""))}function Zi(m,E){if(E){if(E=Number(E),isNaN(E)||0>E)throw Error("Bad port number "+E);m.s=E}else m.s=null}function ui(m,E,S){E instanceof fi?(m.i=E,Nf(m.i,m.h)):(S||(E=to(E,Fd)),m.i=new fi(E,m.h))}function Lt(m,E,S){m.i.set(E,S)}function eo(m){return Lt(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Qn(m,E){return m?E?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function to(m,E,S){return typeof m=="string"?(m=encodeURI(m).replace(E,If),S&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function If(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var wc=/[#\/\?@]/g,Ac=/[#\?:]/g,Od=/[#\?]/g,Fd=/[#\?@]/g,Jo=/#/g;function fi(m,E){this.h=this.g=null,this.i=m||null,this.j=!!E}function Zn(m){m.g||(m.g=new Map,m.h=0,m.i&&Dd(m.i,function(E,S){m.add(decodeURIComponent(E.replace(/\+/g," ")),S)}))}t=fi.prototype,t.add=function(m,E){Zn(this),this.i=null,m=La(this,m);var S=this.g.get(m);return S||this.g.set(m,S=[]),S.push(E),this.h+=1,this};function hi(m,E){Zn(m),E=La(m,E),m.g.has(E)&&(m.i=null,m.h-=m.g.get(E).length,m.g.delete(E))}function di(m,E){return Zn(m),E=La(m,E),m.g.has(E)}t.forEach=function(m,E){Zn(this),this.g.forEach(function(S,B){S.forEach(function(le){m.call(E,le,B,this)},this)},this)},t.na=function(){Zn(this);const m=Array.from(this.g.values()),E=Array.from(this.g.keys()),S=[];for(let B=0;B<E.length;B++){const le=m[B];for(let Ee=0;Ee<le.length;Ee++)S.push(E[B])}return S},t.V=function(m){Zn(this);let E=[];if(typeof m=="string")di(this,m)&&(E=E.concat(this.g.get(La(this,m))));else{m=Array.from(this.g.values());for(let S=0;S<m.length;S++)E=E.concat(m[S])}return E},t.set=function(m,E){return Zn(this),this.i=null,m=La(this,m),di(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[E]),this.h+=1,this},t.get=function(m,E){return m?(m=this.V(m),0<m.length?String(m[0]):E):E};function Sc(m,E,S){hi(m,E),0<S.length&&(m.i=null,m.g.set(La(m,E),A(S)),m.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],E=Array.from(this.g.keys());for(var S=0;S<E.length;S++){var B=E[S];const Ee=encodeURIComponent(String(B)),Ve=this.V(B);for(B=0;B<Ve.length;B++){var le=Ee;Ve[B]!==""&&(le+="="+encodeURIComponent(String(Ve[B]))),m.push(le)}}return this.i=m.join("&")};function La(m,E){return E=String(E),m.j&&(E=E.toLowerCase()),E}function Nf(m,E){E&&!m.j&&(Zn(m),m.i=null,m.g.forEach(function(S,B){var le=B.toLowerCase();B!=le&&(hi(this,B),Sc(this,le,S))},m)),m.j=E}function ro(m,E){const S=new Cn;if(u.Image){const B=new Image;B.onload=T(Jn,S,"TestLoadImage: loaded",!0,E,B),B.onerror=T(Jn,S,"TestLoadImage: error",!1,E,B),B.onabort=T(Jn,S,"TestLoadImage: abort",!1,E,B),B.ontimeout=T(Jn,S,"TestLoadImage: timeout",!1,E,B),u.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=m}else E(!1)}function va(m,E){const S=new Cn,B=new AbortController,le=setTimeout(()=>{B.abort(),Jn(S,"TestPingServer: timeout",!1,E)},1e4);fetch(m,{signal:B.signal}).then(Ee=>{clearTimeout(le),Ee.ok?Jn(S,"TestPingServer: ok",!0,E):Jn(S,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(le),Jn(S,"TestPingServer: error",!1,E)})}function Jn(m,E,S,B,le){try{le&&(le.onload=null,le.onerror=null,le.onabort=null,le.ontimeout=null),B(S)}catch{}}function no(){this.g=new ci}function Va(m,E,S){const B=S||"";try{Tc(m,function(le,Ee){let Ve=le;d(le)&&(Ve=kn(le)),E.push(B+Ee+"="+encodeURIComponent(Ve))})}catch(le){throw E.push(B+"type="+encodeURIComponent("_badmap")),le}}function Ji(m){this.l=m.Ub||null,this.j=m.eb||!1}y(Ji,$i),Ji.prototype.g=function(){return new mi(this.l,this.j)},Ji.prototype.i=function(m){return function(){return m}}({});function mi(m,E){Rt.call(this),this.D=m,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(mi,Rt),t=mi.prototype,t.open=function(m,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=E,this.readyState=1,Ba(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const E={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(E.body=m),(this.D||u).fetch(new Request(this.A,E)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ua(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Ba(this)),this.g&&(this.readyState=3,Ba(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;bc(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function bc(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var E=m.value?m.value:new Uint8Array(0);(E=this.v.decode(E,{stream:!m.done}))&&(this.response=this.responseText+=E)}m.done?Ua(this):Ba(this),this.readyState==3&&bc(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,Ua(this))},t.Qa=function(m){this.g&&(this.response=m,Ua(this))},t.ga=function(){this.g&&Ua(this)};function Ua(m){m.readyState=4,m.l=null,m.j=null,m.v=null,Ba(m)}t.setRequestHeader=function(m,E){this.u.append(m,E)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],E=this.h.entries();for(var S=E.next();!S.done;)S=S.value,m.push(S[0]+": "+S[1]),S=E.next();return m.join(`\r
`)};function Ba(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(mi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function kc(m){let E="";return J(m,function(S,B){E+=B,E+=":",E+=S,E+=`\r
`}),E}function Nr(m,E,S){e:{for(B in S){var B=!1;break e}B=!0}B||(S=kc(S),typeof m=="string"?S!=null&&encodeURIComponent(String(S)):Lt(m,E,S))}function Nt(m){Rt.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Nt,Rt);var el=/^https?$/i,ao=["POST","PUT"];t=Nt.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,E,S,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);E=E?E.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?Yi(this.o):Yi(X),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(E,String(m),!0),this.B=!1}catch(Ee){Df(this,Ee);return}if(m=S||"",S=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var le in B)S.set(le,B[le]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const Ee of B.keys())S.set(Ee,B.get(Ee));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(S.keys()).find(Ee=>Ee.toLowerCase()=="content-type"),le=u.FormData&&m instanceof u.FormData,!(0<=Array.prototype.indexOf.call(ao,E,void 0))||B||le||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ee,Ve]of S)this.g.setRequestHeader(Ee,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{io(this),this.u=!0,this.g.send(m),this.u=!1}catch(Ee){Df(this,Ee)}};function Df(m,E){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=E,m.m=5,tl(m),ja(m)}function tl(m){m.A||(m.A=!0,pt(m,"complete"),pt(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,pt(this,"complete"),pt(this,"abort"),ja(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ja(this,!0)),Nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?rl(this):this.bb())},t.bb=function(){rl(this)};function rl(m){if(m.h&&typeof c<"u"&&(!m.v[1]||ea(m)!=4||m.Z()!=2)){if(m.u&&ea(m)==4)jt(m.Ea,0,m);else if(pt(m,"readystatechange"),ea(m)==4){m.h=!1;try{const Ve=m.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var S;if(!(S=E)){var B;if(B=Ve===0){var le=String(m.D).match(Zs)[1]||null;!le&&u.self&&u.self.location&&(le=u.self.location.protocol.slice(0,-1)),B=!el.test(le?le.toLowerCase():"")}S=B}if(S)pt(m,"complete"),pt(m,"success");else{m.m=6;try{var Ee=2<ea(m)?m.g.statusText:""}catch{Ee=""}m.l=Ee+" ["+m.Z()+"]",tl(m)}}finally{ja(m)}}}}function ja(m,E){if(m.g){io(m);const S=m.g,B=m.v[0]?()=>{}:null;m.g=null,m.v=null,E||pt(m,"ready");try{S.onreadystatechange=B}catch{}}}function io(m){m.I&&(u.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function ea(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<ea(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var E=this.g.responseText;return m&&E.indexOf(m)==0&&(E=E.substring(m.length)),Ki(E)}};function Of(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Md(m){const E={};m=(m.g&&2<=ea(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<m.length;B++){if(U(m[B]))continue;var S=M(m[B]);const le=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const Ee=E[le]||[];E[le]=Ee,Ee.push(S)}b(E,function(B){return B.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function so(m,E,S){return S&&S.internalChannelParams&&S.internalChannelParams[m]||E}function nl(m){this.Aa=0,this.i=[],this.j=new Cn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=so("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=so("baseRetryDelayMs",5e3,m),this.cb=so("retryDelaySeedMs",1e4,m),this.Wa=so("forwardChannelMaxRetries",2,m),this.wa=so("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new pn(m&&m.concurrentRequestLimit),this.Da=new no,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=nl.prototype,t.la=8,t.G=1,t.connect=function(m,E,S,B){Gt(0),this.W=m,this.H=E||{},S&&B!==void 0&&(this.H.OSID=S,this.H.OAID=B),this.F=this.X,this.I=Bf(this,null,this.W),il(this)};function Cc(m){if(Ff(m),m.G==3){var E=m.U++,S=Ln(m.I);if(Lt(S,"SID",m.K),Lt(S,"RID",E),Lt(S,"TYPE","terminate"),oo(m,S),E=new ye(m,m.j,E),E.L=2,E.v=eo(Ln(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(E.v.toString(),"")}catch{}!S&&u.Image&&(new Image().src=E.v,S=!0),S||(E.g=jf(E.j,null),E.g.ea(E.v)),E.F=Date.now(),Ue(E)}Uf(m)}function al(m){m.g&&(lo(m),m.g.cancel(),m.g=null)}function Ff(m){al(m),m.u&&(u.clearTimeout(m.u),m.u=null),sl(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&u.clearTimeout(m.s),m.s=null)}function il(m){if(!Rn(m.h)&&!m.s){m.s=!0;var E=m.Ga;ue||Y(),Le||(ue(),Le=!0),oe.add(E,m),m.B=0}}function Pd(m,E){return Pa(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=E.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=Yt(_(m.Ga,m,E),Nc(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const le=new ye(this,this.j,m);let Ee=this.o;if(this.S&&(Ee?(Ee=I(Ee),V(Ee,this.S)):Ee=this.S),this.m!==null||this.O||(le.H=Ee,Ee=null),this.P)e:{for(var E=0,S=0;S<this.i.length;S++){t:{var B=this.i[S];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(E+=B,4096<E){E=S;break e}if(E===4096||S===this.i.length-1){E=S+1;break e}}E=1e3}else E=1e3;E=Mf(this,le,E),S=Ln(this.I),Lt(S,"RID",m),Lt(S,"CVER",22),this.D&&Lt(S,"X-HTTP-Session-Id",this.D),oo(this,S),Ee&&(this.O?E="headers="+encodeURIComponent(String(kc(Ee)))+"&"+E:this.m&&Nr(S,this.m,Ee)),Qo(this.h,le),this.Ua&&Lt(S,"TYPE","init"),this.P?(Lt(S,"$req",E),Lt(S,"SID","null"),le.T=!0,ke(le,S,null)):ke(le,S,E),this.G=2}}else this.G==3&&(m?Rc(this,m):this.i.length==0||Rn(this.h)||Rc(this))};function Rc(m,E){var S;E?S=E.l:S=m.U++;const B=Ln(m.I);Lt(B,"SID",m.K),Lt(B,"RID",S),Lt(B,"AID",m.T),oo(m,B),m.m&&m.o&&Nr(B,m.m,m.o),S=new ye(m,m.j,S,m.B+1),m.m===null&&(S.H=m.o),E&&(m.i=E.D.concat(m.i)),E=Mf(m,S,1e3),S.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),Qo(m.h,S),ke(S,B,E)}function oo(m,E){m.H&&J(m.H,function(S,B){Lt(E,B,S)}),m.l&&Tc({},function(S,B){Lt(E,B,S)})}function Mf(m,E,S){S=Math.min(m.i.length,S);var B=m.l?_(m.l.Na,m.l,m):null;e:{var le=m.i;let Ee=-1;for(;;){const Ve=["count="+S];Ee==-1?0<S?(Ee=le[0].g,Ve.push("ofs="+Ee)):Ee=0:Ve.push("ofs="+Ee);let _t=!0;for(let yr=0;yr<S;yr++){let yt=le[yr].g;const Dr=le[yr].map;if(yt-=Ee,0>yt)Ee=Math.max(0,le[yr].g-100),_t=!1;else try{Va(Dr,Ve,"req"+yt+"_")}catch{B&&B(Dr)}}if(_t){B=Ve.join("&");break e}}}return m=m.i.splice(0,S),E.D=m,B}function Pf(m){if(!m.g&&!m.u){m.Y=1;var E=m.Fa;ue||Y(),Le||(ue(),Le=!0),oe.add(E,m),m.v=0}}function Ic(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=Yt(_(m.Fa,m),Nc(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,Lf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=Yt(_(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gt(10),al(this),Lf(this))};function lo(m){m.A!=null&&(u.clearTimeout(m.A),m.A=null)}function Lf(m){m.g=new ye(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var E=Ln(m.qa);Lt(E,"RID","rpc"),Lt(E,"SID",m.K),Lt(E,"AID",m.T),Lt(E,"CI",m.F?"0":"1"),!m.F&&m.ja&&Lt(E,"TO",m.ja),Lt(E,"TYPE","xmlhttp"),oo(m,E),m.m&&m.o&&Nr(E,m.m,m.o),m.L&&(m.g.I=m.L);var S=m.g;m=m.ia,S.L=1,S.v=eo(Ln(E)),S.m=null,S.P=!0,Me(S,m)}t.Za=function(){this.C!=null&&(this.C=null,al(this),Ic(this),Gt(19))};function sl(m){m.C!=null&&(u.clearTimeout(m.C),m.C=null)}function Vf(m,E){var S=null;if(m.g==E){sl(m),lo(m),m.g=null;var B=2}else if(gn(m.h,E))S=E.D,vn(m.h,E),B=1;else return;if(m.G!=0){if(E.o)if(B==1){S=E.m?E.m.length:0,E=Date.now()-E.F;var le=m.B;B=Oa(),pt(B,new sr(B,S)),il(m)}else Pf(m);else if(le=E.s,le==3||le==0&&0<E.X||!(B==1&&Pd(m,E)||B==2&&Ic(m)))switch(S&&0<S.length&&(E=m.h,E.i=E.i.concat(S)),le){case 1:pi(m,5);break;case 4:pi(m,10);break;case 3:pi(m,6);break;default:pi(m,2)}}}function Nc(m,E){let S=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(S*=2),S*E}function pi(m,E){if(m.j.info("Error code "+E),E==2){var S=_(m.fb,m),B=m.Xa;const le=!B;B=new hr(B||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Js(B,"https"),eo(B),le?ro(B.toString(),S):va(B.toString(),S)}else Gt(2);m.G=0,m.l&&m.l.sa(E),Uf(m),Ff(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function Uf(m){if(m.G=0,m.ka=[],m.l){const E=Ec(m.h);(E.length!=0||m.i.length!=0)&&(w(m.ka,E),w(m.ka,m.i),m.h.i.length=0,A(m.i),m.i.length=0),m.l.ra()}}function Bf(m,E,S){var B=S instanceof hr?Ln(S):new hr(S);if(B.g!="")E&&(B.g=E+"."+B.g),Zi(B,B.s);else{var le=u.location;B=le.protocol,E=E?E+"."+le.hostname:le.hostname,le=+le.port;var Ee=new hr(null);B&&Js(Ee,B),E&&(Ee.g=E),le&&Zi(Ee,le),S&&(Ee.l=S),B=Ee}return S=m.D,E=m.ya,S&&E&&Lt(B,S,E),Lt(B,"VER",m.la),oo(m,B),B}function jf(m,E,S){if(E&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return E=m.Ca&&!m.pa?new Nt(new Ji({eb:S})):new Nt(m.pa),E.Ha(m.J),E}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hf(){}t=Hf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ol(){}ol.prototype.g=function(m,E){return new xn(m,E)};function xn(m,E){Rt.call(this),this.g=new nl(E),this.l=m,this.h=E&&E.messageUrlParams||null,m=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(m?m["X-WebChannel-Content-Type"]=E.messageContentType:m={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.va&&(m?m["X-WebChannel-Client-Profile"]=E.va:m={"X-WebChannel-Client-Profile":E.va}),this.g.S=m,(m=E&&E.Sb)&&!U(m)&&(this.g.m=m),this.v=E&&E.supportsCrossDomainXhr||!1,this.u=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!U(E)&&(this.g.D=E,m=this.h,m!==null&&E in m&&(m=this.h,E in m&&delete m[E])),this.j=new Ha(this)}y(xn,Rt),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Cc(this.g)},xn.prototype.o=function(m){var E=this.g;if(typeof m=="string"){var S={};S.__data__=m,m=S}else this.u&&(S={},S.__data__=kn(m),m=S);E.i.push(new Ma(E.Ya++,m)),E.G==3&&il(E)},xn.prototype.N=function(){this.g.l=null,delete this.j,Cc(this.g),delete this.g,xn.aa.N.call(this)};function zf(m){ga.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var E=m.__sm__;if(E){e:{for(const S in E){m=S;break e}m=void 0}(this.i=m)&&(m=this.i,E=E!==null&&m in E?E[m]:void 0),this.data=E}else this.data=m}y(zf,ga);function Gf(){Da.call(this),this.status=1}y(Gf,Da);function Ha(m){this.g=m}y(Ha,Hf),Ha.prototype.ua=function(){pt(this.g,"a")},Ha.prototype.ta=function(m){pt(this.g,new zf(m))},Ha.prototype.sa=function(m){pt(this.g,new Gf)},Ha.prototype.ra=function(){pt(this.g,"b")},ol.prototype.createWebChannel=ol.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,Mw=function(){return new ol},Fw=function(){return Oa()},Ow=Wn,pg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},z.NO_ERROR=0,z.TIMEOUT=8,z.HTTP_ERROR=6,mh=z,G.COMPLETE="complete",Dw=G,Wi.EventType=pa,pa.OPEN="a",pa.CLOSE="b",pa.ERROR="c",pa.MESSAGE="d",Rt.prototype.listen=Rt.prototype.K,wu=Wi,Nt.prototype.listenOnce=Nt.prototype.L,Nt.prototype.getLastError=Nt.prototype.Ka,Nt.prototype.getLastErrorCode=Nt.prototype.Ba,Nt.prototype.getStatus=Nt.prototype.Z,Nt.prototype.getResponseJson=Nt.prototype.Oa,Nt.prototype.getResponseText=Nt.prototype.oa,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Ha,Nw=Nt}).apply(typeof $0<"u"?$0:typeof self<"u"?self:typeof window<"u"?window:{});const E2="@firebase/firestore",T2="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}nn.UNAUTHENTICATED=new nn(null),nn.GOOGLE_CREDENTIALS=new nn("google-credentials-uid"),nn.FIRST_PARTY=new nn("first-party-uid"),nn.MOCK_USER=new nn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hc="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=new Zg("@firebase/firestore");function Ll(){return Po.logLevel}function je(t,...e){if(Po.logLevel<=dt.DEBUG){const r=e.map(d1);Po.debug(`Firestore (${hc}): ${t}`,...r)}}function Hi(t,...e){if(Po.logLevel<=dt.ERROR){const r=e.map(d1);Po.error(`Firestore (${hc}): ${t}`,...r)}}function Zl(t,...e){if(Po.logLevel<=dt.WARN){const r=e.map(d1);Po.warn(`Firestore (${hc}): ${t}`,...r)}}function d1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Pw(t,n,r)}function Pw(t,e,r){let n=`FIRESTORE (${hc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Hi(n),new Error(n)}function Dt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||Pw(e,a,n)}function tt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ze extends qi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class KN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(nn.UNAUTHENTICATED))}shutdown(){}}class $N{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class YN{constructor(e){this.t=e,this.currentUser=nn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Dt(this.o===void 0,42304);let n=this.i;const a=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new Pi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Pi,e.enqueueRetryable(()=>a(this.currentUser))};const c=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await a(this.currentUser)})},u=h=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Pi)}},0),c()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Dt(typeof n.accessToken=="string",31837,{l:n}),new Lw(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Dt(e===null||typeof e=="string",2055,{h:e}),new nn(e)}}class WN{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=nn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class QN{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new WN(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(nn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class w2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ZN{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wa(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Dt(this.o===void 0,3512);const n=o=>{o.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,je("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const a=o=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>a(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new w2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Dt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new w2(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=JN(40);for(let o=0;o<a.length;++o)n.length<20&&a[o]<r&&(n+=e.charAt(a[o]%62))}return n}}function ct(t,e){return t<e?-1:t>e?1:0}function gg(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),a=e.codePointAt(r);if(n!==a){if(n<128&&a<128)return ct(n,a);{const o=Vw(),c=e6(o.encode(A2(t,r)),o.encode(A2(e,r)));return c!==0?c:ct(n,a)}}r+=n>65535?2:1}return ct(t.length,e.length)}function A2(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function e6(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return ct(t[r],e[r]);return ct(t.length,e.length)}function Jl(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2=-62135596800,b2=1e6;class kr{static now(){return kr.fromMillis(Date.now())}static fromDate(e){return kr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*b2);return new kr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ze(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ze(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<S2)throw new ze(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ze(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/b2}_compareTo(e){return this.seconds===e.seconds?ct(this.nanoseconds,e.nanoseconds):ct(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-S2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new kr(0,0))}static max(){return new Je(new kr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2="__name__";class Qa{constructor(e,r,n){r===void 0?r=0:r>e.length&&$e(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&$e(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Qa.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Qa?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const o=Qa.compareSegments(e.get(a),r.get(a));if(o!==0)return o}return ct(e.length,r.length)}static compareSegments(e,r){const n=Qa.isNumericId(e),a=Qa.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Qa.extractNumericId(e).compare(Qa.extractNumericId(r)):gg(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fs.fromString(e.substring(4,e.length-2))}}class Zt extends Qa{construct(e,r,n){return new Zt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ze(Ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new Zt(r)}static emptyPath(){return new Zt([])}}const t6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kr extends Qa{construct(e,r,n){return new Kr(e,r,n)}static isValidIdentifier(e){return t6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===k2}static keyField(){return new Kr([k2])}static fromServerFormat(e){const r=[];let n="",a=0;const o=()=>{if(n.length===0)throw new ze(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let c=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new ze(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new ze(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,a+=2}else u==="`"?(c=!c,a++):u!=="."||c?(n+=u,a++):(o(),a++)}if(o(),c)throw new ze(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kr(r)}static emptyPath(){return new Kr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.path=e}static fromPath(e){return new qe(Zt.fromString(e))}static fromName(e){return new qe(Zt.fromString(e).popFirst(5))}static empty(){return new qe(Zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Zt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new Zt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu=-1;function r6(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=Je.fromTimestamp(n===1e9?new kr(r+1,0):new kr(r,n));return new Ls(a,qe.empty(),e)}function n6(t){return new Ls(t.readTime,t.key,Yu)}class Ls{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ls(Je.min(),qe.empty(),Yu)}static max(){return new Ls(Je.max(),qe.empty(),Yu)}}function a6(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=qe.comparator(t.documentKey,e.documentKey),r!==0?r:ct(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class s6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dc(t){if(t.code!==Ce.FAILED_PRECONDITION||t.message!==i6)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&$e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Se((n,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,a)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Se?r:Se.resolve(r)}catch(r){return Se.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Se.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Se.reject(r)}static resolve(e){return new Se((r,n)=>{r(e)})}static reject(e){return new Se((r,n)=>{n(e)})}static waitFor(e){return new Se((r,n)=>{let a=0,o=0,c=!1;e.forEach(u=>{++a,u.next(()=>{++o,c&&o===a&&r()},h=>n(h))}),c=!0,o===a&&r()})}static or(e){let r=Se.resolve(!1);for(const n of e)r=r.next(a=>a?Se.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,o)=>{n.push(r.call(this,a,o))}),this.waitFor(n)}static mapArray(e,r){return new Se((n,a)=>{const o=e.length,c=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next(g=>{c[d]=g,++u,u===o&&n(c)},g=>a(g))}})}static doWhile(e,r){return new Se((n,a)=>{const o=()=>{e()===!0?r().next(()=>{o()},a):n()};o()})}}function o6(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function mc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>r.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}od.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1=-1;function ld(t){return t==null}function Ih(t){return t===0&&1/t==-1/0}function l6(t){return typeof t=="number"&&Number.isInteger(t)&&!Ih(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="";function c6(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=C2(e)),e=u6(t.get(r),e);return C2(e)}function u6(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const o=t.charAt(a);switch(o){case"\0":r+="";break;case Bw:r+="";break;default:r+=o}}return r}function C2(t){return t+Bw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ks(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function jw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,r){this.comparator=e,this.root=r||qr.EMPTY}insert(e,r){return new tr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,qr.BLACK,null,null))}remove(e){return new tr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Y0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Y0(this.root,e,this.comparator,!1)}getReverseIterator(){return new Y0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Y0(this.root,e,this.comparator,!0)}}class Y0{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qr{constructor(e,r,n,a,o){this.key=e,this.value=r,this.color=n??qr.RED,this.left=a??qr.EMPTY,this.right=o??qr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,o){return new qr(e??this.key,r??this.value,n??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const o=n(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,r,n),null):o===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return qr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return qr.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw $e(27949);return e+(this.isRed()?0:1)}}qr.EMPTY=null,qr.RED=!0,qr.BLACK=!1;qr.EMPTY=new class{constructor(){this.size=0}get key(){throw $e(57766)}get value(){throw $e(16141)}get color(){throw $e(16727)}get left(){throw $e(29726)}get right(){throw $e(36894)}copy(e,r,n,a,o){return this}insert(e,r,n){return new qr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this.comparator=e,this.data=new tr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new I2(this.data.getIterator())}getIteratorFrom(e){return new I2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Cr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Cr(this.comparator);return r.data=e,r}}class I2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.fields=e,e.sort(Kr.comparator)}static empty(){return new Kn([])}unionWith(e){let r=new Cr(Kr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Kn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Jl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Hw("Invalid base64 string: "+o):o}}(e);return new Qr(r)}static fromUint8Array(e){const r=function(a){let o="";for(let c=0;c<a.length;++c)o+=String.fromCharCode(a[c]);return o}(e);return new Qr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ct(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qr.EMPTY_BYTE_STRING=new Qr("");const f6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vs(t){if(Dt(!!t,39018),typeof t=="string"){let e=0;const r=f6.exec(t);if(Dt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ur(t.seconds),nanos:ur(t.nanos)}}function ur(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Us(t){return typeof t=="string"?Qr.fromBase64String(t):Qr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw="server_timestamp",Gw="__type__",qw="__previous_value__",Xw="__local_write_time__";function p1(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Gw])===null||r===void 0?void 0:r.stringValue)===zw}function cd(t){const e=t.mapValue.fields[qw];return p1(e)?cd(e):e}function Wu(t){const e=Vs(t.mapValue.fields[Xw].timestampValue);return new kr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,r,n,a,o,c,u,h,d,g){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=g}}const Nh="(default)";class Qu{constructor(e,r){this.projectId=e,this.database=r||Nh}static empty(){return new Qu("","")}get isDefaultDatabase(){return this.database===Nh}isEqual(e){return e instanceof Qu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="__type__",d6="__max__",W0={mapValue:{}},$w="__vector__",Dh="value";function Bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?p1(t)?4:p6(t)?9007199254740991:m6(t)?10:11:$e(28295,{value:t})}function ri(t,e){if(t===e)return!0;const r=Bs(t);if(r!==Bs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wu(t).isEqual(Wu(e));case 3:return function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const c=Vs(a.timestampValue),u=Vs(o.timestampValue);return c.seconds===u.seconds&&c.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,o){return Us(a.bytesValue).isEqual(Us(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,o){return ur(a.geoPointValue.latitude)===ur(o.geoPointValue.latitude)&&ur(a.geoPointValue.longitude)===ur(o.geoPointValue.longitude)}(t,e);case 2:return function(a,o){if("integerValue"in a&&"integerValue"in o)return ur(a.integerValue)===ur(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const c=ur(a.doubleValue),u=ur(o.doubleValue);return c===u?Ih(c)===Ih(u):isNaN(c)&&isNaN(u)}return!1}(t,e);case 9:return Jl(t.arrayValue.values||[],e.arrayValue.values||[],ri);case 10:case 11:return function(a,o){const c=a.mapValue.fields||{},u=o.mapValue.fields||{};if(R2(c)!==R2(u))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(u[h]===void 0||!ri(c[h],u[h])))return!1;return!0}(t,e);default:return $e(52216,{left:t})}}function Zu(t,e){return(t.values||[]).find(r=>ri(r,e))!==void 0}function ec(t,e){if(t===e)return 0;const r=Bs(t),n=Bs(e);if(r!==n)return ct(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ct(t.booleanValue,e.booleanValue);case 2:return function(o,c){const u=ur(o.integerValue||o.doubleValue),h=ur(c.integerValue||c.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return N2(t.timestampValue,e.timestampValue);case 4:return N2(Wu(t),Wu(e));case 5:return gg(t.stringValue,e.stringValue);case 6:return function(o,c){const u=Us(o),h=Us(c);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,c){const u=o.split("/"),h=c.split("/");for(let d=0;d<u.length&&d<h.length;d++){const g=ct(u[d],h[d]);if(g!==0)return g}return ct(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,c){const u=ct(ur(o.latitude),ur(c.latitude));return u!==0?u:ct(ur(o.longitude),ur(c.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return D2(t.arrayValue,e.arrayValue);case 10:return function(o,c){var u,h,d,g;const x=o.fields||{},_=c.fields||{},T=(u=x[Dh])===null||u===void 0?void 0:u.arrayValue,y=(h=_[Dh])===null||h===void 0?void 0:h.arrayValue,A=ct(((d=T==null?void 0:T.values)===null||d===void 0?void 0:d.length)||0,((g=y==null?void 0:y.values)===null||g===void 0?void 0:g.length)||0);return A!==0?A:D2(T,y)}(t.mapValue,e.mapValue);case 11:return function(o,c){if(o===W0.mapValue&&c===W0.mapValue)return 0;if(o===W0.mapValue)return 1;if(c===W0.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=c.fields||{},g=Object.keys(d);h.sort(),g.sort();for(let x=0;x<h.length&&x<g.length;++x){const _=gg(h[x],g[x]);if(_!==0)return _;const T=ec(u[h[x]],d[g[x]]);if(T!==0)return T}return ct(h.length,g.length)}(t.mapValue,e.mapValue);default:throw $e(23264,{Pe:r})}}function N2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ct(t,e);const r=Vs(t),n=Vs(e),a=ct(r.seconds,n.seconds);return a!==0?a:ct(r.nanos,n.nanos)}function D2(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const o=ec(r[a],n[a]);if(o)return o}return ct(r.length,n.length)}function tc(t){return vg(t)}function vg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Vs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Us(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return qe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const o of r.values||[])a?a=!1:n+=",",n+=vg(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",o=!0;for(const c of n)o?o=!1:a+=",",a+=`${c}:${vg(r.fields[c])}`;return a+"}"}(t.mapValue):$e(61005,{value:t})}function ph(t){switch(Bs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cd(t);return e?16+ph(e):16;case 5:return 2*t.stringValue.length;case 6:return Us(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((a,o)=>a+ph(o),0)}(t.arrayValue);case 10:case 11:return function(n){let a=0;return Ks(n.fields,(o,c)=>{a+=o.length+ph(c)}),a}(t.mapValue);default:throw $e(13486,{value:t})}}function xg(t){return!!t&&"integerValue"in t}function g1(t){return!!t&&"arrayValue"in t}function O2(t){return!!t&&"nullValue"in t}function F2(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gh(t){return!!t&&"mapValue"in t}function m6(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Kw])===null||r===void 0?void 0:r.stringValue)===$w}function Ou(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ks(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ou(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ou(t.arrayValue.values[r]);return e}return Object.assign({},t)}function p6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===d6}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.value=e}static empty(){return new Mn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!gh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ou(r)}setAll(e){let r=Kr.emptyPath(),n={},a=[];e.forEach((c,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,a),n={},a=[],r=u.popLast()}c?n[u.lastSegment()]=Ou(c):a.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,a)}delete(e){const r=this.field(e.popLast());gh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ri(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];gh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Ks(r,(a,o)=>e[a]=o);for(const a of n)delete e[a]}clone(){return new Mn(Ou(this.value))}}function Yw(t){const e=[];return Ks(t.fields,(r,n)=>{const a=new Kr([r]);if(gh(n)){const o=Yw(n.mapValue).fields;if(o.length===0)e.push(a);else for(const c of o)e.push(a.child(c))}else e.push(a)}),new Kn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,r,n,a,o,c,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=o,this.data=c,this.documentState=u}static newInvalidDocument(e){return new sn(e,0,Je.min(),Je.min(),Je.min(),Mn.empty(),0)}static newFoundDocument(e,r,n,a){return new sn(e,1,r,Je.min(),n,a,0)}static newNoDocument(e,r){return new sn(e,2,r,Je.min(),Je.min(),Mn.empty(),0)}static newUnknownDocument(e,r){return new sn(e,3,r,Je.min(),Je.min(),Mn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof sn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new sn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,r){this.position=e,this.inclusive=r}}function M2(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const o=e[a],c=t.position[a];if(o.field.isKeyField()?n=qe.comparator(qe.fromName(c.referenceValue),r.key):n=ec(c,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function P2(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ri(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,r="asc"){this.field=e,this.dir=r}}function g6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{}class Sr extends Ww{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new x6(e,r,n):r==="array-contains"?new E6(e,n):r==="in"?new T6(e,n):r==="not-in"?new w6(e,n):r==="array-contains-any"?new A6(e,n):new Sr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new _6(e,n):new y6(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(ec(r,this.value)):r!==null&&Bs(this.value)===Bs(r)&&this.matchesComparison(ec(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ni extends Ww{constructor(e,r){super(),this.filters=e,this.op=r,this.Te=null}static create(e,r){return new ni(e,r)}matches(e){return Qw(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Qw(t){return t.op==="and"}function Zw(t){return v6(t)&&Qw(t)}function v6(t){for(const e of t.filters)if(e instanceof ni)return!1;return!0}function _g(t){if(t instanceof Sr)return t.field.canonicalString()+t.op.toString()+tc(t.value);if(Zw(t))return t.filters.map(e=>_g(e)).join(",");{const e=t.filters.map(r=>_g(r)).join(",");return`${t.op}(${e})`}}function Jw(t,e){return t instanceof Sr?function(n,a){return a instanceof Sr&&n.op===a.op&&n.field.isEqual(a.field)&&ri(n.value,a.value)}(t,e):t instanceof ni?function(n,a){return a instanceof ni&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((o,c,u)=>o&&Jw(c,a.filters[u]),!0):!1}(t,e):void $e(19439)}function eA(t){return t instanceof Sr?function(r){return`${r.field.canonicalString()} ${r.op} ${tc(r.value)}`}(t):t instanceof ni?function(r){return r.op.toString()+" {"+r.getFilters().map(eA).join(" ,")+"}"}(t):"Filter"}class x6 extends Sr{constructor(e,r,n){super(e,r,n),this.key=qe.fromName(n.referenceValue)}matches(e){const r=qe.comparator(e.key,this.key);return this.matchesComparison(r)}}class _6 extends Sr{constructor(e,r){super(e,"in",r),this.keys=tA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class y6 extends Sr{constructor(e,r){super(e,"not-in",r),this.keys=tA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function tA(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>qe.fromName(n.referenceValue))}class E6 extends Sr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return g1(r)&&Zu(r.arrayValue,this.value)}}class T6 extends Sr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Zu(this.value.arrayValue,r)}}class w6 extends Sr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Zu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Zu(this.value.arrayValue,r)}}class A6 extends Sr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!g1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Zu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e,r=null,n=[],a=[],o=null,c=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=o,this.startAt=c,this.endAt=u,this.Ie=null}}function L2(t,e=null,r=[],n=[],a=null,o=null,c=null){return new S6(t,e,r,n,a,o,c)}function v1(t){const e=tt(t);if(e.Ie===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>_g(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),ld(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>tc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>tc(n)).join(",")),e.Ie=r}return e.Ie}function x1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!g6(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Jw(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!P2(t.startAt,e.startAt)&&P2(t.endAt,e.endAt)}function yg(t){return qe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,r=null,n=[],a=[],o=null,c="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=o,this.limitType=c,this.startAt=u,this.endAt=h,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function b6(t,e,r,n,a,o,c,u){return new ud(t,e,r,n,a,o,c,u)}function _1(t){return new ud(t)}function V2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function k6(t){return t.collectionGroup!==null}function Fu(t){const e=tt(t);if(e.Ee===null){e.Ee=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ee.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let u=new Cr(Kr.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ee.push(new Fh(o,n))}),r.has(Kr.keyField().canonicalString())||e.Ee.push(new Fh(Kr.keyField(),n))}return e.Ee}function Ja(t){const e=tt(t);return e.de||(e.de=C6(e,Fu(t))),e.de}function C6(t,e){if(t.limitType==="F")return L2(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const o=a.dir==="desc"?"asc":"desc";return new Fh(a.field,o)});const r=t.endAt?new Oh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Oh(t.startAt.position,t.startAt.inclusive):null;return L2(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Eg(t,e,r){return new ud(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function fd(t,e){return x1(Ja(t),Ja(e))&&t.limitType===e.limitType}function rA(t){return`${v1(Ja(t))}|lt:${t.limitType}`}function Vl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>eA(a)).join(", ")}]`),ld(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>tc(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>tc(a)).join(",")),`Target(${n})`}(Ja(t))}; limitType=${t.limitType})`}function hd(t,e){return e.isFoundDocument()&&function(n,a){const o=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):qe.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,a){for(const o of Fu(n))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const o of n.filters)if(!o.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(c,u,h){const d=M2(c,u,h);return c.inclusive?d<=0:d<0}(n.startAt,Fu(n),a)||n.endAt&&!function(c,u,h){const d=M2(c,u,h);return c.inclusive?d>=0:d>0}(n.endAt,Fu(n),a))}(t,e)}function R6(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function nA(t){return(e,r)=>{let n=!1;for(const a of Fu(t)){const o=I6(a,e,r);if(o!==0)return o;n=n||a.field.isKeyField()}return 0}}function I6(t,e,r){const n=t.field.isKeyField()?qe.comparator(e.key,r.key):function(o,c,u){const h=c.data.field(o),d=u.data.field(o);return h!==null&&d!==null?ec(h,d):$e(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return $e(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,o]of n)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ks(this.inner,(r,n)=>{for(const[a,o]of n)e(a,o)})}isEmpty(){return jw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N6=new tr(qe.comparator);function zi(){return N6}const aA=new tr(qe.comparator);function Au(...t){let e=aA;for(const r of t)e=e.insert(r.key,r);return e}function iA(t){let e=aA;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Co(){return Mu()}function sA(){return Mu()}function Mu(){return new Ho(t=>t.toString(),(t,e)=>t.isEqual(e))}const D6=new tr(qe.comparator),O6=new Cr(qe.comparator);function mt(...t){let e=O6;for(const r of t)e=e.add(r);return e}const F6=new Cr(ct);function M6(){return F6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ih(e)?"-0":e}}function oA(t){return{integerValue:""+t}}function P6(t,e){return l6(e)?oA(e):y1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(){this._=void 0}}function L6(t,e,r){return t instanceof Mh?function(a,o){const c={fields:{[Gw]:{stringValue:zw},[Xw]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&p1(o)&&(o=cd(o)),o&&(c.fields[qw]=o),{mapValue:c}}(r,e):t instanceof Ju?cA(t,e):t instanceof ef?uA(t,e):function(a,o){const c=lA(a,o),u=U2(c)+U2(a.Re);return xg(c)&&xg(a.Re)?oA(u):y1(a.serializer,u)}(t,e)}function V6(t,e,r){return t instanceof Ju?cA(t,e):t instanceof ef?uA(t,e):r}function lA(t,e){return t instanceof Ph?function(n){return xg(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Mh extends dd{}class Ju extends dd{constructor(e){super(),this.elements=e}}function cA(t,e){const r=fA(e);for(const n of t.elements)r.some(a=>ri(a,n))||r.push(n);return{arrayValue:{values:r}}}class ef extends dd{constructor(e){super(),this.elements=e}}function uA(t,e){let r=fA(e);for(const n of t.elements)r=r.filter(a=>!ri(a,n));return{arrayValue:{values:r}}}class Ph extends dd{constructor(e,r){super(),this.serializer=e,this.Re=r}}function U2(t){return ur(t.integerValue||t.doubleValue)}function fA(t){return g1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function U6(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof Ju&&a instanceof Ju||n instanceof ef&&a instanceof ef?Jl(n.elements,a.elements,ri):n instanceof Ph&&a instanceof Ph?ri(n.Re,a.Re):n instanceof Mh&&a instanceof Mh}(t.transform,e.transform)}class B6{constructor(e,r){this.version=e,this.transformResults=r}}class fa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new fa}static exists(e){return new fa(void 0,e)}static updateTime(e){return new fa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class md{}function hA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new E1(t.key,fa.none()):new xf(t.key,t.data,fa.none());{const r=t.data,n=Mn.empty();let a=new Cr(Kr.comparator);for(let o of e.fields)if(!a.has(o)){let c=r.field(o);c===null&&o.length>1&&(o=o.popLast(),c=r.field(o)),c===null?n.delete(o):n.set(o,c),a=a.add(o)}return new $s(t.key,n,new Kn(a.toArray()),fa.none())}}function j6(t,e,r){t instanceof xf?function(a,o,c){const u=a.value.clone(),h=j2(a.fieldTransforms,o,c.transformResults);u.setAll(h),o.convertToFoundDocument(c.version,u).setHasCommittedMutations()}(t,e,r):t instanceof $s?function(a,o,c){if(!vh(a.precondition,o))return void o.convertToUnknownDocument(c.version);const u=j2(a.fieldTransforms,o,c.transformResults),h=o.data;h.setAll(dA(a)),h.setAll(u),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(t,e,r):function(a,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,r)}function Pu(t,e,r,n){return t instanceof xf?function(o,c,u,h){if(!vh(o.precondition,c))return u;const d=o.value.clone(),g=H2(o.fieldTransforms,h,c);return d.setAll(g),c.convertToFoundDocument(c.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof $s?function(o,c,u,h){if(!vh(o.precondition,c))return u;const d=H2(o.fieldTransforms,h,c),g=c.data;return g.setAll(dA(o)),g.setAll(d),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(x=>x.field))}(t,e,r,n):function(o,c,u){return vh(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):u}(t,e,r)}function H6(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),o=lA(n.transform,a||null);o!=null&&(r===null&&(r=Mn.empty()),r.set(n.field,o))}return r||null}function B2(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Jl(n,a,(o,c)=>U6(o,c))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class xf extends md{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class $s extends md{constructor(e,r,n,a,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function dA(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function j2(t,e,r){const n=new Map;Dt(t.length===r.length,32656,{Ve:r.length,me:t.length});for(let a=0;a<r.length;a++){const o=t[a],c=o.transform,u=e.data.field(o.field);n.set(o.field,V6(c,u,r[a]))}return n}function H2(t,e,r){const n=new Map;for(const a of t){const o=a.transform,c=r.data.field(a.field);n.set(a.field,L6(o,c,e))}return n}class E1 extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class z6 extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&j6(o,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Pu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Pu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=sA();return this.mutations.forEach(a=>{const o=e.get(a.key),c=o.overlayedDocument;let u=this.applyToLocalView(c,o.mutatedFields);u=r.has(a.key)?null:u;const h=hA(c,u);h!==null&&n.set(a.key,h),c.isValidDocument()||c.convertToNoDocument(Je.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),mt())}isEqual(e){return this.batchId===e.batchId&&Jl(this.mutations,e.mutations,(r,n)=>B2(r,n))&&Jl(this.baseMutations,e.baseMutations,(r,n)=>B2(r,n))}}class T1{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Dt(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let a=function(){return D6}();const o=e.mutations;for(let c=0;c<o.length;c++)a=a.insert(o[c].key,n[c].version);return new T1(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gr,Tt;function K6(t){switch(t){case Ce.OK:return $e(64938);case Ce.CANCELLED:case Ce.UNKNOWN:case Ce.DEADLINE_EXCEEDED:case Ce.RESOURCE_EXHAUSTED:case Ce.INTERNAL:case Ce.UNAVAILABLE:case Ce.UNAUTHENTICATED:return!1;case Ce.INVALID_ARGUMENT:case Ce.NOT_FOUND:case Ce.ALREADY_EXISTS:case Ce.PERMISSION_DENIED:case Ce.FAILED_PRECONDITION:case Ce.ABORTED:case Ce.OUT_OF_RANGE:case Ce.UNIMPLEMENTED:case Ce.DATA_LOSS:return!0;default:return $e(15467,{code:t})}}function mA(t){if(t===void 0)return Hi("GRPC error has no .code"),Ce.UNKNOWN;switch(t){case gr.OK:return Ce.OK;case gr.CANCELLED:return Ce.CANCELLED;case gr.UNKNOWN:return Ce.UNKNOWN;case gr.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case gr.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case gr.INTERNAL:return Ce.INTERNAL;case gr.UNAVAILABLE:return Ce.UNAVAILABLE;case gr.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case gr.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case gr.NOT_FOUND:return Ce.NOT_FOUND;case gr.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case gr.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case gr.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case gr.ABORTED:return Ce.ABORTED;case gr.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case gr.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case gr.DATA_LOSS:return Ce.DATA_LOSS;default:return $e(39323,{code:t})}}(Tt=gr||(gr={}))[Tt.OK=0]="OK",Tt[Tt.CANCELLED=1]="CANCELLED",Tt[Tt.UNKNOWN=2]="UNKNOWN",Tt[Tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tt[Tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tt[Tt.NOT_FOUND=5]="NOT_FOUND",Tt[Tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tt[Tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tt[Tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tt[Tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tt[Tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tt[Tt.ABORTED=10]="ABORTED",Tt[Tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tt[Tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tt[Tt.INTERNAL=13]="INTERNAL",Tt[Tt.UNAVAILABLE=14]="UNAVAILABLE",Tt[Tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $6=new Fs([4294967295,4294967295],0);function z2(t){const e=Vw().encode(t),r=new Iw;return r.update(e),new Uint8Array(r.digest())}function G2(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Fs([r,n],0),new Fs([a,o],0)]}class w1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Su(`Invalid padding: ${r}`);if(n<0)throw new Su(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Su(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Su(`Invalid padding when bitmap length is 0: ${r}`);this.pe=8*e.length-r,this.ye=Fs.fromNumber(this.pe)}we(e,r,n){let a=e.add(r.multiply(Fs.fromNumber(n)));return a.compare($6)===1&&(a=new Fs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const r=z2(e),[n,a]=G2(r);for(let o=0;o<this.hashCount;o++){const c=this.we(n,a,o);if(!this.be(c))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new w1(o,a,r);return n.forEach(u=>c.insert(u)),c}insert(e){if(this.pe===0)return;const r=z2(e),[n,a]=G2(r);for(let o=0;o<this.hashCount;o++){const c=this.we(n,a,o);this.Se(c)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Su extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,r,n,a,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,_f.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new pd(Je.min(),a,new tr(ct),zi(),mt())}}class _f{constructor(e,r,n,a,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new _f(n,r,mt(),mt(),mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,r,n,a){this.De=e,this.removedTargetIds=r,this.key=n,this.ve=a}}class pA{constructor(e,r){this.targetId=e,this.Ce=r}}class gA{constructor(e,r,n=Qr.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class q2{constructor(){this.Fe=0,this.Me=X2(),this.xe=Qr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=mt(),r=mt(),n=mt();return this.Me.forEach((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:$e(38017,{changeType:o})}}),new _f(this.xe,this.Oe,e,r,n)}Qe(){this.Ne=!1,this.Me=X2()}$e(e,r){this.Ne=!0,this.Me=this.Me.insert(e,r)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Dt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class Y6{constructor(e){this.ze=e,this.je=new Map,this.He=zi(),this.Je=Q0(),this.Ye=Q0(),this.Ze=new tr(ct)}Xe(e){for(const r of e.De)e.ve&&e.ve.isFoundDocument()?this.et(r,e.ve):this.tt(r,e.key,e.ve);for(const r of e.removedTargetIds)this.tt(r,e.key,e.ve)}nt(e){this.forEachTarget(e,r=>{const n=this.rt(r);switch(e.state){case 0:this.it(r)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(r);break;case 3:this.it(r)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(r)&&(this.st(r),n.ke(e.resumeToken));break;default:$e(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.je.forEach((n,a)=>{this.it(a)&&r(a)})}ot(e){const r=e.targetId,n=e.Ce.count,a=this._t(r);if(a){const o=a.target;if(yg(o))if(n===0){const c=new qe(o.path);this.tt(r,c,sn.newNoDocument(c,Je.min()))}else Dt(n===1,20013,{expectedCount:n});else{const c=this.ut(r);if(c!==n){const u=this.ct(e),h=u?this.lt(u,e,c):1;if(h!==0){this.st(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(r,d)}}}}}ct(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:o=0}=r;let c,u;try{c=Us(n).toUint8Array()}catch(h){if(h instanceof Hw)return Zl("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new w1(c,a,o)}catch(h){return Zl(h instanceof Su?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.pe===0?null:u}lt(e,r,n){return r.Ce.count===n-this.Tt(e,r.targetId)?0:2}Tt(e,r){const n=this.ze.getRemoteKeysForTarget(r);let a=0;return n.forEach(o=>{const c=this.ze.Pt(),u=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.tt(r,o,null),a++)}),a}It(e){const r=new Map;this.je.forEach((o,c)=>{const u=this._t(c);if(u){if(o.current&&yg(u.target)){const h=new qe(u.target.path);this.Et(h).has(c)||this.dt(c,h)||this.tt(c,h,sn.newNoDocument(h,e))}o.Le&&(r.set(c,o.qe()),o.Qe())}});let n=mt();this.Ye.forEach((o,c)=>{let u=!0;c.forEachWhile(h=>{const d=this._t(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(o))}),this.He.forEach((o,c)=>c.setReadTime(e));const a=new pd(e,r,this.Ze,this.He,n);return this.He=zi(),this.Je=Q0(),this.Ye=Q0(),this.Ze=new tr(ct),a}et(e,r){if(!this.it(e))return;const n=this.dt(e,r.key)?2:0;this.rt(e).$e(r.key,n),this.He=this.He.insert(r.key,r),this.Je=this.Je.insert(r.key,this.Et(r.key).add(e)),this.Ye=this.Ye.insert(r.key,this.At(r.key).add(e))}tt(e,r,n){if(!this.it(e))return;const a=this.rt(e);this.dt(e,r)?a.$e(r,1):a.Ue(r),this.Ye=this.Ye.insert(r,this.At(r).delete(e)),this.Ye=this.Ye.insert(r,this.At(r).add(e)),n&&(this.He=this.He.insert(r,n))}removeTarget(e){this.je.delete(e)}ut(e){const r=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let r=this.je.get(e);return r||(r=new q2,this.je.set(e,r)),r}At(e){let r=this.Ye.get(e);return r||(r=new Cr(ct),this.Ye=this.Ye.insert(e,r)),r}Et(e){let r=this.Je.get(e);return r||(r=new Cr(ct),this.Je=this.Je.insert(e,r)),r}it(e){const r=this._t(e)!==null;return r||je("WatchChangeAggregator","Detected inactive target",e),r}_t(e){const r=this.je.get(e);return r&&r.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new q2),this.ze.getRemoteKeysForTarget(e).forEach(r=>{this.tt(e,r,null)})}dt(e,r){return this.ze.getRemoteKeysForTarget(e).has(r)}}function Q0(){return new tr(qe.comparator)}function X2(){return new tr(qe.comparator)}const W6={asc:"ASCENDING",desc:"DESCENDING"},Q6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Z6={and:"AND",or:"OR"};class J6{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Tg(t,e){return t.useProto3Json||ld(e)?e:{value:e}}function Lh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function eD(t,e){return Lh(t,e.toTimestamp())}function ei(t){return Dt(!!t,49232),Je.fromTimestamp(function(r){const n=Vs(r);return new kr(n.seconds,n.nanos)}(t))}function A1(t,e){return wg(t,e).canonicalString()}function wg(t,e){const r=function(a){return new Zt(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function xA(t){const e=Zt.fromString(t);return Dt(wA(e),10190,{key:e.toString()}),e}function Ag(t,e){return A1(t.databaseId,e.path)}function Hp(t,e){const r=xA(e);if(r.get(1)!==t.databaseId.projectId)throw new ze(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ze(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new qe(yA(r))}function _A(t,e){return A1(t.databaseId,e)}function tD(t){const e=xA(t);return e.length===4?Zt.emptyPath():yA(e)}function Sg(t){return new Zt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yA(t){return Dt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function K2(t,e,r){return{name:Ag(t,e),fields:r.value.mapValue.fields}}function rD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:$e(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=function(d,g){return d.useProto3Json?(Dt(g===void 0||typeof g=="string",58123),Qr.fromBase64String(g||"")):(Dt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Qr.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),c=e.targetChange.cause,u=c&&function(d){const g=d.code===void 0?Ce.UNKNOWN:mA(d.code);return new ze(g,d.message||"")}(c);r=new gA(n,a,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Hp(t,n.document.name),o=ei(n.document.updateTime),c=n.document.createTime?ei(n.document.createTime):Je.min(),u=new Mn({mapValue:{fields:n.document.fields}}),h=sn.newFoundDocument(a,o,c,u),d=n.targetIds||[],g=n.removedTargetIds||[];r=new xh(d,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Hp(t,n.document),o=n.readTime?ei(n.readTime):Je.min(),c=sn.newNoDocument(a,o),u=n.removedTargetIds||[];r=new xh([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Hp(t,n.document),o=n.removedTargetIds||[];r=new xh([],o,a,null)}else{if(!("filter"in e))return $e(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:o}=n,c=new X6(a,o),u=n.targetId;r=new pA(u,c)}}return r}function nD(t,e){let r;if(e instanceof xf)r={update:K2(t,e.key,e.value)};else if(e instanceof E1)r={delete:Ag(t,e.key)};else if(e instanceof $s)r={update:K2(t,e.key,e.data),updateMask:hD(e.fieldMask)};else{if(!(e instanceof z6))return $e(16599,{ft:e.type});r={verify:Ag(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,c){const u=c.transform;if(u instanceof Mh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Ju)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ef)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ph)return{fieldPath:c.field.canonicalString(),increment:u.Re};throw $e(20930,{transform:c.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,o){return o.updateTime!==void 0?{updateTime:eD(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:$e(27497)}(t,e.precondition)),r}function aD(t,e){return t&&t.length>0?(Dt(e!==void 0,14353),t.map(r=>function(a,o){let c=a.updateTime?ei(a.updateTime):ei(o);return c.isEqual(Je.min())&&(c=ei(o)),new B6(c,a.transformResults||[])}(r,e))):[]}function iD(t,e){return{documents:[_A(t,e.path)]}}function sD(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=_A(t,a);const o=function(d){if(d.length!==0)return TA(ni.create(d,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const c=function(d){if(d.length!==0)return d.map(g=>function(_){return{field:Ul(_.field),direction:cD(_.dir)}}(g))}(e.orderBy);c&&(r.structuredQuery.orderBy=c);const u=Tg(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{gt:r,parent:a}}function oD(t){let e=tD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Dt(n===1,65062);const g=r.from[0];g.allDescendants?a=g.collectionId:e=e.child(g.collectionId)}let o=[];r.where&&(o=function(x){const _=EA(x);return _ instanceof ni&&Zw(_)?_.getFilters():[_]}(r.where));let c=[];r.orderBy&&(c=function(x){return x.map(_=>function(y){return new Fh(Bl(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(_))}(r.orderBy));let u=null;r.limit&&(u=function(x){let _;return _=typeof x=="object"?x.value:x,ld(_)?null:_}(r.limit));let h=null;r.startAt&&(h=function(x){const _=!!x.before,T=x.values||[];return new Oh(T,_)}(r.startAt));let d=null;return r.endAt&&(d=function(x){const _=!x.before,T=x.values||[];return new Oh(T,_)}(r.endAt)),b6(e,a,c,o,u,"F",h,d)}function lD(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $e(28987,{purpose:a})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function EA(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Bl(r.unaryFilter.field);return Sr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Bl(r.unaryFilter.field);return Sr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Bl(r.unaryFilter.field);return Sr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Bl(r.unaryFilter.field);return Sr.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $e(61313);default:return $e(60726)}}(t):t.fieldFilter!==void 0?function(r){return Sr.create(Bl(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $e(58110);default:return $e(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ni.create(r.compositeFilter.filters.map(n=>EA(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return $e(1026)}}(r.compositeFilter.op))}(t):$e(30097,{filter:t})}function cD(t){return W6[t]}function uD(t){return Q6[t]}function fD(t){return Z6[t]}function Ul(t){return{fieldPath:t.canonicalString()}}function Bl(t){return Kr.fromServerFormat(t.fieldPath)}function TA(t){return t instanceof Sr?function(r){if(r.op==="=="){if(F2(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NAN"}};if(O2(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(F2(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NOT_NAN"}};if(O2(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ul(r.field),op:uD(r.op),value:r.value}}}(t):t instanceof ni?function(r){const n=r.getFilters().map(a=>TA(a));return n.length===1?n[0]:{compositeFilter:{op:fD(r.op),filters:n}}}(t):$e(54877,{filter:t})}function hD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function wA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,r,n,a,o=Je.min(),c=Je.min(),u=Qr.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e){this.wt=e}}function mD(t){const e=oD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Eg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(){this.Cn=new gD}addToCollectionParentIndex(e,r){return this.Cn.add(r),Se.resolve()}getCollectionParents(e,r){return Se.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Se.resolve()}deleteFieldIndex(e,r){return Se.resolve()}deleteAllFieldIndexes(e){return Se.resolve()}createTargetIndexes(e,r){return Se.resolve()}getDocumentsMatchingTarget(e,r){return Se.resolve(null)}getIndexType(e,r){return Se.resolve(0)}getFieldIndexes(e,r){return Se.resolve([])}getNextCollectionGroupToUpdate(e){return Se.resolve(null)}getMinOffset(e,r){return Se.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,r){return Se.resolve(Ls.min())}updateCollectionGroup(e,r,n){return Se.resolve()}updateIndexEntries(e,r){return Se.resolve()}}class gD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new Cr(Zt.comparator),o=!a.has(n);return this.index[r]=a.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new Cr(Zt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},AA=41943040;class Fn{static withCacheSize(e){return new Fn(e,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(AA,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new rc(0)}static lr(){return new rc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2="LruGarbageCollector",vD=1048576;function W2([t,e],[r,n]){const a=ct(t,r);return a===0?ct(e,n):a}class xD{constructor(e){this.Er=e,this.buffer=new Cr(W2),this.dr=0}Ar(){return++this.dr}Rr(e){const r=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();W2(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class _D{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){je(Y2,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){mc(r)?je(Y2,"Ignoring IndexedDB error during garbage collection: ",r):await dc(r)}await this.mr(3e5)})}}class yD{constructor(e,r){this.gr=e,this.params=r}calculateTargetCount(e,r){return this.gr.pr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Se.resolve(od.le);const n=new xD(r);return this.gr.forEachTarget(e,a=>n.Rr(a.sequenceNumber)).next(()=>this.gr.yr(e,a=>n.Rr(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.gr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.gr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),Se.resolve($2)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$2):this.wr(e,r))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,r){let n,a,o,c,u,h,d;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(x=>(x>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,c=Date.now(),this.nthSequenceNumber(e,a))).next(x=>(n=x,u=Date.now(),this.removeTargets(e,n,r))).next(x=>(o=x,h=Date.now(),this.removeOrphanedDocuments(e,n))).next(x=>(d=Date.now(),Ll()<=dt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${a} in `+(u-c)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${x} documents in `+(d-h)+`ms
Total Duration: ${d-g}ms`),Se.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:x})))}}function ED(t,e){return new yD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(){this.changes=new Ho(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,sn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Se.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&Pu(n.mutation,a,Kn.empty(),kr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,mt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=mt()){const a=Co();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(o=>{let c=Au();return o.forEach((u,h)=>{c=c.insert(u,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,r){const n=Co();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,mt()))}populateOverlays(e,r,n){const a=[];return n.forEach(o=>{r.has(o)||a.push(o)}),this.documentOverlayCache.getOverlays(e,a).next(o=>{o.forEach((c,u)=>{r.set(c,u)})})}computeViews(e,r,n,a){let o=zi();const c=Mu(),u=function(){return Mu()}();return r.forEach((h,d)=>{const g=n.get(d.key);a.has(d.key)&&(g===void 0||g.mutation instanceof $s)?o=o.insert(d.key,d):g!==void 0?(c.set(d.key,g.mutation.getFieldMask()),Pu(g.mutation,d,g.mutation.getFieldMask(),kr.now())):c.set(d.key,Kn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,g)=>c.set(d,g)),r.forEach((d,g)=>{var x;return u.set(d,new wD(g,(x=c.get(d))!==null&&x!==void 0?x:null))}),u))}recalculateAndSaveOverlays(e,r){const n=Mu();let a=new tr((c,u)=>c-u),o=mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(c=>{for(const u of c)u.keys().forEach(h=>{const d=r.get(h);if(d===null)return;let g=n.get(h)||Kn.empty();g=u.applyToLocalView(d,g),n.set(h,g);const x=(a.get(u.batchId)||mt()).add(h);a=a.insert(u.batchId,x)})}).next(()=>{const c=[],u=a.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,g=h.value,x=sA();g.forEach(_=>{if(!o.has(_)){const T=hA(r.get(_),n.get(_));T!==null&&x.set(_,T),o=o.add(_)}}),c.push(this.documentOverlayCache.saveOverlays(e,d,x))}return Se.waitFor(c)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(c){return qe.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):k6(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(o=>{const c=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-o.size):Se.resolve(Co());let u=Yu,h=o;return c.next(d=>Se.forEach(d,(g,x)=>(u<x.largestBatchId&&(u=x.largestBatchId),o.get(g)?Se.resolve():this.remoteDocumentCache.getEntry(e,g).next(_=>{h=h.insert(g,_)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,mt())).next(g=>({batchId:u,changes:iA(g)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new qe(r)).next(n=>{let a=Au();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const o=r.collectionGroup;let c=Au();return this.indexManager.getCollectionParents(e,o).next(u=>Se.forEach(u,h=>{const d=function(x,_){return new ud(_,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)}(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next(g=>{g.forEach((x,_)=>{c=c.insert(x,_)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,r,n,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,a))).next(c=>{o.forEach((h,d)=>{const g=d.getKey();c.get(g)===null&&(c=c.insert(g,sn.newInvalidDocument(g)))});let u=Au();return c.forEach((h,d)=>{const g=o.get(h);g!==void 0&&Pu(g.mutation,d,Kn.empty(),kr.now()),hd(r,d)&&(u=u.insert(h,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,r){return Se.resolve(this.kr.get(r))}saveBundleMetadata(e,r){return this.kr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:ei(a.createTime)}}(r)),Se.resolve()}getNamedQuery(e,r){return Se.resolve(this.qr.get(r))}saveNamedQuery(e,r){return this.qr.set(r.name,function(a){return{name:a.name,query:mD(a.bundledQuery),readTime:ei(a.readTime)}}(r)),Se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(){this.overlays=new tr(qe.comparator),this.Qr=new Map}getOverlay(e,r){return Se.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Co();return Se.forEach(r,a=>this.getOverlay(e,a).next(o=>{o!==null&&n.set(a,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,o)=>{this.St(e,r,o)}),Se.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Qr.get(n);return a!==void 0&&(a.forEach(o=>this.overlays=this.overlays.remove(o)),this.Qr.delete(n)),Se.resolve()}getOverlaysForCollection(e,r,n){const a=Co(),o=r.length+1,c=new qe(r.child("")),u=this.overlays.getIteratorFrom(c);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&a.set(h.getKey(),h)}return Se.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let o=new tr((d,g)=>d-g);const c=this.overlays.getIterator();for(;c.hasNext();){const d=c.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let g=o.get(d.largestBatchId);g===null&&(g=Co(),o=o.insert(d.largestBatchId,g)),g.set(d.getKey(),d)}}const u=Co(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,g)=>u.set(d,g)),!(u.size()>=a)););return Se.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const c=this.Qr.get(a.largestBatchId).delete(n.key);this.Qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new q6(r,n));let o=this.Qr.get(r);o===void 0&&(o=mt(),this.Qr.set(r,o)),this.Qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(){this.sessionToken=Qr.EMPTY_BYTE_STRING}getSessionToken(e){return Se.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(){this.$r=new Cr(Pr.Ur),this.Kr=new Cr(Pr.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,r){const n=new Pr(e,r);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.zr(new Pr(e,r))}jr(e,r){e.forEach(n=>this.removeReference(n,r))}Hr(e){const r=new qe(new Zt([])),n=new Pr(r,e),a=new Pr(r,e+1),o=[];return this.Kr.forEachInRange([n,a],c=>{this.zr(c),o.push(c.key)}),o}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const r=new qe(new Zt([])),n=new Pr(r,e),a=new Pr(r,e+1);let o=mt();return this.Kr.forEachInRange([n,a],c=>{o=o.add(c.key)}),o}containsKey(e){const r=new Pr(e,0),n=this.$r.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Pr{constructor(e,r){this.key=e,this.Zr=r}static Ur(e,r){return qe.comparator(e.key,r.key)||ct(e.Zr,r.Zr)}static Wr(e,r){return ct(e.Zr,r.Zr)||qe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.nr=1,this.Xr=new Cr(Pr.Ur)}checkEmpty(e){return Se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const o=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new G6(o,r,n,a);this.mutationQueue.push(c);for(const u of a)this.Xr=this.Xr.add(new Pr(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Se.resolve(c)}lookupMutationBatch(e,r){return Se.resolve(this.ei(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ti(n),o=a<0?0:a;return Se.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Se.resolve(this.mutationQueue.length===0?m1:this.nr-1)}getAllMutationBatches(e){return Se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Pr(r,0),a=new Pr(r,Number.POSITIVE_INFINITY),o=[];return this.Xr.forEachInRange([n,a],c=>{const u=this.ei(c.Zr);o.push(u)}),Se.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Cr(ct);return r.forEach(a=>{const o=new Pr(a,0),c=new Pr(a,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([o,c],u=>{n=n.add(u.Zr)})}),Se.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let o=n;qe.isDocumentKey(o)||(o=o.child(""));const c=new Pr(new qe(o),0);let u=new Cr(ct);return this.Xr.forEachWhile(h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(h.Zr)),!0)},c),Se.resolve(this.ni(u))}ni(e){const r=[];return e.forEach(n=>{const a=this.ei(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){Dt(this.ri(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return Se.forEach(r.mutations,a=>{const o=new Pr(a.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,r){const n=new Pr(r,0),a=this.Xr.firstAfterOrEqual(n);return Se.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Se.resolve()}ri(e,r){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const r=this.ti(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.ii=e,this.docs=function(){return new tr(qe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),o=a?a.size:0,c=this.ii(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Se.resolve(n?n.document.mutableCopy():sn.newInvalidDocument(r))}getEntries(e,r){let n=zi();return r.forEach(a=>{const o=this.docs.get(a);n=n.insert(a,o?o.document.mutableCopy():sn.newInvalidDocument(a))}),Se.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let o=zi();const c=r.path,u=new qe(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:g}}=h.getNext();if(!c.isPrefixOf(d.path))break;d.path.length>c.length+1||a6(n6(g),n)<=0||(a.has(g.key)||hd(r,g))&&(o=o.insert(g.key,g.mutableCopy()))}return Se.resolve(o)}getAllFromCollectionGroup(e,r,n,a){$e(9500)}si(e,r){return Se.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new ID(this)}getSize(e){return Se.resolve(this.size)}}class ID extends TD{constructor(e){super(),this.Br=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.Br.addEntry(e,a)):this.Br.removeEntry(n)}),Se.waitFor(r)}getFromCache(e,r){return this.Br.getEntry(e,r)}getAllFromCache(e,r){return this.Br.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.persistence=e,this.oi=new Ho(r=>v1(r),x1),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this._i=0,this.ai=new S1,this.targetCount=0,this.ui=rc.cr()}forEachTarget(e,r){return this.oi.forEach((n,a)=>r(a)),Se.resolve()}getLastRemoteSnapshotVersion(e){return Se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Se.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),Se.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this._i&&(this._i=r),Se.resolve()}Tr(e){this.oi.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ui=new rc(r),this.highestTargetId=r),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,r){return this.Tr(r),this.targetCount+=1,Se.resolve()}updateTargetData(e,r){return this.Tr(r),Se.resolve()}removeTargetData(e,r){return this.oi.delete(r.target),this.ai.Hr(r.targetId),this.targetCount-=1,Se.resolve()}removeTargets(e,r,n){let a=0;const o=[];return this.oi.forEach((c,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.oi.delete(c),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)}),Se.waitFor(o).next(()=>a)}getTargetCount(e){return Se.resolve(this.targetCount)}getTargetData(e,r){const n=this.oi.get(r)||null;return Se.resolve(n)}addMatchingKeys(e,r,n){return this.ai.Gr(r,n),Se.resolve()}removeMatchingKeys(e,r,n){this.ai.jr(r,n);const a=this.persistence.referenceDelegate,o=[];return a&&r.forEach(c=>{o.push(a.markPotentiallyOrphaned(e,c))}),Se.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.ai.Hr(r),Se.resolve()}getMatchingKeysForTargetId(e,r){const n=this.ai.Yr(r);return Se.resolve(n)}containsKey(e,r){return Se.resolve(this.ai.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,r){this.ci={},this.overlays={},this.li=new od(0),this.hi=!1,this.hi=!0,this.Pi=new kD,this.referenceDelegate=e(this),this.Ti=new ND(this),this.indexManager=new pD,this.remoteDocumentCache=function(a){return new RD(a)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new dD(r),this.Ei=new SD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new bD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ci[e.toKey()];return n||(n=new CD(r,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,r,n){je("MemoryPersistence","Starting transaction:",e);const a=new DD(this.li.next());return this.referenceDelegate.di(),n(a).next(o=>this.referenceDelegate.Ai(a).next(()=>o)).toPromise().then(o=>(a.raiseOnCommittedEvent(),o))}Ri(e,r){return Se.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,r)))}}class DD extends s6{constructor(e){super(),this.currentSequenceNumber=e}}class b1{constructor(e){this.persistence=e,this.Vi=new S1,this.mi=null}static fi(e){return new b1(e)}get gi(){if(this.mi)return this.mi;throw $e(60996)}addReference(e,r,n){return this.Vi.addReference(n,r),this.gi.delete(n.toString()),Se.resolve()}removeReference(e,r,n){return this.Vi.removeReference(n,r),this.gi.add(n.toString()),Se.resolve()}markPotentiallyOrphaned(e,r){return this.gi.add(r.toString()),Se.resolve()}removeTarget(e,r){this.Vi.Hr(r.targetId).forEach(a=>this.gi.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(o=>this.gi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}di(){this.mi=new Set}Ai(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Se.forEach(this.gi,n=>{const a=qe.fromPath(n);return this.pi(e,a).next(o=>{o||r.removeEntry(a,Je.min())})}).next(()=>(this.mi=null,r.apply(e)))}updateLimboDocument(e,r){return this.pi(e,r).next(n=>{n?this.gi.delete(r.toString()):this.gi.add(r.toString())})}Ii(e){return 0}pi(e,r){return Se.or([()=>Se.resolve(this.Vi.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ri(e,r)])}}class Vh{constructor(e,r){this.persistence=e,this.yi=new Ho(n=>c6(n.path),(n,a)=>n.isEqual(a)),this.garbageCollector=ED(this,r)}static fi(e,r){return new Vh(e,r)}di(){}Ai(e){return Se.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}pr(e){const r=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}br(e){let r=0;return this.yr(e,n=>{r++}).next(()=>r)}yr(e,r){return Se.forEach(this.yi,(n,a)=>this.Dr(e,n,a).next(o=>o?Se.resolve():r(a)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.si(e,c=>this.Dr(e,c,r).next(u=>{u||(n++,o.removeEntry(c,Je.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.yi.set(r,e.currentSequenceNumber),Se.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),Se.resolve()}removeReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),Se.resolve()}updateLimboDocument(e,r){return this.yi.set(r,e.currentSequenceNumber),Se.resolve()}Ii(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=ph(e.data.value)),r}Dr(e,r,n){return Se.or([()=>this.persistence.Ri(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.yi.get(r);return Se.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.ds=n,this.As=a}static Rs(e,r){let n=mt(),a=mt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new k1(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return IR()?8:o6(un())>0?6:4}()}initialize(e,r){this.ys=e,this.indexManager=r,this.Vs=!0}getDocumentsMatchingQuery(e,r,n,a){const o={result:null};return this.ws(e,r).next(c=>{o.result=c}).next(()=>{if(!o.result)return this.bs(e,r,a,n).next(c=>{o.result=c})}).next(()=>{if(o.result)return;const c=new OD;return this.Ss(e,r,c).next(u=>{if(o.result=u,this.fs)return this.Ds(e,r,c,u.size)})}).next(()=>o.result)}Ds(e,r,n,a){return n.documentReadCount<this.gs?(Ll()<=dt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Vl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),Se.resolve()):(Ll()<=dt.DEBUG&&je("QueryEngine","Query:",Vl(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.ps*a?(Ll()<=dt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Vl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ja(r))):Se.resolve())}ws(e,r){if(V2(r))return Se.resolve(null);let n=Ja(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=Eg(r,null,"F"),n=Ja(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const c=mt(...o);return this.ys.getDocuments(e,c).next(u=>this.indexManager.getMinOffset(e,n).next(h=>{const d=this.vs(r,u);return this.Cs(r,d,c,h.readTime)?this.ws(e,Eg(r,null,"F")):this.Fs(e,d,r,h)}))})))}bs(e,r,n,a){return V2(r)||a.isEqual(Je.min())?Se.resolve(null):this.ys.getDocuments(e,n).next(o=>{const c=this.vs(r,o);return this.Cs(r,c,n,a)?Se.resolve(null):(Ll()<=dt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Vl(r)),this.Fs(e,c,r,r6(a,Yu)).next(u=>u))})}vs(e,r){let n=new Cr(nA(e));return r.forEach((a,o)=>{hd(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}Ss(e,r,n){return Ll()<=dt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Vl(r)),this.ys.getDocumentsMatchingQuery(e,r,Ls.min(),n)}Fs(e,r,n,a){return this.ys.getDocumentsMatchingQuery(e,n,a).next(o=>(r.forEach(c=>{o=o.insert(c.key,c)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1="LocalStore",MD=3e8;class PD{constructor(e,r,n,a){this.persistence=e,this.Ms=r,this.serializer=a,this.xs=new tr(ct),this.Os=new Ho(o=>v1(o),x1),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new AD(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.xs))}}function LD(t,e,r,n){return new PD(t,e,r,n)}async function bA(t,e){const r=tt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(o=>(a=o,r.Ls(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const c=[],u=[];let h=mt();for(const d of a){c.push(d.batchId);for(const g of d.mutations)h=h.add(g.key)}for(const d of o){u.push(d.batchId);for(const g of d.mutations)h=h.add(g.key)}return r.localDocuments.getDocuments(n,h).next(d=>({ks:d,removedBatchIds:c,addedBatchIds:u}))})})}function VD(t,e){const r=tt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),o=r.Bs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,g){const x=d.batch,_=x.keys();let T=Se.resolve();return _.forEach(y=>{T=T.next(()=>g.getEntry(h,y)).next(A=>{const w=d.docVersions.get(y);Dt(w!==null,48541),A.version.compareTo(w)<0&&(x.applyToRemoteDocument(A,d),A.isValidDocument()&&(A.setReadTime(d.commitVersion),g.addEntry(A)))})}),T.next(()=>u.mutationQueue.removeMutationBatch(h,x))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let h=mt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function kA(t){const e=tt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ti.getLastRemoteSnapshotVersion(r))}function UD(t,e){const r=tt(t),n=e.snapshotVersion;let a=r.xs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const c=r.Bs.newChangeBuffer({trackRemovals:!0});a=r.xs;const u=[];e.targetChanges.forEach((g,x)=>{const _=a.get(x);if(!_)return;u.push(r.Ti.removeMatchingKeys(o,g.removedDocuments,x).next(()=>r.Ti.addMatchingKeys(o,g.addedDocuments,x)));let T=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(x)!==null?T=T.withResumeToken(Qr.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,n)),a=a.insert(x,T),function(A,w,N){return A.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=MD?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(_,T,g)&&u.push(r.Ti.updateTargetData(o,T))});let h=zi(),d=mt();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(BD(o,c,e.documentUpdates).next(g=>{h=g.qs,d=g.Qs})),!n.isEqual(Je.min())){const g=r.Ti.getLastRemoteSnapshotVersion(o).next(x=>r.Ti.setTargetsMetadata(o,o.currentSequenceNumber,n));u.push(g)}return Se.waitFor(u).next(()=>c.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(r.xs=a,o))}function BD(t,e,r){let n=mt(),a=mt();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let c=zi();return r.forEach((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),h.isNoDocument()&&h.version.isEqual(Je.min())?(e.removeEntry(u,h.readTime),c=c.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),c=c.insert(u,h)):je(C1,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{qs:c,Qs:a}})}function jD(t,e){const r=tt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=m1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function HD(t,e){const r=tt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Ti.getTargetData(n,e).next(o=>o?(a=o,Se.resolve(a)):r.Ti.allocateTargetId(n).next(c=>(a=new Cs(e,c,"TargetPurposeListen",n.currentSequenceNumber),r.Ti.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.xs.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.xs=r.xs.insert(n.targetId,n),r.Os.set(e,n.targetId)),n})}async function bg(t,e,r){const n=tt(t),a=n.xs.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,c=>n.persistence.referenceDelegate.removeTarget(c,a))}catch(c){if(!mc(c))throw c;je(C1,`Failed to update sequence numbers for target ${e}: ${c}`)}n.xs=n.xs.remove(e),n.Os.delete(a.target)}function Q2(t,e,r){const n=tt(t);let a=Je.min(),o=mt();return n.persistence.runTransaction("Execute query","readwrite",c=>function(h,d,g){const x=tt(h),_=x.Os.get(g);return _!==void 0?Se.resolve(x.xs.get(_)):x.Ti.getTargetData(d,g)}(n,c,Ja(e)).next(u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(c,u.targetId).next(h=>{o=h})}).next(()=>n.Ms.getDocumentsMatchingQuery(c,e,r?a:Je.min(),r?o:mt())).next(u=>(zD(n,R6(e),u),{documents:u,$s:o})))}function zD(t,e,r){let n=t.Ns.get(e)||Je.min();r.forEach((a,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Ns.set(e,n)}class Z2{constructor(){this.activeTargetIds=M6()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GD{constructor(){this.xo=new Z2,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,r,n){this.Oo[e]=r}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Z2,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2="ConnectivityMonitor";class eE{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){je(J2,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){je(J2,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0=null;function kg(){return Z0===null?Z0=function(){return 268435456+Math.round(2147483648*Math.random())}():Z0++,"0x"+Z0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="RestConnection",XD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class KD{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Ko=r+"://"+e.host,this.Wo=`projects/${n}/databases/${a}`,this.Go=this.databaseId.database===Nh?`project_id=${n}`:`project_id=${n}&database_id=${a}`}zo(e,r,n,a,o){const c=kg(),u=this.jo(e,r.toUriEncodedString());je(zp,`Sending RPC '${e}' ${c}:`,u,n);const h={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(h,a,o);const{host:d}=new URL(u),g=cc(d);return this.Jo(e,u,h,n,g).then(x=>(je(zp,`Received RPC '${e}' ${c}: `,x),x),x=>{throw Zl(zp,`RPC '${e}' ${c} failed with error: `,x,"url: ",u,"request:",n),x})}Yo(e,r,n,a,o,c){return this.zo(e,r,n,a,o)}Ho(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+hc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,o)=>e[o]=a),n&&n.headers.forEach((a,o)=>e[o]=a)}jo(e,r){const n=XD[e];return`${this.Ko}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="WebChannelConnection";class YD extends KD{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,o){const c=kg();return new Promise((u,h)=>{const d=new Nw;d.setWithCredentials(!0),d.listenOnce(Dw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case mh.NO_ERROR:const x=d.getResponseJson();je(tn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(x)),u(x);break;case mh.TIMEOUT:je(tn,`RPC '${e}' ${c} timed out`),h(new ze(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case mh.HTTP_ERROR:const _=d.getStatus();if(je(tn,`RPC '${e}' ${c} failed with status:`,_,"response text:",d.getResponseText()),_>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const y=T==null?void 0:T.error;if(y&&y.status&&y.message){const A=function(N){const U=N.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(U)>=0?U:Ce.UNKNOWN}(y.status);h(new ze(A,y.message))}else h(new ze(Ce.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new ze(Ce.UNAVAILABLE,"Connection failed."));break;default:$e(9055,{h_:e,streamId:c,P_:d.getLastErrorCode(),T_:d.getLastError()})}}finally{je(tn,`RPC '${e}' ${c} completed.`)}});const g=JSON.stringify(a);je(tn,`RPC '${e}' ${c} sending request:`,a),d.send(r,"POST",g,n,15)})}I_(e,r,n){const a=kg(),o=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Mw(),u=Fw(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Ho(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const g=o.join("");je(tn,`Creating RPC '${e}' stream ${a}: ${g}`,h);const x=c.createWebChannel(g,h);this.E_(x);let _=!1,T=!1;const y=new $D({Zo:w=>{T?je(tn,`Not sending because RPC '${e}' stream ${a} is closed:`,w):(_||(je(tn,`Opening RPC '${e}' stream ${a} transport.`),x.open(),_=!0),je(tn,`RPC '${e}' stream ${a} sending:`,w),x.send(w))},Xo:()=>x.close()}),A=(w,N,U)=>{w.listen(N,R=>{try{U(R)}catch(K){setTimeout(()=>{throw K},0)}})};return A(x,wu.EventType.OPEN,()=>{T||(je(tn,`RPC '${e}' stream ${a} transport opened.`),y.__())}),A(x,wu.EventType.CLOSE,()=>{T||(T=!0,je(tn,`RPC '${e}' stream ${a} transport closed`),y.u_(),this.d_(x))}),A(x,wu.EventType.ERROR,w=>{T||(T=!0,Zl(tn,`RPC '${e}' stream ${a} transport errored. Name:`,w.name,"Message:",w.message),y.u_(new ze(Ce.UNAVAILABLE,"The operation could not be completed")))}),A(x,wu.EventType.MESSAGE,w=>{var N;if(!T){const U=w.data[0];Dt(!!U,16349);const R=U,K=(R==null?void 0:R.error)||((N=R[0])===null||N===void 0?void 0:N.error);if(K){je(tn,`RPC '${e}' stream ${a} received error:`,K);const te=K.status;let J=function(C){const V=gr[C];if(V!==void 0)return mA(V)}(te),b=K.message;J===void 0&&(J=Ce.INTERNAL,b="Unknown error status: "+te+" with message "+K.message),T=!0,y.u_(new ze(J,b)),x.close()}else je(tn,`RPC '${e}' stream ${a} received:`,U),y.c_(U)}}),A(u,Ow.STAT_EVENT,w=>{w.stat===pg.PROXY?je(tn,`RPC '${e}' stream ${a} detected buffering proxy`):w.stat===pg.NOPROXY&&je(tn,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{y.a_()},0),y}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(r=>r===e)}}function Gp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(t){return new J6(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,r,n=1e3,a=1.5,o=6e4){this.xi=e,this.timerId=r,this.A_=n,this.R_=a,this.V_=o,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const r=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),a=Math.max(0,r-n);a>0&&je("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.m_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,a,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE="PersistentStream";class RA{constructor(e,r,n,a,o,c,u,h){this.xi=e,this.S_=n,this.D_=a,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new CA(e,r)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,r){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():r&&r.code===Ce.RESOURCE_EXHAUSTED?(Hi(r.toString()),Hi("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):r&&r.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(r)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),r=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.v_===r&&this.z_(n,a)},n=>{e(()=>{const a=new ze(Ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(a)})})}z_(e,r){const n=this.G_(this.v_);this.stream=this.H_(e,r),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(a=>{n(()=>this.j_(a))}),this.stream.onMessage(a=>{n(()=>++this.M_==1?this.J_(a):this.onNext(a))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return je(tE,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return r=>{this.xi.enqueueAndForget(()=>this.v_===e?r():(je(tE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class WD extends RA{constructor(e,r,n,a,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,c),this.serializer=o}H_(e,r){return this.connection.I_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const r=rD(this.serializer,e),n=function(o){if(!("targetChange"in o))return Je.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Je.min():c.readTime?ei(c.readTime):Je.min()}(e);return this.listener.Y_(r,n)}Z_(e){const r={};r.database=Sg(this.serializer),r.addTarget=function(o,c){let u;const h=c.target;if(u=yg(h)?{documents:iD(o,h)}:{query:sD(o,h).gt},u.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){u.resumeToken=vA(o,c.resumeToken);const d=Tg(o,c.expectedCount);d!==null&&(u.expectedCount=d)}else if(c.snapshotVersion.compareTo(Je.min())>0){u.readTime=Lh(o,c.snapshotVersion.toTimestamp());const d=Tg(o,c.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const n=lD(this.serializer,e);n&&(r.labels=n),this.Q_(r)}X_(e){const r={};r.database=Sg(this.serializer),r.removeTarget=e,this.Q_(r)}}class QD extends RA{constructor(e,r,n,a,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,c),this.serializer=o}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,r){return this.connection.I_("Write",e,r)}J_(e){return Dt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Dt(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Dt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const r=aD(e.writeResults,e.commitTime),n=ei(e.commitTime);return this.listener.ra(n,r)}ia(){const e={};e.database=Sg(this.serializer),this.Q_(e)}ta(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>nD(this.serializer,n))};this.Q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{}class JD extends ZD{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.sa=!1}oa(){if(this.sa)throw new ze(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,r,n,a){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.zo(e,wg(r,n),a,o,c)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ze(Ce.UNKNOWN,o.toString())})}Yo(e,r,n,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,u])=>this.connection.Yo(e,wg(r,n),a,c,u,o)).catch(c=>{throw c.name==="FirebaseError"?(c.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ze(Ce.UNKNOWN,c.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class eO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Hi(r),this.ua=!1):je("OnlineStateTracker",r)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo="RemoteStore";class tO{constructor(e,r,n,a,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=o,this.Ra.No(c=>{n.enqueueAndForget(async()=>{zo(this)&&(je(Lo,"Restarting streams for network reachability change."),await async function(h){const d=tt(h);d.da.add(4),await yf(d),d.Va.set("Unknown"),d.da.delete(4),await vd(d)}(this))})}),this.Va=new eO(n,a)}}async function vd(t){if(zo(t))for(const e of t.Aa)await e(!0)}async function yf(t){for(const e of t.Aa)await e(!1)}function IA(t,e){const r=tt(t);r.Ea.has(e.targetId)||(r.Ea.set(e.targetId,e),D1(r)?N1(r):pc(r).N_()&&I1(r,e))}function R1(t,e){const r=tt(t),n=pc(r);r.Ea.delete(e),n.N_()&&NA(r,e),r.Ea.size===0&&(n.N_()?n.k_():zo(r)&&r.Va.set("Unknown"))}function I1(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}pc(t).Z_(e)}function NA(t,e){t.ma.Ke(e),pc(t).X_(e)}function N1(t){t.ma=new Y6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),pc(t).start(),t.Va.ca()}function D1(t){return zo(t)&&!pc(t).O_()&&t.Ea.size>0}function zo(t){return tt(t).da.size===0}function DA(t){t.ma=void 0}async function rO(t){t.Va.set("Online")}async function nO(t){t.Ea.forEach((e,r)=>{I1(t,e)})}async function aO(t,e){DA(t),D1(t)?(t.Va.Pa(e),N1(t)):t.Va.set("Unknown")}async function iO(t,e,r){if(t.Va.set("Online"),e instanceof gA&&e.state===2&&e.cause)try{await async function(a,o){const c=o.cause;for(const u of o.targetIds)a.Ea.has(u)&&(await a.remoteSyncer.rejectListen(u,c),a.Ea.delete(u),a.ma.removeTarget(u))}(t,e)}catch(n){je(Lo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Uh(t,n)}else if(e instanceof xh?t.ma.Xe(e):e instanceof pA?t.ma.ot(e):t.ma.nt(e),!r.isEqual(Je.min()))try{const n=await kA(t.localStore);r.compareTo(n)>=0&&await function(o,c){const u=o.ma.It(c);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const g=o.Ea.get(d);g&&o.Ea.set(d,g.withResumeToken(h.resumeToken,c))}}),u.targetMismatches.forEach((h,d)=>{const g=o.Ea.get(h);if(!g)return;o.Ea.set(h,g.withResumeToken(Qr.EMPTY_BYTE_STRING,g.snapshotVersion)),NA(o,h);const x=new Cs(g.target,h,d,g.sequenceNumber);I1(o,x)}),o.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){je(Lo,"Failed to raise snapshot:",n),await Uh(t,n)}}async function Uh(t,e,r){if(!mc(e))throw e;t.da.add(1),await yf(t),t.Va.set("Offline"),r||(r=()=>kA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je(Lo,"Retrying IndexedDB access"),await r(),t.da.delete(1),await vd(t)})}function OA(t,e){return e().catch(r=>Uh(t,r,e))}async function xd(t){const e=tt(t),r=js(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:m1;for(;sO(e);)try{const a=await jD(e.localStore,n);if(a===null){e.Ia.length===0&&r.k_();break}n=a.batchId,oO(e,a)}catch(a){await Uh(e,a)}FA(e)&&MA(e)}function sO(t){return zo(t)&&t.Ia.length<10}function oO(t,e){t.Ia.push(e);const r=js(t);r.N_()&&r.ea&&r.ta(e.mutations)}function FA(t){return zo(t)&&!js(t).O_()&&t.Ia.length>0}function MA(t){js(t).start()}async function lO(t){js(t).ia()}async function cO(t){const e=js(t);for(const r of t.Ia)e.ta(r.mutations)}async function uO(t,e,r){const n=t.Ia.shift(),a=T1.from(n,e,r);await OA(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await xd(t)}async function fO(t,e){e&&js(t).ea&&await async function(n,a){if(function(c){return K6(c)&&c!==Ce.ABORTED}(a.code)){const o=n.Ia.shift();js(n).L_(),await OA(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,a)),await xd(n)}}(t,e),FA(t)&&MA(t)}async function rE(t,e){const r=tt(t);r.asyncQueue.verifyOperationInProgress(),je(Lo,"RemoteStore received new credentials");const n=zo(r);r.da.add(3),await yf(r),n&&r.Va.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.da.delete(3),await vd(r)}async function hO(t,e){const r=tt(t);e?(r.da.delete(2),await vd(r)):e||(r.da.add(2),await yf(r),r.Va.set("Unknown"))}function pc(t){return t.fa||(t.fa=function(r,n,a){const o=tt(r);return o.oa(),new WD(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{e_:rO.bind(null,t),n_:nO.bind(null,t),i_:aO.bind(null,t),Y_:iO.bind(null,t)}),t.Aa.push(async e=>{e?(t.fa.L_(),D1(t)?N1(t):t.Va.set("Unknown")):(await t.fa.stop(),DA(t))})),t.fa}function js(t){return t.ga||(t.ga=function(r,n,a){const o=tt(r);return o.oa(),new QD(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:lO.bind(null,t),i_:fO.bind(null,t),na:cO.bind(null,t),ra:uO.bind(null,t)}),t.Aa.push(async e=>{e?(t.ga.L_(),await xd(t)):(await t.ga.stop(),t.Ia.length>0&&(je(Lo,`Stopping write stream with ${t.Ia.length} pending writes`),t.Ia=[]))})),t.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,r,n,a,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=o,this.deferred=new Pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,o){const c=Date.now()+n,u=new O1(e,r,c,a,o);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ze(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function F1(t,e){if(Hi("AsyncQueue",`${e}: ${t}`),mc(t))return new ze(Ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{static emptySet(e){return new Xl(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||qe.comparator(r.key,n.key):(r,n)=>qe.comparator(r.key,n.key),this.keyedMap=Au(),this.sortedSet=new tr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Xl)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Xl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(){this.pa=new tr(qe.comparator)}track(e){const r=e.doc.key,n=this.pa.get(r);n?e.type!==0&&n.type===3?this.pa=this.pa.insert(r,e):e.type===3&&n.type!==1?this.pa=this.pa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.pa=this.pa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.pa=this.pa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.pa=this.pa.remove(r):e.type===1&&n.type===2?this.pa=this.pa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.pa=this.pa.insert(r,{type:2,doc:e.doc}):$e(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(r,e)}wa(){const e=[];return this.pa.inorderTraversal((r,n)=>{e.push(n)}),e}}class nc{constructor(e,r,n,a,o,c,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,o){const c=[];return r.forEach(u=>{c.push({type:0,doc:u})}),new nc(e,r,Xl.emptySet(r),c,n,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class mO{constructor(){this.queries=aE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=tt(r),o=a.queries;a.queries=aE(),o.forEach((c,u)=>{for(const h of u.Sa)h.onError(n)})})(this,new ze(Ce.ABORTED,"Firestore shutting down"))}}function aE(){return new Ho(t=>rA(t),fd)}async function PA(t,e){const r=tt(t);let n=3;const a=e.query;let o=r.queries.get(a);o?!o.Da()&&e.va()&&(n=2):(o=new dO,n=e.va()?0:1);try{switch(n){case 0:o.ba=await r.onListen(a,!0);break;case 1:o.ba=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(c){const u=F1(c,`Initialization of query '${Vl(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,o),o.Sa.push(e),e.Fa(r.onlineState),o.ba&&e.Ma(o.ba)&&M1(r)}async function LA(t,e){const r=tt(t),n=e.query;let a=3;const o=r.queries.get(n);if(o){const c=o.Sa.indexOf(e);c>=0&&(o.Sa.splice(c,1),o.Sa.length===0?a=e.va()?0:1:!o.Da()&&e.va()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function pO(t,e){const r=tt(t);let n=!1;for(const a of e){const o=a.query,c=r.queries.get(o);if(c){for(const u of c.Sa)u.Ma(a)&&(n=!0);c.ba=a}}n&&M1(r)}function gO(t,e,r){const n=tt(t),a=n.queries.get(e);if(a)for(const o of a.Sa)o.onError(r);n.queries.delete(e)}function M1(t){t.Ca.forEach(e=>{e.next()})}var Cg,iE;(iE=Cg||(Cg={})).xa="default",iE.Cache="cache";class VA{constructor(e,r,n){this.query=e,this.Oa=r,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new nc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Na?this.La(e)&&(this.Oa.next(e),r=!0):this.ka(e,this.onlineState)&&(this.qa(e),r=!0),this.Ba=e,r}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let r=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),r=!0),r}ka(e,r){if(!e.fromCache||!this.va())return!0;const n=r!=="Offline";return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}La(e){if(e.docChanges.length>0)return!0;const r=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}qa(e){e=nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Cg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e){this.key=e}}class BA{constructor(e){this.key=e}}class vO{constructor(e,r){this.query=e,this.Ha=r,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=mt(),this.mutatedKeys=mt(),this.Za=nA(e),this.Xa=new Xl(this.Za)}get eu(){return this.Ha}tu(e,r){const n=r?r.nu:new nE,a=r?r.Xa:this.Xa;let o=r?r.mutatedKeys:this.mutatedKeys,c=a,u=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((g,x)=>{const _=a.get(g),T=hd(this.query,x)?x:null,y=!!_&&this.mutatedKeys.has(_.key),A=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let w=!1;_&&T?_.data.isEqual(T.data)?y!==A&&(n.track({type:3,doc:T}),w=!0):this.ru(_,T)||(n.track({type:2,doc:T}),w=!0,(h&&this.Za(T,h)>0||d&&this.Za(T,d)<0)&&(u=!0)):!_&&T?(n.track({type:0,doc:T}),w=!0):_&&!T&&(n.track({type:1,doc:_}),w=!0,(h||d)&&(u=!0)),w&&(T?(c=c.add(T),o=A?o.add(g):o.delete(g)):(c=c.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),o=o.delete(g.key),n.track({type:1,doc:g})}return{Xa:c,nu:n,Cs:u,mutatedKeys:o}}ru(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const o=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const c=e.nu.wa();c.sort((g,x)=>function(T,y){const A=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $e(20277,{Vt:w})}};return A(T)-A(y)}(g.type,x.type)||this.Za(g.doc,x.doc)),this.iu(n),a=a!=null&&a;const u=r&&!a?this.su():[],h=this.Ya.size===0&&this.current&&!a?1:0,d=h!==this.Ja;return this.Ja=h,c.length!==0||d?{snapshot:new nc(this.query,e.Xa,o,c,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:u}:{ou:u}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new nE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=mt(),this.Xa.forEach(n=>{this._u(n.key)&&(this.Ya=this.Ya.add(n.key))});const r=[];return e.forEach(n=>{this.Ya.has(n)||r.push(new BA(n))}),this.Ya.forEach(n=>{e.has(n)||r.push(new UA(n))}),r}au(e){this.Ha=e.$s,this.Ya=mt();const r=this.tu(e.documents);return this.applyChanges(r,!0)}uu(){return nc.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const P1="SyncEngine";class xO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class _O{constructor(e){this.key=e,this.cu=!1}}class yO{constructor(e,r,n,a,o,c){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.lu={},this.hu=new Ho(u=>rA(u),fd),this.Pu=new Map,this.Tu=new Set,this.Iu=new tr(qe.comparator),this.Eu=new Map,this.du=new S1,this.Au={},this.Ru=new Map,this.Vu=rc.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function EO(t,e,r=!0){const n=XA(t);let a;const o=n.hu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.uu()):a=await jA(n,e,r,!0),a}async function TO(t,e){const r=XA(t);await jA(r,e,!0,!1)}async function jA(t,e,r,n){const a=await HD(t.localStore,Ja(e)),o=a.targetId,c=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await wO(t,e,o,c==="current",a.resumeToken)),t.isPrimaryClient&&r&&IA(t.remoteStore,a),u}async function wO(t,e,r,n,a){t.fu=(x,_,T)=>async function(A,w,N,U){let R=w.view.tu(N);R.Cs&&(R=await Q2(A.localStore,w.query,!1).then(({documents:b})=>w.view.tu(b,R)));const K=U&&U.targetChanges.get(w.targetId),te=U&&U.targetMismatches.get(w.targetId)!=null,J=w.view.applyChanges(R,A.isPrimaryClient,K,te);return oE(A,w.targetId,J.ou),J.snapshot}(t,x,_,T);const o=await Q2(t.localStore,e,!0),c=new vO(e,o.$s),u=c.tu(o.documents),h=_f.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=c.applyChanges(u,t.isPrimaryClient,h);oE(t,r,d.ou);const g=new xO(e,r,c);return t.hu.set(e,g),t.Pu.has(r)?t.Pu.get(r).push(e):t.Pu.set(r,[e]),d.snapshot}async function AO(t,e,r){const n=tt(t),a=n.hu.get(e),o=n.Pu.get(a.targetId);if(o.length>1)return n.Pu.set(a.targetId,o.filter(c=>!fd(c,e))),void n.hu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await bg(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&R1(n.remoteStore,a.targetId),Rg(n,a.targetId)}).catch(dc)):(Rg(n,a.targetId),await bg(n.localStore,a.targetId,!0))}async function SO(t,e){const r=tt(t),n=r.hu.get(e),a=r.Pu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),R1(r.remoteStore,n.targetId))}async function bO(t,e,r){const n=OO(t);try{const a=await function(c,u){const h=tt(c),d=kr.now(),g=u.reduce((T,y)=>T.add(y.key),mt());let x,_;return h.persistence.runTransaction("Locally write mutations","readwrite",T=>{let y=zi(),A=mt();return h.Bs.getEntries(T,g).next(w=>{y=w,y.forEach((N,U)=>{U.isValidDocument()||(A=A.add(N))})}).next(()=>h.localDocuments.getOverlayedDocuments(T,y)).next(w=>{x=w;const N=[];for(const U of u){const R=H6(U,x.get(U.key).overlayedDocument);R!=null&&N.push(new $s(U.key,R,Yw(R.value.mapValue),fa.exists(!0)))}return h.mutationQueue.addMutationBatch(T,d,N,u)}).next(w=>{_=w;const N=w.applyToLocalDocumentSet(x,A);return h.documentOverlayCache.saveOverlays(T,w.batchId,N)})}).then(()=>({batchId:_.batchId,changes:iA(x)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(c,u,h){let d=c.Au[c.currentUser.toKey()];d||(d=new tr(ct)),d=d.insert(u,h),c.Au[c.currentUser.toKey()]=d}(n,a.batchId,r),await Ef(n,a.changes),await xd(n.remoteStore)}catch(a){const o=F1(a,"Failed to persist write");r.reject(o)}}async function HA(t,e){const r=tt(t);try{const n=await UD(r.localStore,e);e.targetChanges.forEach((a,o)=>{const c=r.Eu.get(o);c&&(Dt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.cu=!0:a.modifiedDocuments.size>0?Dt(c.cu,14607):a.removedDocuments.size>0&&(Dt(c.cu,42227),c.cu=!1))}),await Ef(r,n,e)}catch(n){await dc(n)}}function sE(t,e,r){const n=tt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.hu.forEach((o,c)=>{const u=c.view.Fa(e);u.snapshot&&a.push(u.snapshot)}),function(c,u){const h=tt(c);h.onlineState=u;let d=!1;h.queries.forEach((g,x)=>{for(const _ of x.Sa)_.Fa(u)&&(d=!0)}),d&&M1(h)}(n.eventManager,e),a.length&&n.lu.Y_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function kO(t,e,r){const n=tt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Eu.get(e),o=a&&a.key;if(o){let c=new tr(qe.comparator);c=c.insert(o,sn.newNoDocument(o,Je.min()));const u=mt().add(o),h=new pd(Je.min(),new Map,new tr(ct),c,u);await HA(n,h),n.Iu=n.Iu.remove(o),n.Eu.delete(e),L1(n)}else await bg(n.localStore,e,!1).then(()=>Rg(n,e,r)).catch(dc)}async function CO(t,e){const r=tt(t),n=e.batch.batchId;try{const a=await VD(r.localStore,e);GA(r,n,null),zA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ef(r,a)}catch(a){await dc(a)}}async function RO(t,e,r){const n=tt(t);try{const a=await function(c,u){const h=tt(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let g;return h.mutationQueue.lookupMutationBatch(d,u).next(x=>(Dt(x!==null,37113),g=x.keys(),h.mutationQueue.removeMutationBatch(d,x))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,g,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,g)).next(()=>h.localDocuments.getDocuments(d,g))})}(n.localStore,e);GA(n,e,r),zA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Ef(n,a)}catch(a){await dc(a)}}function zA(t,e){(t.Ru.get(e)||[]).forEach(r=>{r.resolve()}),t.Ru.delete(e)}function GA(t,e,r){const n=tt(t);let a=n.Au[n.currentUser.toKey()];if(a){const o=a.get(e);o&&(r?o.reject(r):o.resolve(),a=a.remove(e)),n.Au[n.currentUser.toKey()]=a}}function Rg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Pu.get(e))t.hu.delete(n),r&&t.lu.gu(n,r);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach(n=>{t.du.containsKey(n)||qA(t,n)})}function qA(t,e){t.Tu.delete(e.path.canonicalString());const r=t.Iu.get(e);r!==null&&(R1(t.remoteStore,r),t.Iu=t.Iu.remove(e),t.Eu.delete(r),L1(t))}function oE(t,e,r){for(const n of r)n instanceof UA?(t.du.addReference(n.key,e),IO(t,n)):n instanceof BA?(je(P1,"Document no longer in limbo: "+n.key),t.du.removeReference(n.key,e),t.du.containsKey(n.key)||qA(t,n.key)):$e(19791,{pu:n})}function IO(t,e){const r=e.key,n=r.path.canonicalString();t.Iu.get(r)||t.Tu.has(n)||(je(P1,"New document in limbo: "+r),t.Tu.add(n),L1(t))}function L1(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const r=new qe(Zt.fromString(e)),n=t.Vu.next();t.Eu.set(n,new _O(r)),t.Iu=t.Iu.insert(r,n),IA(t.remoteStore,new Cs(Ja(_1(r.path)),n,"TargetPurposeLimboResolution",od.le))}}async function Ef(t,e,r){const n=tt(t),a=[],o=[],c=[];n.hu.isEmpty()||(n.hu.forEach((u,h)=>{c.push(n.fu(h,e,r).then(d=>{var g;if((d||r)&&n.isPrimaryClient){const x=d?!d.fromCache:(g=r==null?void 0:r.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(h.targetId,x?"current":"not-current")}if(d){a.push(d);const x=k1.Rs(h.targetId,d);o.push(x)}}))}),await Promise.all(c),n.lu.Y_(a),await async function(h,d){const g=tt(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",x=>Se.forEach(d,_=>Se.forEach(_.ds,T=>g.persistence.referenceDelegate.addReference(x,_.targetId,T)).next(()=>Se.forEach(_.As,T=>g.persistence.referenceDelegate.removeReference(x,_.targetId,T)))))}catch(x){if(!mc(x))throw x;je(C1,"Failed to update sequence numbers: "+x)}for(const x of d){const _=x.targetId;if(!x.fromCache){const T=g.xs.get(_),y=T.snapshotVersion,A=T.withLastLimboFreeSnapshotVersion(y);g.xs=g.xs.insert(_,A)}}}(n.localStore,o))}async function NO(t,e){const r=tt(t);if(!r.currentUser.isEqual(e)){je(P1,"User change. New user:",e.toKey());const n=await bA(r.localStore,e);r.currentUser=e,function(o,c){o.Ru.forEach(u=>{u.forEach(h=>{h.reject(new ze(Ce.CANCELLED,c))})}),o.Ru.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ef(r,n.ks)}}function DO(t,e){const r=tt(t),n=r.Eu.get(e);if(n&&n.cu)return mt().add(n.key);{let a=mt();const o=r.Pu.get(e);if(!o)return a;for(const c of o){const u=r.hu.get(c);a=a.unionWith(u.view.eu)}return a}}function XA(t){const e=tt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=HA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kO.bind(null,e),e.lu.Y_=pO.bind(null,e.eventManager),e.lu.gu=gO.bind(null,e.eventManager),e}function OO(t){const e=tt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RO.bind(null,e),e}class Bh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,r){return null}Cu(e,r){return null}Du(e){return LD(this.persistence,new FD,e.initialUser,this.serializer)}Su(e){return new SA(b1.fi,this.serializer)}bu(e){return new GD}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bh.provider={build:()=>new Bh};class FO extends Bh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,r){Dt(this.persistence.referenceDelegate instanceof Vh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new _D(n,e.asyncQueue,r)}Su(e){const r=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new SA(n=>Vh.fi(n,r),this.serializer)}}class Ig{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>sE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=NO.bind(null,this.syncEngine),await hO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mO}()}createDatastore(e){const r=gd(e.databaseInfo.databaseId),n=function(o){return new YD(o)}(e.databaseInfo);return function(o,c,u,h){return new JD(o,c,u,h)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,o,c,u){return new tO(n,a,o,c,u)}(this.localStore,this.datastore,e.asyncQueue,r=>sE(this.syncEngine,r,0),function(){return eE.C()?new eE:new qD}())}createSyncEngine(e,r){return function(a,o,c,u,h,d,g){const x=new yO(a,o,c,u,h,d);return g&&(x.mu=!0),x}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const o=tt(a);je(Lo,"RemoteStore shutting down."),o.da.add(5),await yf(o),o.Ra.shutdown(),o.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Ig.provider={build:()=>new Ig};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Hi("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs="FirestoreClient";class MO{constructor(e,r,n,a,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=nn.UNAUTHENTICATED,this.clientId=Uw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async c=>{je(Hs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(n,c=>(je(Hs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=F1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qp(t,e){t.asyncQueue.verifyOperationInProgress(),je(Hs,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await bA(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function lE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await PO(t);je(Hs,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>rE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>rE(e.remoteStore,a)),t._onlineComponents=e}async function PO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je(Hs,"Using user provided OfflineComponentProvider");try{await qp(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===Ce.FAILED_PRECONDITION||a.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;Zl("Error using user provided cache. Falling back to memory cache: "+r),await qp(t,new Bh)}}else je(Hs,"Using default OfflineComponentProvider"),await qp(t,new FO(void 0));return t._offlineComponents}async function $A(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je(Hs,"Using user provided OnlineComponentProvider"),await lE(t,t._uninitializedComponentsProvider._online)):(je(Hs,"Using default OnlineComponentProvider"),await lE(t,new Ig))),t._onlineComponents}function LO(t){return $A(t).then(e=>e.syncEngine)}async function YA(t){const e=await $A(t),r=e.eventManager;return r.onListen=EO.bind(null,e.syncEngine),r.onUnlisten=AO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=TO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=SO.bind(null,e.syncEngine),r}function VO(t,e,r={}){const n=new Pi;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,d){const g=new KA({next:_=>{g.xu(),c.enqueueAndForget(()=>LA(o,x));const T=_.docs.has(u);!T&&_.fromCache?d.reject(new ze(Ce.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&_.fromCache&&h&&h.source==="server"?d.reject(new ze(Ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),x=new VA(_1(u.path),g,{includeMetadataChanges:!0,Qa:!0});return PA(o,x)}(await YA(t),t.asyncQueue,e,r,n)),n.promise}function UO(t,e,r={}){const n=new Pi;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,d){const g=new KA({next:_=>{g.xu(),c.enqueueAndForget(()=>LA(o,x)),_.fromCache&&h.source==="server"?d.reject(new ze(Ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),x=new VA(u,g,{includeMetadataChanges:!0,Qa:!0});return PA(o,x)}(await YA(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(t,e,r){if(!r)throw new ze(Ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function BO(t,e,r,n){if(e===!0&&n===!0)throw new ze(Ce.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function uE(t){if(!qe.isDocumentKey(t))throw new ze(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function fE(t){if(qe.isDocumentKey(t))throw new ze(Ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function V1(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":$e(12329,{type:typeof t})}function zs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ze(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=V1(t);throw new ze(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA="firestore.googleapis.com",hE=!0;class dE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ze(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ZA,this.ssl=hE}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:hE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=AA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vD)throw new ze(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WA((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ze(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ze(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ze(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _d{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ze(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ze(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new KN;switch(n.type){case"firstParty":return new QN(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ze(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=cE.get(r);n&&(je("ComponentProvider","Removing Datastore"),cE.delete(r),n.terminate())}(this),Promise.resolve()}}function jO(t,e,r,n={}){var a;t=zs(t,_d);const o=cc(e),c=t._getSettings(),u=Object.assign(Object.assign({},c),{emulatorOptions:t._getEmulatorOptions()}),h=`${e}:${r}`;o&&(qT(`https://${h}`),XT("Firestore",!0)),c.host!==ZA&&c.host!==h&&Zl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},c),{host:h,ssl:o,emulatorOptions:n});if(!Oo(d,u)&&(t._setSettings(d),n.mockUserToken)){let g,x;if(typeof n.mockUserToken=="string")g=n.mockUserToken,x=nn.MOCK_USER;else{g=ER(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new ze(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new nn(_)}t._authCredentials=new $N(new Lw(g,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new yd(this.firestore,e,this._query)}}class $n{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $n(this.firestore,e,this._key)}}class Ms extends yd{constructor(e,r,n){super(e,r,_1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $n(this.firestore,null,new qe(e))}withConverter(e){return new Ms(this.firestore,e,this._path)}}function JA(t,e,...r){if(t=Wr(t),QA("collection","path",e),t instanceof _d){const n=Zt.fromString(e,...r);return fE(n),new Ms(t,null,n)}{if(!(t instanceof $n||t instanceof Ms))throw new ze(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Zt.fromString(e,...r));return fE(n),new Ms(t.firestore,null,n)}}function Ed(t,e,...r){if(t=Wr(t),arguments.length===1&&(e=Uw.newId()),QA("doc","path",e),t instanceof _d){const n=Zt.fromString(e,...r);return uE(n),new $n(t,null,new qe(n))}{if(!(t instanceof $n||t instanceof Ms))throw new ze(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Zt.fromString(e,...r));return uE(n),new $n(t.firestore,t instanceof Ms?t.converter:null,new qe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE="AsyncQueue";class pE{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new CA(this,"async_queue_retry"),this.rc=()=>{const n=Gp();n&&je(mE,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const r=Gp();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const r=Gp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const r=new Pi;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!mc(e))throw e;je(mE,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const r=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Hi("INTERNAL UNHANDLED ERROR: ",gE(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=r,r}enqueueAfterDelay(e,r,n){this.oc(),this.nc.indexOf(e)>-1&&(r=0);const a=O1.createAndSchedule(this,e,r,n,o=>this.uc(o));return this.Zu.push(a),a}oc(){this.Xu&&$e(47125,{cc:gE(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const r of this.Zu)if(r.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Zu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const r=this.Zu.indexOf(e);this.Zu.splice(r,1)}}function gE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Tf extends _d{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new pE,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pE(e),this._firestoreClient=void 0,await e}}}function eS(t,e){const r=typeof t=="object"?t:WT(),n=typeof t=="string"?t:Nh,a=e1(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const o=_R("firestore");o&&jO(a,...o)}return a}function Td(t){if(t._terminated)throw new ze(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HO(t),t._firestoreClient}function HO(t){var e,r,n;const a=t._freezeSettings(),o=function(u,h,d,g){return new h6(u,h,d,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,WA(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new MO(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const h=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ac(Qr.fromBase64String(e))}catch(r){throw new ze(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ac(Qr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ze(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ze(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ze(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ct(this._lat,e._lat)||ct(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==a[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zO=/^__.*__$/;class GO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new $s(e,this.data,this.fieldMask,r,this.fieldTransforms):new xf(e,this.data,r,this.fieldTransforms)}}class tS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new $s(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function rS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $e(40011,{Ic:t})}}class H1{constructor(e,r,n,a,o,c){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,o===void 0&&this.Ec(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new H1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.dc({path:n,Rc:!1});return a.Vc(e),a}mc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.dc({path:n,Rc:!1});return a.Ec(),a}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return jh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(rS(this.Ic)&&zO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class qO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||gd(e)}bc(e,r,n,a=!1){return new H1({Ic:e,methodName:r,wc:n,path:Kr.emptyPath(),Rc:!1,yc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nS(t){const e=t._freezeSettings(),r=gd(t._databaseId);return new qO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function aS(t,e,r,n,a,o={}){const c=t.bc(o.merge||o.mergeFields?2:0,e,r,a);z1("Data must be an object, but it was:",c,n);const u=iS(n,c);let h,d;if(o.merge)h=new Kn(c.fieldMask),d=c.fieldTransforms;else if(o.mergeFields){const g=[];for(const x of o.mergeFields){const _=Ng(e,x,r);if(!c.contains(_))throw new ze(Ce.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);oS(g,_)||g.push(_)}h=new Kn(g),d=c.fieldTransforms.filter(x=>h.covers(x.field))}else h=null,d=c.fieldTransforms;return new GO(new Mn(u),h,d)}class Ad extends U1{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ad}}function XO(t,e,r,n){const a=t.bc(1,e,r);z1("Data must be an object, but it was:",a,n);const o=[],c=Mn.empty();Ks(n,(h,d)=>{const g=G1(e,h,r);d=Wr(d);const x=a.mc(g);if(d instanceof Ad)o.push(g);else{const _=Sd(d,x);_!=null&&(o.push(g),c.set(g,_))}});const u=new Kn(o);return new tS(c,u,a.fieldTransforms)}function KO(t,e,r,n,a,o){const c=t.bc(1,e,r),u=[Ng(e,n,r)],h=[a];if(o.length%2!=0)throw new ze(Ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)u.push(Ng(e,o[_])),h.push(o[_+1]);const d=[],g=Mn.empty();for(let _=u.length-1;_>=0;--_)if(!oS(d,u[_])){const T=u[_];let y=h[_];y=Wr(y);const A=c.mc(T);if(y instanceof Ad)d.push(T);else{const w=Sd(y,A);w!=null&&(d.push(T),g.set(T,w))}}const x=new Kn(d);return new tS(g,x,c.fieldTransforms)}function Sd(t,e){if(sS(t=Wr(t)))return z1("Unsupported field value:",e,t),iS(t,e);if(t instanceof U1)return function(n,a){if(!rS(a.Ic))throw a.gc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.gc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(a);o&&a.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,a){const o=[];let c=0;for(const u of n){let h=Sd(u,a.fc(c));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),c++}return{arrayValue:{values:o}}}(t,e)}return function(n,a){if((n=Wr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return P6(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=kr.fromDate(n);return{timestampValue:Lh(a.serializer,o)}}if(n instanceof kr){const o=new kr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Lh(a.serializer,o)}}if(n instanceof B1)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ac)return{bytesValue:vA(a.serializer,n._byteString)};if(n instanceof $n){const o=a.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw a.gc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:A1(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof j1)return function(c,u){return{mapValue:{fields:{[Kw]:{stringValue:$w},[Dh]:{arrayValue:{values:c.toArray().map(d=>{if(typeof d!="number")throw u.gc("VectorValues must only contain numeric values.");return y1(u.serializer,d)})}}}}}}(n,a);throw a.gc(`Unsupported field value: ${V1(n)}`)}(t,e)}function iS(t,e){const r={};return jw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ks(t,(n,a)=>{const o=Sd(a,e.Ac(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function sS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof kr||t instanceof B1||t instanceof ac||t instanceof $n||t instanceof U1||t instanceof j1)}function z1(t,e,r){if(!sS(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=V1(r);throw n==="an object"?e.gc(t+" a custom object"):e.gc(t+" "+n)}}function Ng(t,e,r){if((e=Wr(e))instanceof wd)return e._internalPath;if(typeof e=="string")return G1(t,e);throw jh("Field path arguments must be of type string or ",t,!1,void 0,r)}const $O=new RegExp("[~\\*/\\[\\]]");function G1(t,e,r){if(e.search($O)>=0)throw jh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new wd(...e.split("."))._internalPath}catch{throw jh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function jh(t,e,r,n,a){const o=n&&!n.isEmpty(),c=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||c)&&(h+=" (found",o&&(h+=` in field ${n}`),c&&(h+=` in document ${a}`),h+=")"),new ze(Ce.INVALID_ARGUMENT,u+t+h)}function oS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r,n,a,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new $n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new YO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(cS("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class YO extends lS{data(){return super.data()}}function cS(t,e){return typeof e=="string"?G1(t,e):e instanceof wd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ze(Ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class QO{convertValue(e,r="none"){switch(Bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ur(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw $e(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ks(e,(a,o)=>{n[a]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,a;const o=(a=(n=(r=e.fields)===null||r===void 0?void 0:r[Dh].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(c=>ur(c.doubleValue));return new j1(o)}convertGeoPoint(e){return new B1(ur(e.latitude),ur(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=cd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Wu(e));default:return null}}convertTimestamp(e){const r=Vs(e);return new kr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Zt.fromString(e);Dt(wA(n),9688,{name:e});const a=new Qu(n.get(1),n.get(3)),o=new qe(n.popFirst(5));return a.isEqual(r)||Hi(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fS extends lS{constructor(e,r,n,a,o,c){super(e,r,n,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new _h(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(cS("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class _h extends fS{data(e={}){return super.data(e)}}class ZO{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new bu(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new _h(this._firestore,this._userDataWriter,n.key,n,new bu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ze(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,o){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map(u=>{const h=new _h(a._firestore,a._userDataWriter,u.doc.key,u.doc,new bu(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const h=new _h(a._firestore,a._userDataWriter,u.doc.key,u.doc,new bu(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,g=-1;return u.type!==0&&(d=c.indexOf(u.doc.key),c=c.delete(u.doc.key)),u.type!==1&&(c=c.add(u.doc),g=c.indexOf(u.doc.key)),{type:JO(u.type),doc:h,oldIndex:d,newIndex:g}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function JO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $e(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){t=zs(t,$n);const e=zs(t.firestore,Tf);return VO(Td(e),t._key).then(r=>e5(e,t,r))}class dS extends QO{constructor(e){super(),this.firestore=e}convertBytes(e){return new ac(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new $n(this.firestore,null,r)}}function mS(t){t=zs(t,yd);const e=zs(t.firestore,Tf),r=Td(e),n=new dS(e);return WO(t._query),UO(r,t._query).then(a=>new ZO(e,n,t,a))}function pS(t,e,r){t=zs(t,$n);const n=zs(t.firestore,Tf),a=uS(t.converter,e,r);return gS(n,[aS(nS(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,fa.none())])}function gS(t,e){return function(n,a){const o=new Pi;return n.asyncQueue.enqueueAndForget(async()=>bO(await LO(n),a,o)),o.promise}(Td(t),e)}function e5(t,e,r){const n=r.docs.get(e._key),a=new dS(t);return new fS(t,a,e._key,n,new bu(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t5{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=nS(e)}set(e,r,n){this._verifyNotCommitted();const a=Xp(e,this._firestore),o=uS(a.converter,r,n),c=aS(this._dataReader,"WriteBatch.set",a._key,o,a.converter!==null,n);return this._mutations.push(c.toMutation(a._key,fa.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const o=Xp(e,this._firestore);let c;return c=typeof(r=Wr(r))=="string"||r instanceof wd?KO(this._dataReader,"WriteBatch.update",o._key,r,n,a):XO(this._dataReader,"WriteBatch.update",o._key,r),this._mutations.push(c.toMutation(o._key,fa.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Xp(e,this._firestore);return this._mutations=this._mutations.concat(new E1(r._key,fa.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ze(Ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Xp(t,e){if((t=Wr(t)).firestore!==e)throw new ze(Ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(t){return Td(t=zs(t,Tf)),new t5(t,e=>gS(t,e))}(function(e,r=!0){(function(a){hc=a})(uc),Wl(new Fo("firestore",(n,{instanceIdentifier:a,options:o})=>{const c=n.getProvider("app").getImmediate(),u=new Tf(new YN(n.getProvider("auth-internal")),new ZN(c,n.getProvider("app-check-internal")),function(d,g){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ze(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qu(d.options.projectId,g)}(c,a),c);return o=Object.assign({useFetchStreams:r},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),Os(E2,T2,e),Os(E2,T2,"esm2017")})();var n5="firebase",a5="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Os(n5,a5,"app");const i5={apiKey:"AIzaSyBdGXuIiDjFp84ErBGql86OEm9gyQTMI8Q",authDomain:"golasso-17530.firebaseapp.com",projectId:"golasso-17530",storageBucket:"golasso-17530.firebasestorage.app",messagingSenderId:"380558190244",appId:"1:380558190244:web:822de831bc4b1ac1bf6831",measurementId:"G-TKFNHKQGZ0"},bd=YT(i5),vS=h1(bd),s5=new Ni,wf=eS(bd);var En=(t=>(t[t.Lettore=0]="Lettore",t[t.Scrittore=1]="Scrittore",t[t.Admin=2]="Admin",t))(En||{});const o5=async t=>{const e=Ed(wf,"users",t.uid);try{if((await hS(e)).exists())console.log(`Profilo utente esistente per ${t.uid}.`);else{const n={ID:t.uid,idProfilo:En.Lettore};await pS(e,n),console.log(`Profilo utente creato per ${t.uid} con ruolo Lettore.`)}}catch(r){throw console.error("Errore durante la verifica o creazione del profilo utente:",r),r}},l5=async t=>{const e=Ed(wf,"users",t);try{const r=await hS(e);return r.exists()?r.data():null}catch(r){throw console.error("Errore durante il recupero del profilo utente:",r),r}},c5=async(t,e)=>{const r=Ed(wf,"users",t);try{await pS(r,{idProfilo:e},{merge:!0}),console.log(`Ruolo utente ${t} aggiornato a ${e}.`)}catch(n){throw console.error("Errore durante l'aggiornamento del ruolo utente:",n),n}};async function u5(){const t=[];try{const e=JA(wf,"users");return(await mS(e)).forEach(n=>{t.push({ID:n.id,...n.data()})}),t}catch(e){throw console.error("Errore nel recuperare tutti i profili utente dal client:",e),e}}const f5=h1(bd),gc=VT((t,e)=>({user:null,profile:null,loading:!0,isAdmin:!1,isEditor:!1,clearStore:()=>t({user:null,profile:null,loading:!1,isAdmin:!1,isEditor:!1}),initialize:()=>{xw(f5,async r=>{if(r)try{const n=await l5(r.uid);t({user:r,profile:n,isAdmin:(n==null?void 0:n.idProfilo)===En.Admin,isEditor:((n==null?void 0:n.idProfilo)??0)>=En.Scrittore,loading:!1})}catch(n){console.error("Errore store user:",n),e().clearStore()}else e().clearStore()})}})),h5=({ruolo:t})=>{const e=r=>{switch(r){case"P":return"bg-orange-500 text-white";case"D":return"bg-blue-500 text-white";case"C":return"bg-green-500 text-white";case"A":return"bg-red-600 text-white";default:return"bg-gray-300 text-gray-700"}};return F.jsx("span",{className:`inline-block px-3 py-1 rounded-full font-semibold ${e(t)}`,style:{minWidth:24,textAlign:"center"},children:t})},d5=({giocatore:t,isOpen:e})=>F.jsxs("div",{className:"grid grid-cols-[45px_35px_1fr_100px_40px_50px_50px_25px] items-center gap-2 px-6 py-4",children:[F.jsxs("span",{className:"text-[10px] font-mono text-gray-500",children:["#",t.Cod]}),F.jsx("div",{className:"flex justify-center",children:F.jsx(h5,{ruolo:t.R})}),F.jsx("div",{className:"font-bold uppercase tracking-tight text-sm truncate text-white",children:t.Nome}),F.jsx("div",{className:"text-right text-[10px] font-bold text-gray-400 uppercase truncate",children:t.Squadra}),F.jsx("div",{className:"text-right text-sm text-gray-300",children:t.Pv}),F.jsx("div",{className:"text-right text-sm text-gray-300 font-medium",children:t.Mv.toFixed(2)}),F.jsx("div",{className:"text-right text-sm font-black text-emerald-400",children:t.Fm.toFixed(2)}),F.jsx("div",{className:`flex justify-end text-gray-600 transition-transform ${e?"rotate-180":""}`,children:F.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:F.jsx("path",{fillRule:"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})})})]}),m5=({giocatore:t})=>F.jsxs("div",{className:"px-4 py-5 bg-gray-900/80 rounded-b-xl grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-3",children:[F.jsx(Ii,{label:"Gol",value:t.Gf,isPositive:t.Gf>0}),F.jsx(Ii,{label:"Assist",value:t.Ass,isPositive:t.Ass>0}),t.R==="P"?F.jsxs(F.Fragment,{children:[F.jsx(Ii,{label:"Subiti",value:t.Gs,isNegative:t.Gs>0}),F.jsx(Ii,{label:"Parati",value:t.Rp,isPositive:t.Rp>0})]}):F.jsxs(F.Fragment,{children:[F.jsx(Ii,{label:"Rig. F",value:t.Rf}),F.jsx(Ii,{label:"Rig. S",value:t.Rs,isNegative:t.Rs>0})]}),F.jsx(Ii,{label:"Amm",value:t.Amm,color:"text-yellow-500"}),F.jsx(Ii,{label:"Esp",value:t.Esp,color:"text-red-500"}),F.jsx(Ii,{label:"Autogol",value:t.Au,isNegative:t.Au>0})]}),Ii=({label:t,value:e,isPositive:r,isNegative:n,color:a})=>F.jsxs("div",{className:"bg-gray-800/50 p-2 rounded-lg border border-gray-700/50 flex flex-col items-center",children:[F.jsx("div",{className:"text-[9px] uppercase tracking-tighter text-gray-500 font-bold mb-1",children:t}),F.jsx("div",{className:`text-sm font-black ${a||(r?"text-emerald-400":n?"text-red-400":"text-white")}`,children:e})]}),p5=({giocatore:t})=>{const[e,r]=_e.useState(!1);return F.jsxs("div",{className:`group bg-gray-800/50 rounded-xl border transition-all duration-200 ${e?"border-emerald-500 shadow-lg shadow-emerald-900/20":"border-gray-700 hover:border-gray-500 shadow-md"}`,onClick:()=>r(!e),children:[F.jsx(d5,{giocatore:t,isOpen:e}),e&&F.jsx(m5,{giocatore:t})]})},g5=[{id:"CK",FantaSquadra:"Coca Kolarov"},{id:"MU",FantaSquadra:"Mannigger United"},{id:"ING",FantaSquadra:"FC Ingiocabili"},{id:"DIO",FantaSquadra:"Dio"},{id:"ACP",FantaSquadra:"AC PICCHIA"},{id:"ASB",FantaSquadra:"As Borra"},{id:"ASP",FantaSquadra:"AS Piliqueta"},{id:"HA",FantaSquadra:"Hiroshima Atomic"},{id:"PK20",FantaSquadra:"Pieronekalulu20"},{id:"OT",FantaSquadra:"Orlando Tragic"}],yh=g5.map(t=>t.FantaSquadra);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=t=>{const e=x5(t);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=_e.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:c,...u},h)=>_e.createElement("svg",{ref:h,..._5,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:xS("lucide",a),...!o&&!y5(u)&&{"aria-hidden":"true"},...u},[...c.map(([d,g])=>_e.createElement(d,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=(t,e)=>{const r=_e.forwardRef(({className:n,...a},o)=>_e.createElement(E5,{ref:o,iconNode:e,className:xS(`lucide-${v5(vE(t))}`,`lucide-${t}`,n),...a}));return r.displayName=vE(t),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],w5=Zr("circle-check",T5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A5=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],S5=Zr("cloud-upload",A5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Kp=Zr("database",b5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],C5=Zr("file-spreadsheet",k5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R5=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],I5=Zr("funnel",R5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],D5=Zr("info",N5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O5=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Hh=Zr("loader-circle",O5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F5=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],M5=Zr("refresh-cw",F5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P5=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],L5=Zr("rotate-ccw",P5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],U5=Zr("search",V5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B5=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],j5=Zr("settings-2",B5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],z5=Zr("shield-alert",H5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],q5=Zr("shield-check",G5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X5=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],K5=Zr("trending-up",X5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Y5=Zr("triangle-alert",$5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],_S=Zr("users",W5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q5=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Z5=Zr("wallet",Q5),xE=({search:t,setSearch:e,minPv:r,setMinPv:n,minMv:a,setMinMv:o,minFm:c,setMinFm:u,role:h,setRole:d,selectedTeam:g,setSelectedTeam:x,showFuoriLista:_,setShowFuoriLista:T,onReset:y})=>{const A={TUTTI:"Tutti",P:"Por",D:"Dif",C:"Cen",A:"Att"};return F.jsxs("aside",{className:"w-64 flex flex-col gap-6 bg-gray-800/40 p-4 rounded-2xl border border-gray-700/50 backdrop-blur-sm overflow-auto custom-scrollbar h-fit",children:[F.jsxs("div",{className:"flex flex-col gap-2",children:[F.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold ml-1",children:"Cerca Giocatore"}),F.jsxs("div",{className:"relative",children:[F.jsx("input",{type:"text",placeholder:"Nome, squadra...",value:t,onChange:w=>e(w.target.value),className:"w-full bg-gray-900 border border-gray-700 text-white rounded-xl px-4 py-2.5 pl-10 focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 outline-none transition-all placeholder:text-gray-600"}),F.jsx(U5,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"})]})]}),F.jsxs("div",{className:"flex items-center justify-between px-1",children:[F.jsxs("div",{className:"flex flex-col",children:[F.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold",children:"Fuori Lista"}),F.jsx("span",{className:"text-[9px] text-gray-600 font-medium",children:"Includi giocatori rimossi"})]}),F.jsx("button",{onClick:()=>T(!_),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors outline-none ${_?"bg-emerald-600":"bg-gray-700"}`,children:F.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${_?"translate-x-6":"translate-x-1"}`})})]}),F.jsxs("div",{className:"flex flex-col gap-2",children:[F.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold ml-1",children:"Fanta Squadra"}),F.jsxs("div",{className:"relative",children:[F.jsxs("select",{value:g,onChange:w=>x(w.target.value),className:"w-full bg-gray-900 border border-gray-700 text-white rounded-xl px-4 py-2.5 pl-10 focus:ring-2 focus:ring-emerald-500/50 outline-none transition-all appearance-none cursor-pointer text-sm font-medium",children:[F.jsx("option",{value:"TUTTE",children:"Tutte le squadre"}),F.jsx("option",{value:"LIBERI",children:"Svincolati (-)"}),yh.map(w=>F.jsx("option",{value:w,children:w},w))]}),F.jsx(_S,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),F.jsx("div",{className:"absolute right-3 top-4 pointer-events-none",children:F.jsx("div",{className:"border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-500"})})]})]}),F.jsxs("div",{className:"flex flex-col gap-2",children:[F.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold ml-1",children:"Ruolo"}),F.jsx("div",{className:"grid grid-cols-5 gap-1 bg-gray-900 p-1 rounded-xl border border-gray-700",children:["TUTTI","P","D","C","A"].map(w=>F.jsx("button",{onClick:()=>d(w),className:`py-1.5 rounded-lg text-[10px] font-bold transition-all ${h===w?"bg-emerald-600 text-white shadow-lg shadow-emerald-900/20":"text-gray-400 hover:bg-gray-800 hover:text-gray-200"}`,children:A[w]},w))})]}),F.jsx("div",{className:"h-[1px] bg-gray-700/50 w-full my-1"}),F.jsxs("div",{className:"flex flex-col gap-5",children:[F.jsxs("div",{className:"space-y-3",children:[F.jsxs("div",{className:"flex justify-between items-end",children:[F.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold ml-1",children:"Partite a Voto"}),F.jsxs("span",{className:"text-emerald-500 font-mono font-bold text-xs bg-emerald-500/10 px-2 py-0.5 rounded border border-emerald-500/20",children:[" ",r]})]}),F.jsx("input",{type:"range",min:0,max:38,value:r,onChange:w=>n(Number(w.target.value)),className:"w-full h-1.5 bg-gray-900 rounded-lg appearance-none cursor-pointer accent-emerald-500"})]}),F.jsxs("div",{className:"space-y-3",children:[F.jsxs("div",{className:"flex justify-between items-end",children:[F.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold ml-1",children:"Media Voto"}),F.jsxs("span",{className:"text-emerald-500 font-mono font-bold text-xs bg-emerald-500/10 px-2 py-0.5 rounded border border-emerald-500/20",children:[" ",a.toFixed(1)]})]}),F.jsx("input",{type:"range",min:2,max:10,step:.1,value:a,onChange:w=>o(Number(w.target.value)),className:"w-full h-1.5 bg-gray-900 rounded-lg appearance-none cursor-pointer accent-emerald-500"})]}),F.jsxs("div",{className:"space-y-3",children:[F.jsxs("div",{className:"flex justify-between items-end",children:[F.jsx("label",{className:"text-[10px] uppercase tracking-widest text-gray-500 font-bold ml-1",children:"Fanta Media"}),F.jsxs("span",{className:"text-emerald-500 font-mono font-bold text-xs bg-emerald-500/10 px-2 py-0.5 rounded border border-emerald-500/20",children:[" ",c.toFixed(1)]})]}),F.jsx("input",{type:"range",min:2,max:10,step:.1,value:c,onChange:w=>u(Number(w.target.value)),className:"w-full h-1.5 bg-gray-900 rounded-lg appearance-none cursor-pointer accent-emerald-500"})]})]}),F.jsxs("button",{onClick:y,className:"mt-4 flex items-center justify-center gap-2 w-full py-3 rounded-xl border border-gray-700 text-gray-400 font-bold text-xs uppercase tracking-widest hover:bg-gray-700 hover:text-white transition-all active:scale-95",children:[F.jsx(L5,{className:"w-3.5 h-3.5"}),"Reset Filtri"]})]})},J5=({sortConfig:t,onSortClick:e})=>{const r="grid grid-cols-[45px_35px_1fr_100px_40px_50px_50px_50px] items-center gap-2 px-6 py-3",n=a=>(t==null?void 0:t.field)!==a?null:t.direction==="asc"?" ":" ";return F.jsxs("div",{className:`${r} bg-gray-900/50 text-gray-500 uppercase text-[10px] tracking-widest font-bold border-b border-gray-800`,children:[F.jsxs("div",{className:"cursor-pointer hover:text-gray-300",onClick:()=>e("Cod"),children:["ID",n("Cod")]}),F.jsx("div",{})," ",F.jsxs("div",{className:"cursor-pointer hover:text-gray-300",onClick:()=>e("Nome"),children:["Giocatore",n("Nome")]}),F.jsxs("div",{className:"text-right cursor-pointer hover:text-gray-300",onClick:()=>e("Squadra"),children:["Team",n("Squadra")]}),F.jsxs("div",{className:"text-right cursor-pointer hover:text-gray-300",onClick:()=>e("Pv"),children:["PV",n("Pv")]}),F.jsxs("div",{className:"text-right cursor-pointer hover:text-gray-300",onClick:()=>e("Mv"),children:["MV",n("Mv")]}),F.jsxs("div",{className:"text-right text-emerald-500 cursor-pointer",onClick:()=>e("Fm"),children:["FM",n("Fm")]}),F.jsx("div",{})," "]})},e8=async()=>{try{const e=(await tN(vS,s5)).user;return e&&await o5(e),e}catch(t){throw console.error("Errore durante il login con Google:",t),t}},t8=()=>MI(vS),r8=()=>{const t=ff(),e=async()=>{try{await t8(),t("/login")}catch(r){console.error("Errore logout:",r)}};return F.jsxs("button",{onClick:e,className:"flex items-center gap-2 bg-gray-800 hover:bg-red-900/40 text-gray-300 hover:text-red-400 px-4 py-2 rounded-lg border border-gray-700 transition-all duration-200 shadow-sm text-sm font-medium group w-32",children:[F.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 transition-transform group-hover:-translate-x-1",children:F.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),"Logout"]})},yS="/golasso/assets/logo-7Qd2Xm0B.svg",ES=()=>{const{isAdmin:t}=gc();return F.jsx("header",{className:"w-full bg-gray-900 border-b border-gray-800 sticky top-0 z-50 shadow-md",children:F.jsxs("div",{className:"max-w-7xl mx-auto px-4 h-16 flex items-center justify-between",children:[F.jsx(Sa,{to:"/home",className:"flex items-center gap-3 group outline-none",children:F.jsx("img",{src:yS,alt:"Golasso Logo",className:"w-10 h-10 object-contain group-hover:scale-110 transition-transform duration-200"})}),F.jsxs("div",{className:"flex items-center gap-6",children:[F.jsxs("nav",{className:"hidden md:flex items-center gap-4 text-sm font-medium text-gray-400",children:[F.jsx(Sa,{to:"/home",className:"hover:text-emerald-400 transition-colors",children:"Giocatori"}),F.jsx(Sa,{to:"/fantasquadra",className:"hover:text-emerald-400 transition-colors",children:"FantaSquadra"}),t&&F.jsx(Sa,{to:"/gestione-ruoli",className:"hover:text-emerald-400 transition-colors",children:"Utenti"})]}),F.jsx("div",{className:"h-6 w-[1px] bg-gray-700 hidden md:block"}),F.jsx(r8,{})]})]})})};function TS(t,e){let r;try{r=t()}catch{return}return{getItem:a=>{var o;const c=h=>h===null?null:JSON.parse(h,void 0),u=(o=r.getItem(a))!=null?o:null;return u instanceof Promise?u.then(c):c(u)},setItem:(a,o)=>r.setItem(a,JSON.stringify(o,void 0)),removeItem:a=>r.removeItem(a)}}const Dg=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Dg(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Dg(n)(r)}}}},n8=(t,e)=>(r,n,a)=>{let o={storage:TS(()=>window.localStorage),partialize:w=>w,version:0,merge:(w,N)=>({...N,...w}),...e},c=!1,u=0;const h=new Set,d=new Set;let g=o.storage;if(!g)return t((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),r(...w)},n,a);const x=()=>{const w=o.partialize({...n()});return g.setItem(o.name,{state:w,version:o.version})},_=a.setState;a.setState=(w,N)=>(_(w,N),x());const T=t((...w)=>(r(...w),x()),n,a);a.getInitialState=()=>T;let y;const A=()=>{var w,N;if(!g)return;const U=++u;c=!1,h.forEach(K=>{var te;return K((te=n())!=null?te:T)});const R=((N=o.onRehydrateStorage)==null?void 0:N.call(o,(w=n())!=null?w:T))||void 0;return Dg(g.getItem.bind(g))(o.name).then(K=>{if(K)if(typeof K.version=="number"&&K.version!==o.version){if(o.migrate){const te=o.migrate(K.state,K.version);return te instanceof Promise?te.then(J=>[!0,J]):[!0,te]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,K.state];return[!1,void 0]}).then(K=>{var te;if(U!==u)return;const[J,b]=K;if(y=o.merge(b,(te=n())!=null?te:T),r(y,!0),J)return x()}).then(()=>{U===u&&(R==null||R(y,void 0),y=n(),c=!0,d.forEach(K=>K(y)))}).catch(K=>{U===u&&(R==null||R(void 0,K))})};return a.persist={setOptions:w=>{o={...o,...w},w.storage&&(g=w.storage)},clearStorage:()=>{g==null||g.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>A(),hasHydrated:()=>c,onHydrate:w=>(h.add(w),()=>{h.delete(w)}),onFinishHydration:w=>(d.add(w),()=>{d.delete(w)})},o.skipHydration||A(),y||T},a8=n8;async function i8(){const t=[];try{const e=JA(wf,"Giocatori");return(await mS(e)).forEach(n=>{t.push({id:n.id,...n.data()})}),t}catch(e){throw console.error("Errore nel recuperare i giocatori: ",e),e}}async function s8(t){const e=eS(),r=r5(e);console.log(`Inizio elaborazione di ${t.length} giocatori...`),t.forEach(n=>{var c,u;const a=((c=n.Cod)==null?void 0:c.toString())||((u=n.id)==null?void 0:u.toString());if(!a){console.error("Salto giocatore: ID mancante",n);return}const o=Ed(e,"Giocatori",a);r.set(o,n)});try{await r.commit(),console.log("Sincronizzazione completata con successo.")}catch(n){throw console.error("Errore durante il commit del batch:",n),n}}const wS=VT()(a8((t,e)=>({giocatori:[],lastFetched:null,loading:!1,fetchGiocatori:async(r=!1)=>{const{giocatori:n,lastFetched:a}=e(),o=Date.now(),c=30*60*1e3;if(!r&&n.length>0&&a&&o-a<c){console.log(" Dati recuperati dal LocalStorage (Zustand Persist)");return}t({loading:!0});try{const u=await i8();t({giocatori:u,lastFetched:o,loading:!1}),console.log(" Query Firestore eseguita: Dati aggiornati")}catch(u){console.error("Errore fetch:",u),t({loading:!1})}},clearCache:()=>{t({giocatori:[],lastFetched:null}),localStorage.removeItem("golasso-giocatori-cache")}}),{name:"golasso-giocatori-cache",storage:TS(()=>localStorage),partialize:t=>({giocatori:t.giocatori,lastFetched:t.lastFetched})})),o8=()=>{const{isEditor:t}=gc(),{giocatori:e,loading:r,fetchGiocatori:n,lastFetched:a}=wS(),[o,c]=_e.useState({field:"Fm",direction:"desc"}),[u,h]=_e.useState(!1),[d,g]=_e.useState(""),[x,_]=_e.useState(0),[T,y]=_e.useState(0),[A,w]=_e.useState(0),[N,U]=_e.useState("TUTTI"),[R,K]=_e.useState("TUTTE"),[te,J]=_e.useState(!1),b=a?`Aggiornato il ${new Date(a).toLocaleDateString([],{day:"2-digit",month:"2-digit"})} alle ${new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:"Dati non sincronizzati",I=()=>{n(!0)};_e.useEffect(()=>{n()},[]);const C=()=>{g(""),_(0),y(2),w(2),U("TUTTI"),K("TUTTE"),J(!1)},V=[...e].filter(O=>O.Pv>=x&&O.Mv>=T&&O.Fm>=A&&O.Nome.toLowerCase().includes(d.toLowerCase())&&(N==="TUTTI"||O.R===N)&&(R==="TUTTE"||R==="LIBERI"&&(O.FantaSquadra==="-"||!O.FantaSquadra)||O.FantaSquadra===R)&&(te||Number(O.Fl)===0||!O.Fl)).sort((O,L)=>{const{field:De,direction:be}=o;let ae=O[De],ue=L[De];return typeof ae=="string"&&typeof ue=="string"?be==="asc"?ae.localeCompare(ue):ue.localeCompare(ae):be==="asc"?ae-ue:ue-ae}),M=O=>{c({field:O,direction:o.field===O&&o.direction==="desc"?"asc":"desc"})};return F.jsxs("div",{className:"flex flex-col h-screen w-full bg-gray-900 text-white overflow-hidden",children:[F.jsx(ES,{}),F.jsxs("main",{className:"flex-1 flex flex-col w-full max-w-7xl mx-auto px-4 py-6 overflow-hidden",children:[F.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 mb-6",children:[F.jsxs("div",{children:[F.jsxs("h2",{className:"text-3xl font-black italic uppercase tracking-tighter",children:["Elenco ",F.jsx("span",{className:"text-emerald-500",children:"Giocatori"})]}),F.jsx("p",{className:"text-gray-500 text-sm font-medium",children:r?"Caricamento in corso...":`Trovati ${V.length} giocatori`})]}),F.jsxs("div",{className:"flex flex-row gap-x-2 content-center",children:[F.jsx("p",{className:"text-gray-500 text-[10px] uppercase font-bold tracking-widest flex items-center",children:b}),F.jsx("button",{onClick:I,disabled:r,title:"Aggiorna dati dal server",className:`p-2 rounded-xl border border-gray-700 bg-gray-800/50 hover:bg-gray-700 transition-all ${r?"opacity-50 cursor-not-allowed":"active:scale-90"}`,children:F.jsx(M5,{className:`w-4 h-4 text-emerald-500 ${r?"animate-spin":""}`})})]}),t&&F.jsxs(Sa,{to:"/statistiche-er",className:"flex items-center gap-2 bg-gray-800 hover:bg-gray-700 text-emerald-400 border border-emerald-500/20 px-4 py-2 rounded-xl transition-all font-bold text-sm",children:[F.jsx(j5,{className:"w-4 h-4"}),"Gestione Giocatori"]})]}),F.jsxs("div",{className:"flex gap-6 flex-1 overflow-hidden",children:[F.jsx("aside",{className:"hidden lg:block",children:F.jsx(xE,{search:d,setSearch:g,minPv:x,setMinPv:_,minMv:T,setMinMv:y,minFm:A,setMinFm:w,role:N,setRole:U,selectedTeam:R,setSelectedTeam:K,showFuoriLista:te,setShowFuoriLista:J,onReset:C})}),F.jsxs("div",{className:"flex-1 flex flex-col bg-gray-800/20 rounded-2xl border border-gray-800 overflow-hidden relative",children:[F.jsx(J5,{sortConfig:o,onSortClick:M}),F.jsx("section",{className:"flex-1 overflow-y-auto p-2 md:p-4 flex flex-col gap-3 custom-scrollbar",children:r?F.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900/40 backdrop-blur-[2px] z-10",children:[F.jsx(Hh,{className:"w-12 h-12 text-emerald-500 animate-spin"}),F.jsx("p",{className:"mt-4 text-emerald-500 font-bold tracking-widest uppercase text-xs animate-pulse",children:"Recupero Dati..."})]}):V.length>0?V.map(O=>F.jsx(p5,{giocatore:O},O.id)):F.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-600 italic py-20",children:[F.jsx("p",{children:"Nessun giocatore corrisponde ai filtri"}),F.jsx("button",{onClick:C,className:"text-emerald-500 underline mt-2",children:"Reset"})]})})]})]})]}),F.jsx("button",{onClick:()=>h(!0),className:"fixed bottom-6 right-6 bg-emerald-600 hover:bg-emerald-500 text-white rounded-2xl w-14 h-14 flex items-center justify-center shadow-2xl shadow-emerald-900/40 lg:hidden transition-transform active:scale-90 z-40",children:F.jsx(I5,{className:"w-6 h-6"})}),u&&F.jsxs("div",{className:"fixed inset-0 z-[60] flex lg:hidden",children:[F.jsx("div",{className:"absolute inset-0 bg-gray-950/80 backdrop-blur-sm",onClick:()=>h(!1)}),F.jsxs("aside",{className:"relative ml-auto w-80 max-w-full h-full bg-gray-900 border-l border-gray-800 p-6 flex flex-col gap-4 shadow-2xl",children:[F.jsxs("div",{className:"flex items-center justify-between mb-4",children:[F.jsx("h3",{className:"text-xl font-bold",children:"Filtra"}),F.jsx("button",{className:"p-2 text-gray-500 hover:text-white",onClick:()=>h(!1),children:""})]}),F.jsx(xE,{search:d,setSearch:g,minPv:x,setMinPv:_,minMv:T,setMinMv:y,minFm:A,setMinFm:w,role:N,setRole:U,selectedTeam:R,setSelectedTeam:K,showFuoriLista:te,setShowFuoriLista:J,onReset:C})]})]})]})},l8=()=>F.jsx("div",{children:"Giocatore"});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var AS=1252,c8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],q1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},X1=function(t){c8.indexOf(t)!=-1&&(AS=q1[0]=t)};function u8(){X1(1252)}var ka=function(t){X1(t)};function SS(){ka(1200),u8()}function _E(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function f8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function bS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var ku=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?f8(t.slice(2)):e==254&&r==255?bS(t.slice(2)):e==65279?t.slice(1):t},J0=function(e){return String.fromCharCode(e)},yE=function(e){return String.fromCharCode(e)},Og,Rs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function EE(t){for(var e="",r=0,n=0,a=0,o=0,c=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),c=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,h=a&63,isNaN(n)?u=h=64:isNaN(a)&&(h=64),e+=Rs.charAt(o)+Rs.charAt(c)+Rs.charAt(u)+Rs.charAt(h);return e}function Yn(t){var e="",r=0,n=0,a=0,o=0,c=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=Rs.indexOf(t.charAt(d++)),c=Rs.indexOf(t.charAt(d++)),r=o<<2|c>>4,e+=String.fromCharCode(r),u=Rs.indexOf(t.charAt(d++)),n=(c&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=Rs.indexOf(t.charAt(d++)),a=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Go=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Gs(t){return gt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function TE(t){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Aa=function(e){return gt?Go(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function qo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function K1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return K1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ks=gt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Go(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function h8(t){for(var e=[],r=0,n=t.length+250,a=Gs(t.length+255),o=0;o<t.length;++o){var c=t.charCodeAt(o);if(c<128)a[r++]=c;else if(c<2048)a[r++]=192|c>>6&31,a[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=t.charCodeAt(++o)&1023;a[r++]=240|c>>8&7,a[r++]=128|c>>2&63,a[r++]=128|u>>6&15|(c&3)<<4,a[r++]=128|u&63}else a[r++]=224|c>>12&15,a[r++]=128|c>>6&63,a[r++]=128|c&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Gs(65535),n=65530)}return e.push(a.slice(0,r)),ks(e)}var An=/\u0000/g,Cu=/[\u0001-\u0006]/g;function Kl(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ca(t,e){var r=""+t;return r.length>=e?r:ar("0",e-r.length)+r}function $1(t,e){var r=""+t;return r.length>=e?r:ar(" ",e-r.length)+r}function zh(t,e){var r=""+t;return r.length>=e?r:r+ar(" ",e-r.length)}function d8(t,e){var r=""+Math.round(t);return r.length>=e?r:ar("0",e-r.length)+r}function m8(t,e){var r=""+t;return r.length>=e?r:ar("0",e-r.length)+r}var wE=Math.pow(2,32);function Pl(t,e){if(t>wE||t<-wE)return d8(t,e);var r=Math.round(t);return m8(r,e)}function Gh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var AE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],$p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function p8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},g8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function qh(t,e,r){for(var n=t<0?-1:1,a=t*n,o=0,c=1,u=0,h=1,d=0,g=0,x=Math.floor(a);d<e&&(x=Math.floor(a),u=x*c+o,g=x*d+h,!(a-x<5e-8));)a=1/(a-x),o=c,c=u,h=d,d=g;if(g>e&&(d>e?(g=h,u=o):(g=d,u=c)),!r)return[0,n*u,g];var _=Math.floor(n*u/g);return[_,n*u-_*g,g]}function Ro(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,c=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)c=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=T8(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var kS=new Date(1899,11,31,0,0,0),v8=kS.getTime(),x8=new Date(1900,2,1,0,0,0);function CS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=x8&&(r+=24*60*60*1e3),(r-(v8+(t.getTimezoneOffset()-kS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Y1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function y8(t){var e=t<0?12:11,r=Y1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function E8(t){var e=Y1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function tf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=y8(t):e===10?r=t.toFixed(10).substr(0,12):r=E8(t),Y1(_8(r.toUpperCase()))}function Vo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):tf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return da(14,CS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function T8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function w8(t,e,r,n){var a="",o=0,c=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return $p[r.m-1][1];case 5:return $p[r.m-1][0];default:return $p[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return AE[r.q][0];default:return AE[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ca(r.S,e.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,o=Math.round(c*(r.S+r.u)),o>=60*c&&(o=0),e==="s"?o===0?"0":""+o/c:(a=Ca(o,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var g=d>0?Ca(h,d):"";return g}function Is(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var RS=/%/g;function A8(t,e,r){var n=e.replace(RS,""),a=e.length-n.length;return Li(t,n,r*Math.pow(10,2*a))+ar("%",a)}function S8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Li(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function IS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+IS(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var NS=/# (\?+)( ?)\/( ?)(\d+)/;function b8(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),o=Math.floor(a/n),c=a-o*n,u=n;return r+(o===0?"":""+o)+" "+(c===0?ar(" ",t[1].length+1+t[4].length):$1(c,t[1].length)+t[2]+"/"+t[3]+Ca(u,t[4].length))}function k8(t,e,r){return r+(e===0?"":""+e)+ar(" ",t[1].length+2+t[4].length)}var DS=/^#*0*\.([0#]+)/,OS=/\).*[0#]/,FS=/\(###\) ###\\?-####/;function yn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function bE(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function kE(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function C8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function R8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ca(t,e,r){if(t.charCodeAt(0)===40&&!e.match(OS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ca("n",n,r):"("+ca("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return S8(t,e,r);if(e.indexOf("%")!==-1)return A8(t,e,r);if(e.indexOf("E")!==-1)return IS(e,r);if(e.charCodeAt(0)===36)return"$"+ca(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Pl(h,e.length);if(e.match(/^[#?]+$/))return a=Pl(r,0),a==="0"&&(a=""),a.length>e.length?a:yn(e.substr(0,e.length-a.length))+a;if(o=e.match(NS))return b8(o,h,d);if(e.match(/^#+0+$/))return d+Pl(h,e.length-e.indexOf("0"));if(o=e.match(DS))return a=bE(r,o[1].length).replace(/^([^\.]+)$/,"$1."+yn(o[1])).replace(/\.$/,"."+yn(o[1])).replace(/\.(\d*)$/,function(y,A){return"."+A+ar("0",yn(o[1]).length-A.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+bE(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Is(Pl(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ca(t,e,-r):Is(""+(Math.floor(r)+C8(r,o[1].length)))+"."+Ca(kE(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return ca(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Kl(ca(t,e.replace(/[\\-]/g,""),r)),c=0,Kl(Kl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return c<a.length?a.charAt(c++):y==="0"?"0":""}));if(e.match(FS))return a=ca(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=qh(h,Math.pow(10,c)-1,!1),a=""+d,g=Li("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=zh(u[2],c),g.length<o[4].length&&(g=yn(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=qh(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?$1(u[1],c)+o[2]+"/"+o[3]+zh(u[2],c):ar(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=Pl(r,0),e.length<=a.length?a:yn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var x=e.indexOf(".")-c,_=e.length-a.length-x;return yn(e.substr(0,x)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return c=kE(r,o[1].length),r<0?"-"+ca(t,e,-r):Is(R8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ca(0,3-y.length):"")+y})+"."+Ca(c,o[1].length);switch(e){case"###,##0.00":return ca(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var T=Is(Pl(h,0));return T!=="0"?d+T:"";case"###,###.00":return ca(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ca(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function I8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Li(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function N8(t,e,r){var n=e.replace(RS,""),a=e.length-n.length;return Li(t,n,r*Math.pow(10,2*a))+ar("%",a)}function MS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+MS(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Wa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(OS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",n,r):"("+Wa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return I8(t,e,r);if(e.indexOf("%")!==-1)return N8(t,e,r);if(e.indexOf("E")!==-1)return MS(e,r);if(e.charCodeAt(0)===36)return"$"+Wa(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Ca(h,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:yn(e.substr(0,e.length-a.length))+a;if(o=e.match(NS))return k8(o,h,d);if(e.match(/^#+0+$/))return d+Ca(h,e.length-e.indexOf("0"));if(o=e.match(DS))return a=(""+r).replace(/^([^\.]+)$/,"$1."+yn(o[1])).replace(/\.$/,"."+yn(o[1])),a=a.replace(/\.(\d*)$/,function(y,A){return"."+A+ar("0",yn(o[1]).length-A.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Is(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(t,e,-r):Is(""+r)+"."+ar("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Wa(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Kl(Wa(t,e.replace(/[\\-]/g,""),r)),c=0,Kl(Kl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return c<a.length?a.charAt(c++):y==="0"?"0":""}));if(e.match(FS))return a=Wa(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=qh(h,Math.pow(10,c)-1,!1),a=""+d,g=Li("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=zh(u[2],c),g.length<o[4].length&&(g=yn(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=qh(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?$1(u[1],c)+o[2]+"/"+o[3]+zh(u[2],c):ar(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:yn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var x=e.indexOf(".")-c,_=e.length-a.length-x;return yn(e.substr(0,x)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Wa(t,e,-r):Is(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ca(0,3-y.length):"")+y})+"."+Ca(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=Is(""+h);return T!=="0"?d+T:"";default:if(e.match(/\.[0#?]*$/))return Wa(t,e.slice(0,e.lastIndexOf(".")),r)+yn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Li(t,e,r){return(r|0)===r?Wa(t,e,r):ca(t,e,r)}function D8(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var PS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function vc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Gh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(PS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function O8(t,e,r,n){for(var a=[],o="",c=0,u="",h="t",d,g,x,_="H";c<t.length;)switch(u=t.charAt(c)){case"G":if(!Gh(t,c))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(x=t.charCodeAt(++c))!==34&&c<t.length;)o+=String.fromCharCode(x);a[a.length]={t:"t",v:o},++c;break;case"\\":var T=t.charAt(++c),y=T==="("||T===")"?T:"t";a[a.length]={t:y,v:T},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:e},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(d==null&&(d=Ro(e,r,t.charAt(c+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Ro(e,r),d==null))return"";for(o=u;++c<t.length&&t.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var A={t:u,v:u};if(d==null&&(d=Ro(e,r)),t.substr(c,3).toUpperCase()==="A/P"?(d!=null&&(A.v=d.H>=12?"P":"A"),A.t="T",_="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(d!=null&&(A.v=d.H>=12?"PM":"AM"),A.t="T",c+=5,_="h"):t.substr(c,5).toUpperCase()==="/"?(d!=null&&(A.v=d.H>=12?"":""),A.t="T",c+=5,_="h"):(A.t="t",++c),d==null&&A.t==="T")return"";a[a.length]=A,h=u;break;case"[":for(o=u;t.charAt(c++)!=="]"&&c<t.length;)o+=t.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(PS)){if(d==null&&(d=Ro(e,r),d==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",vc(t)||(a[a.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++c<t.length&&(u=t.charAt(c))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(c))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++c)===u;)o+=u;a[a.length]={t:u,v:o},h=u;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)o+=t.charAt(c);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++c;break}var w=0,N=0,U;for(c=a.length-1,h="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=_,h="h",w<1&&(w=1);break;case"s":(U=a[c].v.match(/\.0+$/))&&(N=Math.max(N,U[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":h=a[c].t;break;case"m":h==="s"&&(a[c].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[c].v.match(/[Hh]/)&&(w=1),w<2&&a[c].v.match(/[Mm]/)&&(w=2),w<3&&a[c].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var R="",K;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=w8(a[c].t.charCodeAt(0),a[c].v,d,N),a[c].t="t";break;case"n":case"?":for(K=c+1;a[K]!=null&&((u=a[K].t)==="?"||u==="D"||(u===" "||u==="t")&&a[K+1]!=null&&(a[K+1].t==="?"||a[K+1].t==="t"&&a[K+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[K].v==="/"||a[K].v===" "&&a[K+1]!=null&&a[K+1].t=="?"));)a[c].v+=a[K].v,a[K]={v:"",t:";"},++K;R+=a[c].v,c=K-1;break;case"G":a[c].t="t",a[c].v=Vo(e,r);break}var te="",J,b;if(R.length>0){R.charCodeAt(0)==40?(J=e<0&&R.charCodeAt(0)===45?-e:e,b=Li("n",R,J)):(J=e<0&&n>1?-e:e,b=Li("n",R,J),J<0&&a[0]&&a[0].t=="t"&&(b=b.substr(1),a[0].v="-"+a[0].v)),K=b.length-1;var I=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){I=c;break}var C=a.length;if(I===a.length&&b.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(K>=a[c].v.length-1?(K-=a[c].v.length,a[c].v=b.substr(K+1,a[c].v.length)):K<0?a[c].v="":(a[c].v=b.substr(0,K+1),K=-1),a[c].t="t",C=c);K>=0&&C<a.length&&(a[C].v=b.substr(0,K+1)+a[C].v)}else if(I!==a.length&&b.indexOf("E")===-1){for(K=b.indexOf(".")-1,c=I;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(g=a[c].v.indexOf(".")>-1&&c===I?a[c].v.indexOf(".")-1:a[c].v.length-1,te=a[c].v.substr(g+1);g>=0;--g)K>=0&&(a[c].v.charAt(g)==="0"||a[c].v.charAt(g)==="#")&&(te=b.charAt(K--)+te);a[c].v=te,a[c].t="t",C=c}for(K>=0&&C<a.length&&(a[C].v=b.substr(0,K+1)+a[C].v),K=b.indexOf(".")+1,c=I;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==I)){for(g=a[c].v.indexOf(".")>-1&&c===I?a[c].v.indexOf(".")+1:0,te=a[c].v.substr(0,g);g<a[c].v.length;++g)K<b.length&&(te+=b.charAt(K++));a[c].v=te,a[c].t="t",C=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(J=n>1&&e<0&&c>0&&a[c-1].v==="-"?-e:e,a[c].v=Li(a[c].t,a[c].v,J),a[c].t="t");var V="";for(c=0;c!==a.length;++c)a[c]!=null&&(V+=a[c].v);return V}var CE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function RE(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function F8(t,e){var r=D8(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(CE),u=r[1].match(CE);return RE(e,c)?[n,r[0]]:RE(e,u)?[n,r[1]]:[n,r[c!=null&&u!=null?2:1]]}return[n,o]}function da(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[t],n==null&&(n=r.table&&r.table[SE[t]]||it[SE[t]]),n==null&&(n=g8[t]||"General");break}if(Gh(n,0))return Vo(e,r);e instanceof Date&&(e=CS(e,r.date1904));var a=F8(n,e);if(Gh(a[1]))return Vo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return O8(a[1],e,r,a[0])}function No(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(it[r]==null){e<0&&(e=r);continue}if(it[r]==t){e=r;break}}e<0&&(e=391)}return it[e]=t,e}function LS(){it=p8()}var M8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},VS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function P8(t){var e=typeof t=="number"?it[t]:t;return e=e.replace(VS,"(\\d+)"),new RegExp("^"+e+"$")}function L8(t,e,r){var n=-1,a=-1,o=-1,c=-1,u=-1,h=-1;(e.match(VS)||[]).forEach(function(x,_){var T=parseInt(r[_+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=T;break;case"d":o=T;break;case"h":c=T;break;case"s":h=T;break;case"m":c>=0?u=T:a=T;break}}),h>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?d:n==-1&&a==-1&&o==-1?g:d+"T"+g}var V8=function(){var t={};t.version="1.2.0";function e(){for(var b=0,I=new Array(256),C=0;C!=256;++C)b=C,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,I[C]=b;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(b){var I=0,C=0,V=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)M[V]=b[V];for(V=0;V!=256;++V)for(C=b[V],I=256+V;I<4096;I+=256)C=M[I]=C>>>8^b[C&255];var O=[];for(V=1;V!=16;++V)O[V-1]=typeof Int32Array<"u"?M.subarray(V*256,V*256+256):M.slice(V*256,V*256+256);return O}var a=n(r),o=a[0],c=a[1],u=a[2],h=a[3],d=a[4],g=a[5],x=a[6],_=a[7],T=a[8],y=a[9],A=a[10],w=a[11],N=a[12],U=a[13],R=a[14];function K(b,I){for(var C=I^-1,V=0,M=b.length;V<M;)C=C>>>8^r[(C^b.charCodeAt(V++))&255];return~C}function te(b,I){for(var C=I^-1,V=b.length-15,M=0;M<V;)C=R[b[M++]^C&255]^U[b[M++]^C>>8&255]^N[b[M++]^C>>16&255]^w[b[M++]^C>>>24]^A[b[M++]]^y[b[M++]]^T[b[M++]]^_[b[M++]]^x[b[M++]]^g[b[M++]]^d[b[M++]]^h[b[M++]]^u[b[M++]]^c[b[M++]]^o[b[M++]]^r[b[M++]];for(V+=15;M<V;)C=C>>>8^r[(C^b[M++])&255];return~C}function J(b,I){for(var C=I^-1,V=0,M=b.length,O=0,L=0;V<M;)O=b.charCodeAt(V++),O<128?C=C>>>8^r[(C^O)&255]:O<2048?(C=C>>>8^r[(C^(192|O>>6&31))&255],C=C>>>8^r[(C^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,L=b.charCodeAt(V++)&1023,C=C>>>8^r[(C^(240|O>>8&7))&255],C=C>>>8^r[(C^(128|O>>2&63))&255],C=C>>>8^r[(C^(128|L>>6&15|(O&3)<<4))&255],C=C>>>8^r[(C^(128|L&63))&255]):(C=C>>>8^r[(C^(224|O>>12&15))&255],C=C>>>8^r[(C^(128|O>>6&63))&255],C=C>>>8^r[(C^(128|O&63))&255]);return~C}return t.table=r,t.bstr=K,t.buf=te,t.str=J,t}(),wt=function(){var e={};e.version="1.2.1";function r(D,q){for(var H=D.split("/"),z=q.split("/"),G=0,X=0,fe=Math.min(H.length,z.length);G<fe;++G){if(X=H[G].length-z[G].length)return X;if(H[G]!=z[G])return H[G]<z[G]?-1:1}return H.length-z.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var q=D.lastIndexOf("/");return q===-1?D:D.slice(0,q+1)}function a(D){if(D.charAt(D.length-1)=="/")return a(D.slice(0,-1));var q=D.lastIndexOf("/");return q===-1?D:D.slice(q+1)}function o(D,q){typeof q=="string"&&(q=new Date(q));var H=q.getHours();H=H<<6|q.getMinutes(),H=H<<5|q.getSeconds()>>>1,D.write_shift(2,H);var z=q.getFullYear()-1980;z=z<<4|q.getMonth()+1,z=z<<5|q.getDate(),D.write_shift(2,z)}function c(D){var q=D.read_shift(2)&65535,H=D.read_shift(2)&65535,z=new Date,G=H&31;H>>>=5;var X=H&15;H>>>=4,z.setMilliseconds(0),z.setFullYear(H+1980),z.setMonth(X-1),z.setDate(G);var fe=q&31;q>>>=5;var ye=q&63;return q>>>=6,z.setHours(q),z.setMinutes(ye),z.setSeconds(fe<<1),z}function u(D){Xr(D,0);for(var q={},H=0;D.l<=D.length-4;){var z=D.read_shift(2),G=D.read_shift(2),X=D.l+G,fe={};switch(z){case 21589:H=D.read_shift(1),H&1&&(fe.mtime=D.read_shift(4)),G>5&&(H&2&&(fe.atime=D.read_shift(4)),H&4&&(fe.ctime=D.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}D.l=X,q[z]=fe}return q}var h;function d(){return h||(h={})}function g(D,q){if(D[0]==80&&D[1]==75)return Wi(D,q);if((D[0]|32)==109&&(D[1]|32)==105)return Wo(D,q);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var H=3,z=512,G=0,X=0,fe=0,ye=0,se=0,de=[],pe=D.slice(0,512);Xr(pe,0);var ke=x(pe);switch(H=ke[0],H){case 3:z=512;break;case 4:z=4096;break;case 0:if(ke[1]==0)return Wi(D,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}z!==512&&(pe=D.slice(0,z),Xr(pe,28));var Me=D.slice(0,z);_(pe,H);var Be=pe.read_shift(4,"i");if(H===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);pe.l+=4,fe=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),ye=pe.read_shift(4,"i"),G=pe.read_shift(4,"i"),se=pe.read_shift(4,"i"),X=pe.read_shift(4,"i");for(var Oe=-1,Ue=0;Ue<109&&(Oe=pe.read_shift(4,"i"),!(Oe<0));++Ue)de[Ue]=Oe;var Ye=T(D,z);w(se,X,Ye,z,de);var kt=U(Ye,fe,de,z);kt[fe].name="!Directory",G>0&&ye!==L&&(kt[ye].name="!MiniFAT"),kt[de[0]].name="!FAT",kt.fat_addrs=de,kt.ssz=z;var vt={},xt=[],Pn=[],Ma=[];R(fe,kt,Ye,xt,G,vt,Pn,ye),y(Pn,Ma,xt),xt.shift();var pn={FileIndex:Pn,FullPaths:Ma};return q&&q.raw&&(pn.raw={header:Me,sectors:Ye}),pn}function x(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(De,"Header Signature: "),D.l+=16;var q=D.read_shift(2,"u");return[D.read_shift(2,"u"),q]}function _(D,q){var H=9;switch(D.l+=2,H=D.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function T(D,q){for(var H=Math.ceil(D.length/q)-1,z=[],G=1;G<H;++G)z[G-1]=D.slice(G*q,(G+1)*q);return z[H-1]=D.slice(H*q),z}function y(D,q,H){for(var z=0,G=0,X=0,fe=0,ye=0,se=H.length,de=[],pe=[];z<se;++z)de[z]=pe[z]=z,q[z]=H[z];for(;ye<pe.length;++ye)z=pe[ye],G=D[z].L,X=D[z].R,fe=D[z].C,de[z]===z&&(G!==-1&&de[G]!==G&&(de[z]=de[G]),X!==-1&&de[X]!==X&&(de[z]=de[X])),fe!==-1&&(de[fe]=z),G!==-1&&z!=de[z]&&(de[G]=de[z],pe.lastIndexOf(G)<ye&&pe.push(G)),X!==-1&&z!=de[z]&&(de[X]=de[z],pe.lastIndexOf(X)<ye&&pe.push(X));for(z=1;z<se;++z)de[z]===z&&(X!==-1&&de[X]!==X?de[z]=de[X]:G!==-1&&de[G]!==G&&(de[z]=de[G]));for(z=1;z<se;++z)if(D[z].type!==0){if(ye=z,ye!=de[ye])do ye=de[ye],q[z]=q[ye]+"/"+q[z];while(ye!==0&&de[ye]!==-1&&ye!=de[ye]);de[z]=-1}for(q[0]+="/",z=1;z<se;++z)D[z].type!==2&&(q[z]+="/")}function A(D,q,H){for(var z=D.start,G=D.size,X=[],fe=z;H&&G>0&&fe>=0;)X.push(q.slice(fe*O,fe*O+O)),G-=O,fe=bo(H,fe*4);return X.length===0?Ar(0):ks(X).slice(0,D.size)}function w(D,q,H,z,G){var X=L;if(D===L){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var fe=H[D],ye=(z>>>2)-1;if(!fe)return;for(var se=0;se<ye&&(X=bo(fe,se*4))!==L;++se)G.push(X);w(bo(fe,z-4),q-1,H,z,G)}}function N(D,q,H,z,G){var X=[],fe=[];G||(G=[]);var ye=z-1,se=0,de=0;for(se=q;se>=0;){G[se]=!0,X[X.length]=se,fe.push(D[se]);var pe=H[Math.floor(se*4/z)];if(de=se*4&ye,z<4+de)throw new Error("FAT boundary crossed: "+se+" 4 "+z);if(!D[pe])break;se=bo(D[pe],de)}return{nodes:X,data:UE([fe])}}function U(D,q,H,z){var G=D.length,X=[],fe=[],ye=[],se=[],de=z-1,pe=0,ke=0,Me=0,Be=0;for(pe=0;pe<G;++pe)if(ye=[],Me=pe+q,Me>=G&&(Me-=G),!fe[Me]){se=[];var Oe=[];for(ke=Me;ke>=0;){Oe[ke]=!0,fe[ke]=!0,ye[ye.length]=ke,se.push(D[ke]);var Ue=H[Math.floor(ke*4/z)];if(Be=ke*4&de,z<4+Be)throw new Error("FAT boundary crossed: "+ke+" 4 "+z);if(!D[Ue]||(ke=bo(D[Ue],Be),Oe[ke]))break}X[Me]={nodes:ye,data:UE([se])}}return X}function R(D,q,H,z,G,X,fe,ye){for(var se=0,de=z.length?2:0,pe=q[D].data,ke=0,Me=0,Be;ke<pe.length;ke+=128){var Oe=pe.slice(ke,ke+128);Xr(Oe,64),Me=Oe.read_shift(2),Be=ev(Oe,0,Me-de),z.push(Be);var Ue={name:Be,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},Ye=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Ye!==0&&(Ue.ct=K(Oe,Oe.l-8));var kt=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);kt!==0&&(Ue.mt=K(Oe,Oe.l-8)),Ue.start=Oe.read_shift(4,"i"),Ue.size=Oe.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=L,Ue.name=""),Ue.type===5?(se=Ue.start,G>0&&se!==L&&(q[se].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",q[Ue.start]===void 0&&(q[Ue.start]=N(H,Ue.start,q.fat_addrs,q.ssz)),q[Ue.start].name=Ue.name,Ue.content=q[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:se!==L&&Ue.start!==L&&q[se]&&(Ue.content=A(Ue,q[se].data,(q[ye]||{}).data))),Ue.content&&Xr(Ue.content,0),X[Be]=Ue,fe.push(Ue)}}function K(D,q){return new Date((qn(D,q+4)/1e7*Math.pow(2,32)+qn(D,q)/1e7-11644473600)*1e3)}function te(D,q){return d(),g(h.readFileSync(D),q)}function J(D,q){var H=q&&q.type;switch(H||gt&&Buffer.isBuffer(D)&&(H="buffer"),H||"base64"){case"file":return te(D,q);case"base64":return g(Aa(Yn(D)),q);case"binary":return g(Aa(D),q)}return g(D,q)}function b(D,q){var H=q||{},z=H.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=z+"/",D.FileIndex[0]={name:z,type:5}),H.CLSID&&(D.FileIndex[0].clsid=H.CLSID),I(D)}function I(D){var q="Sh33tJ5";if(!wt.find(D,"/"+q)){var H=Ar(4);H[0]=55,H[1]=H[3]=50,H[2]=54,D.FileIndex.push({name:q,type:2,content:H,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+q),C(D)}}function C(D,q){b(D);for(var H=!1,z=!1,G=D.FullPaths.length-1;G>=0;--G){var X=D.FileIndex[G];switch(X.type){case 0:z?H=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(X.R*X.L*X.C)&&(H=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!q)){var fe=new Date(1987,1,19),ye=0,se=Object.create?Object.create(null):{},de=[];for(G=0;G<D.FullPaths.length;++G)se[D.FullPaths[G]]=!0,D.FileIndex[G].type!==0&&de.push([D.FullPaths[G],D.FileIndex[G]]);for(G=0;G<de.length;++G){var pe=n(de[G][0]);z=se[pe],z||(de.push([pe,{name:a(pe).replace("/",""),type:1,clsid:ae,ct:fe,mt:fe,content:null}]),se[pe]=!0)}for(de.sort(function(Be,Oe){return r(Be[0],Oe[0])}),D.FullPaths=[],D.FileIndex=[],G=0;G<de.length;++G)D.FullPaths[G]=de[G][0],D.FileIndex[G]=de[G][1];for(G=0;G<de.length;++G){var ke=D.FileIndex[G],Me=D.FullPaths[G];if(ke.name=a(Me).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||ae,G===0)ke.C=de.length>1?1:-1,ke.size=0,ke.type=5;else if(Me.slice(-1)=="/"){for(ye=G+1;ye<de.length&&n(D.FullPaths[ye])!=Me;++ye);for(ke.C=ye>=de.length?-1:ye,ye=G+1;ye<de.length&&n(D.FullPaths[ye])!=n(Me);++ye);ke.R=ye>=de.length?-1:ye,ke.type=1}else n(D.FullPaths[G+1]||"")==n(Me)&&(ke.R=G+1),ke.type=2}}}function V(D,q){var H=q||{};if(H.fileType=="mad")return Gt(D,H);switch(C(D),H.fileType){case"zip":return ga(D,H)}var z=function(Be){for(var Oe=0,Ue=0,Ye=0;Ye<Be.FileIndex.length;++Ye){var kt=Be.FileIndex[Ye];if(kt.content){var vt=kt.content.length;vt>0&&(vt<4096?Oe+=vt+63>>6:Ue+=vt+511>>9)}}for(var xt=Be.FullPaths.length+3>>2,Pn=Oe+7>>3,Ma=Oe+127>>7,pn=Pn+Ue+xt+Ma,Rn=pn+127>>7,Pa=Rn<=109?0:Math.ceil((Rn-109)/127);pn+Rn+Pa+127>>7>Rn;)Pa=++Rn<=109?0:Math.ceil((Rn-109)/127);var gn=[1,Pa,Rn,Ma,xt,Ue,Oe,0];return Be.FileIndex[0].size=Oe<<6,gn[7]=(Be.FileIndex[0].start=gn[0]+gn[1]+gn[2]+gn[3]+gn[4]+gn[5])+(gn[6]+7>>3),gn}(D),G=Ar(z[7]<<9),X=0,fe=0;{for(X=0;X<8;++X)G.write_shift(1,be[X]);for(X=0;X<8;++X)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),X=0;X<3;++X)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,z[2]),G.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:L),G.write_shift(4,z[3]),G.write_shift(-4,z[1]?z[0]-1:L),G.write_shift(4,z[1]),X=0;X<109;++X)G.write_shift(-4,X<z[2]?z[1]+X:-1)}if(z[1])for(fe=0;fe<z[1];++fe){for(;X<236+fe*127;++X)G.write_shift(-4,X<z[2]?z[1]+X:-1);G.write_shift(-4,fe===z[1]-1?L:fe+1)}var ye=function(Be){for(fe+=Be;X<fe-1;++X)G.write_shift(-4,X+1);Be&&(++X,G.write_shift(-4,L))};for(fe=X=0,fe+=z[1];X<fe;++X)G.write_shift(-4,ue.DIFSECT);for(fe+=z[2];X<fe;++X)G.write_shift(-4,ue.FATSECT);ye(z[3]),ye(z[4]);for(var se=0,de=0,pe=D.FileIndex[0];se<D.FileIndex.length;++se)pe=D.FileIndex[se],pe.content&&(de=pe.content.length,!(de<4096)&&(pe.start=fe,ye(de+511>>9)));for(ye(z[6]+7>>3);G.l&511;)G.write_shift(-4,ue.ENDOFCHAIN);for(fe=X=0,se=0;se<D.FileIndex.length;++se)pe=D.FileIndex[se],pe.content&&(de=pe.content.length,!(!de||de>=4096)&&(pe.start=fe,ye(de+63>>6)));for(;G.l&511;)G.write_shift(-4,ue.ENDOFCHAIN);for(X=0;X<z[4]<<2;++X){var ke=D.FullPaths[X];if(!ke||ke.length===0){for(se=0;se<17;++se)G.write_shift(4,0);for(se=0;se<3;++se)G.write_shift(4,-1);for(se=0;se<12;++se)G.write_shift(4,0);continue}pe=D.FileIndex[X],X===0&&(pe.start=pe.size?pe.start-1:L);var Me=X===0&&H.root||pe.name;if(de=2*(Me.length+1),G.write_shift(64,Me,"utf16le"),G.write_shift(2,de),G.write_shift(1,pe.type),G.write_shift(1,pe.color),G.write_shift(-4,pe.L),G.write_shift(-4,pe.R),G.write_shift(-4,pe.C),pe.clsid)G.write_shift(16,pe.clsid,"hex");else for(se=0;se<4;++se)G.write_shift(4,0);G.write_shift(4,pe.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,pe.start),G.write_shift(4,pe.size),G.write_shift(4,0)}for(X=1;X<D.FileIndex.length;++X)if(pe=D.FileIndex[X],pe.size>=4096)if(G.l=pe.start+1<<9,gt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+511&-512;else{for(se=0;se<pe.size;++se)G.write_shift(1,pe.content[se]);for(;se&511;++se)G.write_shift(1,0)}for(X=1;X<D.FileIndex.length;++X)if(pe=D.FileIndex[X],pe.size>0&&pe.size<4096)if(gt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+63&-64;else{for(se=0;se<pe.size;++se)G.write_shift(1,pe.content[se]);for(;se&63;++se)G.write_shift(1,0)}if(gt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function M(D,q){var H=D.FullPaths.map(function(se){return se.toUpperCase()}),z=H.map(function(se){var de=se.split("/");return de[de.length-(se.slice(-1)=="/"?2:1)]}),G=!1;q.charCodeAt(0)===47?(G=!0,q=H[0].slice(0,-1)+q):G=q.indexOf("/")!==-1;var X=q.toUpperCase(),fe=G===!0?H.indexOf(X):z.indexOf(X);if(fe!==-1)return D.FileIndex[fe];var ye=!X.match(Cu);for(X=X.replace(An,""),ye&&(X=X.replace(Cu,"!")),fe=0;fe<H.length;++fe)if((ye?H[fe].replace(Cu,"!"):H[fe]).replace(An,"")==X||(ye?z[fe].replace(Cu,"!"):z[fe]).replace(An,"")==X)return D.FileIndex[fe];return null}var O=64,L=-2,De="d0cf11e0a1b11ae1",be=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:De,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Le(D,q,H){d();var z=V(D,H);h.writeFileSync(q,z)}function oe(D){for(var q=new Array(D.length),H=0;H<D.length;++H)q[H]=String.fromCharCode(D[H]);return q.join("")}function Y(D,q){var H=V(D,q);switch(q&&q.type||"buffer"){case"file":return d(),h.writeFileSync(q.filename,H),H;case"binary":return typeof H=="string"?H:oe(H);case"base64":return EE(typeof H=="string"?H:oe(H));case"buffer":if(gt)return Buffer.isBuffer(H)?H:Go(H);case"array":return typeof H=="string"?Aa(H):H}return H}var ve;function j(D){try{var q=D.InflateRaw,H=new q;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)ve=D;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function Q(D,q){if(!ve)return $i(D,q);var H=ve.InflateRaw,z=new H,G=z._processChunk(D.slice(D.l),z._finishFlushFlag);return D.l+=z.bytesRead,G}function ee(D){return ve?ve.deflateRawSync(D):nt(D)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(D){var q=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(q>>16|q>>8|q)&255}for(var Fe=typeof Uint8Array<"u",Re=Fe?new Uint8Array(256):[],rt=0;rt<256;++rt)Re[rt]=Ne(rt);function W(D,q){var H=Re[D&255];return q<=8?H>>>8-q:(H=H<<8|Re[D>>8&255],q<=16?H>>>16-q:(H=H<<8|Re[D>>16&255],H>>>24-q))}function Ot(D,q){var H=q&7,z=q>>>3;return(D[z]|(H<=6?0:D[z+1]<<8))>>>H&3}function ot(D,q){var H=q&7,z=q>>>3;return(D[z]|(H<=5?0:D[z+1]<<8))>>>H&7}function St(D,q){var H=q&7,z=q>>>3;return(D[z]|(H<=4?0:D[z+1]<<8))>>>H&15}function at(D,q){var H=q&7,z=q>>>3;return(D[z]|(H<=3?0:D[z+1]<<8))>>>H&31}function Pe(D,q){var H=q&7,z=q>>>3;return(D[z]|(H<=1?0:D[z+1]<<8))>>>H&127}function Kt(D,q,H){var z=q&7,G=q>>>3,X=(1<<H)-1,fe=D[G]>>>z;return H<8-z||(fe|=D[G+1]<<8-z,H<16-z)||(fe|=D[G+2]<<16-z,H<24-z)||(fe|=D[G+3]<<24-z),fe&X}function Ir(D,q,H){var z=q&7,G=q>>>3;return z<=5?D[G]|=(H&7)<<z:(D[G]|=H<<z&255,D[G+1]=(H&7)>>8-z),q+3}function Ur(D,q,H){var z=q&7,G=q>>>3;return H=(H&1)<<z,D[G]|=H,q+1}function Br(D,q,H){var z=q&7,G=q>>>3;return H<<=z,D[G]|=H&255,H>>>=8,D[G+1]=H,q+8}function li(D,q,H){var z=q&7,G=q>>>3;return H<<=z,D[G]|=H&255,H>>>=8,D[G+1]=H&255,D[G+2]=H>>>8,q+16}function dn(D,q){var H=D.length,z=2*H>q?2*H:q+5,G=0;if(H>=q)return D;if(gt){var X=TE(z);if(D.copy)D.copy(X);else for(;G<D.length;++G)X[G]=D[G];return X}else if(Fe){var fe=new Uint8Array(z);if(fe.set)fe.set(D);else for(;G<H;++G)fe[G]=D[G];return fe}return D.length=z,D}function _r(D){for(var q=new Array(D),H=0;H<D;++H)q[H]=0;return q}function bn(D,q,H){var z=1,G=0,X=0,fe=0,ye=0,se=D.length,de=Fe?new Uint16Array(32):_r(32);for(X=0;X<32;++X)de[X]=0;for(X=se;X<H;++X)D[X]=0;se=D.length;var pe=Fe?new Uint16Array(se):_r(se);for(X=0;X<se;++X)de[G=D[X]]++,z<G&&(z=G),pe[X]=0;for(de[0]=0,X=1;X<=z;++X)de[X+16]=ye=ye+de[X-1]<<1;for(X=0;X<se;++X)ye=D[X],ye!=0&&(pe[X]=de[ye+16]++);var ke=0;for(X=0;X<se;++X)if(ke=D[X],ke!=0)for(ye=W(pe[X],z)>>z-ke,fe=(1<<z+4-ke)-1;fe>=0;--fe)q[ye|fe<<ke]=ke&15|X<<4;return z}var Rt=Fe?new Uint16Array(512):_r(512),pt=Fe?new Uint16Array(32):_r(32);if(!Fe){for(var Ft=0;Ft<512;++Ft)Rt[Ft]=0;for(Ft=0;Ft<32;++Ft)pt[Ft]=0}(function(){for(var D=[],q=0;q<32;q++)D.push(5);bn(D,pt,32);var H=[];for(q=0;q<=143;q++)H.push(8);for(;q<=255;q++)H.push(9);for(;q<=279;q++)H.push(7);for(;q<=287;q++)H.push(8);bn(H,Rt,288)})();var jt=function(){for(var q=Fe?new Uint8Array(32768):[],H=0,z=0;H<Ie.length-1;++H)for(;z<Ie[H+1];++z)q[z]=H;for(;z<32768;++z)q[z]=29;var G=Fe?new Uint8Array(259):[];for(H=0,z=0;H<me.length-1;++H)for(;z<me[H+1];++z)G[z]=H;function X(ye,se){for(var de=0;de<ye.length;){var pe=Math.min(65535,ye.length-de),ke=de+pe==ye.length;for(se.write_shift(1,+ke),se.write_shift(2,pe),se.write_shift(2,~pe&65535);pe-- >0;)se[se.l++]=ye[de++]}return se.l}function fe(ye,se){for(var de=0,pe=0,ke=Fe?new Uint16Array(32768):[];pe<ye.length;){var Me=Math.min(65535,ye.length-pe);if(Me<10){for(de=Ir(se,de,+(pe+Me==ye.length)),de&7&&(de+=8-(de&7)),se.l=de/8|0,se.write_shift(2,Me),se.write_shift(2,~Me&65535);Me-- >0;)se[se.l++]=ye[pe++];de=se.l*8;continue}de=Ir(se,de,+(pe+Me==ye.length)+2);for(var Be=0;Me-- >0;){var Oe=ye[pe];Be=(Be<<5^Oe)&32767;var Ue=-1,Ye=0;if((Ue=ke[Be])&&(Ue|=pe&-32768,Ue>pe&&(Ue-=32768),Ue<pe))for(;ye[Ue+Ye]==ye[pe+Ye]&&Ye<250;)++Ye;if(Ye>2){Oe=G[Ye],Oe<=22?de=Br(se,de,Re[Oe+1]>>1)-1:(Br(se,de,3),de+=5,Br(se,de,Re[Oe-23]>>5),de+=3);var kt=Oe<8?0:Oe-4>>2;kt>0&&(li(se,de,Ye-me[Oe]),de+=kt),Oe=q[pe-Ue],de=Br(se,de,Re[Oe]>>3),de-=3;var vt=Oe<4?0:Oe-2>>1;vt>0&&(li(se,de,pe-Ue-Ie[Oe]),de+=vt);for(var xt=0;xt<Ye;++xt)ke[Be]=pe&32767,Be=(Be<<5^ye[pe])&32767,++pe;Me-=Ye-1}else Oe<=143?Oe=Oe+48:de=Ur(se,de,1),de=Br(se,de,Re[Oe]),ke[Be]=pe&32767,++pe}de=Br(se,de,0)-1}return se.l=(de+7)/8|0,se.l}return function(se,de){return se.length<8?X(se,de):fe(se,de)}}();function nt(D){var q=Ar(50+Math.floor(D.length*1.1)),H=jt(D,q);return q.slice(0,H)}var $t=Fe?new Uint16Array(32768):_r(32768),fr=Fe?new Uint16Array(32768):_r(32768),Ht=Fe?new Uint16Array(128):_r(128),mn=1,kn=1;function Ki(D,q){var H=at(D,q)+257;q+=5;var z=at(D,q)+1;q+=5;var G=St(D,q)+4;q+=4;for(var X=0,fe=Fe?new Uint8Array(19):_r(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,de=Fe?new Uint8Array(8):_r(8),pe=Fe?new Uint8Array(8):_r(8),ke=fe.length,Me=0;Me<G;++Me)fe[re[Me]]=X=ot(D,q),se<X&&(se=X),de[X]++,q+=3;var Be=0;for(de[0]=0,Me=1;Me<=se;++Me)pe[Me]=Be=Be+de[Me-1]<<1;for(Me=0;Me<ke;++Me)(Be=fe[Me])!=0&&(ye[Me]=pe[Be]++);var Oe=0;for(Me=0;Me<ke;++Me)if(Oe=fe[Me],Oe!=0){Be=Re[ye[Me]]>>8-Oe;for(var Ue=(1<<7-Oe)-1;Ue>=0;--Ue)Ht[Be|Ue<<Oe]=Oe&7|Me<<3}var Ye=[];for(se=1;Ye.length<H+z;)switch(Be=Ht[Pe(D,q)],q+=Be&7,Be>>>=3){case 16:for(X=3+Ot(D,q),q+=2,Be=Ye[Ye.length-1];X-- >0;)Ye.push(Be);break;case 17:for(X=3+ot(D,q),q+=3;X-- >0;)Ye.push(0);break;case 18:for(X=11+Pe(D,q),q+=7;X-- >0;)Ye.push(0);break;default:Ye.push(Be),se<Be&&(se=Be);break}var kt=Ye.slice(0,H),vt=Ye.slice(H);for(Me=H;Me<286;++Me)kt[Me]=0;for(Me=z;Me<30;++Me)vt[Me]=0;return mn=bn(kt,$t,286),kn=bn(vt,fr,30),q}function ci(D,q){if(D[0]==3&&!(D[1]&3))return[Gs(q),2];for(var H=0,z=0,G=TE(q||1<<18),X=0,fe=G.length>>>0,ye=0,se=0;(z&1)==0;){if(z=ot(D,H),H+=3,z>>>1)z>>1==1?(ye=9,se=5):(H=Ki(D,H),ye=mn,se=kn);else{H&7&&(H+=8-(H&7));var de=D[H>>>3]|D[(H>>>3)+1]<<8;if(H+=32,de>0)for(!q&&fe<X+de&&(G=dn(G,X+de),fe=G.length);de-- >0;)G[X++]=D[H>>>3],H+=8;continue}for(;;){!q&&fe<X+32767&&(G=dn(G,X+32767),fe=G.length);var pe=Kt(D,H,ye),ke=z>>>1==1?Rt[pe]:$t[pe];if(H+=ke&15,ke>>>=4,(ke>>>8&255)===0)G[X++]=ke;else{if(ke==256)break;ke-=257;var Me=ke<8?0:ke-4>>2;Me>5&&(Me=0);var Be=X+me[ke];Me>0&&(Be+=Kt(D,H,Me),H+=Me),pe=Kt(D,H,se),ke=z>>>1==1?pt[pe]:fr[pe],H+=ke&15,ke>>>=4;var Oe=ke<4?0:ke-2>>1,Ue=Ie[ke];for(Oe>0&&(Ue+=Kt(D,H,Oe),H+=Oe),!q&&fe<Be&&(G=dn(G,Be+100),fe=G.length);X<Be;)G[X]=G[X-Ue],++X}}}return q?[G,H+7>>>3]:[G.slice(0,X),H+7>>>3]}function $i(D,q){var H=D.slice(D.l||0),z=ci(H,q);return D.l+=z[1],z[0]}function Yi(D,q){if(D)typeof console<"u"&&console.error(q);else throw new Error(q)}function Wi(D,q){var H=D;Xr(H,0);var z=[],G=[],X={FileIndex:z,FullPaths:G};b(X,{root:q.root});for(var fe=H.length-4;(H[fe]!=80||H[fe+1]!=75||H[fe+2]!=5||H[fe+3]!=6)&&fe>=0;)--fe;H.l=fe+4,H.l+=4;var ye=H.read_shift(2);H.l+=6;var se=H.read_shift(4);for(H.l=se,fe=0;fe<ye;++fe){H.l+=20;var de=H.read_shift(4),pe=H.read_shift(4),ke=H.read_shift(2),Me=H.read_shift(2),Be=H.read_shift(2);H.l+=8;var Oe=H.read_shift(4),Ue=u(H.slice(H.l+ke,H.l+ke+Me));H.l+=ke+Me+Be;var Ye=H.l;H.l=Oe+4,pa(H,de,pe,X,Ue),H.l=Ye}return X}function pa(D,q,H,z,G){D.l+=2;var X=D.read_shift(2),fe=D.read_shift(2),ye=c(D);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var se=D.read_shift(4),de=D.read_shift(4),pe=D.read_shift(4),ke=D.read_shift(2),Me=D.read_shift(2),Be="",Oe=0;Oe<ke;++Oe)Be+=String.fromCharCode(D[D.l++]);if(Me){var Ue=u(D.slice(D.l,D.l+Me));(Ue[21589]||{}).mt&&(ye=Ue[21589].mt),((G||{})[21589]||{}).mt&&(ye=G[21589].mt)}D.l+=Me;var Ye=D.slice(D.l,D.l+de);switch(fe){case 8:Ye=Q(D,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var kt=!1;X&8&&(se=D.read_shift(4),se==134695760&&(se=D.read_shift(4),kt=!0),de=D.read_shift(4),pe=D.read_shift(4)),de!=q&&Yi(kt,"Bad compressed size: "+q+" != "+de),pe!=H&&Yi(kt,"Bad uncompressed size: "+H+" != "+pe),Yt(z,Be,Ye,{unsafe:!0,mt:ye})}function ga(D,q){var H=q||{},z=[],G=[],X=Ar(1),fe=H.compression?8:0,ye=0,se=0,de=0,pe=0,ke=0,Me=D.FullPaths[0],Be=Me,Oe=D.FileIndex[0],Ue=[],Ye=0;for(se=1;se<D.FullPaths.length;++se)if(Be=D.FullPaths[se].slice(Me.length),Oe=D.FileIndex[se],!(!Oe.size||!Oe.content||Be=="Sh33tJ5")){var kt=pe,vt=Ar(Be.length);for(de=0;de<Be.length;++de)vt.write_shift(1,Be.charCodeAt(de)&127);vt=vt.slice(0,vt.l),Ue[ke]=V8.buf(Oe.content,0);var xt=Oe.content;fe==8&&(xt=ee(xt)),X=Ar(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ye),X.write_shift(2,fe),Oe.mt?o(X,Oe.mt):X.write_shift(4,0),X.write_shift(-4,Ue[ke]),X.write_shift(4,xt.length),X.write_shift(4,Oe.content.length),X.write_shift(2,vt.length),X.write_shift(2,0),pe+=X.length,z.push(X),pe+=vt.length,z.push(vt),pe+=xt.length,z.push(xt),X=Ar(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ye),X.write_shift(2,fe),X.write_shift(4,0),X.write_shift(-4,Ue[ke]),X.write_shift(4,xt.length),X.write_shift(4,Oe.content.length),X.write_shift(2,vt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,kt),Ye+=X.l,G.push(X),Ye+=vt.length,G.push(vt),++ke}return X=Ar(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,ke),X.write_shift(2,ke),X.write_shift(4,Ye),X.write_shift(4,pe),X.write_shift(2,0),ks([ks(z),ks(G),X])}var Da={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wn(D,q){if(D.ctype)return D.ctype;var H=D.name||"",z=H.match(/\.([^\.]+)$/);return z&&Da[z[1]]||q&&(z=(H=q).match(/[\.\\]([^\.\\])+$/),z&&Da[z[1]])?Da[z[1]]:"application/octet-stream"}function Ws(D){for(var q=EE(D),H=[],z=0;z<q.length;z+=76)H.push(q.slice(z,z+76));return H.join(`\r
`)+`\r
`}function Oa(D){var q=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var pe=de.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],z=q.split(`\r
`),G=0;G<z.length;++G){var X=z[G];if(X.length==0){H.push("");continue}for(var fe=0;fe<X.length;){var ye=76,se=X.slice(fe,fe+ye);se.charAt(ye-1)=="="?ye--:se.charAt(ye-2)=="="?ye-=2:se.charAt(ye-3)=="="&&(ye-=3),se=X.slice(fe,fe+ye),fe+=ye,fe<X.length&&(se+="="),H.push(se)}}return H.join(`\r
`)}function Qi(D){for(var q=[],H=0;H<D.length;++H){for(var z=D[H];H<=D.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+D[++H];q.push(z)}for(var G=0;G<q.length;++G)q[G]=q[G].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Aa(q.join(`\r
`))}function Fa(D,q,H){for(var z="",G="",X="",fe,ye=0;ye<10;++ye){var se=q[ye];if(!se||se.match(/^\s*$/))break;var de=se.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":z=de[2].trim();break;case"content-type":X=de[2].trim();break;case"content-transfer-encoding":G=de[2].trim();break}}switch(++ye,G.toLowerCase()){case"base64":fe=Aa(Yn(q.slice(ye).join("")));break;case"quoted-printable":fe=Qi(q.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var pe=Yt(D,z.slice(H.length),fe,{unsafe:!0});X&&(pe.ctype=X)}function Wo(D,q){if(oe(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=q&&q.root||"",z=(gt&&Buffer.isBuffer(D)?D.toString("binary"):oe(D)).split(`\r
`),G=0,X="";for(G=0;G<z.length;++G)if(X=z[G],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),H||(H=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),X.slice(0,H.length)!=H););var fe=(z[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var ye="--"+(fe[1]||""),se=[],de=[],pe={FileIndex:se,FullPaths:de};b(pe);var ke,Me=0;for(G=0;G<z.length;++G){var Be=z[G];Be!==ye&&Be!==ye+"--"||(Me++&&Fa(pe,z.slice(ke,G),H),ke=G)}return pe}function Gt(D,q){var H=q||{},z=H.boundary||"SheetJS";z="------="+z;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],X=D.FullPaths[0],fe=X,ye=D.FileIndex[0],se=1;se<D.FullPaths.length;++se)if(fe=D.FullPaths[se].slice(X.length),ye=D.FileIndex[se],!(!ye.size||!ye.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var de=ye.content,pe=gt&&Buffer.isBuffer(de)?de.toString("binary"):oe(de),ke=0,Me=Math.min(1024,pe.length),Be=0,Oe=0;Oe<=Me;++Oe)(Be=pe.charCodeAt(Oe))>=32&&Be<128&&++ke;var Ue=ke>=Me*4/5;G.push(z),G.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+fe),G.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),G.push("Content-Type: "+Wn(ye,fe)),G.push(""),G.push(Ue?Oa(pe):Ws(pe))}return G.push(z+`--\r
`),G.join(`\r
`)}function sr(D){var q={};return b(q,D),q}function Yt(D,q,H,z){var G=z&&z.unsafe;G||b(D);var X=!G&&wt.find(D,q);if(!X){var fe=D.FullPaths[0];q.slice(0,fe.length)==fe?fe=q:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+q).replace("//","/")),X={name:a(q),type:2},D.FileIndex.push(X),D.FullPaths.push(fe),G||wt.utils.cfb_gc(D)}return X.content=H,X.size=H?H.length:0,z&&(z.CLSID&&(X.clsid=z.CLSID),z.mt&&(X.mt=z.mt),z.ct&&(X.ct=z.ct)),X}function Cn(D,q){b(D);var H=wt.find(D,q);if(H){for(var z=0;z<D.FileIndex.length;++z)if(D.FileIndex[z]==H)return D.FileIndex.splice(z,1),D.FullPaths.splice(z,1),!0}return!1}function Qs(D,q,H){b(D);var z=wt.find(D,q);if(z){for(var G=0;G<D.FileIndex.length;++G)if(D.FileIndex[G]==z)return D.FileIndex[G].name=a(H),D.FullPaths[G]=H,!0}return!1}function yc(D){C(D,!0)}return e.find=M,e.read=J,e.parse=g,e.write=Y,e.writeFile=Le,e.utils={cfb_new:sr,cfb_add:Yt,cfb_del:Cn,cfb_mov:Qs,cfb_gc:yc,ReadShift:Lu,CheckField:s4,prep_blob:Xr,bconcat:ks,use_zlib:j,_deflateRaw:nt,_inflateRaw:$i,consts:ue},e}();function U8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ai(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function W1(t){for(var e=[],r=ai(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Xh=new Date(1899,11,30,0,0,0);function Sn(t,e){var r=t.getTime(),n=Xh.getTime()+(t.getTimezoneOffset()-Xh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var US=new Date,B8=Xh.getTime()+(US.getTimezoneOffset()-Xh.getTimezoneOffset())*6e4,IE=US.getTimezoneOffset();function kd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+B8),e.getTimezoneOffset()!==IE&&e.setTime(e.getTime()+(e.getTimezoneOffset()-IE)*6e4),e}function j8(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[o],10)}return e}var NE=new Date("2017-02-19T19:06:09.000Z"),BS=isNaN(NE.getFullYear())?new Date("2/19/17"):NE,H8=BS.getFullYear()==2017;function Vr(t,e){var r=new Date(t);if(H8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(BS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Uo(t,e){if(gt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Iu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Iu(bS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Iu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Iu(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function $r(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=$r(t[r]));return e}function ar(t,e){for(var r="";r.length<e;)r+=t;return r}function Ia(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var z8=["january","february","march","april","may","june","july","august","september","october","november","december"];function ic(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&z8.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var G8=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),c=[o[0]],u=1;u<o.length;++u)c.push(a),c.push(o[u]);return c}}();function jS(t){return t?t.content&&t.type?Uo(t.content,!0):t.data?ku(t.data):t.asNodeBuffer&&gt?ku(t.asNodeBuffer().toString("binary")):t.asBinary?ku(t.asBinary()):t._data&&t._data.getContent?ku(Uo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function HS(t){if(!t)return null;if(t.data)return _E(t.data);if(t.asNodeBuffer&&gt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?_E(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function q8(t){return t&&t.name.slice(-4)===".bin"?HS(t):jS(t)}function ua(t,e){for(var r=t.FullPaths||ai(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var c=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||a==c)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function Q1(t,e){var r=ua(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function vr(t,e,r){if(!r)return q8(Q1(t,e));if(!e)return null;try{return vr(t,e)}catch{return null}}function Xn(t,e,r){if(!r)return jS(Q1(t,e));if(!e)return null;try{return Xn(t,e)}catch{return null}}function X8(t,e,r){return HS(Q1(t,e))}function DE(t){for(var e=t.FullPaths||ai(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function K8(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return gt?n=Go(r):n=h8(r),wt.utils.cfb_add(t,e,n)}wt.utils.cfb_add(t,e,r)}else t.file(e,r)}function zS(t,e){switch(e.type){case"base64":return wt.read(t,{type:"base64"});case"binary":return wt.read(t,{type:"binary"});case"buffer":case"array":return wt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ru(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var GS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,OE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Y8=/<[^>]*>/g,hn=GS.match(OE)?OE:Y8,W8=/<\w*:/,Q8=/<(\/?)\w+:/;function Qe(t,e,r){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var c=t.match($8),u=0,h="",d=0,g="",x="",_=1;if(c)for(d=0;d!=c.length;++d){for(x=c[d],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(g=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(_=(a=x.charCodeAt(o+1))==34||a==39?1:0,h=x.slice(o+1+_,x.length-_),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=h,n[g.toLowerCase()]=h;else{var T=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(n[T]&&g.slice(u-3,u)=="ext")continue;n[T]=h,n[T.toLowerCase()]=h}}return n}function si(t){return t.replace(Q8,"<$1")}var qS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Z8=W1(qS),bt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(u,h){return qS[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,c)+r(a.slice(c+3))}}(),J8=/[&<>'"]/g,eF=/[\u0000-\u001f]/g;function Z1(t){var e=t+"";return e.replace(J8,function(r){return Z8[r]}).replace(/\n/g,"<br/>").replace(eF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var FE=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Qt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Yp(t){for(var e="",r=0,n=0,a=0,o=0,c=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=a&63,e+=String.fromCharCode(c);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}c=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function ME(t){var e=Gs(2*t.length),r,n,a=1,o=0,c=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(e[o++]=c&255,e[o++]=c>>>8,c=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function PE(t){return Go(t,"binary").toString("utf8")}var eh="foo bar baz",Xt=gt&&(PE(eh)==Yp(eh)&&PE||ME(eh)==Yp(eh)&&ME)||Yp,Iu=gt?function(t){return Go(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},rf=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),XS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),tF=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),rF=/<\/?(?:vt:)?variant>/g,nF=/<(?:vt:)([^>]*)>([\s\S]*)</;function LE(t,e){var r=Qe(t),n=t.match(tF(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var c=o.replace(rF,"").match(nF);c&&a.push({v:Xt(c[2]),t:c[1]})}),a}var aF=/(^\s|\s$|\n)/;function iF(t){return ai(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function sF(t,e,r){return"<"+t+(r!=null?iF(r):"")+(e!=null?(e.match(aF)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function J1(t){if(gt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Xt(qo(K1(t)));throw new Error("Bad input format: expected Buffer or string")}var nf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,oF={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},lF=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function cF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function uF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,c=n?-e:e;isFinite(c)?c==0?a=o=0:(a=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(a&15)<<4|o&15,t[r+7]=a>>4|n}var VE=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},UE=gt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Go(e)})):VE(t)}:VE,BE=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Fi(t,a)));return n.join("").replace(An,"")},ev=gt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(An,""):BE(t,e,r)}:BE,jE=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},KS=gt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):jE(t,e,r)}:jE,HE=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(jl(t,a)));return n.join("")},Af=gt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):HE(e,r,n)}:HE,$S=function(t,e){var r=qn(t,e);return r>0?Af(t,e+4,e+4+r-1):""},YS=$S,WS=function(t,e){var r=qn(t,e);return r>0?Af(t,e+4,e+4+r-1):""},QS=WS,ZS=function(t,e){var r=2*qn(t,e);return r>0?Af(t,e+4,e+4+r-1):""},JS=ZS,e4=function(e,r){var n=qn(e,r);return n>0?ev(e,r+4,r+4+n):""},t4=e4,r4=function(t,e){var r=qn(t,e);return r>0?Af(t,e+4,e+4+r):""},n4=r4,a4=function(t,e){return cF(t,e)},Kh=a4,i4=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};gt&&(YS=function(e,r){if(!Buffer.isBuffer(e))return $S(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},QS=function(e,r){if(!Buffer.isBuffer(e))return WS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},JS=function(e,r){if(!Buffer.isBuffer(e))return ZS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},t4=function(e,r){if(!Buffer.isBuffer(e))return e4(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},n4=function(e,r){if(!Buffer.isBuffer(e))return r4(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Kh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):a4(e,r)},i4=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var jl=function(t,e){return t[e]},Fi=function(t,e){return t[e+1]*256+t[e]},fF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},qn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},bo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},hF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Lu(t,e){var r="",n,a,o=[],c,u,h,d;switch(e){case"dbcs":if(d=this.l,gt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Fi(this,d)),d+=2;t*=2;break;case"utf8":r=Af(this,this.l,this.l+t);break;case"utf16le":t*=2,r=ev(this,this.l,this.l+t);break;case"wstr":return Lu.call(this,t,"dbcs");case"lpstr-ansi":r=YS(this,this.l),t=4+qn(this,this.l);break;case"lpstr-cp":r=QS(this,this.l),t=4+qn(this,this.l);break;case"lpwstr":r=JS(this,this.l),t=4+2*qn(this,this.l);break;case"lpp4":t=4+qn(this,this.l),r=t4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+qn(this,this.l),r=n4(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(c=jl(this,this.l+t++))!==0;)o.push(J0(c));r=o.join("");break;case"_wstr":for(t=0,r="";(c=Fi(this,this.l+t))!==0;)o.push(J0(c)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=jl(this,d),this.l=d+1,u=Lu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(J0(Fi(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=jl(this,d),this.l=d+1,u=Lu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(J0(jl(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=jl(this,this.l),this.l++,n;case 2:return n=(e==="i"?fF:Fi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?bo:hF)(this,this.l),this.l+=4,n):(a=qn(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Kh(this,this.l):a=Kh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=KS(this,this.l,t);break}}return this.l+=t,r}var dF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},mF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},pF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function gF(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)pF(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var c=e.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,dF(this,e,this.l);break;case 8:if(n=8,r==="f"){uF(this,e,this.l);break}case 16:break;case-4:n=4,mF(this,e,this.l);break}return this.l+=n,this}function s4(t,e){var r=KS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Xr(t,e){t.l=e,t.read_shift=Lu,t.chk=s4,t.write_shift=gF}function fn(t,e){t.l+=e}function Ar(t){var e=Gs(t);return Xr(e,0),e}function Xi(t,e,r){if(t){var n,a,o;Xr(t,t.l||0);for(var c=t.length,u=0,h=0;t.l<c;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=Jh[u]||Jh[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;h=t.l+o;var g=d.f&&d.f(t,o,r);if(t.l=h,e(g,d,u))return}}}function Fg(){var t=[],e=gt?256:2048,r=function(d){var g=Ar(d);return Xr(g,0),g},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},c=function(){return a(),ks(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:c,_bufs:t}}function Vu(t,e,r){var n=$r(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function zE(t,e,r){var n=$r(t);return n.s=Vu(n.s,e.s,r),n.e=Vu(n.e,e.s,r),n}function Uu(t,e){if(t.cRel&&t.c<0)for(t=$r(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=$r(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=et(t);return!t.cRel&&t.cRel!=null&&(r=_F(r)),!t.rRel&&t.rRel!=null&&(r=vF(r)),r}function Wp(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+br(t.s.c)+":"+(t.e.cRel?"":"$")+br(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Yr(t.s.r)+":"+(t.e.rRel?"":"$")+Yr(t.e.r):Uu(t.s,e.biff)+":"+Uu(t.e,e.biff)}function tv(t){return parseInt(xF(t),10)-1}function Yr(t){return""+(t+1)}function vF(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xF(t){return t.replace(/\$(\d+)$/,"$1")}function rv(t){for(var e=yF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function br(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function _F(t){return t.replace(/^([A-Z])/,"$$$1")}function yF(t){return t.replace(/^\$([A-Z])/,"$1")}function EF(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wn(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function et(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function xc(t){var e=t.indexOf(":");return e==-1?{s:wn(t),e:wn(t)}:{s:wn(t.slice(0,e)),e:wn(t.slice(e+1))}}function At(t,e){return typeof e>"u"||typeof e=="number"?At(t.s,t.e):(typeof t!="string"&&(t=et(t)),typeof e!="string"&&(e=et(e)),t==e?t:t+":"+e)}function ir(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=t.length;for(r=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function GE(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=da(t.z,r?Sn(e):e)}catch{}try{return t.w=da((t.XF||{}).numFmtId||(r?14:0),r?Sn(e):e)}catch{return""+e}}function Gi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?$o[t.v]||t.v:e==null?GE(t,t.v):GE(t,e))}function Ys(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function o4(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),c=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?wn(n.origin):n.origin;c=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=ir(o["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(d.e.r=c=g.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[x].length;++_)if(!(typeof e[x][_]>"u")){var T={v:e[x][_]},y=c+x,A=u+_;if(d.s.r>y&&(d.s.r=y),d.s.c>A&&(d.s.c=A),d.e.r<y&&(d.e.r=y),d.e.c<A&&(d.e.c=A),e[x][_]&&typeof e[x][_]=="object"&&!Array.isArray(e[x][_])&&!(e[x][_]instanceof Date))T=e[x][_];else if(Array.isArray(T.v)&&(T.f=e[x][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(n.nullError)T.t="e",T.v=0;else if(n.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=n.dateNF||it[14],n.cellDates?(T.t="d",T.w=da(T.z,Sn(T.v))):(T.t="n",T.v=Sn(T.v),T.w=da(T.z,T.v))):T.t="s";if(a)o[y]||(o[y]=[]),o[y][A]&&o[y][A].z&&(T.z=o[y][A].z),o[y][A]=T;else{var w=et({c:A,r:y});o[w]&&o[w].z&&(T.z=o[w].z),o[w]=T}}}return d.s.c<1e7&&(o["!ref"]=At(d)),o}function _c(t,e){return o4(null,t,e)}function TF(t){return t.read_shift(4,"i")}function cn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function wF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function nv(t,e){var r=t.l,n=t.read_shift(1),a=cn(t),o=[],c={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(wF(t));c.r=o}else c.r=[{ich:0,ifnt:0}];return t.l=r+e,c}var AF=nv;function ma(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Xo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var SF=cn;function av(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var bF=cn,Mg=av;function iv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Kh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):bo(e,0)>>2;return r?a/100:a}function l4(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Ko=l4;function on(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function kF(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),c=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=Do[a];d&&(e.rgb=sf(d));break;case 2:e.rgb=sf([c,u,h]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function CF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function c4(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function RF(t){return c4(t,1)}function IF(t){return c4(t,2)}var sv=2,On=3,th=11,qE=12,$h=19,rh=64,NF=65,DF=71,OF=4108,FF=4126,Lr=80,u4=81,MF=[Lr,u4],PF={1:{n:"CodePage",t:sv},2:{n:"Category",t:Lr},3:{n:"PresentationFormat",t:Lr},4:{n:"ByteCount",t:On},5:{n:"LineCount",t:On},6:{n:"ParagraphCount",t:On},7:{n:"SlideCount",t:On},8:{n:"NoteCount",t:On},9:{n:"HiddenCount",t:On},10:{n:"MultimediaClipCount",t:On},11:{n:"ScaleCrop",t:th},12:{n:"HeadingPairs",t:OF},13:{n:"TitlesOfParts",t:FF},14:{n:"Manager",t:Lr},15:{n:"Company",t:Lr},16:{n:"LinksUpToDate",t:th},17:{n:"CharacterCount",t:On},19:{n:"SharedDoc",t:th},22:{n:"HyperlinksChanged",t:th},23:{n:"AppVersion",t:On,p:"version"},24:{n:"DigSig",t:NF},26:{n:"ContentType",t:Lr},27:{n:"ContentStatus",t:Lr},28:{n:"Language",t:Lr},29:{n:"Version",t:Lr},255:{},2147483648:{n:"Locale",t:$h},2147483651:{n:"Behavior",t:$h},1919054434:{}},LF={1:{n:"CodePage",t:sv},2:{n:"Title",t:Lr},3:{n:"Subject",t:Lr},4:{n:"Author",t:Lr},5:{n:"Keywords",t:Lr},6:{n:"Comments",t:Lr},7:{n:"Template",t:Lr},8:{n:"LastAuthor",t:Lr},9:{n:"RevNumber",t:Lr},10:{n:"EditTime",t:rh},11:{n:"LastPrinted",t:rh},12:{n:"CreatedDate",t:rh},13:{n:"ModifiedDate",t:rh},14:{n:"PageCount",t:On},15:{n:"WordCount",t:On},16:{n:"CharCount",t:On},17:{n:"Thumbnail",t:DF},18:{n:"Application",t:Lr},19:{n:"DocSecurity",t:On},255:{},2147483648:{n:"Locale",t:$h},2147483651:{n:"Behavior",t:$h},1919054434:{}},XE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},VF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function UF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var BF=UF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Do=$r(BF),$o={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},f4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},KE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function jF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function HF(t){var e=jF();if(!t||!t.match)return e;var r={};if((t.match(hn)||[]).forEach(function(n){var a=Qe(n);switch(a[0].replace(W8,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[KE[a.ContentType]]!==void 0&&e[KE[a.ContentType]].push(a.PartName);break}}),e.xmlns!==oF.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Hl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Pg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Bu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(hn)||[]).forEach(function(a){var o=Qe(a);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Ru(o.Target,e);r[u]=c,n[o.Id]=c}}),r["!id"]=n,r}var zF="application/vnd.oasis.opendocument.spreadsheet";function GF(t,e){for(var r=J1(t),n,a;n=nf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Qe(n[0],!1),a.path=="/"&&a.type!==zF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var ju=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],qF=function(){for(var t=new Array(ju.length),e=0;e<ju.length;++e){var r=ju[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function h4(t){var e={};t=Xt(t);for(var r=0;r<ju.length;++r){var n=ju[r],a=t.match(qF[r]);a!=null&&a.length>0&&(e[n[1]]=bt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Vr(e[n[1]]))}return e}var XF=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function d4(t,e,r,n){var a=[];if(typeof t=="string")a=LE(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(g){return{v:g}}));var c=typeof e=="string"?LE(e,n).map(function(g){return g.v}):e,u=0,h=0;if(c.length>0)for(var d=0;d!==a.length;d+=2){switch(h=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function KF(t,e,r){var n={};return e||(e={}),t=Xt(t),XF.forEach(function(a){var o=(t.match(rf(a[0]))||[])[1];switch(a[2]){case"string":o&&(e[a[1]]=bt(o));break;case"bool":e[a[1]]=o==="true";break;case"raw":var c=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(n[a[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&d4(n.HeadingPairs,n.TitlesOfParts,e,r),e}var $F=/<[^>]+>[^<]*/g;function YF(t,e){var r={},n="",a=t.match($F);if(a)for(var o=0;o!=a.length;++o){var c=a[o],u=Qe(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=bt(u.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),d=h[0].slice(4),g=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=bt(g);break;case"bool":r[n]=Qt(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=Vr(g);break;case"cy":case"error":r[n]=bt(g);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",c,d,h)}}else if(c.slice(0,2)!=="</"){if(e.WTF)throw new Error(c)}}}return r}var WF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qp;function QF(t,e,r){Qp||(Qp=W1(WF)),e=Qp[e]||e,t[e]=r}function ov(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function m4(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function p4(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function g4(t,e,r){return e===31?p4(t):m4(t,e,r)}function Lg(t,e,r){return g4(t,e,r===!1?0:4)}function ZF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return g4(t,e,0)}function JF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(An,""),t.l-a&2&&(t.l+=2)}return r}function eM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(An,"");return r}function tM(t){var e=t.l,r=Yh(t,u4);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Yh(t,On);return[r,n]}function rM(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(tM(t));return r}function $E(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var o=t.read_shift(4),c=t.read_shift(4);n[o]=t.read_shift(c,e===1200?"utf16le":"utf8").replace(An,"").replace(Cu,"!"),e===1200&&c%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function v4(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function nM(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Yh(t,e,r){var n=t.read_shift(2),a,o=r||{};if(t.l+=2,e!==qE&&n!==e&&MF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===qE?n:e){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return m4(t,n,4).replace(An,"");case 31:return p4(t);case 64:return ov(t);case 65:return v4(t);case 71:return nM(t);case 80:return Lg(t,n,!o.raw).replace(An,"");case 81:return ZF(t,n).replace(An,"");case 4108:return rM(t);case 4126:case 4127:return n==4127?JF(t):eM(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function YE(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],c=0,u=0,h=-1,d={};for(c=0;c!=a;++c){var g=t.read_shift(4),x=t.read_shift(4);o[c]=[g,x+r]}o.sort(function(U,R){return U[1]-R[1]});var _={};for(c=0;c!=a;++c){if(t.l!==o[c][1]){var T=!0;if(c>0&&e)switch(e[o[c-1][0]].t){case 2:t.l+2===o[c][1]&&(t.l+=2,T=!1);break;case 80:t.l<=o[c][1]&&(t.l=o[c][1],T=!1);break;case 4108:t.l<=o[c][1]&&(t.l=o[c][1],T=!1);break}if((!e||c==0)&&t.l<=o[c][1]&&(T=!1,t.l=o[c][1]),T)throw new Error("Read Error: Expected address "+o[c][1]+" at "+t.l+" :"+c)}if(e){var y=e[o[c][0]];if(_[y.n]=Yh(t,y.t,{raw:!0}),y.p==="version"&&(_[y.n]=String(_[y.n]>>16)+"."+("0000"+String(_[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(_[y.n]){case 0:_[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ka(u=_[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[y.n])}}else if(o[c][0]===1){if(u=_.CodePage=Yh(t,sv),ka(u),h!==-1){var A=t.l;t.l=o[h][1],d=$E(t,u),t.l=A}}else if(o[c][0]===0){if(u===0){h=c,t.l=o[c+1][1];continue}d=$E(t,u)}else{var w=d[o[c][0]],N;switch(t[t.l]){case 65:t.l+=4,N=v4(t);break;case 30:t.l+=4,N=Lg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,N=Lg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,N=t.read_shift(4,"i");break;case 19:t.l+=4,N=t.read_shift(4);break;case 5:t.l+=4,N=t.read_shift(8,"f");break;case 11:t.l+=4,N=cr(t,4);break;case 64:t.l+=4,N=Vr(ov(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[w]=N}}return t.l=r+n,_}function WE(t,e,r){var n=t.content;if(!n)return{};Xr(n,0);var a,o,c,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),g=n.read_shift(16);if(g!==wt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(c=n.read_shift(16),h=n.read_shift(4));var x=YE(n,e),_={SystemIdentifier:d};for(var T in x)_[T]=x[T];if(_.FMTID=o,a===1)return _;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var y;try{y=YE(n,null)}catch{}for(T in y)_[T]=y[T];return _.FMTID=[o,c],_}function Ts(t,e){return t.read_shift(e),null}function aM(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function cr(t,e){return t.read_shift(e)===1}function xr(t){return t.read_shift(2,"u")}function x4(t,e){return aM(t,e,xr)}function iM(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Sf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var c=n?t.read_shift(n,a):"";return c}function sM(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,o=1+(r&1),c=0,u,h={};a&&(c=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*c),n&&(t.l+=u),h.t=g,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Bo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function bf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Bo(t,n,r)}function Yo(t,e,r){if(r.biff>5)return bf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function oM(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function lM(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(An,"");return n&&(t.l+=24),a}function cM(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=t.read_shift(o>>1,"utf16le").replace(An,"");return r+c}function uM(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return lM(t);case"0303000000000000c000000000000046":return cM(t);default:throw new Error("Unsupported Moniker "+r)}}function nh(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(An,""):"";return r}function fM(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,c,u,h,d="",g,x;a&16&&(o=nh(t,r-t.l)),a&128&&(c=nh(t,r-t.l)),(a&257)===257&&(u=nh(t,r-t.l)),(a&257)===1&&(h=uM(t,r-t.l)),a&8&&(d=nh(t,r-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(x=ov(t)),t.l=r;var _=c||u||h||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),x&&(T.time=x),o&&(T.Tooltip=o),T}function _4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function y4(t,e){var r=_4(t);return r[3]=0,r}function oi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function hM(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function dM(t,e,r){return e===0?"":Yo(t,e,r)}function mM(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[a,o,c]}function E4(t){var e=t.read_shift(2),r=iv(t);return[e,r]}function pM(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=Sf(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Cd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function T4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var gM=T4;function w4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function vM(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function xM(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function rn(t){t.l+=2,t.l+=t.read_shift(2)}var _M={0:rn,4:rn,5:rn,6:rn,7:xM,8:rn,9:rn,10:rn,11:rn,12:rn,13:vM,14:rn,15:rn,16:rn,17:rn,18:rn,19:rn,20:rn,21:w4};function yM(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(_M[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function ah(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function EM(t,e){return e===0||t.read_shift(2),1200}function TM(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Yo(t,0,r);return t.read_shift(e+n-t.l),a}function wM(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function AM(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=Sf(t,0,r);return c.length===0&&(c="Sheet1"),{pos:n,hs:a,dt:o,name:c}}function SM(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),o=[],c=0;c!=a&&t.l<r;++c)o.push(sM(t));return o.Count=n,o.Unique=a,o}function bM(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function kM(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function CM(t){var e=hM(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function RM(t){return t.read_shift(2),t.read_shift(4)}function QE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function IM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:o,CurTab:c,FirstTab:u,Selected:h,TabRatio:d}}function NM(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function DM(){}function OM(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Sf(t,0,r),n}function FM(t){var e=oi(t);return e.isst=t.read_shift(4),e}function MM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=oi(t);r.biff==2&&t.l++;var o=bf(t,n-t.l,r);return a.val=o,a}function PM(t,e,r){var n=t.read_shift(2),a=Yo(t,0,r);return[n,a]}var LM=Yo;function ZE(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,o=t.read_shift(a),c=t.read_shift(a),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:c,c:h}}}function VM(t){var e=t.read_shift(2),r=t.read_shift(2),n=E4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function UM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(E4(t));if(t.l!==r)throw new Error("MulRK read error");var c=t.read_shift(2);if(o.length!=c-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:c,rkrec:o}}function BM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var c=t.read_shift(2);if(o.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:c,ixfe:o}}function jM(t,e,r,n){var a={},o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return a.patternType=VF[u>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function HM(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=jM(t,e,n.fStyle,r),n}function zM(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function JE(t,e,r){var n=oi(t);(r.biff==2||e==9)&&++t.l;var a=iM(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function GM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=oi(t),a=on(t);return n.val=a,n}var eT=dM;function qM(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=Bo(t,o),u=[];n>t.l;)u.push(bf(t));return[o,a,c,u]}function tT(t,e,r){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=pM(t,e-2,r)),o.body=a||t.read_shift(e-2),typeof a=="string"&&(o.Name=a),o}var XM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function rT(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Bo(t,c,r);a&32&&(d=XM[d.charCodeAt(0)]);var g=n-t.l;r&&r.biff==2&&--g;var x=n==t.l||u===0||!(g>0)?[]:k7(t,g,r,u);return{chKey:o,Name:d,itab:h,rgce:x}}function A4(t,e,r){if(r.biff<8)return KM(t,e,r);for(var n=[],a=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(mM(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function KM(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Sf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function $M(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),o=Bo(t,n,r),c=Bo(t,a,r);return[o,c]}function YM(t,e,r){var n=T4(t);t.l++;var a=t.read_shift(1);return e-=8,[C7(t,e,r),a,n]}function nT(t,e,r){var n=gM(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,S7(t,e,r)]}function WM(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function QM(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=Yo(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,c,o]}}function ZM(t,e,r){return QM(t,e,r)}function JM(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Cd(t));return r}function e9(t,e,r){if(r&&r.biff<8)return r9(t,e,r);var n=w4(t),a=yM(t,e-22,n[1]);return{cmo:n,ft:a}}var t9={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function r9(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var c=[];return c.push((t9[n]||fn)(t,e,r)),{cmo:[a,n,o],ft:c}}function n9(t,e,r){var n=t.l,a="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:c=oM(t,6,r);var u=t.read_shift(2);t.read_shift(2),xr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var g=t[t.l],x=Bo(t,t.lens[d+1]-t.lens[d]-1);if(a+=x,a.length>=(g?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function a9(t,e){var r=Cd(t);t.l+=16;var n=fM(t,e-24);return[r,n]}function i9(t,e){t.read_shift(2);var r=Cd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(An,""),[r,n]}function s9(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=XE[r]||r,r=t.read_shift(2),e[1]=XE[r]||r,e}function o9(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(y4(t));return r}function l9(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(y4(t));return r}function c9(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function S4(t,e,r){if(!r.cellStyles)return fn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:o,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function u9(t,e){var r={};return e<32||(t.l+=16,r.header=on(t),r.footer=on(t),t.l+=2),r}function f9(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}var h9=oi,d9=x4,m9=bf;function p9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function g9(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=oi(t);++t.l;var a=Yo(t,e-7,r);return n.t="str",n.val=a,n}function v9(t){var e=oi(t);++t.l;var r=on(t);return e.t="n",e.val=r,e}function x9(t){var e=oi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function _9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function y9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function E9(t,e,r){var n=t.l+e,a=oi(t),o=t.read_shift(2),c=Bo(t,o,r);return t.l=n,a.t="str",a.val=c,a}var T9=[2,3,48,49,131,139,140,245],aT=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=W1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],g=Gs(1);switch(h.type){case"base64":g=Aa(Yn(u));break;case"binary":g=Aa(u);break;case"buffer":case"array":g=u;break}Xr(g,0);var x=g.read_shift(1),_=!!(x&136),T=!1,y=!1;switch(x){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var A=0,w=521;x==2&&(A=g.read_shift(2)),g.l+=3,x!=2&&(A=g.read_shift(4)),A>1048576&&(A=1e6),x!=2&&(w=g.read_shift(2));var N=g.read_shift(2),U=h.codepage||1252;x!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(U=t[g[g.l]]),g.l+=1,g.l+=2),y&&(g.l+=36);for(var R=[],K={},te=Math.min(g.length,x==2?521:w-10-(T?264:0)),J=y?32:11;g.l<te&&g[g.l]!=13;)switch(K={},K.name=Og.utils.decode(U,g.slice(g.l,g.l+J)).replace(/[\u0000\r\n].*$/g,""),g.l+=J,K.type=String.fromCharCode(g.read_shift(1)),x!=2&&!y&&(K.offset=g.read_shift(4)),K.len=g.read_shift(1),x==2&&(K.offset=g.read_shift(2)),K.dec=g.read_shift(1),K.name.length&&R.push(K),x!=2&&(g.l+=y?13:14),K.type){case"B":(!T||K.len!=8)&&h.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+K.type)}if(g[g.l]!==13&&(g.l=w-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=w;var b=0,I=0;for(d[0]=[],I=0;I!=R.length;++I)d[0][I]=R[I].name;for(;A-- >0;){if(g[g.l]===42){g.l+=N;continue}for(++g.l,d[++b]=[],I=0,I=0;I!=R.length;++I){var C=g.slice(g.l,g.l+R[I].len);g.l+=R[I].len,Xr(C,0);var V=Og.utils.decode(U,C);switch(R[I].type){case"C":V.trim().length&&(d[b][I]=V.replace(/\s+$/,""));break;case"D":V.length===8?d[b][I]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):d[b][I]=V;break;case"F":d[b][I]=parseFloat(V.trim());break;case"+":case"I":d[b][I]=y?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":d[b][I]=!0;break;case"N":case"F":d[b][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[b][I]="##MEMO##"+(y?parseInt(V.trim(),10):C.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(d[b][I]=+V||0);break;case"@":d[b][I]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":d[b][I]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":d[b][I]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[b][I]=-C.read_shift(-8,"f");break;case"B":if(T&&R[I].len==8){d[b][I]=C.read_shift(8,"f");break}case"G":case"P":C.l+=R[I].len;break;case"0":if(R[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[I].type)}}}if(x!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=R,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=_c(r(u,d),d);return g["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,g}function a(u,h){try{return Ys(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var d=h||{};if(+d.codepage>=0&&ka(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Fg(),x=zg(u,{header:1,raw:!0,cellDates:!0}),_=x[0],T=x.slice(1),y=u["!cols"]||[],A=0,w=0,N=0,U=1;for(A=0;A<_.length;++A){if(((y[A]||{}).DBF||{}).name){_[A]=y[A].DBF.name,++N;continue}if(_[A]!=null){if(++N,typeof _[A]=="number"&&(_[A]=_[A].toString(10)),typeof _[A]!="string")throw new Error("DBF Invalid column name "+_[A]+" |"+typeof _[A]+"|");if(_.indexOf(_[A])!==A){for(w=0;w<1024;++w)if(_.indexOf(_[A]+"_"+w)==-1){_[A]+="_"+w;break}}}}var R=ir(u["!ref"]),K=[],te=[],J=[];for(A=0;A<=R.e.c-R.s.c;++A){var b="",I="",C=0,V=[];for(w=0;w<T.length;++w)T[w][A]!=null&&V.push(T[w][A]);if(V.length==0||_[A]==null){K[A]="?";continue}for(w=0;w<V.length;++w){switch(typeof V[w]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=V[w]instanceof Date?"D":"C";break;default:I="C"}C=Math.max(C,String(V[w]).length),b=b&&b!=I?"C":I}C>250&&(C=250),I=((y[A]||{}).DBF||{}).type,I=="C"&&y[A].DBF.len>C&&(C=y[A].DBF.len),b=="B"&&I=="N"&&(b="N",J[A]=y[A].DBF.dec,C=y[A].DBF.len),te[A]=b=="C"||I=="N"?C:o[b]||0,U+=te[A],K[A]=b}var M=g.next(32);for(M.write_shift(4,318902576),M.write_shift(4,T.length),M.write_shift(2,296+32*N),M.write_shift(2,U),A=0;A<4;++A)M.write_shift(4,0);for(M.write_shift(4,0|(+e[AS]||3)<<8),A=0,w=0;A<_.length;++A)if(_[A]!=null){var O=g.next(32),L=(_[A].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,L,"sbcs"),O.write_shift(1,K[A]=="?"?"C":K[A],"sbcs"),O.write_shift(4,w),O.write_shift(1,te[A]||o[K[A]]||0),O.write_shift(1,J[A]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),w+=te[A]||o[K[A]]||0}var De=g.next(264);for(De.write_shift(4,13),A=0;A<65;++A)De.write_shift(4,0);for(A=0;A<T.length;++A){var be=g.next(U);for(be.write_shift(1,0),w=0;w<_.length;++w)if(_[w]!=null)switch(K[w]){case"L":be.write_shift(1,T[A][w]==null?63:T[A][w]?84:70);break;case"B":be.write_shift(8,T[A][w]||0,"f");break;case"N":var ae="0";for(typeof T[A][w]=="number"&&(ae=T[A][w].toFixed(J[w]||0)),N=0;N<te[w]-ae.length;++N)be.write_shift(1,32);be.write_shift(1,ae,"sbcs");break;case"D":T[A][w]?(be.write_shift(4,("0000"+T[A][w].getFullYear()).slice(-4),"sbcs"),be.write_shift(2,("00"+(T[A][w].getMonth()+1)).slice(-2),"sbcs"),be.write_shift(2,("00"+T[A][w].getDate()).slice(-2),"sbcs")):be.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(T[A][w]!=null?T[A][w]:"").slice(0,te[w]);for(be.write_shift(1,ue,"sbcs"),N=0;N<te[w]-ue.length;++N)be.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:n,from_sheet:c}}(),w9=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ai(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,T){var y=t[T];return typeof y=="number"?yE(y):y},n=function(_,T,y){var A=T.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return A==59?_:yE(A)};t["|"]=254;function a(_,T){switch(T.type){case"base64":return o(Yn(_),T);case"binary":return o(_,T);case"buffer":return o(gt&&Buffer.isBuffer(_)?_.toString("binary"):qo(_),T);case"array":return o(Uo(_),T)}throw new Error("Unrecognized type "+T.type)}function o(_,T){var y=_.split(/[\n\r]+/),A=-1,w=-1,N=0,U=0,R=[],K=[],te=null,J={},b=[],I=[],C=[],V=0,M;for(+T.codepage>=0&&ka(+T.codepage);N!==y.length;++N){V=0;var O=y[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),L=O.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),De=L[0],be;if(O.length>0)switch(De){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&K.push(O.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,ue=!1,Le=!1,oe=!1,Y=-1,ve=-1;for(U=1;U<L.length;++U)switch(L[U].charAt(0)){case"A":break;case"X":w=parseInt(L[U].slice(1))-1,ue=!0;break;case"Y":for(A=parseInt(L[U].slice(1))-1,ue||(w=0),M=R.length;M<=A;++M)R[M]=[];break;case"K":be=L[U].slice(1),be.charAt(0)==='"'?be=be.slice(1,be.length-1):be==="TRUE"?be=!0:be==="FALSE"?be=!1:isNaN(Ia(be))?isNaN(ic(be).getDate())||(be=Vr(be)):(be=Ia(be),te!==null&&vc(te)&&(be=kd(be))),ae=!0;break;case"E":oe=!0;var j=$l(L[U].slice(1),{r:A,c:w});R[A][w]=[R[A][w],j];break;case"S":Le=!0,R[A][w]=[R[A][w],"S5S"];break;case"G":break;case"R":Y=parseInt(L[U].slice(1))-1;break;case"C":ve=parseInt(L[U].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+O)}if(ae&&(R[A][w]&&R[A][w].length==2?R[A][w][0]=be:R[A][w]=be,te=null),Le){if(oe)throw new Error("SYLK shared formula cannot have own formula");var Q=Y>-1&&R[Y][ve];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");R[A][w][1]=M4(Q[1],{r:A-Y,c:w-ve})}break;case"F":var ee=0;for(U=1;U<L.length;++U)switch(L[U].charAt(0)){case"X":w=parseInt(L[U].slice(1))-1,++ee;break;case"Y":for(A=parseInt(L[U].slice(1))-1,M=R.length;M<=A;++M)R[M]=[];break;case"M":V=parseInt(L[U].slice(1))/20;break;case"F":break;case"G":break;case"P":te=K[parseInt(L[U].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=L[U].slice(1).split(" "),M=parseInt(C[0],10);M<=parseInt(C[1],10);++M)V=parseInt(C[2],10),I[M-1]=V===0?{hidden:!0}:{wch:V},sc(I[M-1]);break;case"C":w=parseInt(L[U].slice(1))-1,I[w]||(I[w]={});break;case"R":A=parseInt(L[U].slice(1))-1,b[A]||(b[A]={}),V>0?(b[A].hpt=V,b[A].hpx=of(V)):V===0&&(b[A].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+O)}ee<1&&(te=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+O)}}return b.length>0&&(J["!rows"]=b),I.length>0&&(J["!cols"]=I),T&&T.sheetRows&&(R=R.slice(0,T.sheetRows)),[R,J]}function c(_,T){var y=a(_,T),A=y[0],w=y[1],N=_c(A,T);return ai(w).forEach(function(U){N[U]=w[U]}),N}function u(_,T){return Ys(c(_,T),T)}function h(_,T,y,A){var w="C;Y"+(y+1)+";X"+(A+1)+";K";switch(_.t){case"n":w+=_.v||0,_.f&&!_.F&&(w+=";E"+cL(_.f,{r:y,c:A}));break;case"b":w+=_.v?"TRUE":"FALSE";break;case"e":w+=_.w||_.v;break;case"d":w+='"'+(_.w||_.v)+'"';break;case"s":w+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(_,T){T.forEach(function(y,A){var w="F;W"+(A+1)+" "+(A+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Qh(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Zh(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&_.push(w)})}function g(_,T){T.forEach(function(y,A){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*D4(y.hpx)+";"),w.length>2&&_.push(w+"R"+(A+1))})}function x(_,T){var y=["ID;PWXL;N;E"],A=[],w=ir(_["!ref"]),N,U=Array.isArray(_),R=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),_["!cols"]&&d(y,_["!cols"]),_["!rows"]&&g(y,_["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var K=w.s.r;K<=w.e.r;++K)for(var te=w.s.c;te<=w.e.c;++te){var J=et({r:K,c:te});N=U?(_[K]||[])[te]:_[J],!(!N||N.v==null&&(!N.f||N.F))&&A.push(h(N,_,K,te))}return y.join(R)+R+A.join(R)+R+"E"+R}return{to_workbook:u,to_sheet:c,from_sheet:x}}(),A9=function(){function t(o,c){switch(c.type){case"base64":return e(Yn(o),c);case"binary":return e(o,c);case"buffer":return e(gt&&Buffer.isBuffer(o)?o.toString("binary"):qo(o),c);case"array":return e(Uo(o),c)}throw new Error("Unrecognized type "+c.type)}function e(o,c){for(var u=o.split(`
`),h=-1,d=-1,g=0,x=[];g!==u.length;++g){if(u[g].trim()==="BOT"){x[++h]=[],d=0;continue}if(!(h<0)){var _=u[g].trim().split(","),T=_[0],y=_[1];++g;for(var A=u[g]||"";(A.match(/["]/g)||[]).length&1&&g<u.length-1;)A+=`
`+u[++g];switch(A=A.trim(),+T){case-1:if(A==="BOT"){x[++h]=[],d=0;continue}else if(A!=="EOD")throw new Error("Unrecognized DIF special command "+A);break;case 0:A==="TRUE"?x[h][d]=!0:A==="FALSE"?x[h][d]=!1:isNaN(Ia(y))?isNaN(ic(y).getDate())?x[h][d]=y:x[h][d]=Vr(y):x[h][d]=Ia(y),++d;break;case 1:A=A.slice(1,A.length-1),A=A.replace(/""/g,'"'),A&&A.match(/^=".*"$/)&&(A=A.slice(2,-1)),x[h][d++]=A!==""?A:null;break}if(A==="EOD")break}}return c&&c.sheetRows&&(x=x.slice(0,c.sheetRows)),x}function r(o,c){return _c(t(o,c),c)}function n(o,c){return Ys(r(o,c),c)}var a=function(){var o=function(h,d,g,x,_){h.push(d),h.push(g+","+x),h.push('"'+_.replace(/"/g,'""')+'"')},c=function(h,d,g,x){h.push(d+","+g),h.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(h){var d=[],g=ir(h["!ref"]),x,_=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,g.e.r-g.s.r+1,""),o(d,"TUPLES",0,g.e.c-g.s.c+1,""),o(d,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){c(d,-1,0,"BOT");for(var y=g.s.c;y<=g.e.c;++y){var A=et({r:T,c:y});if(x=_?(h[T]||[])[y]:h[A],!x){c(d,1,0,"");continue}switch(x.t){case"n":var w=x.w;!w&&x.v!=null&&(w=x.v),w==null?x.f&&!x.F?c(d,1,0,"="+x.f):c(d,1,0,""):c(d,0,w,"V");break;case"b":c(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":c(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=da(x.z||it[14],Sn(Vr(x.v)))),c(d,0,x.w,"V");break;default:c(d,1,0,"")}}}c(d,-1,0,"EOD");var N=`\r
`,U=d.join(N);return U}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),S9=function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,_){for(var T=x.split(`
`),y=-1,A=-1,w=0,N=[];w!==T.length;++w){var U=T[w].trim().split(":");if(U[0]==="cell"){var R=wn(U[1]);if(N.length<=R.r)for(y=N.length;y<=R.r;++y)N[y]||(N[y]=[]);switch(y=R.r,A=R.c,U[2]){case"t":N[y][A]=t(U[3]);break;case"v":N[y][A]=+U[3];break;case"vtf":var K=U[U.length-1];case"vtc":switch(U[3]){case"nl":N[y][A]=!!+U[4];break;default:N[y][A]=+U[4];break}U[2]=="vtf"&&(N[y][A]=[N[y][A],K])}}}return _&&_.sheetRows&&(N=N.slice(0,_.sheetRows)),N}function n(x,_){return _c(r(x,_),_)}function a(x,_){return Ys(n(x,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var _=[],T=[],y,A="",w=xc(x["!ref"]),N=Array.isArray(x),U=w.s.r;U<=w.e.r;++U)for(var R=w.s.c;R<=w.e.c;++R)if(A=et({r:U,c:R}),y=N?(x[U]||[])[R]:x[A],!(!y||y.v==null||y.t==="z")){switch(T=["cell",A,"t"],y.t){case"s":case"str":T.push(e(y.v));break;case"n":y.f?(T[2]="vtf",T[3]="n",T[4]=y.v,T[5]=e(y.f)):(T[2]="v",T[3]=y.v);break;case"b":T[2]="vt"+(y.f?"f":"c"),T[3]="nl",T[4]=y.v?"1":"0",T[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var K=Sn(Vr(y.v));T[2]="vtc",T[3]="nd",T[4]=""+K,T[5]=y.w||da(y.z||it[14],K);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(x){return[o,c,u,c,d(x),h].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:g}}(),af=function(){function t(g,x,_,T,y){y.raw?x[_][T]=g:g===""||(g==="TRUE"?x[_][T]=!0:g==="FALSE"?x[_][T]=!1:isNaN(Ia(g))?isNaN(ic(g).getDate())?x[_][T]=g:x[_][T]=Vr(g):x[_][T]=Ia(g))}function e(g,x){var _=x||{},T=[];if(!g||g.length===0)return T;for(var y=g.split(/[\r\n]/),A=y.length-1;A>=0&&y[A].length===0;)--A;for(var w=10,N=0,U=0;U<=A;++U)N=y[U].indexOf(" "),N==-1?N=y[U].length:N++,w=Math.max(w,N);for(U=0;U<=A;++U){T[U]=[];var R=0;for(t(y[U].slice(0,w).trim(),T,U,R,_),R=1;R<=(y[U].length-w)/10+1;++R)t(y[U].slice(w+(R-1)*10,w+R*10).trim(),T,U,R,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(g){for(var x={},_=!1,T=0,y=0;T<g.length;++T)(y=g.charCodeAt(T))==34?_=!_:!_&&y in r&&(x[y]=(x[y]||0)+1);y=[];for(T in x)Object.prototype.hasOwnProperty.call(x,T)&&y.push([x[T],T]);if(!y.length){x=n;for(T in x)Object.prototype.hasOwnProperty.call(x,T)&&y.push([x[T],T])}return y.sort(function(A,w){return A[0]-w[0]||n[A[1]]-n[w[1]]}),r[y.pop()[1]]||44}function o(g,x){var _=x||{},T="",y=_.dense?[]:{},A={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var w=0,N=0,U=0,R=0,K=0,te=T.charCodeAt(0),J=!1,b=0,I=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var C=_.dateNF!=null?P8(_.dateNF):null;function V(){var M=g.slice(R,K),O={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)O.t="z";else if(_.raw)O.t="s",O.v=M;else if(M.trim().length===0)O.t="s",O.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(O.t="s",O.v=M.slice(2,-1).replace(/""/g,'"')):fL(M)?(O.t="n",O.f=M.slice(1)):(O.t="s",O.v=M);else if(M=="TRUE")O.t="b",O.v=!0;else if(M=="FALSE")O.t="b",O.v=!1;else if(!isNaN(U=Ia(M)))O.t="n",_.cellText!==!1&&(O.w=M),O.v=U;else if(!isNaN(ic(M).getDate())||C&&M.match(C)){O.z=_.dateNF||it[14];var L=0;C&&M.match(C)&&(M=L8(M,_.dateNF,M.match(C)||[]),L=1),_.cellDates?(O.t="d",O.v=Vr(M,L)):(O.t="n",O.v=Sn(Vr(M,L))),_.cellText!==!1&&(O.w=da(O.z,O.v instanceof Date?Sn(O.v):O.v)),_.cellNF||delete O.z}else O.t="s",O.v=M;if(O.t=="z"||(_.dense?(y[w]||(y[w]=[]),y[w][N]=O):y[et({c:N,r:w})]=O),R=K+1,I=g.charCodeAt(R),A.e.c<N&&(A.e.c=N),A.e.r<w&&(A.e.r=w),b==te)++N;else if(N=0,++w,_.sheetRows&&_.sheetRows<=w)return!0}e:for(;K<g.length;++K)switch(b=g.charCodeAt(K)){case 34:I===34&&(J=!J);break;case te:case 10:case 13:if(!J&&V())break e;break}return K-R>0&&V(),y["!ref"]=At(A),y}function c(g,x){return!(x&&x.PRN)||x.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,x):_c(e(g,x),x)}function u(g,x){var _="",T=x.type=="string"?[0,0,0,0]:pv(g,x);switch(x.type){case"base64":_=Yn(g);break;case"binary":_=g;break;case"buffer":x.codepage==65001?_=g.toString("utf8"):(x.codepage,_=gt&&Buffer.isBuffer(g)?g.toString("binary"):qo(g));break;case"array":_=Uo(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+x.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=Xt(_.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?_=Xt(_):x.type=="binary",_.slice(0,19)=="socialcalc:version:"?S9.to_sheet(x.type=="string"?_:Xt(_),x):c(_,x)}function h(g,x){return Ys(u(g,x),x)}function d(g){for(var x=[],_=ir(g["!ref"]),T,y=Array.isArray(g),A=_.s.r;A<=_.e.r;++A){for(var w=[],N=_.s.c;N<=_.e.c;++N){var U=et({r:A,c:N});if(T=y?(g[A]||[])[N]:g[U],!T||T.v==null){w.push("          ");continue}for(var R=(T.w||(Gi(T),T.w)||"").slice(0,10);R.length<10;)R+=" ";w.push(R+(N===0?" ":""))}x.push(w.join(""))}return x.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}}();function b9(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=w9.to_workbook(t,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return af.to_workbook(t,e)}}var Hu=function(){function t(j,Q,ee){if(j){Xr(j,j.l||0);for(var re=ee.Enum||Y;j.l<j.length;){var me=j.read_shift(2),Ie=re[me]||re[65535],Ne=j.read_shift(2),Fe=j.l+Ne,Re=Ie.f&&Ie.f(j,Ne,ee);if(j.l=Fe,Q(Re,Ie,me))return}}}function e(j,Q){switch(Q.type){case"base64":return r(Aa(Yn(j)),Q);case"binary":return r(Aa(j),Q);case"buffer":case"array":return r(j,Q)}throw"Unsupported type "+Q.type}function r(j,Q){if(!j)return j;var ee=Q||{},re=ee.dense?[]:{},me="Sheet1",Ie="",Ne=0,Fe={},Re=[],rt=[],W={s:{r:0,c:0},e:{r:0,c:0}},Ot=ee.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)ee.Enum=Y,t(j,function(Pe,Kt,Ir){switch(Ir){case 0:ee.vers=Pe,Pe>=4096&&(ee.qpro=!0);break;case 6:W=Pe;break;case 204:Pe&&(Ie=Pe);break;case 222:Ie=Pe;break;case 15:case 51:ee.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:Ir==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=ee.dateNF||it[14],ee.cellDates&&(Pe[1].t="d",Pe[1].v=kd(Pe[1].v))),ee.qpro&&Pe[3]>Ne&&(re["!ref"]=At(W),Fe[me]=re,Re.push(me),re=ee.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},Ne=Pe[3],me=Ie||"Sheet"+(Ne+1),Ie="");var Ur=ee.dense?(re[Pe[0].r]||[])[Pe[0].c]:re[et(Pe[0])];if(Ur){Ur.t=Pe[1].t,Ur.v=Pe[1].v,Pe[1].z!=null&&(Ur.z=Pe[1].z),Pe[1].f!=null&&(Ur.f=Pe[1].f);break}ee.dense?(re[Pe[0].r]||(re[Pe[0].r]=[]),re[Pe[0].r][Pe[0].c]=Pe[1]):re[et(Pe[0])]=Pe[1];break}},ee);else if(j[2]==26||j[2]==14)ee.Enum=ve,j[2]==14&&(ee.qpro=!0,j.l=0),t(j,function(Pe,Kt,Ir){switch(Ir){case 204:me=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>Ne&&(re["!ref"]=At(W),Fe[me]=re,Re.push(me),re=ee.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},Ne=Pe[3],me="Sheet"+(Ne+1)),Ot>0&&Pe[0].r>=Ot)break;ee.dense?(re[Pe[0].r]||(re[Pe[0].r]=[]),re[Pe[0].r][Pe[0].c]=Pe[1]):re[et(Pe[0])]=Pe[1],W.e.c<Pe[0].c&&(W.e.c=Pe[0].c),W.e.r<Pe[0].r&&(W.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(rt[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:rt[Pe[0]]=Pe[1],Pe[0]==Ne&&(me=Pe[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(re["!ref"]=At(W),Fe[Ie||me]=re,Re.push(Ie||me),!rt.length)return{SheetNames:Re,Sheets:Fe};for(var ot={},St=[],at=0;at<rt.length;++at)Fe[Re[at]]?(St.push(rt[at]||Re[at]),ot[rt[at]]=Fe[rt[at]]||Fe[Re[at]]):(St.push(rt[at]),ot[rt[at]]={"!ref":"A1"});return{SheetNames:St,Sheets:ot}}function n(j,Q){var ee=Q||{};if(+ee.codepage>=0&&ka(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var re=Fg(),me=ir(j["!ref"]),Ie=Array.isArray(j),Ne=[];Ta(re,0,o(1030)),Ta(re,6,h(me));for(var Fe=Math.min(me.e.r,8191),Re=me.s.r;Re<=Fe;++Re)for(var rt=Yr(Re),W=me.s.c;W<=me.e.c;++W){Re===me.s.r&&(Ne[W]=br(W));var Ot=Ne[W]+rt,ot=Ie?(j[Re]||[])[W]:j[Ot];if(!(!ot||ot.t=="z"))if(ot.t=="n")(ot.v|0)==ot.v&&ot.v>=-32768&&ot.v<=32767?Ta(re,13,T(Re,W,ot.v)):Ta(re,14,A(Re,W,ot.v));else{var St=Gi(ot);Ta(re,15,x(Re,W,St.slice(0,239)))}}return Ta(re,1),re.end()}function a(j,Q){var ee=Q||{};if(+ee.codepage>=0&&ka(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var re=Fg();Ta(re,0,c(j));for(var me=0,Ie=0;me<j.SheetNames.length;++me)(j.Sheets[j.SheetNames[me]]||{})["!ref"]&&Ta(re,27,oe(j.SheetNames[me],Ie++));var Ne=0;for(me=0;me<j.SheetNames.length;++me){var Fe=j.Sheets[j.SheetNames[me]];if(!(!Fe||!Fe["!ref"])){for(var Re=ir(Fe["!ref"]),rt=Array.isArray(Fe),W=[],Ot=Math.min(Re.e.r,8191),ot=Re.s.r;ot<=Ot;++ot)for(var St=Yr(ot),at=Re.s.c;at<=Re.e.c;++at){ot===Re.s.r&&(W[at]=br(at));var Pe=W[at]+St,Kt=rt?(Fe[ot]||[])[at]:Fe[Pe];if(!(!Kt||Kt.t=="z"))if(Kt.t=="n")Ta(re,23,V(ot,at,Ne,Kt.v));else{var Ir=Gi(Kt);Ta(re,22,b(ot,at,Ne,Ir.slice(0,239)))}}++Ne}}return Ta(re,1),re.end()}function o(j){var Q=Ar(2);return Q.write_shift(2,j),Q}function c(j){var Q=Ar(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var ee=0,re=0,me=0,Ie=0;Ie<j.SheetNames.length;++Ie){var Ne=j.SheetNames[Ie],Fe=j.Sheets[Ne];if(!(!Fe||!Fe["!ref"])){++me;var Re=xc(Fe["!ref"]);ee<Re.e.r&&(ee=Re.e.r),re<Re.e.c&&(re=Re.e.c)}}return ee>8191&&(ee=8191),Q.write_shift(2,ee),Q.write_shift(1,me),Q.write_shift(1,re),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function u(j,Q,ee){var re={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&ee.qpro?(re.s.c=j.read_shift(1),j.l++,re.s.r=j.read_shift(2),re.e.c=j.read_shift(1),j.l++,re.e.r=j.read_shift(2),re):(re.s.c=j.read_shift(2),re.s.r=j.read_shift(2),Q==12&&ee.qpro&&(j.l+=2),re.e.c=j.read_shift(2),re.e.r=j.read_shift(2),Q==12&&ee.qpro&&(j.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function h(j){var Q=Ar(8);return Q.write_shift(2,j.s.c),Q.write_shift(2,j.s.r),Q.write_shift(2,j.e.c),Q.write_shift(2,j.e.r),Q}function d(j,Q,ee){var re=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(re[0].c=j.read_shift(1),re[3]=j.read_shift(1),re[0].r=j.read_shift(2),j.l+=2):(re[2]=j.read_shift(1),re[0].c=j.read_shift(2),re[0].r=j.read_shift(2)),re}function g(j,Q,ee){var re=j.l+Q,me=d(j,Q,ee);if(me[1].t="s",ee.vers==20768){j.l++;var Ie=j.read_shift(1);return me[1].v=j.read_shift(Ie,"utf8"),me}return ee.qpro&&j.l++,me[1].v=j.read_shift(re-j.l,"cstr"),me}function x(j,Q,ee){var re=Ar(7+ee.length);re.write_shift(1,255),re.write_shift(2,Q),re.write_shift(2,j),re.write_shift(1,39);for(var me=0;me<re.length;++me){var Ie=ee.charCodeAt(me);re.write_shift(1,Ie>=128?95:Ie)}return re.write_shift(1,0),re}function _(j,Q,ee){var re=d(j,Q,ee);return re[1].v=j.read_shift(2,"i"),re}function T(j,Q,ee){var re=Ar(7);return re.write_shift(1,255),re.write_shift(2,Q),re.write_shift(2,j),re.write_shift(2,ee,"i"),re}function y(j,Q,ee){var re=d(j,Q,ee);return re[1].v=j.read_shift(8,"f"),re}function A(j,Q,ee){var re=Ar(13);return re.write_shift(1,255),re.write_shift(2,Q),re.write_shift(2,j),re.write_shift(8,ee,"f"),re}function w(j,Q,ee){var re=j.l+Q,me=d(j,Q,ee);if(me[1].v=j.read_shift(8,"f"),ee.qpro)j.l=re;else{var Ie=j.read_shift(2);K(j.slice(j.l,j.l+Ie),me),j.l+=Ie}return me}function N(j,Q,ee){var re=Q&32768;return Q&=-32769,Q=(re?j:0)+(Q>=8192?Q-16384:Q),(re?"":"$")+(ee?br(Q):Yr(Q))}var U={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},R=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(j,Q){Xr(j,0);for(var ee=[],re=0,me="",Ie="",Ne="",Fe="";j.l<j.length;){var Re=j[j.l++];switch(Re){case 0:ee.push(j.read_shift(8,"f"));break;case 1:Ie=N(Q[0].c,j.read_shift(2),!0),me=N(Q[0].r,j.read_shift(2),!1),ee.push(Ie+me);break;case 2:{var rt=N(Q[0].c,j.read_shift(2),!0),W=N(Q[0].r,j.read_shift(2),!1);Ie=N(Q[0].c,j.read_shift(2),!0),me=N(Q[0].r,j.read_shift(2),!1),ee.push(rt+W+":"+Ie+me)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(j.read_shift(2));break;case 6:{for(var Ot="";Re=j[j.l++];)Ot+=String.fromCharCode(Re);ee.push('"'+Ot.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:Fe=ee.pop(),Ne=ee.pop(),ee.push(["AND","OR"][Re-20]+"("+Ne+","+Fe+")");break;default:if(Re<32&&R[Re])Fe=ee.pop(),Ne=ee.pop(),ee.push(Ne+R[Re]+Fe);else if(U[Re]){if(re=U[Re][1],re==69&&(re=j[j.l++]),re>ee.length){console.error("WK1 bad formula parse 0x"+Re.toString(16)+":|"+ee.join("|")+"|");return}var ot=ee.slice(-re);ee.length-=re,ee.push(U[Re][0]+"("+ot.join(",")+")")}else return Re<=7?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=24?console.error("WK1 unsupported op "+Re.toString(16)):Re<=30?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=115?console.error("WK1 unsupported function opcode "+Re.toString(16)):console.error("WK1 unrecognized opcode "+Re.toString(16))}}ee.length==1?Q[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function te(j){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=j.read_shift(2),Q[3]=j[j.l++],Q[0].c=j[j.l++],Q}function J(j,Q){var ee=te(j);return ee[1].t="s",ee[1].v=j.read_shift(Q-4,"cstr"),ee}function b(j,Q,ee,re){var me=Ar(6+re.length);me.write_shift(2,j),me.write_shift(1,ee),me.write_shift(1,Q),me.write_shift(1,39);for(var Ie=0;Ie<re.length;++Ie){var Ne=re.charCodeAt(Ie);me.write_shift(1,Ne>=128?95:Ne)}return me.write_shift(1,0),me}function I(j,Q){var ee=te(j);ee[1].v=j.read_shift(2);var re=ee[1].v>>1;if(ee[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return ee[1].v=re,ee}function C(j,Q){var ee=te(j),re=j.read_shift(4),me=j.read_shift(4),Ie=j.read_shift(2);if(Ie==65535)return re===0&&me===3221225472?(ee[1].t="e",ee[1].v=15):re===0&&me===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var Ne=Ie&32768;return Ie=(Ie&32767)-16446,ee[1].v=(1-Ne*2)*(me*Math.pow(2,Ie+32)+re*Math.pow(2,Ie)),ee}function V(j,Q,ee,re){var me=Ar(14);if(me.write_shift(2,j),me.write_shift(1,ee),me.write_shift(1,Q),re==0)return me.write_shift(4,0),me.write_shift(4,0),me.write_shift(2,65535),me;var Ie=0,Ne=0,Fe=0,Re=0;return re<0&&(Ie=1,re=-re),Ne=Math.log2(re)|0,re/=Math.pow(2,Ne-31),Re=re>>>0,(Re&2147483648)==0&&(re/=2,++Ne,Re=re>>>0),re-=Re,Re|=2147483648,Re>>>=0,re*=Math.pow(2,32),Fe=re>>>0,me.write_shift(4,Fe),me.write_shift(4,Re),Ne+=16383+(Ie?32768:0),me.write_shift(2,Ne),me}function M(j,Q){var ee=C(j);return j.l+=Q-14,ee}function O(j,Q){var ee=te(j),re=j.read_shift(4);return ee[1].v=re>>6,ee}function L(j,Q){var ee=te(j),re=j.read_shift(8,"f");return ee[1].v=re,ee}function De(j,Q){var ee=L(j);return j.l+=Q-10,ee}function be(j,Q){return j[j.l+Q-1]==0?j.read_shift(Q,"cstr"):""}function ae(j,Q){var ee=j[j.l++];ee>Q-1&&(ee=Q-1);for(var re="";re.length<ee;)re+=String.fromCharCode(j[j.l++]);return re}function ue(j,Q,ee){if(!(!ee.qpro||Q<21)){var re=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var me=j.read_shift(Q-21,"cstr");return[re,me]}}function Le(j,Q){for(var ee={},re=j.l+Q;j.l<re;){var me=j.read_shift(2);if(me==14e3){for(ee[me]=[0,""],ee[me][0]=j.read_shift(2);j[j.l];)ee[me][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return ee}function oe(j,Q){var ee=Ar(5+j.length);ee.write_shift(2,14e3),ee.write_shift(2,Q);for(var re=0;re<j.length;++re){var me=j.charCodeAt(re);ee[ee.l++]=me>127?95:me}return ee[ee.l++]=0,ee}var Y={0:{n:"BOF",f:xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:be},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:De},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:be},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function k9(t){var e={},r=t.match(hn),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=Qe(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=q1[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return e}var C9=function(){var t=rf("t"),e=rf("rPr");function r(o){var c=o.match(t);if(!c)return{t:"s",v:""};var u={t:"s",v:bt(c[1])},h=o.match(e);return h&&(u.s=k9(h[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(a).map(r).filter(function(u){return u.v})}}(),R9=function(){var e=/(\r\n|\n)/g;function r(a,o,c){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),c.push("</b>")),a.i&&(o.push("<i>"),c.push("</i>")),a.strike&&(o.push("<s>"),c.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),I9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,N9=/<(?:\w+:)?r>/,D9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function lv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=bt(Xt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Xt(t),r&&(n.h=Z1(n.t))):t.match(N9)&&(n.r=Xt(t),n.t=bt(Xt((t.replace(D9,"").match(I9)||[]).join("").replace(hn,""))),r&&(n.h=R9(C9(n.r)))),n):{t:""}}var O9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,F9=/<(?:\w+:)?(?:si|sstItem)>/g,M9=/<\/(?:\w+:)?(?:si|sstItem)>/;function P9(t,e){var r=[],n="";if(!t)return r;var a=t.match(O9);if(a){n=a[2].replace(F9,"").split(M9);for(var o=0;o!=n.length;++o){var c=lv(n[o].trim(),e);c!=null&&(r[r.length]=c)}a=Qe(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function L9(t){return[t.read_shift(4),t.read_shift(4)]}function V9(t,e){var r=[],n=!1;return Xi(t,function(o,c,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function b4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Vi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function U9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Vi(t,4),e.U=Vi(t,4),e.W=Vi(t,4),e}function B9(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function j9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(B9(t));return e}function H9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function z9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Vi(t,4),e.U=Vi(t,4),e.W=Vi(t,4),e}function G9(t){var e=z9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function k4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function C4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function q9(t){var e=Vi(t);switch(e.Minor){case 2:return[e.Minor,X9(t)];case 3:return[e.Minor,K9()];case 4:return[e.Minor,$9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function X9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=k4(t,r),a=C4(t,t.length-t.l);return{t:"Std",h:n,v:a}}function K9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(hn,function(o){var c=Qe(o);switch(si(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=c[u]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function Y9(t,e){var r={},n=r.EncryptionVersionInfo=Vi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=k4(t,a),e-=a,r.EncryptionVerifier=C4(t,e),r}function W9(t){var e={},r=e.EncryptionVersionInfo=Vi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Q9(t){var e=0,r,n=b4(t),a=n.length+1,o,c,u,h,d;for(r=Gs(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)c=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^c;return e^52811}var R4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},a=function(c,u){return n(c^u)},o=function(c){for(var u=e[c.length-1],h=104,d=c.length-1;d>=0;--d)for(var g=c[d],x=0;x!=7;++x)g&64&&(u^=r[h]),g*=2,--h;return u};return function(c){for(var u=b4(c),h=o(u),d=u.length,g=Gs(16),x=0;x!=16;++x)g[x]=0;var _,T,y;for((d&1)===1&&(_=h>>8,g[d]=a(t[0],_),--d,_=h&255,T=u[u.length-1],g[d]=a(T,_));d>0;)--d,_=h>>8,g[d]=a(u[d],_),--d,_=h&255,g[d]=a(u[d],_);for(d=15,y=15-u.length;y>0;)_=h>>8,g[d]=a(t[y],_),--d,--y,_=h&255,g[d]=a(u[d],_),--d,--y;return g}}(),Z9=function(t,e,r,n,a){a||(a=e),n||(n=R4(t));var o,c;for(o=0;o!=e.length;++o)c=e[o],c^=n[r],c=(c>>5|c<<3)&255,a[o]=c,++r;return[a,r,n]},J9=function(t){var e=0,r=R4(t);return function(n){var a=Z9("",n,e,r);return e=a[1],a[0]}};function eP(t,e,r,n){var a={key:xr(t),verificationBytes:xr(t)};return r.password&&(a.verifier=Q9(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=J9(r.password)),a}function tP(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=W9(t):n.Data=Y9(t,e),n}function rP(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?tP(t,e-2,n):eP(t,r.biff>=8?e:e-2,r,n),n}var nP=function(){function t(a,o){switch(o.type){case"base64":return e(Yn(a),o);case"binary":return e(a,o);case"buffer":return e(gt&&Buffer.isBuffer(a)?a.toString("binary"):qo(a),o);case"array":return e(Uo(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var c=o||{},u=c.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,x){Array.isArray(u)&&(u[x]=[]);for(var _=/\\\w+\b/g,T=0,y,A=-1;y=_.exec(g);){switch(y[0]){case"\\cell":var w=g.slice(T,_.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++A,w.length){var N={v:w,t:"s"};Array.isArray(u)?u[x][A]=N:u[et({r:x,c:A})]=N}break}T=_.lastIndex}A>d.e.c&&(d.e.c=A)}),u["!ref"]=At(d),u}function r(a,o){return Ys(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],c=ir(a["!ref"]),u,h=Array.isArray(a),d=c.s.r;d<=c.e.r;++d){o.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var x=et({r:d,c:g});u=h?(a[d]||[])[g]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(Gi(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function aP(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function sf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function iP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),o=Math.min(e,r,n),c=a-o;if(c===0)return[0,0,e];var u=0,h=0,d=a+o;switch(h=c/(d>1?2-d:d),a){case e:u=((r-n)/c+6)%6;break;case r:u=(n-e)/c+2;break;case n:u=(e-r)/c+4;break}return[u/6,h,d/2]}function sP(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),o=n-a/2,c=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=a*u,c[0]+=a,c[1]+=h;break;case 1:h=a*(2-u),c[0]+=h,c[1]+=a;break;case 2:h=a*(u-2),c[1]+=a,c[2]+=h;break;case 3:h=a*(4-u),c[1]+=h,c[2]+=a;break;case 4:h=a*(u-4),c[2]+=a,c[0]+=h;break;case 5:h=a*(6-u),c[2]+=h,c[0]+=a;break}for(var d=0;d!=3;++d)c[d]=Math.round(c[d]*255);return c}function Wh(t,e){if(e===0)return t;var r=iP(aP(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),sf(sP(r))}var I4=6,oP=15,lP=1,Tn=I4;function Qh(t){return Math.floor((t+Math.round(128/Tn)/256)*Tn)}function Zh(t){return Math.floor((t-5)/Tn*100+.5)/100}function Vg(t){return Math.round((t*Tn+5)/Tn*256)/256}function Zp(t){return Vg(Zh(Qh(t)))}function cv(t){var e=Math.abs(t-Zp(t)),r=Tn;if(e>.005)for(Tn=lP;Tn<oP;++Tn)Math.abs(t-Zp(t))<=e&&(e=Math.abs(t-Zp(t)),r=Tn);Tn=r}function sc(t){t.width?(t.wpx=Qh(t.width),t.wch=Zh(t.wpx),t.MDW=Tn):t.wpx?(t.wch=Zh(t.wpx),t.width=Vg(t.wch),t.MDW=Tn):typeof t.wch=="number"&&(t.width=Vg(t.wch),t.wpx=Qh(t.width),t.MDW=Tn),t.customWidth&&delete t.customWidth}var cP=96,N4=cP;function D4(t){return t*96/N4}function of(t){return t*N4/96}var uP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fP(t,e,r,n){e.Borders=[];var a={},o=!1;(t[0].match(hn)||[]).forEach(function(c){var u=Qe(c);switch(si(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Qt(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Qt(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function hP(t,e,r,n){e.Fills=[];var a={},o=!1;(t[0].match(hn)||[]).forEach(function(c){var u=Qe(c);switch(si(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function dP(t,e,r,n){e.Fonts=[];var a={},o=!1;(t[0].match(hn)||[]).forEach(function(c){var u=Qe(c);switch(si(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=Xt(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Qt(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Qt(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Qt(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Qt(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Qt(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Qt(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Qt(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=q1[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Qt(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=Do[a.color.index];a.color.index==81&&(h=Do[1]),h||(h=Do[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Wh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function mP(t,e,r){e.NumberFmt=[];for(var n=ai(it),a=0;a<n.length;++a)e.NumberFmt[n[a]]=it[n[a]];var o=t[0].match(hn);if(o)for(a=0;a<o.length;++a){var c=Qe(o[a]);switch(si(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=bt(Xt(c.formatCode)),h=parseInt(c.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}No(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var ih=["numFmtId","fillId","fontId","borderId","xfId"],sh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pP(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(hn)||[]).forEach(function(o){var c=Qe(o),u=0;switch(si(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],u=0;u<ih.length;++u)n[ih[u]]&&(n[ih[u]]=parseInt(n[ih[u]],10));for(u=0;u<sh.length;++u)n[sh[u]]&&(n[sh[u]]=Qt(n[sh[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=Qt(c.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var gP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&mP(x,g,d),(x=u.match(a))&&dP(x,g,h,d),(x=u.match(n))&&hP(x,g,h,d),(x=u.match(o))&&fP(x,g,h,d),(x=u.match(r))&&pP(x,g,d),g}}();function vP(t,e){var r=t.read_shift(2),n=cn(t);return[r,n]}function xP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=CF(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=kF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=cn(t),n}var _P=fn;function yP(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}var EP=fn;function TP(t,e,r){var n={};n.NumberFmt=[];for(var a in it)n.NumberFmt[a]=it[a];n.CellXf=[],n.Fonts=[];var o=[],c=!1;return Xi(t,function(h,d,g){switch(g){case 44:n.NumberFmt[h[0]]=h[1],No(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=Wh(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(g),c=!0;break;case 38:o.pop(),c=!1;break;default:if(d.T>0)o.push(g);else if(d.T<0)o.pop();else if(!c||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}var wP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function AP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(hn)||[]).forEach(function(a){var o=Qe(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[wP.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function SP(){}function bP(){}var kP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,CP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,RP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function IP(t,e,r){e.themeElements={};var n;[["clrScheme",kP,AP],["fontScheme",CP,SP],["fmtScheme",RP,bP]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var NP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function O4(t,e){(!t||t.length===0)&&(t=DP());var r,n={};if(!(r=t.match(NP)))throw new Error("themeElements not found in theme");return IP(r[0],n,e),n.raw=t,n}function DP(t,e){var r=[GS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function OP(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var c;try{c=zS(o,{type:"array"})}catch{return}var u=Xn(c,"theme/theme/theme1.xml",!0);if(u)return O4(u,r)}}function FP(t){return t.read_shift(4)}function MP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=PP(t,4);break;case 2:e.xclrValue=_4(t);break;case 3:e.xclrValue=FP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function PP(t,e){return fn(t,e)}function LP(t,e){return fn(t,e)}function VP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=MP(t);break;case 6:n[1]=LP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function UP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(VP(t,r-t.l));return{ixfe:n,ext:o}}function BP(t,e){e.forEach(function(r){r[0]})}function jP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:cn(t)}}function HP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function zP(t){return t.l+=4,t.read_shift(4)!=0}function GP(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],c=!1,u=2;return Xi(t,function(h,d,g){switch(g){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(g),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!d.T){if(!c||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function qP(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,c;return t.replace(hn,function(u){var h=Qe(u);switch(si(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(c=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function XP(t){var e=[];if(!t)return e;var r=1;return(t.match(hn)||[]).forEach(function(n){var a=Qe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function KP(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=et(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function $P(t,e,r){var n=[];return Xi(t,function(o,c,u){switch(u){case 63:n.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function YP(t,e,r,n){if(!t)return t;var a=n||{},o=!1;Xi(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function WP(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function iT(t,e,r,n){var a=Array.isArray(t),o;e.forEach(function(c){var u=wn(c.ref);if(a?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[c.ref],!o){o={t:"z"},a?t[u.r][u.c]=o:t[c.ref]=o;var h=ir(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=At(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var g={a:c.author,t:c.t,r:c.r,T:r};c.h&&(g.h=c.h);for(var x=o.c.length-1;x>=0;--x){if(!r&&o.c[x].T)return;r&&!o.c[x].T&&o.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(g.a==n[x].id){g.a=n[x].name||g.a;break}}o.c.push(g)})}function QP(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=Qe(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=wn(h.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var x=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!x&&!!x[1]&&lv(x[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function ZP(t,e){var r=[],n=!1,a={},o=0;return t.replace(hn,function(u,h){var d=Qe(u);switch(si(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":a.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function JP(t,e){var r=[],n=!1;return t.replace(hn,function(o){var c=Qe(o);switch(si(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function eL(t){var e={};e.iauthor=t.read_shift(4);var r=Ko(t);return e.rfx=r.s,e.ref=et(r.s),t.l+=16,e}var tL=cn;function rL(t,e){var r=[],n=[],a={},o=!1;return Xi(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var nL="application/vnd.ms-office.vbaProject";function aL(t){var e=wt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");wt.utils.cfb_add(e,a,t.FileIndex[n].content)}}),wt.write(e)}function iL(){return{"!type":"dialog"}}function sL(){return{"!type":"dialog"}}function oL(){return{"!type":"macro"}}function lL(){return{"!type":"macro"}}var $l=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,o,c){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=e.c:--g,h?d+=e.r:--d,a+(u?"":"$")+br(g)+(h?"":"$")+Yr(d)}return function(a,o){return e=o,a.replace(t,r)}}(),F4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,cL=function(){return function(e,r){return e.replace(F4,function(n,a,o,c,u,h){var d=rv(c)-(o?0:r.c),g=tv(h)-(u?0:r.r),x=g==0?"":u?g+1:"["+g+"]",_=d==0?"":o?d+1:"["+d+"]";return a+"R"+x+"C"+_})}}();function M4(t,e){return t.replace(F4,function(r,n,a,o,c,u){return n+(a=="$"?a+o:br(rv(o)+e.c))+(c=="$"?c+u:Yr(tv(u)+e.r))})}function uL(t,e,r){var n=xc(e),a=n.s,o=wn(r),c={r:o.r-a.r,c:o.c-a.c};return M4(t,c)}function fL(t){return t.length!=1}function sT(t){return t.replace(/_xlfn\./g,"")}function pr(t){t.l+=1}function qs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function P4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return L4(t);r.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),c=qs(t),u=qs(t);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function L4(t){var e=qs(t),r=qs(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function hL(t,e,r){if(r.biff<8)return L4(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),o=qs(t),c=qs(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function V4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return dL(t);var n=t.read_shift(r&&r.biff==12?4:2),a=qs(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function dL(t){var e=qs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function mL(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function pL(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return gL(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:c,rRel:u}}function gL(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function vL(t,e,r){var n=(t[t.l++]&96)>>5,a=P4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function xL(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var c=P4(t,o,r);return[n,a,c]}function _L(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yL(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function EL(t,e,r){var n=(t[t.l++]&96)>>5,a=hL(t,e-1,r);return[n,a]}function TL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function oT(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function wL(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function AL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function SL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function bL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function kL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function U4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function CL(t){return t.read_shift(2),U4(t)}function RL(t){return t.read_shift(2),U4(t)}function IL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=V4(t,0,r);return[n,a]}function NL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=pL(t,0,r);return[n,a]}function DL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=V4(t,0,r);return[n,a,o]}function OL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[F7[a],H4[a],n]}function FL(t,e,r){var n=t[t.l++],a=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:ML(t);return[a,(o[0]===0?H4:O7)[o[1]]]}function ML(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function PL(t,e,r){t.l+=r&&r.biff==2?3:4}function LL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function VL(t){return t.l++,$o[t.read_shift(1)]}function UL(t){return t.l++,t.read_shift(2)}function BL(t){return t.l++,t.read_shift(1)!==0}function jL(t){return t.l++,on(t)}function HL(t,e,r){return t.l++,Sf(t,e-1,r)}function zL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=cr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=$o[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=on(t);break;case 2:r[1]=Yo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function GL(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?Ko:Cd)(t));return a}function qL(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,c=[];o!=n&&(c[o]=[]);++o)for(var u=0;u!=a;++u)c[o][u]=zL(t,r.biff);return c}function XL(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function KL(t,e,r){if(r.biff==5)return $L(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function $L(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function YL(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function WL(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function QL(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function ZL(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var JL=fn,e7=fn,t7=fn;function kf(t,e,r){return t.l+=2,[mL(t)]}function uv(t){return t.l+=6,[]}var r7=kf,n7=uv,a7=uv,i7=kf;function B4(t){return t.l+=2,[xr(t),t.read_shift(2)&1]}var s7=kf,o7=B4,l7=uv,c7=kf,u7=kf,f7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function h7(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),c=f7[r>>2&31];return{ixti:e,coltype:r&3,rt:c,idx:n,c:a,C:o}}function d7(t){return t.l+=2,[t.read_shift(4)]}function m7(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function p7(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function g7(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function v7(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function x7(t){return t.l+=4,[0,0]}var lT={1:{n:"PtgExp",f:LL},2:{n:"PtgTbl",f:t7},3:{n:"PtgAdd",f:pr},4:{n:"PtgSub",f:pr},5:{n:"PtgMul",f:pr},6:{n:"PtgDiv",f:pr},7:{n:"PtgPower",f:pr},8:{n:"PtgConcat",f:pr},9:{n:"PtgLt",f:pr},10:{n:"PtgLe",f:pr},11:{n:"PtgEq",f:pr},12:{n:"PtgGe",f:pr},13:{n:"PtgGt",f:pr},14:{n:"PtgNe",f:pr},15:{n:"PtgIsect",f:pr},16:{n:"PtgUnion",f:pr},17:{n:"PtgRange",f:pr},18:{n:"PtgUplus",f:pr},19:{n:"PtgUminus",f:pr},20:{n:"PtgPercent",f:pr},21:{n:"PtgParen",f:pr},22:{n:"PtgMissArg",f:pr},23:{n:"PtgStr",f:HL},26:{n:"PtgSheet",f:m7},27:{n:"PtgEndSheet",f:p7},28:{n:"PtgErr",f:VL},29:{n:"PtgBool",f:BL},30:{n:"PtgInt",f:UL},31:{n:"PtgNum",f:jL},32:{n:"PtgArray",f:TL},33:{n:"PtgFunc",f:OL},34:{n:"PtgFuncVar",f:FL},35:{n:"PtgName",f:XL},36:{n:"PtgRef",f:IL},37:{n:"PtgArea",f:vL},38:{n:"PtgMemArea",f:YL},39:{n:"PtgMemErr",f:JL},40:{n:"PtgMemNoMem",f:e7},41:{n:"PtgMemFunc",f:WL},42:{n:"PtgRefErr",f:QL},43:{n:"PtgAreaErr",f:_L},44:{n:"PtgRefN",f:NL},45:{n:"PtgAreaN",f:EL},46:{n:"PtgMemAreaN",f:g7},47:{n:"PtgMemNoMemN",f:v7},57:{n:"PtgNameX",f:KL},58:{n:"PtgRef3d",f:DL},59:{n:"PtgArea3d",f:xL},60:{n:"PtgRefErr3d",f:ZL},61:{n:"PtgAreaErr3d",f:yL},255:{}},_7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},y7={1:{n:"PtgElfLel",f:B4},2:{n:"PtgElfRw",f:c7},3:{n:"PtgElfCol",f:r7},6:{n:"PtgElfRwV",f:u7},7:{n:"PtgElfColV",f:i7},10:{n:"PtgElfRadical",f:s7},11:{n:"PtgElfRadicalS",f:l7},13:{n:"PtgElfColS",f:n7},15:{n:"PtgElfColSV",f:a7},16:{n:"PtgElfRadicalLel",f:o7},25:{n:"PtgList",f:h7},29:{n:"PtgSxName",f:d7},255:{}},E7={0:{n:"PtgAttrNoop",f:x7},1:{n:"PtgAttrSemi",f:kL},2:{n:"PtgAttrIf",f:SL},4:{n:"PtgAttrChoose",f:wL},8:{n:"PtgAttrGoto",f:AL},16:{n:"PtgAttrSum",f:PL},32:{n:"PtgAttrBaxcel",f:oT},33:{n:"PtgAttrBaxcel",f:oT},64:{n:"PtgAttrSpace",f:CL},65:{n:"PtgAttrSpaceSemi",f:RL},128:{n:"PtgAttrIfError",f:bL},255:{}};function Cf(t,e,r,n){if(n.biff<8)return fn(t,e);for(var a=t.l+e,o=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=qL(t,0,n),o.push(r[c][1]);break;case"PtgMemArea":r[c][2]=GL(t,r[c][1],n),o.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=t.read_shift(4),o.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return e=a-t.l,e!==0&&o.push(fn(t,e)),o}function Rf(t,e,r){for(var n=t.l+e,a,o,c=[];n!=t.l;)e=n-t.l,o=t[t.l],a=lT[o]||lT[_7[o]],(o===24||o===25)&&(a=(o===24?y7:E7)[t[t.l+1]]),!a||!a.f?fn(t,e):c.push([a.n,a.f(t,e,r)]);return c}function T7(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],o=0;o<n.length;++o){var c=n[o];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var w7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function A7(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function j4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function cT(t,e,r){var n=j4(t,e,r);return n=="#REF"?n:A7(n,r)}function an(t,e,r,n,a){var o=a&&a.biff||8,c={s:{c:0,r:0}},u=[],h,d,g,x=0,_=0,T,y="";if(!t[0]||!t[0][0])return"";for(var A=-1,w="",N=0,U=t[0].length;N<U;++N){var R=t[0][N];switch(R[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),A>=0){switch(t[0][A][1][0]){case 0:w=ar(" ",t[0][A][1][1]);break;case 1:w=ar("\r",t[0][A][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][A][1][0])}d=d+w,A=-1}u.push(d+w7[R[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Vu(R[1][1],c,a),u.push(Uu(g,o));break;case"PtgRefN":g=r?Vu(R[1][1],r,a):R[1][1],u.push(Uu(g,o));break;case"PtgRef3d":x=R[1][1],g=Vu(R[1][2],c,a),y=cT(n,x,a),u.push(y+"!"+Uu(g,o));break;case"PtgFunc":case"PtgFuncVar":var K=R[1][0],te=R[1][1];K||(K=0),K&=127;var J=K==0?[]:u.slice(-K);u.length-=K,te==="User"&&(te=J.shift()),u.push(te+"("+J.join(",")+")");break;case"PtgBool":u.push(R[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(R[1]);break;case"PtgNum":u.push(String(R[1]));break;case"PtgStr":u.push('"'+R[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(R[1]);break;case"PtgAreaN":T=zE(R[1][1],r?{s:r}:c,a),u.push(Wp(T,a));break;case"PtgArea":T=zE(R[1][1],c,a),u.push(Wp(T,a));break;case"PtgArea3d":x=R[1][1],T=R[1][2],y=cT(n,x,a),u.push(y+"!"+Wp(T,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=R[1][2];var b=(n.names||[])[_-1]||(n[0]||[])[_],I=b?b.Name:"SH33TJSNAME"+String(_);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),u.push(I);break;case"PtgNameX":var C=R[1][1];_=R[1][2];var V;if(a.biff<=5)C<0&&(C=-C),n[C]&&(V=n[C][_]);else{var M="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][_]&&n[C][_].itab>0&&(M=n.SheetNames[n[C][_].itab-1]+"!"):M=n.SheetNames[_-1]+"!"),n[C]&&n[C][_])M+=n[C][_].Name;else if(n[0]&&n[0][_])M+=n[0][_].Name;else{var O=(j4(n,C,a)||"").split(";;");O[_-1]?M=O[_-1]:M+="SH33TJSERRX"}u.push(M);break}V||(V={Name:"SH33TJSERRY"}),u.push(V.Name);break;case"PtgParen":var L="(",De=")";if(A>=0){switch(w="",t[0][A][1][0]){case 2:L=ar(" ",t[0][A][1][1])+L;break;case 3:L=ar("\r",t[0][A][1][1])+L;break;case 4:De=ar(" ",t[0][A][1][1])+De;break;case 5:De=ar("\r",t[0][A][1][1])+De;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][A][1][0])}A=-1}u.push(L+u.pop()+De);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:R[1][1],r:R[1][0]};var be={c:r.c,r:r.r};if(n.sharedf[et(g)]){var ae=n.sharedf[et(g)];u.push(an(ae,c,be,n,a))}else{var ue=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){u.push(an(d[1],c,be,n,a)),ue=!0;break}ue||u.push(R[1])}break;case"PtgArray":u.push("{"+T7(R[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":A=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+R[1].idx+"[#"+R[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(R));default:throw new Error("Unrecognized Formula Token: "+String(R))}var Le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&A>=0&&Le.indexOf(t[0][N][0])==-1){R=t[0][A];var oe=!0;switch(R[1][0]){case 4:oe=!1;case 0:w=ar(" ",R[1][1]);break;case 5:oe=!1;case 1:w=ar("\r",R[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+R[1][0])}u.push((oe?w:"")+u.pop()+(oe?"":w)),A=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function S7(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,c=t.read_shift(a);if(c==65535)return[[],fn(t,e-2)];var u=Rf(t,c,r);return e!==c+a&&(o=Cf(t,e-c-a,u,r)),t.l=n,[u,o]}function b7(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,c=t.read_shift(a);if(c==65535)return[[],fn(t,e-2)];var u=Rf(t,c,r);return e!==c+a&&(o=Cf(t,e-c-a,u,r)),t.l=n,[u,o]}function k7(t,e,r,n){var a=t.l+e,o=Rf(t,n,r),c;return a!==t.l&&(c=Cf(t,a-t.l,o,r)),[o,c]}function C7(t,e,r){var n=t.l+e,a,o=t.read_shift(2),c=Rf(t,o,r);return o==65535?[[],fn(t,e-2)]:(e!==o+2&&(a=Cf(t,n-o-2,c,r)),[c,a])}function R7(t){var e;if(Fi(t,t.l+6)!==65535)return[on(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Jp(t,e,r){var n=t.l+e,a=oi(t);r.biff==2&&++t.l;var o=R7(t),c=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=b7(t,n-t.l,r);return{cell:a,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function Rd(t,e,r){var n=t.read_shift(4),a=Rf(t,n,r),o=t.read_shift(4),c=o>0?Cf(t,o,a,r):null;return[a,c]}var I7=Rd,Id=Rd,N7=Rd,D7=Rd,O7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},H4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},F7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function eg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var zu={},Yl={};function Gu(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function z4(t,e,r,n,a,o){try{n.cellNF&&(t.z=it[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Vr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(it[e]==null&&No(M8[e]||"General",e),t.t==="e")t.w=t.w||$o[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tf(t.v);else if(t.t==="d"){var c=Sn(t.v);(c|0)===c?t.w=c.toString(10):t.w=tf(c)}else{if(t.v===void 0)return"";t.w=Vo(t.v,Yl)}else t.t==="d"?t.w=da(e,Sn(t.v),Yl):t.w=da(e,t.v,Yl)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Wh(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Wh(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function M7(t,e){var r=ir(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=At(r))}var P7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,L7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,V7=/<(?:\w:)?hyperlink [^>]*>/mg,U7=/"(\w*:\w*)"/,B7=/<(?:\w:)?col\b[^>]*[\/]?>/g,j7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,H7=/<(?:\w:)?pageMargins[^>]*\/>/g,G4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,z7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,G7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function q7(t,e,r,n,a,o,c){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",x=t.match(L7);x?(d=t.slice(0,x.index),g=t.slice(x.index+x[0].length)):d=g=t;var _=d.match(G4);_?fv(_[0],u,a,r):(_=d.match(z7))&&X7(_[0],_[1]||"",u,a,r);var T=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var y=d.slice(T,T+50).match(U7);y&&M7(u,y[1])}var A=d.match(G7);A&&A[1]&&Z7(A[1],a);var w=[];if(e.cellStyles){var N=d.match(B7);N&&Y7(w,N)}x&&J7(x[1],u,e,h,o,c);var U=g.match(j7);U&&(u["!autofilter"]=W7(U[0]));var R=[],K=g.match(P7);if(K)for(T=0;T!=K.length;++T)R[T]=ir(K[T].slice(K[T].indexOf('"')+1));var te=g.match(V7);te&&K7(u,te,n);var J=g.match(H7);if(J&&(u["!margins"]=$7(Qe(J[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=At(h)),e.sheetRows>0&&u["!ref"]){var b=ir(u["!ref"]);e.sheetRows<=+b.e.r&&(b.e.r=e.sheetRows-1,b.e.r>h.e.r&&(b.e.r=h.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>h.e.c&&(b.e.c=h.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),u["!fullref"]=u["!ref"],u["!ref"]=At(b))}return w.length>0&&(u["!cols"]=w),R.length>0&&(u["!merges"]=R),u}function fv(t,e,r,n){var a=Qe(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=bt(Xt(a.codeName)))}function X7(t,e,r,n,a){fv(t.slice(0,t.indexOf(">")),r,n,a)}function K7(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var o=Qe(Xt(e[a]),!0);if(!o.ref)return;var c=((r||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+bt(o.location))):(o.Target="#"+bt(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=ir(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var g=et({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=o)}}}function $7(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Y7(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=Qe(e[n],!0);a.hidden&&(a.hidden=Qt(a.hidden));var o=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,cv(a.width)),sc(a);o<=c;)t[o++]=$r(a)}}function W7(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var Q7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Z7(t,e){e.Views||(e.Views=[{}]),(t.match(Q7)||[]).forEach(function(r,n){var a=Qe(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Qt(a.rightToLeft)&&(e.Views[n].RTL=!0)})}var J7=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=rf("v"),c=rf("f");return function(h,d,g,x,_,T){for(var y=0,A="",w=[],N=[],U=0,R=0,K=0,te="",J,b,I=0,C=0,V,M,O=0,L=0,De=Array.isArray(T.CellXf),be,ae=[],ue=[],Le=Array.isArray(d),oe=[],Y={},ve=!1,j=!!g.sheetStubs,Q=h.split(e),ee=0,re=Q.length;ee!=re;++ee){A=Q[ee].trim();var me=A.length;if(me!==0){var Ie=0;e:for(y=0;y<me;++y)switch(A[y]){case">":if(A[y-1]!="/"){++y;break e}if(g&&g.cellStyles){if(b=Qe(A.slice(Ie,y),!0),I=b.r!=null?parseInt(b.r,10):I+1,C=-1,g.sheetRows&&g.sheetRows<I)continue;Y={},ve=!1,b.ht&&(ve=!0,Y.hpt=parseFloat(b.ht),Y.hpx=of(Y.hpt)),b.hidden=="1"&&(ve=!0,Y.hidden=!0),b.outlineLevel!=null&&(ve=!0,Y.level=+b.outlineLevel),ve&&(oe[I-1]=Y)}break;case"<":Ie=y;break}if(Ie>=y)break;if(b=Qe(A.slice(Ie,y),!0),I=b.r!=null?parseInt(b.r,10):I+1,C=-1,!(g.sheetRows&&g.sheetRows<I)){x.s.r>I-1&&(x.s.r=I-1),x.e.r<I-1&&(x.e.r=I-1),g&&g.cellStyles&&(Y={},ve=!1,b.ht&&(ve=!0,Y.hpt=parseFloat(b.ht),Y.hpx=of(Y.hpt)),b.hidden=="1"&&(ve=!0,Y.hidden=!0),b.outlineLevel!=null&&(ve=!0,Y.level=+b.outlineLevel),ve&&(oe[I-1]=Y)),w=A.slice(y).split(t);for(var Ne=0;Ne!=w.length&&w[Ne].trim().charAt(0)=="<";++Ne);for(w=w.slice(Ne),y=0;y!=w.length;++y)if(A=w[y].trim(),A.length!==0){if(N=A.match(r),U=y,R=0,K=0,A="<c "+(A.slice(0,1)=="<"?">":"")+A,N!=null&&N.length===2){for(U=0,te=N[1],R=0;R!=te.length&&!((K=te.charCodeAt(R)-64)<1||K>26);++R)U=26*U+K;--U,C=U}else++C;for(R=0;R!=A.length&&A.charCodeAt(R)!==62;++R);if(++R,b=Qe(A.slice(0,R),!0),b.r||(b.r=et({r:I-1,c:C})),te=A.slice(R),J={t:""},(N=te.match(o))!=null&&N[1]!==""&&(J.v=bt(N[1])),g.cellFormula){if((N=te.match(c))!=null&&N[1]!==""){if(J.f=bt(Xt(N[1])).replace(/\r\n/g,`
`),g.xlfn||(J.f=sT(J.f)),N[0].indexOf('t="array"')>-1)J.F=(te.match(a)||[])[1],J.F.indexOf(":")>-1&&ae.push([ir(J.F),J.F]);else if(N[0].indexOf('t="shared"')>-1){M=Qe(N[0]);var Fe=bt(Xt(N[1]));g.xlfn||(Fe=sT(Fe)),ue[parseInt(M.si,10)]=[M,Fe,b.r]}}else(N=te.match(/<f[^>]*\/>/))&&(M=Qe(N[0]),ue[M.si]&&(J.f=uL(ue[M.si][1],ue[M.si][2],b.r)));var Re=wn(b.r);for(R=0;R<ae.length;++R)Re.r>=ae[R][0].s.r&&Re.r<=ae[R][0].e.r&&Re.c>=ae[R][0].s.c&&Re.c<=ae[R][0].e.c&&(J.F=ae[R][1])}if(b.t==null&&J.v===void 0)if(J.f||J.F)J.v=0,J.t="n";else if(j)J.t="z";else continue;else J.t=b.t||"n";switch(x.s.c>C&&(x.s.c=C),x.e.c<C&&(x.e.c=C),J.t){case"n":if(J.v==""||J.v==null){if(!j)continue;J.t="z"}else J.v=parseFloat(J.v);break;case"s":if(typeof J.v>"u"){if(!j)continue;J.t="z"}else V=zu[parseInt(J.v,10)],J.v=V.t,J.r=V.r,g.cellHTML&&(J.h=V.h);break;case"str":J.t="s",J.v=J.v!=null?Xt(J.v):"",g.cellHTML&&(J.h=Z1(J.v));break;case"inlineStr":N=te.match(n),J.t="s",N!=null&&(V=lv(N[1]))?(J.v=V.t,g.cellHTML&&(J.h=V.h)):J.v="";break;case"b":J.v=Qt(J.v);break;case"d":g.cellDates?J.v=Vr(J.v,1):(J.v=Sn(Vr(J.v,1)),J.t="n");break;case"e":(!g||g.cellText!==!1)&&(J.w=J.v),J.v=f4[J.v];break}if(O=L=0,be=null,De&&b.s!==void 0&&(be=T.CellXf[b.s],be!=null&&(be.numFmtId!=null&&(O=be.numFmtId),g.cellStyles&&be.fillId!=null&&(L=be.fillId))),z4(J,O,L,g,_,T),g.cellDates&&De&&J.t=="n"&&vc(it[O])&&(J.t="d",J.v=kd(J.v)),b.cm&&g.xlmeta){var rt=(g.xlmeta.Cell||[])[+b.cm-1];rt&&rt.type=="XLDAPR"&&(J.D=!0)}if(Le){var W=wn(b.r);d[W.r]||(d[W.r]=[]),d[W.r][W.c]=J}else d[b.r]=J}}}}oe.length>0&&(d["!rows"]=oe)}}();function eV(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}var tV=Ko;function rV(){}function nV(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=SF(t),r}function aV(t){var e=ma(t);return[e]}function iV(t){var e=Xo(t);return[e]}function sV(t){var e=ma(t),r=t.read_shift(1);return[e,r,"b"]}function oV(t){var e=Xo(t),r=t.read_shift(1);return[e,r,"b"]}function lV(t){var e=ma(t),r=t.read_shift(1);return[e,r,"e"]}function cV(t){var e=Xo(t),r=t.read_shift(1);return[e,r,"e"]}function uV(t){var e=ma(t),r=t.read_shift(4);return[e,r,"s"]}function fV(t){var e=Xo(t),r=t.read_shift(4);return[e,r,"s"]}function hV(t){var e=ma(t),r=on(t);return[e,r,"n"]}function q4(t){var e=Xo(t),r=on(t);return[e,r,"n"]}function dV(t){var e=ma(t),r=iv(t);return[e,r,"n"]}function mV(t){var e=Xo(t),r=iv(t);return[e,r,"n"]}function pV(t){var e=ma(t),r=nv(t);return[e,r,"is"]}function gV(t){var e=ma(t),r=cn(t);return[e,r,"str"]}function vV(t){var e=Xo(t),r=cn(t);return[e,r,"str"]}function xV(t,e,r){var n=t.l+e,a=ma(t);a.r=r["!row"];var o=t.read_shift(1),c=[a,o,"b"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=an(u,null,a,r.supbooks,r)}else t.l=n;return c}function _V(t,e,r){var n=t.l+e,a=ma(t);a.r=r["!row"];var o=t.read_shift(1),c=[a,o,"e"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=an(u,null,a,r.supbooks,r)}else t.l=n;return c}function yV(t,e,r){var n=t.l+e,a=ma(t);a.r=r["!row"];var o=on(t),c=[a,o,"n"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=an(u,null,a,r.supbooks,r)}else t.l=n;return c}function EV(t,e,r){var n=t.l+e,a=ma(t);a.r=r["!row"];var o=cn(t),c=[a,o,"str"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=an(u,null,a,r.supbooks,r)}else t.l=n;return c}var TV=Ko;function wV(t,e){var r=t.l+e,n=Ko(t),a=av(t),o=cn(t),c=cn(t),u=cn(t);t.l=r;var h={rfx:n,relId:a,loc:o,display:u};return c&&(h.Tooltip=c),h}function AV(){}function SV(t,e,r){var n=t.l+e,a=l4(t),o=t.read_shift(1),c=[a];if(c[2]=o,r.cellFormula){var u=I7(t,n-t.l,r);c[1]=u}else t.l=n;return c}function bV(t,e,r){var n=t.l+e,a=Ko(t),o=[a];if(r.cellFormula){var c=D7(t,n-t.l,r);o[1]=c,t.l=n}else t.l=n;return o}var kV=["left","right","top","bottom","header","footer"];function CV(t){var e={};return kV.forEach(function(r){e[r]=on(t)}),e}function RV(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function IV(){}function NV(){}function DV(t,e,r,n,a,o,c){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,_=!1,T,y,A,w,N,U,R,K,te,J=[];u.biff=12,u["!row"]=0;var b=0,I=!1,C=[],V={},M=u.supbooks||a.supbooks||[[]];if(M.sharedf=V,M.arrayf=C,M.SheetNames=a.SheetNames||a.Sheets.map(function(Le){return Le.name}),!u.supbooks&&(u.supbooks=M,a.Names))for(var O=0;O<a.Names.length;++O)M[0][O+1]=a.Names[O];var L=[],De=[],be=!1;Jh[16]={n:"BrtShortReal",f:q4};var ae;if(Xi(t,function(oe,Y,ve){if(!_)switch(ve){case 148:d=oe;break;case 0:T=oe,u.sheetRows&&u.sheetRows<=T.r&&(_=!0),K=Yr(w=T.r),u["!row"]=T.r,(oe.hidden||oe.hpt||oe.level!=null)&&(oe.hpt&&(oe.hpx=of(oe.hpt)),De[oe.r]=oe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:oe[2]},oe[2]){case"n":y.v=oe[1];break;case"s":R=zu[oe[1]],y.v=R.t,y.r=R.r;break;case"b":y.v=!!oe[1];break;case"e":y.v=oe[1],u.cellText!==!1&&(y.w=$o[y.v]);break;case"str":y.t="s",y.v=oe[1];break;case"is":y.t="s",y.v=oe[1].t;break}if((A=c.CellXf[oe[0].iStyleRef])&&z4(y,A.numFmtId,null,u,o,c),N=oe[0].c==-1?N+1:oe[0].c,u.dense?(h[w]||(h[w]=[]),h[w][N]=y):h[br(N)+K]=y,u.cellFormula){for(I=!1,b=0;b<C.length;++b){var j=C[b];T.r>=j[0].s.r&&T.r<=j[0].e.r&&N>=j[0].s.c&&N<=j[0].e.c&&(y.F=At(j[0]),I=!0)}!I&&oe.length>3&&(y.f=oe[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>N&&(g.s.c=N),g.e.r<T.r&&(g.e.r=T.r),g.e.c<N&&(g.e.c=N),u.cellDates&&A&&y.t=="n"&&vc(it[A.numFmtId])){var Q=Ro(y.v);Q&&(y.t="d",y.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}ae&&(ae.type=="XLDAPR"&&(y.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;y={t:"z",v:void 0},N=oe[0].c==-1?N+1:oe[0].c,u.dense?(h[w]||(h[w]=[]),h[w][N]=y):h[br(N)+K]=y,g.s.r>T.r&&(g.s.r=T.r),g.s.c>N&&(g.s.c=N),g.e.r<T.r&&(g.e.r=T.r),g.e.c<N&&(g.e.c=N),ae&&(ae.type=="XLDAPR"&&(y.D=!0),ae=void 0);break;case 176:J.push(oe);break;case 49:ae=((u.xlmeta||{}).Cell||[])[oe-1];break;case 494:var ee=n["!id"][oe.relId];for(ee?(oe.Target=ee.Target,oe.loc&&(oe.Target+="#"+oe.loc),oe.Rel=ee):oe.relId==""&&(oe.Target="#"+oe.loc),w=oe.rfx.s.r;w<=oe.rfx.e.r;++w)for(N=oe.rfx.s.c;N<=oe.rfx.e.c;++N)u.dense?(h[w]||(h[w]=[]),h[w][N]||(h[w][N]={t:"z",v:void 0}),h[w][N].l=oe):(U=et({c:N,r:w}),h[U]||(h[U]={t:"z",v:void 0}),h[U].l=oe);break;case 426:if(!u.cellFormula)break;C.push(oe),te=u.dense?h[w][N]:h[br(N)+K],te.f=an(oe[1],g,{r:T.r,c:N},M,u),te.F=At(oe[0]);break;case 427:if(!u.cellFormula)break;V[et(oe[0].s)]=oe[1],te=u.dense?h[w][N]:h[br(N)+K],te.f=an(oe[1],g,{r:T.r,c:N},M,u);break;case 60:if(!u.cellStyles)break;for(;oe.e>=oe.s;)L[oe.e--]={width:oe.w/256,hidden:!!(oe.flags&1),level:oe.level},be||(be=!0,cv(oe.w/256)),sc(L[oe.e+1]);break;case 161:h["!autofilter"]={ref:At(oe)};break;case 476:h["!margins"]=oe;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),oe.name&&(a.Sheets[r].CodeName=oe.name),(oe.above||oe.left)&&(h["!outline"]={above:oe.above,left:oe.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),oe.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Y.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+ve.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=At(d||g)),u.sheetRows&&h["!ref"]){var ue=ir(h["!ref"]);u.sheetRows<=+ue.e.r&&(ue.e.r=u.sheetRows-1,ue.e.r>g.e.r&&(ue.e.r=g.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>g.e.c&&(ue.e.c=g.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),h["!fullref"]=h["!ref"],h["!ref"]=At(ue))}return J.length>0&&(h["!merges"]=J),L.length>0&&(h["!cols"]=L),De.length>0&&(h["!rows"]=De),h}function OV(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(e[+c[1]]=r?+c[2]:c[2])});var a=bt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,a,n]}function FV(t,e,r,n,a,o){var c=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var _=OV(x);g.s.r=g.s.c=0,g.e.c=u,d=br(u),_[0].forEach(function(T,y){c[d+Yr(y)]={t:"n",v:T,z:_[1]},h=y}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(c["!ref"]=At(g)),c}function MV(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=t.match(G4);return u&&fv(u[0],o,a,r),(c=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function PV(t,e){t.l+=10;var r=cn(t);return{name:r}}function LV(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Xi(t,function(h,d,g){switch(g){case 550:o["!rel"]=h;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),h.name&&(a.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!c||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var X4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],VV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],UV=[],BV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function fT(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var o=e[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=Qt(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function hT(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Qt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function K4(t){hT(t.WBProps,X4),hT(t.CalcPr,BV),fT(t.WBView,VV),fT(t.Sheets,UV),Yl.date1904=Qt(t.WBProps.date1904)}var jV="][*?/\\".split("");function HV(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return jV.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var zV=/<\w+:workbook/;function GV(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},c=0;if(t.replace(hn,function(h,d){var g=Qe(h);switch(si(g[0])){case"<?xml":break;case"<workbook":h.match(zV)&&(a="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":X4.forEach(function(x){if(g[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Qt(g[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(g[x[0]],10);break;default:r.WBProps[x[0]]=g[x[0]]}}),g.codeName&&(r.WBProps.CodeName=Xt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=bt(Xt(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Xt(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),Qt(g.hidden||"0")&&(o.Hidden=!0),c=d+h.length;break;case"</definedName>":o.Ref=bt(Xt(t.slice(c,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),lF.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return K4(r),r}function qV(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Mg(t),r.name=cn(t),r}function XV(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?cn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function KV(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function $V(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=bF(t),c=N7(t,0,r),u=av(t);t.l=n;var h={Name:o,Ptg:c};return a<268435455&&(h.Sheet=a),u&&(h.Comment=u),h}function YV(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],Jh[16]={n:"BrtFRTArchID$",f:KV},Xi(t,function(h,d,g){switch(g){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=an(h.Ptg,null,null,c,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,h]):c[0]=[g,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(g),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),K4(r),r.Names=o,r.supbooks=c,r}function WV(t,e,r){return e.slice(-4)===".bin"?YV(t,r):GV(t,r)}function QV(t,e,r,n,a,o,c,u){return e.slice(-4)===".bin"?DV(t,n,r,a,o,c,u):q7(t,n,r,a,o,c,u)}function ZV(t,e,r,n,a,o,c,u){return e.slice(-4)===".bin"?LV(t,n,r,a,o):MV(t,n,r,a,o)}function JV(t,e,r,n,a,o,c,u){return e.slice(-4)===".bin"?oL():lL()}function eU(t,e,r,n,a,o,c,u){return e.slice(-4)===".bin"?iL():sL()}function tU(t,e,r,n){return e.slice(-4)===".bin"?TP(t,r,n):gP(t,r,n)}function rU(t,e,r){return O4(t,r)}function nU(t,e,r){return e.slice(-4)===".bin"?V9(t,r):P9(t,r)}function aU(t,e,r){return e.slice(-4)===".bin"?rL(t,r):QP(t,r)}function iU(t,e,r){return e.slice(-4)===".bin"?$P(t):XP(t)}function sU(t,e,r,n){return r.slice(-4)===".bin"?YP(t,e,r,n):void 0}function oU(t,e,r){return e.slice(-4)===".bin"?GP(t,e,r):qP(t,e,r)}var $4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Y4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ea(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match($4),o,c,u,h;if(a)for(h=0;h!=a.length;++h)o=a[h].match(Y4),(c=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),n[u]=o[2].slice(1,o[2].length-1));return n}function lU(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match($4),a,o,c,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(Y4),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(o+1),r[c]=a[2].slice(1,a[2].length-1));return r}var qu;function cU(t,e){var r=qu[t]||bt(t);return r==="General"?Vo(e):da(r,e)}function uU(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Qt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[bt(e)]=a}function fU(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||$o[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tf(t.v):t.w=Vo(t.v):t.w=cU(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=qu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&vc(n)){var a=Ro(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function hU(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=uP[n.Pattern]||n.Pattern)}t[e.ID]=e}function dU(t,e,r,n,a,o,c,u,h,d){var g="General",x=n.StyleID,_={};d=d||{};var T=[],y=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&c&&(x=c.StyleID);o[x]!==void 0&&(o[x].nf&&(g=o[x].nf),o[x].Interior&&T.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Qt(t);break;case"String":n.t="s",n.r=FE(bt(t)),n.v=t.indexOf("<")>-1?bt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Vr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=bt(t):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=f4[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=FE(e||t));break}if(fU(n,g,d),d.cellFormula!==!1)if(n.Formula){var A=bt(n.Formula);A.charCodeAt(0)==61&&(A=A.slice(1)),n.f=$l(A,a),delete n.Formula,n.ArrayRange=="RC"?n.F=$l("RC:RC",a):n.ArrayRange&&(n.F=$l(n.ArrayRange,a),h.push([ir(n.F),n.F]))}else for(y=0;y<h.length;++y)a.r>=h[y][0].s.r&&a.r<=h[y][0].e.r&&a.c>=h[y][0].s.c&&a.c<=h[y][0].e.c&&(n.F=h[y][1]);d.cellStyles&&(T.forEach(function(w){!_.patternType&&w.patternType&&(_.patternType=w.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function mU(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function tg(t,e){var r=e||{};LS();var n=ku(J1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Xt(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=$r(r);return c.type="string",af.to_workbook(n,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Kt){a.indexOf("<"+Kt)>=0&&(o=!0)}),o)return wU(n,r);qu={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,g={},x=[],_=r.dense?[]:{},T="",y={},A={},w=Ea('<Data ss:Type="String">'),N=0,U=0,R=0,K={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},J={},b="",I=0,C=[],V={},M={},O=0,L=[],De=[],be={},ae=[],ue,Le=!1,oe=[],Y=[],ve={},j=0,Q=0,ee={Sheets:[],WBProps:{date1904:!1}},re={};nf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var me="";u=nf.exec(n);)switch(u[3]=(me=u[3]).toLowerCase()){case"data":if(me=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?dU(n.slice(N,u.index),b,w,h[h.length-1][0]=="comment"?be:y,{c:U,r:R},te,ae[U],A,oe,r):(b="",w=Ea(u[0]),N=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(De.length>0&&(y.c=De),(!r.sheetRows||r.sheetRows>R)&&y.v!==void 0&&(r.dense?(_[R]||(_[R]=[]),_[R][U]=y):_[br(U)+Yr(R)]=y),y.HRef&&(y.l={Target:bt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(j=U+(parseInt(y.MergeAcross,10)|0),Q=R+(parseInt(y.MergeDown,10)|0),C.push({s:{c:U,r:R},e:{c:j,r:Q}})),!r.sheetStubs)y.MergeAcross?U=j+1:++U;else if(y.MergeAcross||y.MergeDown){for(var Ie=U;Ie<=j;++Ie)for(var Ne=R;Ne<=Q;++Ne)(Ie>U||Ne>R)&&(r.dense?(_[Ne]||(_[Ne]=[]),_[Ne][Ie]={t:"z"}):_[br(Ie)+Yr(Ne)]={t:"z"});U=j+1}else++U;else y=lU(u[0]),y.Index&&(U=+y.Index-1),U<K.s.c&&(K.s.c=U),U>K.e.c&&(K.e.c=U),u[0].slice(-2)==="/>"&&++U,De=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(R<K.s.r&&(K.s.r=R),R>K.e.r&&(K.e.r=R),u[0].slice(-2)==="/>"&&(A=Ea(u[0]),A.Index&&(R=+A.Index-1)),U=0,++R):(A=Ea(u[0]),A.Index&&(R=+A.Index-1),ve={},(A.AutoFitHeight=="0"||A.Height)&&(ve.hpx=parseInt(A.Height,10),ve.hpt=D4(ve.hpx),Y[R]=ve),A.Hidden=="1"&&(ve.hidden=!0,Y[R]=ve));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(T),K.s.r<=K.e.r&&K.s.c<=K.e.c&&(_["!ref"]=At(K),r.sheetRows&&r.sheetRows<=K.e.r&&(_["!fullref"]=_["!ref"],K.e.r=r.sheetRows-1,_["!ref"]=At(K))),C.length&&(_["!merges"]=C),ae.length>0&&(_["!cols"]=ae),Y.length>0&&(_["!rows"]=Y),g[T]=_}else K={s:{r:2e6,c:2e6},e:{r:0,c:0}},R=U=0,h.push([u[3],!1]),d=Ea(u[0]),T=bt(d.Name),_=r.dense?[]:{},C=[],oe=[],Y=[],re={name:T,Hidden:0},ee.Sheets.push(re);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ae=[],Le=!1}break;case"style":u[1]==="/"?hU(te,J,r):J=Ea(u[0]);break;case"numberformat":J.nf=bt(Ea(u[0]).Format||"General"),qu[J.nf]&&(J.nf=qu[J.nf]);for(var Fe=0;Fe!=392&&it[Fe]!=J.nf;++Fe);if(Fe==392){for(Fe=57;Fe!=392;++Fe)if(it[Fe]==null){No(J.nf,Fe);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ue=Ea(u[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!Le&&ue.wpx>10){Le=!0,Tn=I4;for(var Re=0;Re<ae.length;++Re)ae[Re]&&sc(ae[Re])}Le&&sc(ue),ae[ue.Index-1||ae.length]=ue;for(var rt=0;rt<+ue.Span;++rt)ae[ae.length]=$r(ue);break;case"namedrange":if(u[1]==="/")break;ee.Names||(ee.Names=[]);var W=Qe(u[0]),Ot={Name:W.Name,Ref:$l(W.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(Ot.Sheet=ee.Sheets.length-1),ee.Names.push(Ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?b+=n.slice(I,u.index):I=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;J.Interior=Ea(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?QF(V,me,n.slice(O,u.index)):O=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));mU(be),De.push(be)}else h.push([u[3],!1]),d=Ea(u[0]),be={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var ot=Ea(u[0]);_["!autofilter"]={ref:$l(ot.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return xT(n,r);var St=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:St=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:St=!1}break;case"excelworkbook":switch(u[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:St=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:St=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(O,u.index)){case"SheetHidden":re.Hidden=1;break;case"SheetVeryHidden":re.Hidden=2;break}else O=u.index+u[0].length;break;case"header":_["!margins"]||Gu(_["!margins"]={},"xlml"),isNaN(+Qe(u[0]).Margin)||(_["!margins"].header=+Qe(u[0]).Margin);break;case"footer":_["!margins"]||Gu(_["!margins"]={},"xlml"),isNaN(+Qe(u[0]).Margin)||(_["!margins"].footer=+Qe(u[0]).Margin);break;case"pagemargins":var at=Qe(u[0]);_["!margins"]||Gu(_["!margins"]={},"xlml"),isNaN(+at.Top)||(_["!margins"].top=+at.Top),isNaN(+at.Left)||(_["!margins"].left=+at.Left),isNaN(+at.Right)||(_["!margins"].right=+at.Right),isNaN(+at.Bottom)||(_["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:St=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:St=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:St=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:St=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:St=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:St=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:St=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:St=!1}break;case"smarttags":break;default:St=!1;break}if(St||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?uU(M,me,L,n.slice(O,u.index)):(L=u,O=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=g),Pe.SheetNames=x,Pe.Workbook=ee,Pe.SSF=$r(it),Pe.Props=V,Pe.Custprops=M,Pe}function Ug(t,e){switch(mv(e=e||{}),e.type||"base64"){case"base64":return tg(Yn(t),e);case"binary":case"buffer":case"file":return tg(t,e);case"array":return tg(qo(t),e)}}function pU(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=RF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=IF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var gU=[60,1084,2066,2165,2175];function vU(t,e,r,n,a){var o=n,c=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}c.push(u),r.l+=o;for(var h=Fi(r,r.l),d=Bg[h],g=0;d!=null&&gU.indexOf(h)>-1;)o=Fi(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+o),c.push(u),r.l+=4+o,d=Bg[h=Fi(r,r.l)];var x=ks(c);Xr(x,0);var _=0;x.lens=[];for(var T=0;T<c.length;++T)x.lens.push(_),_+=c[T].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,a)}function Ya(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=it[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||$o[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tf(t.v):t.w=Vo(t.v):t.w=da(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&vc(it[n]||String(n))){var a=Ro(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function oh(t,e,r){return{v:t,ixfe:e,t:r}}function xU(t,e){var r={opts:{}},n={},a=e.dense?[]:{},o={},c={},u=null,h=[],d="",g={},x,_="",T,y,A,w,N={},U=[],R,K,te=[],J=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},C=function(nt){return nt<8?Do[nt]:nt<64&&J[nt-8]||Do[nt]},V=function(nt,$t,fr){var Ht=$t.XF.data;if(!(!Ht||!Ht.patternType||!fr||!fr.cellStyles)){$t.s={},$t.s.patternType=Ht.patternType;var mn;(mn=sf(C(Ht.icvFore)))&&($t.s.fgColor={rgb:mn}),(mn=sf(C(Ht.icvBack)))&&($t.s.bgColor={rgb:mn})}},M=function(nt,$t,fr){if(!(ve>1)&&!(fr.sheetRows&&nt.r>=fr.sheetRows)){if(fr.cellStyles&&$t.XF&&$t.XF.data&&V(nt,$t,fr),delete $t.ixfe,delete $t.XF,x=nt,_=et(nt),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<c.s.r&&(c.s.r=nt.r),nt.c<c.s.c&&(c.s.c=nt.c),nt.r+1>c.e.r&&(c.e.r=nt.r+1),nt.c+1>c.e.c&&(c.e.c=nt.c+1),fr.cellFormula&&$t.f){for(var Ht=0;Ht<U.length;++Ht)if(!(U[Ht][0].s.c>nt.c||U[Ht][0].s.r>nt.r)&&!(U[Ht][0].e.c<nt.c||U[Ht][0].e.r<nt.r)){$t.F=At(U[Ht][0]),(U[Ht][0].s.c!=nt.c||U[Ht][0].s.r!=nt.r)&&delete $t.f,$t.f&&($t.f=""+an(U[Ht][1],c,nt,oe,O));break}}fr.dense?(a[nt.r]||(a[nt.r]=[]),a[nt.r][nt.c]=$t):a[_]=$t}},O={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:U,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(O.password=e.password);var L,De=[],be=[],ae=[],ue=[],Le=!1,oe=[];oe.SheetNames=O.snames,oe.sharedf=O.sharedf,oe.arrayf=O.arrayf,oe.names=[],oe.XTI=[];var Y=0,ve=0,j=0,Q=[],ee=[],re;O.codepage=1200,ka(1200);for(var me=!1;t.l<t.length-1;){var Ie=t.l,Ne=t.read_shift(2);if(Ne===0&&Y===10)break;var Fe=t.l===t.length?0:t.read_shift(2),Re=Bg[Ne];if(Re&&Re.f){if(e.bookSheets&&Y===133&&Ne!==133)break;if(Y=Ne,Re.r===2||Re.r==12){var rt=t.read_shift(2);if(Fe-=2,!O.enc&&rt!==Ne&&((rt&255)<<8|rt>>8)!==Ne)throw new Error("rt mismatch: "+rt+"!="+Ne);Re.r==12&&(t.l+=10,Fe-=10)}var W={};if(Ne===10?W=Re.f(t,Fe,O):W=vU(Ne,Re,t,Fe,O),ve==0&&[9,521,1033,2057].indexOf(Y)===-1)continue;switch(Ne){case 34:r.opts.Date1904=b.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(t.l=0),O.enc=W,!e.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=W;break;case 66:var Ot=Number(W);switch(Ot){case 21010:Ot=1200;break;case 32768:Ot=1e4;break;case 32769:Ot=1252;break}ka(O.codepage=Ot),me=!0;break;case 317:O.rrtabid=W;break;case 25:O.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:O.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(a["!type"]="dialog"),W.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),W.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:te.push(W);break;case 430:oe.push([W]),oe[oe.length-1].XTI=[];break;case 35:case 547:oe[oe.length-1].push(W);break;case 24:case 536:re={Name:W.Name,Ref:an(W.rgce,c,null,oe,O)},W.itab>0&&(re.Sheet=W.itab-1),oe.names.push(re),oe[0]||(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(ee[W.itab-1]={ref:At(W.rgce[0][0][1][2])});break;case 22:O.ExternCount=W;break;case 23:oe.length==0&&(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].XTI=oe[oe.length-1].XTI.concat(W),oe.XTI=oe.XTI.concat(W);break;case 2196:if(O.biff<8)break;re!=null&&(re.Comment=W[1]);break;case 18:a["!protect"]=W;break;case 19:W!==0&&O.WTF&&console.error("Password verifier: "+W);break;case 133:o[W.pos]=W,O.snames.push(W.name);break;case 10:{if(--ve)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=At(c),e.sheetRows&&e.sheetRows<=c.e.r){var ot=c.e.r;c.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=At(c),c.e.r=ot}c.e.r++,c.e.c++}De.length>0&&(a["!merges"]=De),be.length>0&&(a["!objects"]=be),ae.length>0&&(a["!cols"]=ae),ue.length>0&&(a["!rows"]=ue),b.Sheets.push(I)}d===""?g=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),O.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(O.biff=5,me=!0,ka(O.codepage=28591)),O.biff==8&&W.BIFFVer==0&&W.dt==16&&(O.biff=2),ve++)break;if(a=e.dense?[]:{},O.biff<8&&!me&&(me=!0,ka(O.codepage=e.codepage||1252)),O.biff<5||W.BIFFVer==0&&W.dt==4096){d===""&&(d="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var St={pos:t.l-Fe,name:d};o[St.pos]=St,O.snames.push(d)}else d=(o[Ie]||{name:""}).name;W.dt==32&&(a["!type"]="chart"),W.dt==64&&(a["!type"]="macro"),De=[],be=[],O.arrayf=U=[],ae=[],ue=[],Le=!1,I={Hidden:(o[Ie]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[W.r]||[])[W.c]:a[et({c:W.c,r:W.r})])&&++W.c,R={ixfe:W.ixfe,XF:te[W.ixfe]||{},v:W.val,t:"n"},j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:W.c,r:W.r},R,e);break;case 5:case 517:R={ixfe:W.ixfe,XF:te[W.ixfe],v:W.val,t:W.t},j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:W.c,r:W.r},R,e);break;case 638:R={ixfe:W.ixfe,XF:te[W.ixfe],v:W.rknum,t:"n"},j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:W.c,r:W.r},R,e);break;case 189:for(var at=W.c;at<=W.C;++at){var Pe=W.rkrec[at-W.c][0];R={ixfe:Pe,XF:te[Pe],v:W.rkrec[at-W.c][1],t:"n"},j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:at,r:W.r},R,e)}break;case 6:case 518:case 1030:{if(W.val=="String"){u=W;break}if(R=oh(W.val,W.cell.ixfe,W.tt),R.XF=te[R.ixfe],e.cellFormula){var Kt=W.formula;if(Kt&&Kt[0]&&Kt[0][0]&&Kt[0][0][0]=="PtgExp"){var Ir=Kt[0][0][1][0],Ur=Kt[0][0][1][1],Br=et({r:Ir,c:Ur});N[Br]?R.f=""+an(W.formula,c,W.cell,oe,O):R.F=((e.dense?(a[Ir]||[])[Ur]:a[Br])||{}).F}else R.f=""+an(W.formula,c,W.cell,oe,O)}j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M(W.cell,R,e),u=W}break;case 7:case 519:if(u)u.val=W,R=oh(W,u.cell.ixfe,"s"),R.XF=te[R.ixfe],e.cellFormula&&(R.f=""+an(u.formula,c,u.cell,oe,O)),j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M(u.cell,R,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{U.push(W);var li=et(W[0].s);if(T=e.dense?(a[W[0].s.r]||[])[W[0].s.c]:a[li],e.cellFormula&&T){if(!u||!li||!T)break;T.f=""+an(W[1],c,W[0],oe,O),T.F=At(W[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;N[et(u.cell)]=W[0],T=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[et(u.cell)],(T||{}).f=""+an(W[0],c,x,oe,O)}}break;case 253:R=oh(h[W.isst].t,W.ixfe,"s"),h[W.isst].h&&(R.h=h[W.isst].h),R.XF=te[R.ixfe],j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:W.c,r:W.r},R,e);break;case 513:e.sheetStubs&&(R={ixfe:W.ixfe,XF:te[W.ixfe],t:"z"},j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:W.c,r:W.r},R,e));break;case 190:if(e.sheetStubs)for(var dn=W.c;dn<=W.C;++dn){var _r=W.ixfe[dn-W.c];R={ixfe:_r,XF:te[_r],t:"z"},j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:dn,r:W.r},R,e)}break;case 214:case 516:case 4:R=oh(W.val,W.ixfe,"s"),R.XF=te[R.ixfe],j>0&&(R.z=Q[R.ixfe>>8&63]),Ya(R,e,r.opts.Date1904),M({c:W.c,r:W.r},R,e);break;case 0:case 512:ve===1&&(c=W);break;case 252:h=W;break;case 1054:if(O.biff==4){Q[j++]=W[1];for(var bn=0;bn<j+163&&it[bn]!=W[1];++bn);bn>=163&&No(W[1],j+163)}else No(W[1],W[0]);break;case 30:{Q[j++]=W;for(var Rt=0;Rt<j+163&&it[Rt]!=W;++Rt);Rt>=163&&No(W,j+163)}break;case 229:De=De.concat(W);break;case 93:be[W.cmo[0]]=O.lastobj=W;break;case 438:O.lastobj.TxO=W;break;case 127:O.lastobj.ImData=W;break;case 440:for(w=W[0].s.r;w<=W[0].e.r;++w)for(A=W[0].s.c;A<=W[0].e.c;++A)T=e.dense?(a[w]||[])[A]:a[et({c:A,r:w})],T&&(T.l=W[1]);break;case 2048:for(w=W[0].s.r;w<=W[0].e.r;++w)for(A=W[0].s.c;A<=W[0].e.c;++A)T=e.dense?(a[w]||[])[A]:a[et({c:A,r:w})],T&&T.l&&(T.l.Tooltip=W[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;T=e.dense?(a[W[0].r]||[])[W[0].c]:a[et(W[0])];var pt=be[W[2]];T||(e.dense?(a[W[0].r]||(a[W[0].r]=[]),T=a[W[0].r][W[0].c]={t:"z"}):T=a[et(W[0])]={t:"z"},c.e.r=Math.max(c.e.r,W[0].r),c.s.r=Math.min(c.s.r,W[0].r),c.e.c=Math.max(c.e.c,W[0].c),c.s.c=Math.min(c.s.c,W[0].c)),T.c||(T.c=[]),y={a:W[1],t:pt.TxO.t},T.c.push(y)}break;case 2173:BP(te[W.ixfe],W.ext);break;case 125:{if(!O.cellStyles)break;for(;W.e>=W.s;)ae[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},Le||(Le=!0,cv(W.w/256)),sc(ae[W.e+1])}break;case 520:{var Ft={};W.level!=null&&(ue[W.r]=Ft,Ft.level=W.level),W.hidden&&(ue[W.r]=Ft,Ft.hidden=!0),W.hpt&&(ue[W.r]=Ft,Ft.hpt=W.hpt,Ft.hpx=of(W.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Gu(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=W;break;case 161:a["!margins"]||Gu(a["!margins"]={}),a["!margins"].header=W.header,a["!margins"].footer=W.footer;break;case 574:W.RTL&&(b.Views[0].RTL=!0);break;case 146:J=W;break;case 2198:L=W;break;case 140:K=W;break;case 442:d?I.CodeName=W||I.name:b.WBProps.CodeName=W||"ThisWorkbook";break}}else Re||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),t.l+=Fe}return r.SheetNames=ai(o).sort(function(jt,nt){return Number(jt)-Number(nt)}).map(function(jt){return o[jt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&ee.forEach(function(jt,nt){r.Sheets[r.SheetNames[nt]]["!autofilter"]=jt}),r.Strings=h,r.SSF=$r(it),O.enc&&(r.Encryption=O.enc),L&&(r.Themes=L),r.Metadata={},K!==void 0&&(r.Metadata.Country=K),oe.names.length>0&&(b.Names=oe.names),r.Workbook=b,r}var dT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _U(t,e,r){var n=wt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=WE(n,PF,dT.DSI);for(var o in a)e[o]=a[o]}catch(d){if(r.WTF)throw d}var c=wt.find(t,"/!SummaryInformation");if(c&&c.size>0)try{var u=WE(c,LF,dT.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(d4(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function W4(t,e){e||(e={}),mv(e),SS(),e.codepage&&X1(e.codepage);var r,n;if(t.FullPaths){if(wt.find(t,"/encryption"))throw new Error("File is password-protected");r=wt.find(t,"!CompObj"),n=wt.find(t,"/Workbook")||wt.find(t,"/Book")}else{switch(e.type){case"base64":t=Aa(Yn(t));break;case"binary":t=Aa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Xr(t,0),n={content:t}}var a,o;if(r&&pU(r),e.bookProps&&!e.bookSheets)a={};else{var c=gt?"buffer":"array";if(n&&n.content)a=xU(n.content,e);else if((o=wt.find(t,"PerfectOffice_MAIN"))&&o.content)a=Hu.to_workbook(o.content,(e.type=c,e));else if((o=wt.find(t,"NativeContent_MAIN"))&&o.content)a=Hu.to_workbook(o.content,(e.type=c,e));else throw(o=wt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&wt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=aL(t))}var u={};return t.FullPaths&&_U(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}var Jh={0:{f:eV},1:{f:aV},2:{f:dV},3:{f:lV},4:{f:sV},5:{f:hV},6:{f:gV},7:{f:uV},8:{f:EV},9:{f:yV},10:{f:xV},11:{f:_V},12:{f:iV},13:{f:mV},14:{f:cV},15:{f:oV},16:{f:q4},17:{f:vV},18:{f:fV},19:{f:nv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$V},40:{},42:{},43:{f:xP},44:{f:vP},45:{f:_P},46:{f:EP},47:{f:yP},48:{},49:{f:TF},50:{},51:{f:HP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:S4},62:{f:pV},63:{f:KP},64:{f:IV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:fn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:nV},148:{f:tV,p:16},151:{f:AV},152:{},153:{f:XV},154:{},155:{},156:{f:qV},157:{},158:{},159:{T:1,f:L9},160:{T:-1},161:{T:1,f:Ko},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:TV},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:jP},336:{T:-1},337:{f:zP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Mg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:A4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:SV},427:{f:bV},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:CV},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:rV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wV},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Mg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tL},633:{T:1},634:{T:-1},635:{T:1,f:eL},636:{T:-1},637:{f:AF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:PV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:NV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bg={6:{f:Jp},10:{f:Ts},12:{f:xr},13:{f:xr},14:{f:cr},15:{f:cr},16:{f:on},17:{f:cr},18:{f:cr},19:{f:xr},20:{f:eT},21:{f:eT},23:{f:A4},24:{f:rT},25:{f:cr},26:{},27:{},28:{f:ZM},29:{},34:{f:cr},35:{f:tT},38:{f:on},39:{f:on},40:{f:on},41:{f:on},42:{f:cr},43:{f:cr},47:{f:rP},49:{f:OM},51:{f:xr},60:{},61:{f:IM},64:{f:cr},65:{f:DM},66:{f:xr},77:{},80:{},81:{},82:{},85:{f:xr},89:{},90:{},91:{},92:{f:TM},93:{f:e9},94:{},95:{f:cr},96:{},97:{},99:{f:cr},125:{f:S4},128:{f:zM},129:{f:wM},130:{f:xr},131:{f:cr},132:{f:cr},133:{f:AM},134:{},140:{f:s9},141:{f:xr},144:{},146:{f:l9},151:{},152:{},153:{},154:{},155:{},156:{f:xr},157:{},158:{},160:{f:d9},161:{f:u9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UM},190:{f:BM},193:{f:Ts},197:{},198:{},199:{},200:{},201:{},202:{f:cr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xr},220:{},221:{f:cr},222:{},224:{f:HM},225:{f:EM},226:{f:Ts},227:{},229:{f:JM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:SM},253:{f:FM},255:{f:bM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:x4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:cr},353:{f:Ts},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:qM},431:{f:cr},432:{},433:{},434:{},437:{},438:{f:n9},439:{f:cr},440:{f:a9},441:{},442:{f:bf},443:{},444:{f:xr},445:{},446:{},448:{f:Ts},449:{f:RM,r:2},450:{f:Ts},512:{f:ZE},513:{f:h9},515:{f:GM},516:{f:MM},517:{f:JE},519:{f:m9},520:{f:kM},523:{},545:{f:nT},549:{f:QE},566:{},574:{f:NM},638:{f:VM},659:{},1048:{},1054:{f:PM},1084:{},1212:{f:YM},2048:{f:i9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ah},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ts},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:c9,r:12},2173:{f:UP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:cr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$M,r:12},2197:{},2198:{f:OP,r:12},2199:{},2200:{},2201:{},2202:{f:WM,r:12},2203:{f:Ts},2204:{},2205:{},2206:{},2207:{},2211:{f:CM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:f9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:o9},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ZE},1:{},2:{f:x9},3:{f:v9},4:{f:g9},5:{f:JE},7:{f:_9},8:{},9:{f:ah},11:{},22:{f:xr},30:{f:LM},31:{},32:{},33:{f:nT},36:{},37:{f:QE},50:{f:y9},62:{},52:{},67:{},68:{f:xr},69:{},86:{},126:{},127:{f:p9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:E9},223:{},234:{},354:{},421:{},518:{f:Jp},521:{f:ah},536:{f:rT},547:{f:tT},561:{},579:{},1030:{f:Jp},1033:{f:ah},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ta(t,e,r,n){var a=e;if(!isNaN(a)){var o=(r||[]).length||0,c=t.next(4);c.write_shift(2,a),c.write_shift(2,o),o>0&&i4(r)&&t.push(r)}}function mT(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),c=a.index,u=o&&o.index||t.length,h=G8(t.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,x=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(c=0;c<h.length;++c){var A=h[c].trim(),w=A.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}g=0;continue}if(!(w!="<td"&&w!="<th")){var N=A.split(/<\/t[dh]>/i);for(u=0;u<N.length;++u){var U=N[u].trim();if(U.match(/<t[dh]/i)){for(var R=U,K=0;R.charAt(0)=="<"&&(K=R.indexOf(">"))>-1;)R=R.slice(K+1);for(var te=0;te<y.length;++te){var J=y[te];J.s.c==g&&J.s.r<d&&d<=J.e.r&&(g=J.e.c+1,te=-1)}var b=Qe(U.slice(0,U.indexOf(">")));_=b.colspan?+b.colspan:1,((x=+b.rowspan)>1||_>1)&&y.push({s:{r:d,c:g},e:{r:d+(x||1)-1,c:g+_-1}});var I=b.t||b["data-t"]||"";if(!R.length){g+=_;continue}if(R=XS(R),T.s.r>d&&(T.s.r=d),T.e.r<d&&(T.e.r=d),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!R.length){g+=_;continue}var C={t:"s",v:R};r.raw||!R.trim().length||I=="s"||(R==="TRUE"?C={t:"b",v:!0}:R==="FALSE"?C={t:"b",v:!1}:isNaN(Ia(R))?isNaN(ic(R).getDate())||(C={t:"d",v:Vr(R)},r.cellDates||(C={t:"n",v:Sn(C.v)}),C.z=r.dateNF||it[14]):C={t:"n",v:Ia(R)}),r.dense?(n[d]||(n[d]=[]),n[d][g]=C):n[et({r:d,c:g})]=C,g+=_}}}}return n["!ref"]=At(T),y.length&&(n["!merges"]=y),n}function yU(t,e,r,n){for(var a=t["!merges"]||[],o=[],c=e.s.c;c<=e.e.c;++c){for(var u=0,h=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>c)&&!(a[d].e.r<r||a[d].e.c<c)){if(a[d].s.r<r||a[d].s.c<c){u=-1;break}u=a[d].e.r-a[d].s.r+1,h=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var g=et({r,c}),x=n.dense?(t[r]||[])[c]:t[g],_=x&&x.v!=null&&(x.h||Z1(x.w||(Gi(x),x.w)||""))||"",T={};u>1&&(T.rowspan=u),h>1&&(T.colspan=h),n.editable?_='<span contenteditable="true">'+_+"</span>":x&&(T["data-t"]=x&&x.t||"z",x.v!=null&&(T["data-v"]=x.v),x.z!=null&&(T["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+x.l.Target+'">'+_+"</a>")),T.id=(n.id||"sjs")+"-"+g,o.push(sF("td",_,T))}}var y="<tr>";return y+o.join("")+"</tr>"}var EU='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',TU="</body></html>";function wU(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ys(mT(r[0],e),e);var n=gv();return r.forEach(function(a,o){vv(n,mT(a,e),"Sheet"+(o+1))}),n}function AU(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function SU(t,e){var r=e||{},n=r.header!=null?r.header:EU,a=r.footer!=null?r.footer:TU,o=[n],c=xc(t["!ref"]);r.dense=Array.isArray(t),o.push(AU(t,c,r));for(var u=c.s.r;u<=c.e.r;++u)o.push(yU(t,c,u,r));return o.push("</table>"+a),o.join("")}function Q4(t,e,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?wn(n.origin):n.origin;a=c.r,o=c.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var g=xc(t["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),a==-1&&(d.e.r=a=g.e.r+1)}var x=[],_=0,T=t["!rows"]||(t["!rows"]=[]),y=0,A=0,w=0,N=0,U=0,R=0;for(t["!cols"]||(t["!cols"]=[]);y<u.length&&A<h;++y){var K=u[y];if(pT(K)){if(n.display)continue;T[A]={hidden:!0}}var te=K.children;for(w=N=0;w<te.length;++w){var J=te[w];if(!(n.display&&pT(J))){var b=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):XS(J.innerHTML),I=J.getAttribute("data-z")||J.getAttribute("z");for(_=0;_<x.length;++_){var C=x[_];C.s.c==N+o&&C.s.r<A+a&&A+a<=C.e.r&&(N=C.e.c+1-o,_=-1)}R=+J.getAttribute("colspan")||1,((U=+J.getAttribute("rowspan")||1)>1||R>1)&&x.push({s:{r:A+a,c:N+o},e:{r:A+a+(U||1)-1,c:N+o+(R||1)-1}});var V={t:"s",v:b},M=J.getAttribute("data-t")||J.getAttribute("t")||"";b!=null&&(b.length==0?V.t=M||"z":n.raw||b.trim().length==0||M=="s"||(b==="TRUE"?V={t:"b",v:!0}:b==="FALSE"?V={t:"b",v:!1}:isNaN(Ia(b))?isNaN(ic(b).getDate())||(V={t:"d",v:Vr(b)},n.cellDates||(V={t:"n",v:Sn(V.v)}),V.z=n.dateNF||it[14]):V={t:"n",v:Ia(b)})),V.z===void 0&&I!=null&&(V.z=I);var O="",L=J.getElementsByTagName("A");if(L&&L.length)for(var De=0;De<L.length&&!(L[De].hasAttribute("href")&&(O=L[De].getAttribute("href"),O.charAt(0)!="#"));++De);O&&O.charAt(0)!="#"&&(V.l={Target:O}),n.dense?(t[A+a]||(t[A+a]=[]),t[A+a][N+o]=V):t[et({c:N+o,r:A+a})]=V,d.e.c<N+o&&(d.e.c=N+o),N+=R}}++A}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,A-1+a),t["!ref"]=At(d),A>=h&&(t["!fullref"]=At((d.e.r=u.length-y+A-1+a,d))),t}function Z4(t,e){var r=e||{},n=r.dense?[]:{};return Q4(n,t,e)}function bU(t,e){return Ys(Z4(t,e),e)}function pT(t){var e="",r=kU(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function kU(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function CU(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=bt(e.replace(/<[^>]*>/g,""));return[r]}var gT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function J4(t,e){var r=e||{},n=J1(t),a=[],o,c,u={name:""},h="",d=0,g,x,_={},T=[],y=r.dense?[]:{},A,w,N={value:""},U="",R=0,K=[],te=-1,J=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,C={},V=[],M={},O=0,L=0,De=[],be=1,ae=1,ue=[],Le={Names:[]},oe={},Y=["",""],ve=[],j={},Q="",ee=0,re=!1,me=!1,Ie=0;for(nf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");A=nf.exec(n);)switch(A[3]=A[3].replace(/_.*$/,"")){case"table":case"":A[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?y["!ref"]=At(b):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(y["!fullref"]=y["!ref"],b.e.r=r.sheetRows-1,y["!ref"]=At(b)),V.length&&(y["!merges"]=V),De.length&&(y["!rows"]=De),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=y,me=!1):A[0].charAt(A[0].length-2)!=="/"&&(g=Qe(A[0],!1),te=J=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,y=r.dense?[]:{},V=[],De=[],me=!0);break;case"table-row-group":A[1]==="/"?--I:++I;break;case"table-row":case"":if(A[1]==="/"){te+=be,be=1;break}if(x=Qe(A[0],!1),x.?te=x.-1:te==-1&&(te=0),be=+x["number-rows-repeated"]||1,be<10)for(Ie=0;Ie<be;++Ie)I>0&&(De[te+Ie]={level:I});J=-1;break;case"covered-table-cell":A[1]!=="/"&&++J,r.sheetStubs&&(r.dense?(y[te]||(y[te]=[]),y[te][J]={t:"z"}):y[et({r:te,c:J})]={t:"z"}),U="",K=[];break;case"table-cell":case"":if(A[0].charAt(A[0].length-2)==="/")++J,N=Qe(A[0],!1),ae=parseInt(N["number-columns-repeated"]||"1",10),w={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(w.f=uT(bt(N.formula))),(N.||N["value-type"])=="string"&&(w.t="s",w.v=bt(N["string-value"]||""),r.dense?(y[te]||(y[te]=[]),y[te][J]=w):y[et({r:te,c:J})]=w),J+=ae-1;else if(A[1]!=="/"){++J,U="",R=0,K=[],ae=1;var Ne=be?te+be-1:te;if(J>b.e.c&&(b.e.c=J),J<b.s.c&&(b.s.c=J),te<b.s.r&&(b.s.r=te),Ne>b.e.r&&(b.e.r=Ne),N=Qe(A[0],!1),ve=[],j={},w={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=bt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(O=parseInt(N["number-matrix-rows-spanned"],10)||0,L=parseInt(N["number-matrix-columns-spanned"],10)||0,M={s:{r:te,c:J},e:{r:te+O-1,c:J+L-1}},w.F=At(M),ue.push([M,w.F])),N.formula)w.f=uT(N.formula);else for(Ie=0;Ie<ue.length;++Ie)te>=ue[Ie][0].s.r&&te<=ue[Ie][0].e.r&&J>=ue[Ie][0].s.c&&J<=ue[Ie][0].e.c&&(w.F=ue[Ie][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(O=parseInt(N["number-rows-spanned"],10)||0,L=parseInt(N["number-columns-spanned"],10)||0,M={s:{r:te,c:J},e:{r:te+O-1,c:J+L-1}},V.push(M)),N["number-columns-repeated"]&&(ae=parseInt(N["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Qt(N["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(N.value);break;case"percentage":w.t="n",w.v=parseFloat(N.value);break;case"currency":w.t="n",w.v=parseFloat(N.value);break;case"date":w.t="d",w.v=Vr(N["date-value"]),r.cellDates||(w.t="n",w.v=Sn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=j8(N["time-value"])/86400,r.cellDates&&(w.t="d",w.v=kd(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(N.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",N["string-value"]!=null&&(U=bt(N["string-value"]),K=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(re=!1,w.t==="s"&&(w.v=U||"",K.length&&(w.R=K),re=R==0),oe.Target&&(w.l=oe),ve.length>0&&(w.c=ve,ve=[]),U&&r.cellText!==!1&&(w.w=U),re&&(w.t="z",delete w.v),(!re||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=te))for(var Fe=0;Fe<be;++Fe){if(ae=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(y[te+Fe]||(y[te+Fe]=[]),y[te+Fe][J]=Fe==0?w:$r(w);--ae>0;)y[te+Fe][J+ae]=$r(w);else for(y[et({r:te+Fe,c:J})]=w;--ae>0;)y[et({r:te+Fe,c:J+ae})]=$r(w);b.e.c<=J&&(b.e.c=J)}ae=parseInt(N["number-columns-repeated"]||"1",10),J+=ae-1,ae=0,w={},U="",K=[]}oe={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(A[1]==="/"){if((o=a.pop())[0]!==A[3])throw"Bad state: "+o}else A[0].charAt(A[0].length-2)!=="/"&&a.push([A[3],!0]);break;case"annotation":if(A[1]==="/"){if((o=a.pop())[0]!==A[3])throw"Bad state: "+o;j.t=U,K.length&&(j.R=K),j.a=Q,ve.push(j)}else A[0].charAt(A[0].length-2)!=="/"&&a.push([A[3],!1]);Q="",ee=0,U="",R=0,K=[];break;case"creator":A[1]==="/"?Q=n.slice(ee,A.index):ee=A.index+A[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(A[1]==="/"){if((o=a.pop())[0]!==A[3])throw"Bad state: "+o}else A[0].charAt(A[0].length-2)!=="/"&&a.push([A[3],!1]);U="",R=0,K=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(A[1]==="/"){if(C[u.name]=h,(o=a.pop())[0]!==A[3])throw"Bad state: "+o}else A[0].charAt(A[0].length-2)!=="/"&&(h="",u=Qe(A[0],!1),a.push([A[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=Qe(A[0],!1),h+=gT[A[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=Qe(A[0],!1),h+=gT[A[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(A[0].slice(-2)==="/>")break;if(A[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,A.index);break}else d=A.index+A[0].length;break;case"named-range":c=Qe(A[0],!1),Y=eg(c["cell-range-address"]);var Re={Name:c.name,Ref:Y[0]+"!"+Y[1]};me&&(Re.Sheet=T.length),Le.Names.push(Re);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(A[1]==="/"&&(!N||!N["string-value"])){var rt=CU(n.slice(R,A.index));U=(U.length>0?U+`
`:"")+rt[0]}else Qe(A[0],!1),R=A.index+A[0].length;break;case"s":break;case"database-range":if(A[1]==="/")break;try{Y=eg(Qe(A[0])["target-range-address"]),_[Y[0]]["!autofilter"]={ref:Y[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(A[1]!=="/"){if(oe=Qe(A[0],!1),!oe.href)break;oe.Target=bt(oe.href),delete oe.href,oe.Target.charAt(0)=="#"&&oe.Target.indexOf(".")>-1?(Y=eg(oe.Target.slice(1)),oe.Target="#"+Y[0]+"!"+Y[1]):oe.Target.match(/^\.\.[\\\/]/)&&(oe.Target=oe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(A[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(A)}}var W={Sheets:_,SheetNames:T,Workbook:Le};return r.bookSheets&&delete W.Sheets,W}function vT(t,e){e=e||{},ua(t,"META-INF/manifest.xml")&&GF(vr(t,"META-INF/manifest.xml"),e);var r=Xn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=J4(Xt(r),e);return ua(t,"meta.xml")&&(n.Props=h4(vr(t,"meta.xml"))),n}function xT(t,e){return J4(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function hv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function jg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Xt(qo(t))}function Hg(t){var e=t.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function _T(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function RU(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function lf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Rr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ln(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=lf(t,r),o=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:c=4,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=lf(t,r),u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:o};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function dv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function IU(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=lf(t,n),o=ln(t.slice(n[0],n[0]+a));n[0]+=a;var c={id:Rr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=ln(u.data),d=Rr(h[3][0].data);c.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(c.merge=Rr(o[3][0].data)>>>0>0),r.push(c)}return r}function NU(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=lf(e,r),a=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var c=e[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=e[r[0]],u>1&&(c|=e[r[0]+1]<<8),u>2&&(c|=e[r[0]+2]<<16),u>3&&(c|=e[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}a.push(e.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Hg(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(a.push(a[0].slice(-h)),d-=h;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-h,-h+d))}}var g=Hg(a);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function DU(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(NU(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Hg(e)}function OU(t,e,r,n){var a=hv(t),o=a.getUint32(4,!0),c=(n>1?12:8)+_T(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,g=new Date(2001,0,1);o&512&&(u=a.getUint32(c,!0),c+=4),c+=_T(o&(n>1?12288:4096))*4,o&16&&(h=a.getUint32(c,!0),c+=4),o&32&&(d=a.getFloat64(c,!0),c+=8),o&64&&(g.setTime(g.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[h]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(h>-1)x={t:"s",v:e[h]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function FU(t,e,r){var n=hv(t),a=n.getUint32(8,!0),o=12,c=-1,u=-1,h=NaN,d=NaN,g=new Date(2001,0,1);a&1&&(h=RU(t,o),o+=16),a&2&&(d=n.getFloat64(o,!0),o+=8),a&4&&(g.setTime(g.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=n.getUint32(o,!0),o+=4),a&16&&(c=n.getUint32(o,!0),o+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return x}function MU(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return OU(t,e,r,t[0]);case 5:return FU(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ps(t){var e=ln(t);return lf(e[1][0].data)}function yT(t,e){var r=ln(e.data),n=Rr(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(c){var u=ln(c.data),h=Rr(u[1][0].data)>>>0;switch(n){case 1:o[h]=jg(u[3][0].data);break;case 8:{var d=t[Ps(u[9][0].data)][0],g=ln(d.data),x=t[Ps(g[1][0].data)][0],_=Rr(x.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=ln(x.data);o[h]=T[3].map(function(y){return jg(y.data)}).join("")}break}}),o}function PU(t,e){var r,n,a,o,c,u,h,d,g,x,_,T,y,A,w=ln(t),N=Rr(w[1][0].data)>>>0,U=Rr(w[2][0].data)>>>0,R=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Rr(w[8][0].data)>0||!1,K,te;if((o=(a=w[7])==null?void 0:a[0])!=null&&o.data&&e!=0)K=(u=(c=w[7])==null?void 0:c[0])==null?void 0:u.data,te=(d=(h=w[6])==null?void 0:h[0])==null?void 0:d.data;else if((x=(g=w[4])==null?void 0:g[0])!=null&&x.data&&e!=1)K=(T=(_=w[4])==null?void 0:_[0])==null?void 0:T.data,te=(A=(y=w[3])==null?void 0:y[0])==null?void 0:A.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var J=R?4:1,b=hv(K),I=[],C=0;C<K.length/2;++C){var V=b.getUint16(C*2,!0);V<65535&&I.push([C,V])}if(I.length!=U)throw"Expected ".concat(U," cells, found ").concat(I.length);var M=[];for(C=0;C<I.length-1;++C)M[I[C][0]]=te.subarray(I[C][1]*J,I[C+1][1]*J);return I.length>=1&&(M[I[I.length-1][0]]=te.subarray(I[I.length-1][1]*J)),{R:N,cells:M}}function LU(t,e){var r,n=ln(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Rr(n[7][0].data)>>>0>0?1:0:-1,o=dv(n[5],function(c){return PU(c,a)});return{nrows:Rr(n[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,d){if(c[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));c[u.R][d]=h}),c},[])}}function VU(t,e,r){var n,a=ln(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Rr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Rr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=At(o);var c=ln(a[4][0].data),u=yT(t,t[Ps(c[4][0].data)][0]),h=(n=c[17])!=null&&n[0]?yT(t,t[Ps(c[17][0].data)][0]):[],d=ln(c[3][0].data),g=0;d[1].forEach(function(x){var _=ln(x.data),T=t[Ps(_[2][0].data)][0],y=Rr(T.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var A=LU(t,T);A.data.forEach(function(w,N){w.forEach(function(U,R){var K=et({r:g+N,c:R}),te=MU(U,u,h);te&&(r[K]=te)})}),g+=A.nrows})}function UU(t,e){var r=ln(e.data),n={"!ref":"A1"},a=t[Ps(r[2][0].data)],o=Rr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return VU(t,a[0],n),n}function BU(t,e){var r,n=ln(e.data),a={name:(r=n[1])!=null&&r[0]?jg(n[1][0].data):"",sheets:[]},o=dv(n[2],Ps);return o.forEach(function(c){t[c].forEach(function(u){var h=Rr(u.meta[1][0].data);h==6e3&&a.sheets.push(UU(t,u))})}),a}function jU(t,e){var r=gv(),n=ln(e.data),a=dv(n[1],Ps);if(a.forEach(function(o){t[o].forEach(function(c){var u=Rr(c.meta[1][0].data);if(u==2){var h=BU(t,c);h.sheets.forEach(function(d,g){vv(r,d,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function rg(t){var e,r,n,a,o={},c=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=DU(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var g;try{g=IU(d)}catch(x){return console.log("## "+(x.message||x))}g.forEach(function(x){o[x.id]=x.messages,c.push(x.id)})}}),!c.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=o==null?void 0:o[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Rr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(h){o[h].forEach(function(d){var g=Rr(d.meta[1][0].data)>>>0;if(g==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return jU(o,u)}function HU(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function mv(t){HU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function zU(t){return Hl.WS.indexOf(t)>-1?"sheet":t==Hl.CS?"chart":t==Hl.DS?"dialog":t==Hl.MS?"macro":t&&t.length?t:"sheet"}function GU(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,zU(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function qU(t,e,r,n,a,o,c,u,h,d,g,x){try{o[n]=Bu(Xn(t,r,!0),e);var _=vr(t,e),T;switch(u){case"sheet":T=QV(_,e,a,h,o[n],d,g,x);break;case"chart":if(T=ZV(_,e,a,h,o[n],d,g,x),!T||!T["!drawel"])break;var y=Ru(T["!drawel"].Target,e),A=Pg(y),w=WP(Xn(t,y,!0),Bu(Xn(t,A,!0),y)),N=Ru(w,y),U=Pg(N);T=FV(Xn(t,N,!0),N,h,Bu(Xn(t,U,!0),N),d,T);break;case"macro":T=JV(_,e,a,h,o[n],d,g,x);break;case"dialog":T=eU(_,e,a,h,o[n],d,g,x);break;default:throw new Error("Unrecognized sheet type "+u)}c[n]=T;var R=[];o&&o[n]&&ai(o[n]).forEach(function(K){var te="";if(o[n][K].Type==Hl.CMNT){te=Ru(o[n][K].Target,e);var J=aU(vr(t,te,!0),te,h);if(!J||!J.length)return;iT(T,J,!1)}o[n][K].Type==Hl.TCMNT&&(te=Ru(o[n][K].Target,e),R=R.concat(ZP(vr(t,te,!0),h)))}),R&&R.length&&iT(T,R,!0,h.people||[])}catch(K){if(h.WTF)throw K}}function la(t){return t.charAt(0)=="/"?t.slice(1):t}function XU(t,e){if(LS(),e=e||{},mv(e),ua(t,"META-INF/manifest.xml")||ua(t,"objectdata.xml"))return vT(t,e);if(ua(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof rg<"u"){if(t.FileIndex)return rg(t);var r=wt.utils.cfb_new();return DE(t).forEach(function(De){K8(r,De,X8(t,De))}),rg(r)}throw new Error("Unsupported NUMBERS file")}if(!ua(t,"[Content_Types].xml"))throw ua(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ua(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=DE(t),a=HF(Xn(t,"[Content_Types].xml")),o=!1,c,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",vr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!vr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(zu=[],a.sst)try{zu=nU(vr(t,la(a.sst)),a.sst,e)}catch(De){if(e.WTF)throw De}e.cellStyles&&a.themes.length&&(h=rU(Xn(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=tU(vr(t,la(a.style)),a.style,h,e))}a.links.map(function(De){try{var be=Bu(Xn(t,Pg(la(De))),De);return sU(vr(t,la(De)),be,De,e)}catch{}});var g=WV(vr(t,la(a.workbooks[0])),a.workbooks[0],e),x={},_="";a.coreprops.length&&(_=vr(t,la(a.coreprops[0]),!0),_&&(x=h4(_)),a.extprops.length!==0&&(_=vr(t,la(a.extprops[0]),!0),_&&KF(_,x,e)));var T={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Xn(t,la(a.custprops[0]),!0),_&&(T=YF(_,e)));var y={};if((e.bookSheets||e.bookProps)&&(g.Sheets?c=g.Sheets.map(function(be){return be.name}):x.Worksheets&&x.SheetNames.length>0&&(c=x.SheetNames),e.bookProps&&(y.Props=x,y.Custprops=T),e.bookSheets&&typeof c<"u"&&(y.SheetNames=c),e.bookSheets?y.SheetNames:e.bookProps))return y;c={};var A={};e.bookDeps&&a.calcchain&&(A=iU(vr(t,la(a.calcchain)),a.calcchain));var w=0,N={},U,R;{var K=g.Sheets;x.Worksheets=K.length,x.SheetNames=[];for(var te=0;te!=K.length;++te)x.SheetNames[te]=K[te].name}var J=o?"bin":"xml",b=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,b+1)+"_rels/"+a.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");ua(t,I)||(I="xl/_rels/workbook."+J+".rels");var C=Bu(Xn(t,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=oU(vr(t,la(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=JP(vr(t,la(a.people[0])),e)),C&&(C=GU(C,g.Sheets));var V=vr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=x.Worksheets;++w){var M="sheet";if(C&&C[w]?(U="xl/"+C[w][1].replace(/[\/]?xl\//,""),ua(t,U)||(U=C[w][1]),ua(t,U)||(U=I.replace(/_rels\/.*$/,"")+C[w][1]),M=C[w][2]):(U="xl/worksheets/sheet"+(w+1-V)+"."+J,U=U.replace(/sheet0\./,"sheet.")),R=U.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(x.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var O=!1,L=0;L!=e.sheets.length;++L)typeof e.sheets[L]=="number"&&e.sheets[L]==w&&(O=1),typeof e.sheets[L]=="string"&&e.sheets[L].toLowerCase()==x.SheetNames[w].toLowerCase()&&(O=1);if(!O)continue e}}qU(t,U,R,x.SheetNames[w],w,N,c,M,e,g,h,d)}return y={Directory:a,Workbook:g,Props:x,Custprops:T,Deps:A,Sheets:c,SheetNames:x.SheetNames,Strings:zu,Styles:d,Themes:h,SSF:$r(it)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(De,be){De=De.replace(/^Root Entry[\/]/,""),y.keys.push(De),y.files[De]=t.FileIndex[be]}))),e&&e.bookVBA&&(a.vba.length>0?y.vbaraw=vr(t,la(a.vba[0]),!0):a.defaults&&a.defaults.bin===nL&&(y.vbaraw=vr(t,"xl/vbaProject.bin",!0))),y}function KU(t,e){var r=e||{},n="Workbook",a=wt.find(t,n);try{if(n="/!DataSpaces/Version",a=wt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(U9(a.content),n="/!DataSpaces/DataSpaceMap",a=wt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=j9(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=wt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=H9(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=wt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);G9(a.content)}catch{}if(n="/EncryptionInfo",a=wt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=q9(a.content);if(n="/EncryptedPackage",a=wt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function pv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Yn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function $U(t,e){return wt.find(t,"EncryptedPackage")?KU(t,e):W4(t,e)}function YU(t,e){var r,n=t,a=e||{};return a.type||(a.type=gt&&Buffer.isBuffer(t)?"buffer":"base64"),r=zS(n,a),XU(r,a)}function eb(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ug(t.slice(r),e);default:break e}return af.to_workbook(t,e)}function WU(t,e){var r="",n=pv(t,e);switch(e.type){case"base64":r=Yn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Uo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Xt(r)),e.type="binary",eb(r,e)}function QU(t,e){var r=t;return e.type=="base64"&&(r=Yn(r)),r=Og.utils.decode(1200,r.slice(2),"str"),e.type="binary",eb(r,e)}function ZU(t){return t.match(/[^\x00-\x7F]/)?Iu(t):t}function ng(t,e,r,n){return n?(r.type="string",af.to_workbook(t,r)):af.to_workbook(e,r)}function ed(t,e){SS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return ed(new Uint8Array(t),(r=$r(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Yl={},r.dateNF&&(Yl.dateNF=r.dateNF),r.type||(r.type=gt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=gt?"buffer":"binary",n=U8(t),typeof Uint8Array<"u"&&!gt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=ZU(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=$r(r),r.type="array",ed(K1(n),r)}switch((a=pv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return $U(wt.read(n,r),r);break;case 9:if(a[1]<=8)return W4(n,r);break;case 60:return Ug(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return b9(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return A9.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?YU(n,r):ng(t,n,r,o);case 239:return a[3]===60?Ug(n,r):ng(t,n,r,o);case 255:if(a[1]===254)return QU(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Hu.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Hu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return aT.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return nP.to_workbook(n,r);break;case 10:case 13:case 32:return WU(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return T9.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?aT.to_workbook(n,r):ng(t,n,r,o)}function JU(t,e,r,n,a,o,c,u){var h=Yr(r),d=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!c||t[r])for(var T=e.s.c;T<=e.e.c;++T){var y=c?t[r][T]:t[n[T]+h];if(y===void 0||y.t===void 0){if(d===void 0)continue;o[T]!=null&&(_[o[T]]=d);continue}var A=y.v;switch(y.t){case"z":if(A==null)break;continue;case"e":A=A==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(o[T]!=null){if(A==null)if(y.t=="e"&&A===null)_[o[T]]=null;else if(d!==void 0)_[o[T]]=d;else if(g&&A===null)_[o[T]]=null;else continue;else _[o[T]]=g&&(y.t!=="n"||y.t==="n"&&u.rawNumbers!==!1)?A:Gi(y,A,u);A!=null&&(x=!1)}}return{row:_,isempty:x}}function zg(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},g=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof g){case"string":h=ir(g);break;case"number":h=ir(t["!ref"]),h.s.r=g;break;default:h=g}n>0&&(a=0);var x=Yr(h.s.r),_=[],T=[],y=0,A=0,w=Array.isArray(t),N=h.s.r,U=0,R={};w&&!t[N]&&(t[N]=[]);var K=d.skipHidden&&t["!cols"]||[],te=d.skipHidden&&t["!rows"]||[];for(U=h.s.c;U<=h.e.c;++U)if(!(K[U]||{}).hidden)switch(_[U]=br(U),r=w?t[N][U]:t[_[U]+x],n){case 1:o[U]=U-h.s.c;break;case 2:o[U]=_[U];break;case 3:o[U]=d.header[U-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=Gi(r,null,d),A=R[c]||0,!A)R[c]=1;else{do u=c+"_"+A++;while(R[u]);R[c]=A,R[u]=1}o[U]=u}for(N=h.s.r+a;N<=h.e.r;++N)if(!(te[N]||{}).hidden){var J=JU(t,h,N,_,n,o,w,d);(J.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(T[y++]=J.row)}return T.length=y,T}var ET=/"/g;function eB(t,e,r,n,a,o,c,u){for(var h=!0,d=[],g="",x=Yr(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var T=u.dense?(t[r]||[])[_]:t[n[_]+x];if(T==null)g="";else if(T.v!=null){h=!1,g=""+(u.rawNumbers&&T.t=="n"?T.v:Gi(T,null,u));for(var y=0,A=0;y!==g.length;++y)if((A=g.charCodeAt(y))===a||A===o||A===34||u.forceQuotes){g='"'+g.replace(ET,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(h=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(ET,'""')+'"')):g="";d.push(g)}return u.blankrows===!1&&h?null:d.join(c)}function tb(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=ir(t["!ref"]),o=n.FS!==void 0?n.FS:",",c=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),g="",x=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],T=n.skipHidden&&t["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(_[y]||{}).hidden||(x[y]=br(y));for(var A=0,w=a.s.r;w<=a.e.r;++w)(T[w]||{}).hidden||(g=eB(t,a,w,x,c,h,o,n),g!=null&&(n.strip&&(g=g.replace(d,"")),(g||n.blankrows!==!1)&&r.push((A++?u:"")+g)));return delete n.dense,r.join("")}function tB(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=tb(t,e);return r}function rB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=ir(t["!ref"]),o="",c=[],u,h=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)c[u]=br(u);for(var g=a.s.r;g<=a.e.r;++g)for(o=Yr(g),u=a.s.c;u<=a.e.c;++u)if(e=c[u]+o,r=d?(t[g]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function rb(t,e,r){var n=r||{},a=+!n.skipHeader,o=t||{},c=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?wn(n.origin):n.origin;c=h.r,u=h.c}var d,g={s:{c:0,r:0},e:{c:u,r:c+e.length-1+a}};if(o["!ref"]){var x=ir(o["!ref"]);g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),c==-1&&(c=x.e.r+1,g.e.r=c+e.length-1+a)}else c==-1&&(c=0,g.e.r=e.length-1+a);var _=n.header||[],T=0;e.forEach(function(A,w){ai(A).forEach(function(N){(T=_.indexOf(N))==-1&&(_[T=_.length]=N);var U=A[N],R="z",K="",te=et({c:u+T,r:c+w+a});d=cf(o,te),U&&typeof U=="object"&&!(U instanceof Date)?o[te]=U:(typeof U=="number"?R="n":typeof U=="boolean"?R="b":typeof U=="string"?R="s":U instanceof Date?(R="d",n.cellDates||(R="n",U=Sn(U)),K=n.dateNF||it[14]):U===null&&n.nullError&&(R="e",U=0),d?(d.t=R,d.v=U,delete d.w,delete d.R,K&&(d.z=K)):o[te]=d={t:R,v:U},K&&(d.z=K))})}),g.e.c=Math.max(g.e.c,u+_.length-1);var y=Yr(c);if(a)for(T=0;T<_.length;++T)o[br(T+u)+y]={t:"s",v:_[T]};return o["!ref"]=At(g),o}function nB(t,e){return rb(null,t,e)}function cf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=wn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?cf(t,et(e)):cf(t,et({r:e,c:r||0}))}function aB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function gv(){return{SheetNames:[],Sheets:{}}}function vv(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var c=o&&o[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=c+a)!=-1;++a);}if(HV(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function iB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=aB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function sB(t,e){return t.z=e,t}function nb(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function oB(t,e,r){return nb(t,"#"+e,r)}function lB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function cB(t,e,r,n){for(var a=typeof e!="string"?e:ir(e),o=typeof e=="string"?e:At(e),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var h=cf(t,c,u);h.t="n",h.F=o,delete h.v,c==a.s.r&&u==a.s.c&&(h.f=r,n&&(h.D=!0))}return t}var TT={encode_col:br,encode_row:Yr,encode_cell:et,encode_range:At,decode_col:rv,decode_row:tv,split_cell:EF,decode_cell:wn,decode_range:xc,format_cell:Gi,sheet_add_aoa:o4,sheet_add_json:rb,sheet_add_dom:Q4,aoa_to_sheet:_c,json_to_sheet:nB,table_to_sheet:Z4,table_to_book:bU,sheet_to_csv:tb,sheet_to_txt:tB,sheet_to_json:zg,sheet_to_html:SU,sheet_to_formulae:rB,sheet_to_row_object_array:zg,sheet_get_cell:cf,book_new:gv,book_append_sheet:vv,book_set_sheet_visibility:iB,cell_set_number_format:sB,cell_set_hyperlink:nb,cell_set_internal_link:oB,cell_add_comment:lB,sheet_set_array_formula:cB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const uB=()=>{const t=ff(),[e,r]=_e.useState(!1),[n,a]=_e.useState([]),[o,c]=_e.useState(!1),[u,h]=_e.useState(!1),[d,g]=_e.useState(0),x=async y=>{var N;const A=(N=y.target.files)==null?void 0:N[0];if(!A)return;r(!0);const w=new FileReader;w.onload=U=>{var R;try{const K=new Uint8Array((R=U.target)==null?void 0:R.result),J=ed(K,{type:"array"}).Sheets.Tutti,b=TT.sheet_to_json(J,{header:1});let I=b.findIndex(L=>{var De;return((De=L[0])==null?void 0:De.toString().toLowerCase().includes("id"))&&L.includes("Nome")});if(I===-1)throw new Error("Intestazione Statistiche non trovata");const C=b[I],V=b.slice(I+1),M=L=>C.findIndex(De=>(De==null?void 0:De.toString().trim())===L),O=V.filter(L=>L.length>0&&L[0]).map(L=>{var De;return{Cod:parseInt(L[M("Id")]),R:L[M("R")],Rm:((De=L[M("Rm")])==null?void 0:De.toString().split(";").map(be=>be.trim()))||[],Nome:L[M("Nome")],Squadra:L[M("Squadra")],Pv:parseInt(L[M("Pv")])||0,Mv:parseFloat(L[M("Mv")])||0,Fm:parseFloat(L[M("Fm")])||0,Gf:parseInt(L[M("Gf")])||0,Gs:parseInt(L[M("Gs")])||0,Rp:parseInt(L[M("Rp")])||0,Rc:parseInt(L[M("Rc")])||0,Rf:parseInt(L[M("R+")])||0,Rs:parseInt(L[M("R-")])||0,Ass:parseInt(L[M("Ass")])||0,Amm:parseInt(L[M("Amm")])||0,Esp:parseInt(L[M("Esp")])||0,Au:parseInt(L[M("Au")])||0,FantaSquadra:"-",Costo:0,Fl:!1}});a(O)}catch(K){alert("Errore file statistiche: "+K)}finally{r(!1)}},w.readAsArrayBuffer(A)},_=async y=>{var N;const A=(N=y.target.files)==null?void 0:N[0];if(!A||n.length===0){alert("Carica prima il file delle statistiche!");return}r(!0);const w=new FileReader;w.onload=U=>{var R;try{const K=new Uint8Array((R=U.target)==null?void 0:R.result),J=ed(K,{type:"array"}).Sheets["Lista calciatori"];if(!J)throw new Error("Foglio 'Lista calciatori' non trovato");const b=TT.sheet_to_json(J,{header:1});let I=b.findIndex(ue=>ue.includes("Id")&&ue.includes("FantaSquadra"));if(I===-1)throw new Error("Intestazioni 'Id', 'FantaSquadra' non trovate");const C=b[I],V=b.slice(I+1),M=C.indexOf("Id"),O=C.indexOf("FantaSquadra"),L=C.indexOf("Costo"),De=C.indexOf("Fuori lista"),be=new Map;V.forEach(ue=>{ue[M]&&be.set(parseInt(ue[M]),{fanta:ue[O]||"-",costo:parseInt(ue[L])||0,fl:ue[De]=="*"})});const ae=n.map(ue=>{const Le=be.get(ue.Cod);return Le?{...ue,FantaSquadra:Le.fanta,Costo:Le.costo,Fl:Le.fl}:ue});a(ae),c(!0)}catch(K){alert("Errore file asta: "+K)}finally{r(!1)}},w.readAsArrayBuffer(A)},T=async()=>{if(n.length===0)return;h(!0),g(0);const y=50,A=n.length,w=[];for(let N=0;N<A;N+=y)w.push(n.slice(N,N+y));try{for(let N=0;N<w.length;N++){await s8(w[N]);const U=Math.round((N+1)/w.length*100);g(U)}}catch(N){console.log("errore durante il caricamento",N)}finally{h(!1),t("/home")}};return F.jsxs("div",{className:"flex flex-col gap-6 p-6 bg-gray-900/50 border border-gray-800 rounded-3xl shadow-2xl backdrop-blur-sm",children:[F.jsxs("div",{className:"flex items-center gap-3",children:[F.jsx(C5,{className:"text-emerald-500 w-8 h-8"}),F.jsxs("h2",{className:"text-2xl font-black italic uppercase tracking-tighter text-white",children:["Import ",F.jsx("span",{className:"text-emerald-500",children:"Dati"})]})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[F.jsxs("div",{className:"flex flex-col gap-2",children:[F.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 ml-2",children:"1. File Statistiche (Tutti)"}),F.jsxs("div",{className:"relative group",children:[F.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:x,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",disabled:e}),F.jsxs("div",{className:`p-4 border-2 border-dashed rounded-2xl flex items-center justify-center gap-3 transition-all ${n.length>0?"border-emerald-500/50 bg-emerald-500/5":"border-gray-700 bg-gray-800/40 group-hover:border-emerald-500/30"}`,children:[F.jsx(S5,{className:n.length>0?"text-emerald-500":"text-gray-500"}),F.jsx("span",{className:"text-sm font-bold text-gray-300",children:n.length>0?`${n.length} Giocatori Caricati`:"Carica Statistiche"})]})]})]}),F.jsxs("div",{className:`flex flex-col gap-2 ${n.length===0?"opacity-30 pointer-events-none":""}`,children:[F.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 ml-2",children:"2. File Asta (Lista calciatori)"}),F.jsxs("div",{className:"relative group",children:[F.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:_,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),F.jsxs("div",{className:`p-4 border-2 border-dashed rounded-2xl flex items-center justify-center gap-3 transition-all ${o?"border-blue-500/50 bg-blue-500/5":"border-gray-700 bg-gray-800/40 group-hover:border-blue-500/30"}`,children:[o?F.jsx(w5,{className:"text-blue-500"}):F.jsx(Kp,{className:"text-gray-500"}),F.jsx("span",{className:"text-sm font-bold text-gray-300",children:o?"Asta Accoppiata":"Carica Dati Asta"})]})]})]})]}),n.length>0&&F.jsxs("button",{onClick:()=>T(),disabled:e,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-black uppercase tracking-widest py-4 rounded-2xl shadow-xl shadow-emerald-900/20 transition-all flex items-center justify-center gap-3 active:scale-[0.98]",children:[F.jsx(Kp,{className:"w-5 h-5"}),"Sincronizza ",n.length," Giocatori su Firestore"]}),e&&F.jsxs("div",{className:"flex items-center justify-center gap-2 text-emerald-500 animate-pulse",children:[F.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-bounce"}),F.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Elaborazione Excel..."})]}),u&&F.jsxs("div",{className:"absolute inset-0 bg-gray-900/90 backdrop-blur-md z-50 rounded-3xl flex flex-col items-center justify-center p-8",children:[F.jsxs("div",{className:"relative mb-6",children:[F.jsx("div",{className:"w-20 h-20 border-4 border-emerald-500/10 border-t-emerald-500 rounded-full animate-spin"}),F.jsx(Kp,{className:"absolute inset-0 m-auto w-8 h-8 text-emerald-500 animate-pulse"})]}),F.jsxs("div",{className:"w-full max-w-xs flex flex-col items-center gap-3",children:[F.jsxs("div",{className:"flex justify-between w-full mb-1",children:[F.jsx("span",{className:"text-emerald-500 font-black italic uppercase tracking-widest text-xs",children:"Sincronizzazione"}),F.jsxs("span",{className:"text-emerald-500 font-black text-sm",children:[d,"%"]})]}),F.jsx("div",{className:"w-full h-3 bg-gray-800 rounded-full overflow-hidden border border-gray-700 shadow-inner",children:F.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-300 ease-out shadow-[0_0_15px_rgba(16,185,129,0.5)]",style:{width:`${d}%`}})}),F.jsx("p",{className:"mt-2 text-gray-500 font-bold uppercase text-[10px] tracking-widest animate-pulse",children:"Caricamento Dati..."})]})]})]})},fB=()=>{const{isEditor:t,loading:e}=gc();return e?F.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:F.jsx(Hh,{className:"w-10 h-10 text-emerald-500 animate-spin"})}):t?F.jsx("div",{className:"p-4 md:p-8 bg-gray-900 min-h-screen text-white",children:F.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col gap-6",children:[F.jsxs("div",{className:"flex items-center justify-between bg-gray-800/40 p-6 rounded-3xl border border-gray-800 backdrop-blur-md shadow-xl",children:[F.jsxs("div",{children:[F.jsxs("h1",{className:"text-3xl font-black italic uppercase tracking-tighter",children:["Area ",F.jsx("span",{className:"text-emerald-500",children:"Staff"})]}),F.jsx("p",{className:"text-gray-400 text-[10px] font-bold uppercase tracking-[0.2em] mt-1",children:"Data Entry & Statistiche Avanzate"})]}),F.jsx(Sa,{to:"/",className:"bg-white/5 hover:bg-white/10 text-white py-2.5 px-5 rounded-2xl border border-white/10 transition-all text-[10px] font-black uppercase tracking-widest shadow-inner",children:"Chiudi Editor"})]}),F.jsx("div",{className:"bg-gray-800/20 rounded-3xl border border-gray-800 p-2 sm:p-6 shadow-2xl",children:F.jsx(uB,{})})]})}):F.jsx("div",{className:"min-h-screen bg-gray-900 flex flex-col items-center justify-center text-white p-4",children:F.jsxs("div",{className:"bg-gray-800 p-10 rounded-3xl border border-gray-700 text-center shadow-2xl",children:[F.jsx(z5,{className:"w-16 h-16 text-red-500 mb-4 mx-auto"}),F.jsx("h2",{className:"text-2xl font-black uppercase italic tracking-tighter mb-2",children:"Accesso Riservato"}),F.jsxs("p",{className:"text-gray-400 text-sm max-w-xs mb-8",children:["Questa sezione  dedicata esclusivamente allo staff tecnico di ",F.jsx("strong",{children:"Golasso"}),"."]}),F.jsx(Sa,{to:"/",className:"inline-block bg-emerald-600 hover:bg-emerald-500 text-white px-8 py-3 rounded-2xl font-bold transition-all active:scale-95",children:"Torna in Campo"})]})})},hB=h1(bd),dB=()=>{const t=ff(),[e,r]=_e.useState(!0);_e.useEffect(()=>{const a=xw(hB,o=>{o?t("/home"):r(!1)});return()=>a()},[t]);const n=async()=>{try{await e8(),t("/home")}catch(a){console.error("Errore login:",a)}};return e?F.jsx("div",{className:"min-h-screen w-full bg-gray-900 flex items-center justify-center",children:F.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-emerald-500"})}):F.jsxs("div",{className:"min-h-screen w-full bg-gray-900 flex flex-col items-center justify-center p-4",children:[F.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-emerald-600/10 blur-[120px] rounded-full"}),F.jsxs("div",{className:"relative w-full max-w-md bg-gray-800 border border-gray-700 p-10 rounded-3xl shadow-2xl text-center",children:[F.jsx("div",{className:"mb-6 flex justify-center",children:F.jsx("img",{src:yS,alt:"Golasso Logo",className:"w-24 h-24 drop-shadow-[0_0_15px_rgba(16,185,129,0.3)]"})}),F.jsx("p",{className:"text-gray-400 mt-3 mb-10 text-sm",children:"La piattaforma definitiva per la gestione del tuo Fantacalcio."}),F.jsxs("button",{onClick:n,className:"w-full flex items-center justify-center gap-3 bg-white hover:bg-gray-100 text-gray-900 font-bold py-4 px-6 rounded-2xl transition-all duration-200 shadow-xl active:scale-[0.97]",children:[F.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",children:[F.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),F.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),F.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),F.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.66l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Entra in Campo"]}),F.jsx("div",{className:"mt-10 text-[10px] text-gray-600 uppercase tracking-widest font-semibold",children:"Powered by Golasso Engine"})]})]})},mB=()=>{const{profile:t,isAdmin:e,loading:r}=gc(),[n,a]=_e.useState([]),[o,c]=_e.useState(!1),[u,h]=_e.useState(null),d=async()=>{c(!0);try{const x=await u5();a(x)}catch(x){h(`Errore nel caricamento utenti: ${x.message}`)}finally{c(!1)}};_e.useEffect(()=>{!r&&e&&d()},[r,e]);const g=async(x,_)=>{if(h(null),!e){h("Permessi insufficienti.");return}if(!((t==null?void 0:t.ID)===x&&_!==En.Admin&&!window.confirm("Attenzione: stai per declassare te stesso. Continuare?")))try{await c5(x,_),a(T=>T.map(y=>y.ID===x?{...y,idProfilo:_}:y))}catch(T){h(T.message||"Errore durante il cambio ruolo.")}};return r?F.jsxs("div",{className:"w-full h-screen bg-gray-900 flex flex-col items-center justify-center",children:[F.jsx(Hh,{className:"w-12 h-12 text-emerald-500 animate-spin mb-4"}),F.jsx("p",{className:"text-emerald-500 font-bold tracking-widest uppercase text-xs",children:"Verifica credenziali..."})]}):t?F.jsx("div",{className:"w-full bg-gray-900 text-white min-h-screen p-4 md:p-8",children:F.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col gap-8",children:[F.jsxs("div",{className:"flex justify-between items-end border-b border-gray-800 pb-6",children:[F.jsxs("div",{children:[F.jsxs("h2",{className:"text-3xl font-black italic uppercase tracking-tighter",children:["Gestione ",F.jsx("span",{className:"text-emerald-500",children:"Account"})]}),F.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-widest mt-1",children:"Pannello Controllo Staff"})]}),F.jsx(Sa,{to:"/",className:"text-xs bg-gray-800 border border-gray-700 px-4 py-2 rounded-xl hover:bg-gray-700 font-bold transition-all",children:"Home"})]}),F.jsxs("section",{className:"bg-gray-800/30 p-6 rounded-3xl border border-gray-800 backdrop-blur-sm flex items-center justify-between",children:[F.jsxs("div",{className:"flex items-center gap-4",children:[F.jsx("div",{className:"w-12 h-12 bg-emerald-500/10 rounded-2xl flex items-center justify-center border border-emerald-500/20",children:F.jsx(q5,{className:"text-emerald-500 w-6 h-6"})}),F.jsxs("div",{children:[F.jsx("p",{className:"text-gray-500 uppercase text-[10px] font-black tracking-widest",children:"Il mio Account"}),F.jsx("p",{className:"text-sm font-mono text-gray-300",children:t.ID})]})]}),F.jsx("div",{className:"text-right",children:F.jsx("span",{className:"bg-emerald-500 text-gray-900 px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-wider",children:En[t.idProfilo]})})]}),u&&F.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-xl text-xs font-bold flex items-center gap-2 animate-in fade-in",children:[F.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),u]}),e&&F.jsxs("section",{className:"flex flex-col gap-6 mt-4",children:[F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{className:"flex items-center gap-2",children:[F.jsx(_S,{className:"w-5 h-5 text-emerald-500"}),F.jsxs("h3",{className:"text-xl font-black italic uppercase tracking-tighter",children:["Utenti ",F.jsx("span",{className:"text-emerald-500 pr-1",children:"Registrati"})]})]}),o&&F.jsx(Hh,{className:"w-4 h-4 text-emerald-500 animate-spin"})]}),n.length===0&&!o?F.jsx("div",{className:"bg-gray-800/20 p-12 rounded-3xl border border-gray-800 border-dashed text-center text-gray-600 italic",children:"Nessun utente trovato nel database."}):F.jsx("div",{className:"overflow-hidden rounded-3xl border border-gray-800 bg-gray-800/10",children:F.jsxs("table",{className:"w-full text-left border-collapse",children:[F.jsx("thead",{className:"bg-gray-800/50 text-gray-500 uppercase text-[10px] font-black tracking-widest border-b border-gray-800",children:F.jsxs("tr",{children:[F.jsx("th",{className:"px-6 py-4",children:"ID Utente"}),F.jsx("th",{className:"px-6 py-4",children:"Grado Profilo"}),F.jsx("th",{className:"px-6 py-4 text-right",children:"Modifica Permessi"})]})}),F.jsx("tbody",{className:"divide-y divide-gray-800",children:n.map(x=>F.jsxs("tr",{className:"hover:bg-white/5 transition-colors group",children:[F.jsx("td",{className:"px-6 py-4 font-mono text-[10px] text-gray-500 group-hover:text-gray-300 transition-colors",children:x.ID}),F.jsx("td",{className:"px-6 py-4",children:F.jsx("span",{className:`px-2 py-1 rounded-md text-[9px] font-black uppercase tracking-wider ${x.idProfilo===En.Admin?"bg-purple-500/10 text-purple-400 border border-purple-500/20":x.idProfilo===En.Scrittore?"bg-blue-500/10 text-blue-400 border border-blue-500/20":"bg-gray-500/10 text-gray-400 border border-gray-500/20"}`,children:En[x.idProfilo]})}),F.jsx("td",{className:"px-6 py-4 text-right",children:F.jsx("select",{value:x.idProfilo,onChange:_=>g(x.ID,parseInt(_.target.value)),className:"bg-gray-900 border border-gray-700 text-[10px] font-bold uppercase rounded-xl px-3 py-2 focus:ring-2 focus:ring-emerald-500 outline-none cursor-pointer hover:border-emerald-500 transition-all shadow-inner",children:Object.values(En).filter(_=>typeof _=="number").map(_=>F.jsx("option",{value:_,children:En[_]},_))})})]},x.ID))})]})})]})]})}):F.jsxs("div",{className:"w-full h-screen bg-gray-900 flex flex-col items-center justify-center p-4",children:[F.jsx("p",{className:"text-gray-500 mb-6 font-medium",children:"Sessione non trovata o scaduta."}),F.jsx(Sa,{to:"/login",className:"bg-emerald-600 px-8 py-3 rounded-2xl text-white font-bold hover:bg-emerald-500 transition-all shadow-lg shadow-emerald-900/20",children:"Torna al Login"})]})},pB=t=>t<5?"text-red-500":t<6?"text-yellow-500":t>=6.3?"text-emerald-500":"text-gray-400",gB=t=>t<5?"text-red-500":t<6?"text-yellow-500":t>=6.7?"text-emerald-500":"text-gray-400",vB=t=>t<5?"text-red-500":t<10?"text-yellow-500":t>=15?"text-emerald-500":"text-gray-400",wT=["ATALANTA","BOLOGNA","COMO","JUVENTUS","INTER","MILAN","NAPOLI","ROMA"],xB={P:1,D:1.2,C:1.8,A:3.5},_B=(t,e,r)=>{var _,T;const n=r.map(y=>{const w=t.filter(N=>N.FantaSquadra===y&&!N.Fl).reduce((N,U)=>N+(Number(U.Costo)||0),0);return{teamName:y,budget:500-w}}),a=(_=e[0])==null?void 0:_.FantaSquadra,o=((T=n.find(y=>y.teamName===a))==null?void 0:T.budget)||0,c={P:0,D:0,C:0,A:0};r.forEach(y=>{t.filter(w=>w.FantaSquadra===y&&(w.Fl||Number(w.Fm)<6||Number(w.Mv)<6)).forEach(w=>{c[w.R]!==void 0&&c[w.R]++})});const u=e.filter(y=>y.Fl||Number(y.Mv)<6||Number(y.Fm)<6).sort(y=>y.Fl?-1:1),h=Array.from(new Set(u.map(y=>y.R))),d=t.filter(y=>(!y.FantaSquadra||y.FantaSquadra==="-"||y.FantaSquadra==="LIBERI")&&!y.Fl).map(y=>{var N;let A=Number(y.Fm)||0;const w=((N=y.Squadra)==null?void 0:N.toUpperCase())||"";return wT.includes(w)&&(A+=.5),{...y,dynamicScore:A}}).sort((y,A)=>A.dynamicScore-y.dynamicScore),g={P:0,D:0,C:0,A:0},x=d.filter(y=>h.includes(y.R)).map(y=>{g[y.R]++;const A=g[y.R];let w=A===1?2.8:A===2?2.1:A===3?1.6:.8;const N=d.filter(b=>b.R===y.R&&Number(b.Fm)>=6.5).length||1,U=c[y.R]/N,R=y.dynamicScore*xB[y.R],K=Math.max(1,U*.4);let te=Math.round(R*K*w);const J=n.filter(b=>b.budget>100).length;return A<=3&&(te+=J*5),{...y,rankNelRuolo:A,stimaPrezzo:te,livelloHype:A<=3?"ASTA FOLLIA":"POSSIBILE AFFARE",convenienza:o>=te?"ALTA":"RISCHIOSA"}}).filter(y=>{var A;return Number(y.Pv)>=5||wT.includes(((A=y.Squadra)==null?void 0:A.toUpperCase())||"")}).sort((y,A)=>A.dynamicScore-y.dynamicScore);return{daTagliare:u,suggerimenti:x}},yB=()=>{const{giocatori:t}=wS(),[e,r]=_e.useState(yh[0]),n=_e.useMemo(()=>t.filter(u=>{var h;return((h=u.FantaSquadra)==null?void 0:h.trim().toUpperCase())===e.trim().toUpperCase()}),[t,e]),a=_e.useMemo(()=>{const u=n.reduce((d,g)=>d+(g.Costo||0),0),h=n.filter(d=>!d.Fl).reduce((d,g)=>d+(g.Costo||0),0);return{rimastiNominali:500-u,rimastiReali:500-h+50,totaleSpeso:u,fuoriLista:n.filter(d=>d.Fl).length}},[n]),o=_e.useMemo(()=>_B(t,n,yh),[t,n]),c=[{key:"P",label:"Portieri",color:"text-orange-400"},{key:"D",label:"Difensori",color:"text-emerald-400"},{key:"C",label:"Centrocampisti",color:"text-blue-400"},{key:"A",label:"Attaccanti",color:"text-red-400"}];return F.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[F.jsx(ES,{}),F.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[F.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-4",children:[F.jsxs("div",{className:"flex flex-col gap-2",children:[F.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-emerald-500",children:"Seleziona Team"}),F.jsx("select",{value:e,onChange:u=>r(u.target.value),className:"bg-gray-900 border-2 border-gray-800 text-2xl font-black italic uppercase p-3 rounded-2xl focus:border-emerald-500 outline-none transition-all cursor-pointer",children:yh.map(u=>F.jsx("option",{value:u,children:u},u))})]}),F.jsxs("div",{className:"flex gap-4 w-full md:w-auto",children:[F.jsxs("div",{className:"flex-1 md:w-48 bg-gray-900 p-4 rounded-2xl border border-gray-800 shadow-xl",children:[F.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[F.jsx(Z5,{className:"w-4 h-4"}),F.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Crediti Residui"})]}),F.jsx("p",{className:"text-3xl font-black text-white",children:a.rimastiNominali})]}),F.jsxs("div",{className:"flex-1 md:w-48 bg-emerald-900/20 p-4 rounded-2xl border border-emerald-500/30 shadow-xl relative overflow-hidden",children:[F.jsxs("div",{className:"flex items-center gap-2 text-emerald-500 mb-1",children:[F.jsx(D5,{className:"w-4 h-4"}),F.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Residui Reali"})]}),F.jsx("p",{className:"text-3xl font-black text-emerald-400",children:a.rimastiReali}),a.fuoriLista>0&&F.jsxs("div",{className:"absolute top-2 right-2 text-[8px] bg-emerald-500 text-black px-1.5 py-0.5 rounded font-black animate-pulse",children:["+",a.totaleSpeso-(500-a.rimastiReali)," RECUPERATI"]})]})]})]}),F.jsx("div",{className:"grid grid-cols-1",children:c.map(u=>{const h=n.filter(d=>d.R===u.key);return h.length===0?null:F.jsxs("section",{className:"p-4",children:[F.jsxs("div",{className:"flex justify-between items-center mb-6",children:[F.jsx("h3",{className:`text-xl font-black italic uppercase tracking-tighter ${u.color}`,children:u.label}),F.jsxs("span",{className:"text-xs font-bold text-gray-600 bg-gray-800 px-3 py-1 rounded-full",children:[h.length," GIOCATORI"]})]}),F.jsx("div",{className:"space-y-3",children:h.map(d=>F.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl border transition-all ${Number(d.Fl)===1?"bg-red-500/5 border-red-500/20 opacity-60":"bg-gray-800/40 border-gray-700/50 hover:border-gray-600"}`,children:[F.jsxs("div",{className:"flex items-center gap-3",children:[F.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-900 rounded-lg text-[10px] font-black border border-gray-700",children:d.Squadra.substring(0,3).toUpperCase()}),F.jsxs("div",{children:[F.jsxs("p",{className:"font-bold text-sm flex items-center gap-2",children:[d.Nome,d.Fl&&F.jsx("span",{title:"Fuori Lista",children:F.jsx(Y5,{className:"w-3 h-3 text-red-500"})})]}),F.jsxs("p",{className:"text-[9px] uppercase font-black tracking-widest flex gap-2",children:[F.jsxs("span",{className:"text-gray-500",children:["MV: ",F.jsx("span",{className:pB(d.Mv),children:d.Mv.toFixed(2)})]}),F.jsx("span",{className:"text-gray-700",children:"|"}),F.jsxs("span",{className:"text-gray-500",children:["FM: ",F.jsx("span",{className:gB(d.Fm),children:d.Fm.toFixed(2)})]}),F.jsx("span",{className:"text-gray-700",children:"|"}),F.jsxs("span",{className:"text-gray-500",children:["PV: ",F.jsx("span",{className:vB(d.Pv),children:d.Pv})]})]})]})]}),F.jsxs("div",{className:"text-right",children:[F.jsx("p",{className:"text-emerald-500 font-black text-lg leading-none",children:d.Costo}),F.jsx("p",{className:"text-[8px] text-gray-600 font-bold uppercase tracking-tighter",children:"Crediti"})]})]},d.Cod))})]},u.key)})}),F.jsxs("section",{className:"mt-12 bg-gray-900/60 rounded-3xl border border-emerald-500/20 p-8 backdrop-blur-md",children:[F.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[F.jsx("div",{className:"p-2 bg-emerald-500/20 rounded-lg",children:F.jsx(K5,{className:"text-emerald-500 w-6 h-6"})}),F.jsxs("div",{children:[F.jsxs("h2",{className:"text-2xl font-black uppercase italic tracking-tighter",children:["Analisi ",F.jsx("span",{className:"text-emerald-500",children:"Mercato"})]}),F.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest",children:"Sostituzioni consigliate per ruolo"})]})]}),F.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[F.jsx("div",{className:"space-y-4",children:o.daTagliare.map(u=>F.jsxs("div",{className:`p-3 rounded-xl border ${u.Fl?"bg-red-500/20 border-red-500":"bg-gray-800/40 border-gray-700"}`,children:[F.jsxs("div",{className:"flex justify-between items-center",children:[F.jsx("p",{className:"font-bold",children:u.Nome}),u.Fl&&F.jsx("span",{className:"text-[8px] bg-red-600 px-2 py-1 rounded-md animate-pulse",children:"NON IN LISTA"})]}),F.jsxs("p",{className:"text-[10px] text-gray-500",children:["Recuperi: ",u.Costo," cr."]})]},u.Cod))}),F.jsx("div",{className:"space-y-4",children:o.suggerimenti.slice(0,10).map(u=>F.jsxs("div",{className:"p-3 bg-emerald-500/5 border border-emerald-500/20 rounded-xl flex justify-between items-center",children:[F.jsxs("div",{children:[F.jsxs("p",{className:"font-black text-emerald-400",children:[u.Nome," ",F.jsxs("span",{className:"text-[9px] text-gray-500",children:["(",u.Squadra,")"]})]}),F.jsxs("p",{className:"text-[10px] font-bold",children:["Stima asta: ",F.jsxs("span",{className:"text-white",children:[u.stimaPrezzo," cr."]})]})]}),F.jsx("div",{className:`text-[9px] font-black px-2 py-1 rounded ${u.convenienza==="ALTA"?"bg-emerald-500 text-black":"bg-yellow-500 text-black"}`,children:u.convenienza})]},u.Cod))})]})]})]})]})};function Tu({children:t,requiredRole:e=En.Lettore}){const{profile:r,loading:n,user:a}=gc();return n?F.jsx("div",{className:"h-screen w-full bg-gray-900 flex items-center justify-center",children:F.jsx("div",{className:"w-12 h-12 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):a?((r==null?void 0:r.idProfilo)??En.Lettore)<e?F.jsx(ig,{to:"/home",replace:!0}):t:F.jsx(ig,{to:"/login",replace:!0})}function EB(){return _e.useEffect(()=>{gc.getState().initialize()},[]),F.jsx(ZC,{children:F.jsxs(CC,{children:[F.jsx(ws,{path:"/login",element:F.jsx(dB,{})}),F.jsx(ws,{path:"/home",element:F.jsx(Tu,{children:F.jsx(o8,{})})}),F.jsx(ws,{path:"/fantasquadra",element:F.jsx(Tu,{children:F.jsx(yB,{})})}),F.jsx(ws,{path:"/giocatore",element:F.jsx(Tu,{children:F.jsx(l8,{})})}),F.jsx(ws,{path:"/statistiche-er",element:F.jsx(Tu,{requiredRole:En.Scrittore,children:F.jsx(fB,{})})}),F.jsx(ws,{path:"/gestione-ruoli",element:F.jsx(Tu,{requiredRole:En.Admin,children:F.jsx(mB,{})})}),F.jsx(ws,{path:"/*",element:F.jsx(ig,{to:"/home",replace:!0})})]})})}Vk.createRoot(document.getElementById("root")).render(F.jsx(_e.StrictMode,{children:F.jsx(EB,{})}));
